2023/09/15 11:02:16.471825 ttutil.go:133: -----------------------------------------------------------------------------------
2023/09/15 11:02:16.472317 ttdb.go:51: Opening DB Connection to mysql instance
User: root
Host: tuk.coil1nnpqdlr.eu-west-1.rds.amazonaws.com
Port: :3306
Name: tuk
Connect Timeout 2s
Read Timeout 5s
2023/09/15 11:02:16.472436 ttdb.go:54: Opened Database
2023/09/15 11:02:16.659449 ttdb.go:379: Persisting Template dsubcancel_tmplt
2023/09/15 11:02:16.723569 ttdb.go:385: Persisted Template dsubcancel_tmplt
2023/09/15 11:02:16.723621 ttdb.go:366: Persisted Template dsubcancel_tmplt.xml
2023/09/15 11:02:16.786616 ttdb.go:379: Persisting Template cgl_tmplt
2023/09/15 11:02:16.885790 ttdb.go:385: Persisted Template cgl_tmplt
2023/09/15 11:02:16.885943 ttdb.go:366: Persisted Template cgl_tmplt.html
2023/09/15 11:02:16.949724 ttdb.go:379: Persisting Template pdssearch_tmplt
2023/09/15 11:02:17.018656 ttdb.go:385: Persisted Template pdssearch_tmplt
2023/09/15 11:02:17.018785 ttdb.go:366: Persisted Template pdssearch_tmplt.html
2023/09/15 11:02:17.082437 ttdb.go:379: Persisting Template dsubsubscribe_tmplt
2023/09/15 11:02:17.147351 ttdb.go:385: Persisted Template dsubsubscribe_tmplt
2023/09/15 11:02:17.147405 ttdb.go:366: Persisted Template dsubsubscribe_tmplt.xml
2023/09/15 11:02:17.211411 ttdb.go:379: Persisting Template notification_tmplt
2023/09/15 11:02:17.275868 ttdb.go:385: Persisted Template notification_tmplt
2023/09/15 11:02:17.275950 ttdb.go:366: Persisted Template notification_tmplt.txt
2023/09/15 11:02:17.338768 ttdb.go:379: Persisting Template wfstate2t_tmplt
2023/09/15 11:02:17.454217 ttdb.go:385: Persisted Template wfstate2t_tmplt
2023/09/15 11:02:17.454336 ttdb.go:366: Persisted Template wfstate2t_tmplt.html
2023/09/15 11:02:17.517815 ttdb.go:379: Persisting Template publishfile2t_tmplt
2023/09/15 11:02:17.583677 ttdb.go:385: Persisted Template publishfile2t_tmplt
2023/09/15 11:02:17.583864 ttdb.go:366: Persisted Template publishfile2t_tmplt.html
2023/09/15 11:02:17.650067 ttdb.go:379: Persisting Template react_tmplt
2023/09/15 11:02:17.716020 ttdb.go:385: Persisted Template react_tmplt
2023/09/15 11:02:17.716106 ttdb.go:366: Persisted Template react_tmplt.html
2023/09/15 11:02:17.779388 ttdb.go:379: Persisting Template pdsretrieve_tmplt
2023/09/15 11:02:17.846134 ttdb.go:385: Persisted Template pdsretrieve_tmplt
2023/09/15 11:02:17.846301 ttdb.go:366: Persisted Template pdsretrieve_tmplt.html
2023/09/15 11:02:17.911190 ttdb.go:379: Persisting Template allpatientSrvs_tmplt
2023/09/15 11:02:17.983559 ttdb.go:385: Persisted Template allpatientSrvs_tmplt
2023/09/15 11:02:17.983601 ttdb.go:366: Persisted Template allpatientSrvs_tmplt.html
2023/09/15 11:02:18.047199 ttdb.go:379: Persisting Template spa2t_tmplt
2023/09/15 11:02:18.121635 ttdb.go:385: Persisted Template spa2t_tmplt
2023/09/15 11:02:18.121657 ttdb.go:366: Persisted Template spa2t_tmplt.html
2023/09/15 11:02:18.185844 ttdb.go:379: Persisting Template xdw2t_tmplt
2023/09/15 11:02:18.264100 ttdb.go:385: Persisted Template xdw2t_tmplt
2023/09/15 11:02:18.264127 ttdb.go:366: Persisted Template xdw2t_tmplt.html
2023/09/15 11:02:18.329339 ttdb.go:379: Persisting Template spaheader2t_tmplt
2023/09/15 11:02:18.398727 ttdb.go:385: Persisted Template spaheader2t_tmplt
2023/09/15 11:02:18.398760 ttdb.go:366: Persisted Template spaheader2t_tmplt.html
2023/09/15 11:02:18.461718 ttdb.go:379: Persisting Template pds_tmplt
2023/09/15 11:02:18.524595 ttdb.go:385: Persisted Template pds_tmplt
2023/09/15 11:02:18.524636 ttdb.go:366: Persisted Template pds_tmplt.html
2023/09/15 11:02:18.590577 ttdb.go:379: Persisting Template error_tmplt
2023/09/15 11:02:18.653283 ttdb.go:385: Persisted Template error_tmplt
2023/09/15 11:02:18.653384 ttdb.go:366: Persisted Template error_tmplt.html
2023/09/15 11:02:18.716582 ttdb.go:379: Persisting Template dsuback_tmplt
2023/09/15 11:02:18.780759 ttdb.go:385: Persisted Template dsuback_tmplt
2023/09/15 11:02:18.780902 ttdb.go:366: Persisted Template dsuback_tmplt.xml
2023/09/15 11:02:18.845353 ttdb.go:379: Persisting Template pixm_tmplt
2023/09/15 11:02:18.914878 ttdb.go:385: Persisted Template pixm_tmplt
2023/09/15 11:02:18.914991 ttdb.go:366: Persisted Template pixm_tmplt.html
2023/09/15 11:02:18.979275 ttdb.go:379: Persisting Template subscriptions2t_tmplt
2023/09/15 11:02:19.047588 ttdb.go:385: Persisted Template subscriptions2t_tmplt
2023/09/15 11:02:19.047726 ttdb.go:366: Persisted Template subscriptions2t_tmplt.html
2023/09/15 11:02:19.111087 ttdb.go:379: Persisting Template codemaps2t_tmplt
2023/09/15 11:02:19.186287 ttdb.go:385: Persisted Template codemaps2t_tmplt
2023/09/15 11:02:19.186432 ttdb.go:366: Persisted Template codemaps2t_tmplt.html
2023/09/15 11:02:19.325431 ttdb.go:379: Persisting Template mhdpublish_tmplt
2023/09/15 11:02:19.481956 ttdb.go:385: Persisted Template mhdpublish_tmplt
2023/09/15 11:02:19.482083 ttdb.go:366: Persisted Template mhdpublish_tmplt.json
2023/09/15 11:02:19.551292 ttdb.go:379: Persisting Template events_tmplt
2023/09/15 11:02:19.719135 ttdb.go:385: Persisted Template events_tmplt
2023/09/15 11:02:19.719274 ttdb.go:366: Persisted Template events_tmplt.html
2023/09/15 11:02:19.876595 ttdb.go:379: Persisting Template uploadfile2t_tmplt
2023/09/15 11:02:20.009996 ttdb.go:385: Persisted Template uploadfile2t_tmplt
2023/09/15 11:02:20.010147 ttdb.go:366: Persisted Template uploadfile2t_tmplt.html
2023/09/15 11:02:20.010412 ttserver.go:40: Starting ICB Workflow Service. Service Endpoint http://MacBook-Pro-3.lan:8080/
2023/09/15 11:02:24.108834 ttgethandler.go:10: Processing new GET Request
2023/09/15 11:02:24.108996 ttproxy.go:138: 	Request Query Params
2023/09/15 11:02:24.109349 ttutil.go:140: 	{
  "User": "ian.thomas",
  "Org": "2tsolutions",
  "Role": "clinical",
  "Nhs": "9000000009"
}
2023/09/15 11:02:24.109393 ttgethandler.go:15: Path = /beta/spa/consumer/patient
2023/09/15 11:02:24.109463 tttmplts.go:37: CGL Worker starting
2023/09/15 11:02:24.109453 tttmplts.go:30: PIXm Worker starting
2023/09/15 11:02:24.109960 tthttp.go:15: Creating PIXm PDQ - Server URL http://lac-demo-01.tianispirit.co.uk:8081/SpiritPIXFhir/r4/Patient?identifier=2.16.840.1.113883.2.1.4.1%7C9000000009
2023/09/15 11:02:24.111192 tthttp.go:160: Request Headers 
map[Content-Type:[application/json]]
2023/09/15 11:02:24.111259 tthttp.go:160: Request Headers 
map[Accept:[application/json] X-Api-Key:[FNhb#OhxWiEiMdf+@6085k5Zmt] X-Api-Secret:[9710ea0fb4ffb5d56c2e62c71c30bdfhjsyr56a79d]]
2023/09/15 11:02:24.286896 tthttp.go:174: Server Response - Status Code 404 
{"errors":[{"message":"No clients matching nhs number 9000000009","path":"\/"}],"status":404}
2023/09/15 11:02:24.290124 ttutil.go:140: 	{
  "data": {
    "client": {
      "basicDetails": {
        "address": {},
        "name": {}
      },
      "bbvInformation": {},
      "drugTestResults": {
        "results": {}
      },
      "riskInformation": {
        "mentalHealthDomain": {},
        "riskOfHarmToSelfDomain": {},
        "socialDomain": {},
        "substanceMisuseDomain": {}
      },
      "safeguardingInformation": {}
    },
    "keyWorker": {
      "name": {}
    }
  }
}
2023/09/15 11:02:24.290262 tttmplts.go:39: CGL Worker done
2023/09/15 11:02:24.290293 tttmplts.go:40: CGL Worker Status Code 404
2023/09/15 11:02:29.112163 tthttp.go:174: Server Response - Status Code 0 
2023/09/15 11:02:29.112661 tttmplts.go:32: PIXm Worker done
2023/09/15 11:02:29.112800 tttmplts.go:33: PIXm Worker Status Code 408
2023/09/15 11:02:29.113317 tthttp.go:56: Creating PDS Search Request - Server URL https://sandbox.api.service.nhs.uk/personal-demographics/FHIR/R4/Patient/9000000009
2023/09/15 11:02:29.113548 tthttp.go:160: Request Headers 
map[Accept:[*/*] Content-Type:[application/json] X-Request-Id:[007ade35-6433-466b-92c8-614729e739d8]]
2023/09/15 11:02:29.248364 tthttp.go:174: Server Response - Status Code 200 
{"resourceType":"Patient","id":"9000000009","identifier":[{"system":"https://fhir.nhs.uk/Id/nhs-number","value":"9000000009","extension":[{"url":"https://fhir.hl7.org.uk/StructureDefinition/Extension-UKCore-NHSNumberVerificationStatus","valueCodeableConcept":{"coding":[{"system":"https://fhir.hl7.org.uk/CodeSystem/UKCore-NHSNumberVerificationStatus","version":"1.0.0","code":"01","display":"Number present and verified"}]}}]}],"meta":{"versionId":"2","security":[{"system":"http://terminology.hl7.org/CodeSystem/v3-Confidentiality","code":"U","display":"unrestricted"}]},"name":[{"id":"123","use":"usual","period":{"start":"2020-01-01","end":"2021-12-31"},"given":["Jane"],"family":"Smith","prefix":["Mrs"],"suffix":["MBE"]}],"gender":"female","birthDate":"2010-10-22","multipleBirthInteger":1,"deceasedDateTime":"2010-10-22T00:00:00+00:00","generalPractitioner":[{"id":"254406A3","type":"Organization","identifier":{"system":"https://fhir.nhs.uk/Id/ods-organization-code","value":"Y12345","period":{"start":"2020-01-01","end":"2021-12-31"}}}],"managingOrganization":{"type":"Organization","identifier":{"system":"https://fhir.nhs.uk/Id/ods-organization-code","value":"Y12345","period":{"start":"2020-01-01","end":"2021-12-31"}}},"extension":[{"url":"https://fhir.hl7.org.uk/StructureDefinition/Extension-UKCore-NominatedPharmacy","valueReference":{"identifier":{"system":"https://fhir.nhs.uk/Id/ods-organization-code","value":"Y12345"}}},{"url":"https://fhir.hl7.org.uk/StructureDefinition/Extension-UKCore-PreferredDispenserOrganization","valueReference":{"identifier":{"system":"https://fhir.nhs.uk/Id/ods-organization-code","value":"Y23456"}}},{"url":"https://fhir.hl7.org.uk/StructureDefinition/Extension-UKCore-MedicalApplianceSupplier","valueReference":{"identifier":{"system":"https://fhir.nhs.uk/Id/ods-organization-code","value":"Y34567"}}},{"url":"https://fhir.hl7.org.uk/StructureDefinition/Extension-UKCore-DeathNotificationStatus","extension":[{"url":"deathNotificationStatus","valueCodeableConcept":{"coding":[{"system":"https://fhir.hl7.org.uk/CodeSystem/UKCore-DeathNotificationStatus","version":"1.0.0","code":"2","display":"Formal - death notice received from Registrar of Deaths"}]}},{"url":"systemEffectiveDate","valueDateTime":"2010-10-22T00:00:00+00:00"}]},{"url":"https://fhir.hl7.org.uk/StructureDefinition/Extension-UKCore-NHSCommunication","extension":[{"url":"language","valueCodeableConcept":{"coding":[{"system":"https://fhir.hl7.org.uk/CodeSystem/UKCore-HumanLanguage","version":"1.0.0","code":"fr","display":"French"}]}},{"url":"interpreterRequired","valueBoolean":true}]},{"url":"https://fhir.hl7.org.uk/StructureDefinition/Extension-UKCore-ContactPreference","extension":[{"url":"PreferredWrittenCommunicationFormat","valueCodeableConcept":{"coding":[{"system":"https://fhir.hl7.org.uk/CodeSystem/UKCore-PreferredWrittenCommunicationFormat","code":"12","display":"Braille"}]}},{"url":"PreferredContactMethod","valueCodeableConcept":{"coding":[{"system":"https://fhir.hl7.org.uk/CodeSystem/UKCore-PreferredContactMethod","code":"1","display":"Letter"}]}},{"url":"PreferredContactTimes","valueString":"Not after 7pm"}]},{"url":"http://hl7.org/fhir/StructureDefinition/patient-birthPlace","valueAddress":{"city":"Manchester","district":"Greater Manchester","country":"GBR"}},{"url":"https://fhir.nhs.uk/StructureDefinition/Extension-PDS-RemovalFromRegistration","extension":[{"url":"removalFromRegistrationCode","valueCodeableConcept":{"coding":[{"system":"https://fhir.nhs.uk/CodeSystem/PDS-RemovalReasonExitCode","code":"SCT","display":"Transferred to Scotland"}]}},{"url":"effectiveTime","valuePeriod":{"start":"2020-01-01T00:00:00+00:00","end":"2021-12-31T00:00:00+00:00"}}]}],"telecom":[{"id":"789","period":{"start":"2020-01-01","end":"2021-12-31"},"system":"phone","value":"01632960587","use":"home"},{"id":"790","period":{"start":"2019-01-01","end":"2022-12-31"},"system":"email","value":"jane.smith@example.com","use":"home"},{"id":"OC789","period":{"start":"2020-01-01","end":"2021-12-31"},"system":"other","value":"01632960587","use":"home","extension":[{"url":"https://fhir.hl7.org.uk/StructureDefinition/Extension-UKCore-OtherContactSystem","valueCoding":{"system":"https://fhir.hl7.org.uk/CodeSystem/UKCore-OtherContactSystem","code":"textphone","display":"Minicom (Textphone)"}}]}],"contact":[{"id":"C123","period":{"start":"2020-01-01","end":"2021-12-31"},"relationship":[{"coding":[{"system":"http://terminology.hl7.org/CodeSystem/v2-0131","code":"C","display":"Emergency Contact"}]}],"telecom":[{"system":"phone","value":"01632960587"}]}],"address":[{"id":"456","period":{"start":"2020-01-01","end":"2021-12-31"},"use":"home","line":["1 Trevelyan Square","Boar Lane","City Centre","Leeds","West Yorkshire"],"postalCode":"LS1 6AE","extension":[{"url":"https://fhir.hl7.org.uk/StructureDefinition/Extension-UKCore-AddressKey","extension":[{"url":"type","valueCoding":{"system":"https://fhir.hl7.org.uk/CodeSystem/UKCore-AddressKeyType","code":"PAF"}},{"url":"value","valueString":"12345678"}]},{"url":"https://fhir.hl7.org.uk/StructureDefinition/Extension-UKCore-AddressKey","extension":[{"url":"type","valueCoding":{"system":"https://fhir.hl7.org.uk/CodeSystem/UKCore-AddressKeyType","code":"UPRN"}},{"url":"value","valueString":"123456789012"}]}]},{"id":"T456","period":{"start":"2020-01-01","end":"2021-12-31"},"use":"temp","text":"Student Accommodation","line":["1 Trevelyan Square","Boar Lane","City Centre","Leeds","West Yorkshire"],"postalCode":"LS1 6AE","extension":[{"url":"https://fhir.hl7.org.uk/StructureDefinition/Extension-UKCore-AddressKey","extension":[{"url":"type","valueCoding":{"system":"https://fhir.hl7.org.uk/CodeSystem/UKCore-AddressKeyType","code":"PAF"}},{"url":"value","valueString":"12345678"}]},{"url":"https://fhir.hl7.org.uk/StructureDefinition/Extension-UKCore-AddressKey","extension":[{"url":"type","valueCoding":{"system":"https://fhir.hl7.org.uk/CodeSystem/UKCore-AddressKeyType","code":"UPRN"}},{"url":"value","valueString":"123456789012"}]}]}]}
2023/09/15 11:02:29.442517 tttmplts.go:100: Caching 24 Templates
2023/09/15 11:02:29.449935 tttmplts.go:87: Processing Template allpatientSrvs_tmplt
2023/09/15 11:02:29.453056 ttproxy.go:149: Response Status Code 200
2023/09/15 11:08:09.756651 ttserver.go:52: ICB Workflow Service stopped
2023/09/15 11:08:12.896361 ttutil.go:133: -----------------------------------------------------------------------------------
2023/09/15 11:08:12.896886 ttdb.go:51: Opening DB Connection to mysql instance
User: root
Host: tuk.coil1nnpqdlr.eu-west-1.rds.amazonaws.com
Port: :3306
Name: tuk
Connect Timeout 2s
Read Timeout 5s
2023/09/15 11:08:12.897028 ttdb.go:54: Opened Database
2023/09/15 11:08:13.732696 ttdb.go:379: Persisting Template dsubcancel_tmplt
2023/09/15 11:08:13.793828 ttdb.go:385: Persisted Template dsubcancel_tmplt
2023/09/15 11:08:13.794092 ttdb.go:366: Persisted Template dsubcancel_tmplt.xml
2023/09/15 11:08:13.856777 ttdb.go:379: Persisting Template cgl_tmplt
2023/09/15 11:08:13.950913 ttdb.go:385: Persisted Template cgl_tmplt
2023/09/15 11:08:13.951079 ttdb.go:366: Persisted Template cgl_tmplt.html
2023/09/15 11:08:14.011716 ttdb.go:379: Persisting Template pdssearch_tmplt
2023/09/15 11:08:14.077536 ttdb.go:385: Persisted Template pdssearch_tmplt
2023/09/15 11:08:14.077683 ttdb.go:366: Persisted Template pdssearch_tmplt.html
2023/09/15 11:08:14.138222 ttdb.go:379: Persisting Template dsubsubscribe_tmplt
2023/09/15 11:08:14.201060 ttdb.go:385: Persisted Template dsubsubscribe_tmplt
2023/09/15 11:08:14.201130 ttdb.go:366: Persisted Template dsubsubscribe_tmplt.xml
2023/09/15 11:08:14.262187 ttdb.go:379: Persisting Template notification_tmplt
2023/09/15 11:08:14.323606 ttdb.go:385: Persisted Template notification_tmplt
2023/09/15 11:08:14.323675 ttdb.go:366: Persisted Template notification_tmplt.txt
2023/09/15 11:08:14.385372 ttdb.go:379: Persisting Template wfstate2t_tmplt
2023/09/15 11:08:14.498265 ttdb.go:385: Persisted Template wfstate2t_tmplt
2023/09/15 11:08:14.498422 ttdb.go:366: Persisted Template wfstate2t_tmplt.html
2023/09/15 11:08:14.561540 ttdb.go:379: Persisting Template publishfile2t_tmplt
2023/09/15 11:08:14.624395 ttdb.go:385: Persisted Template publishfile2t_tmplt
2023/09/15 11:08:14.624514 ttdb.go:366: Persisted Template publishfile2t_tmplt.html
2023/09/15 11:08:14.688320 ttdb.go:379: Persisting Template react_tmplt
2023/09/15 11:08:14.748807 ttdb.go:385: Persisted Template react_tmplt
2023/09/15 11:08:14.749010 ttdb.go:366: Persisted Template react_tmplt.html
2023/09/15 11:08:14.812171 ttdb.go:379: Persisting Template pdsretrieve_tmplt
2023/09/15 11:08:14.876412 ttdb.go:385: Persisted Template pdsretrieve_tmplt
2023/09/15 11:08:14.876564 ttdb.go:366: Persisted Template pdsretrieve_tmplt.html
2023/09/15 11:08:14.939565 ttdb.go:379: Persisting Template allpatientSrvs_tmplt
2023/09/15 11:08:15.005177 ttdb.go:385: Persisted Template allpatientSrvs_tmplt
2023/09/15 11:08:15.005345 ttdb.go:366: Persisted Template allpatientSrvs_tmplt.html
2023/09/15 11:08:15.068110 ttdb.go:379: Persisting Template spa2t_tmplt
2023/09/15 11:08:15.143992 ttdb.go:385: Persisted Template spa2t_tmplt
2023/09/15 11:08:15.144144 ttdb.go:366: Persisted Template spa2t_tmplt.html
2023/09/15 11:08:15.205003 ttdb.go:379: Persisting Template xdw2t_tmplt
2023/09/15 11:08:15.283713 ttdb.go:385: Persisted Template xdw2t_tmplt
2023/09/15 11:08:15.283743 ttdb.go:366: Persisted Template xdw2t_tmplt.html
2023/09/15 11:08:15.344778 ttdb.go:379: Persisting Template spaheader2t_tmplt
2023/09/15 11:08:15.417398 ttdb.go:385: Persisted Template spaheader2t_tmplt
2023/09/15 11:08:15.417521 ttdb.go:366: Persisted Template spaheader2t_tmplt.html
2023/09/15 11:08:15.478903 ttdb.go:379: Persisting Template pds_tmplt
2023/09/15 11:08:15.540372 ttdb.go:385: Persisted Template pds_tmplt
2023/09/15 11:08:15.540510 ttdb.go:366: Persisted Template pds_tmplt.html
2023/09/15 11:08:15.601589 ttdb.go:379: Persisting Template error_tmplt
2023/09/15 11:08:15.663756 ttdb.go:385: Persisted Template error_tmplt
2023/09/15 11:08:15.663953 ttdb.go:366: Persisted Template error_tmplt.html
2023/09/15 11:08:15.725863 ttdb.go:379: Persisting Template dsuback_tmplt
2023/09/15 11:08:15.787593 ttdb.go:385: Persisted Template dsuback_tmplt
2023/09/15 11:08:15.787640 ttdb.go:366: Persisted Template dsuback_tmplt.xml
2023/09/15 11:08:15.848186 ttdb.go:379: Persisting Template pixm_tmplt
2023/09/15 11:08:15.910084 ttdb.go:385: Persisted Template pixm_tmplt
2023/09/15 11:08:15.910099 ttdb.go:366: Persisted Template pixm_tmplt.html
2023/09/15 11:08:15.971677 ttdb.go:379: Persisting Template subscriptions2t_tmplt
2023/09/15 11:08:16.036439 ttdb.go:385: Persisted Template subscriptions2t_tmplt
2023/09/15 11:08:16.036597 ttdb.go:366: Persisted Template subscriptions2t_tmplt.html
2023/09/15 11:08:16.097929 ttdb.go:379: Persisting Template codemaps2t_tmplt
2023/09/15 11:08:16.162633 ttdb.go:385: Persisted Template codemaps2t_tmplt
2023/09/15 11:08:16.162760 ttdb.go:366: Persisted Template codemaps2t_tmplt.html
2023/09/15 11:08:16.224166 ttdb.go:379: Persisting Template mhdpublish_tmplt
2023/09/15 11:08:16.291062 ttdb.go:385: Persisted Template mhdpublish_tmplt
2023/09/15 11:08:16.291190 ttdb.go:366: Persisted Template mhdpublish_tmplt.json
2023/09/15 11:08:16.352387 ttdb.go:379: Persisting Template events_tmplt
2023/09/15 11:08:16.417455 ttdb.go:385: Persisted Template events_tmplt
2023/09/15 11:08:16.417593 ttdb.go:366: Persisted Template events_tmplt.html
2023/09/15 11:08:16.479564 ttdb.go:379: Persisting Template uploadfile2t_tmplt
2023/09/15 11:08:16.539909 ttdb.go:385: Persisted Template uploadfile2t_tmplt
2023/09/15 11:08:16.540028 ttdb.go:366: Persisted Template uploadfile2t_tmplt.html
2023/09/15 11:08:16.540209 ttserver.go:40: Starting ICB Workflow Service. Service Endpoint http://MacBook-Pro-3.lan:8080/
2023/09/15 11:08:19.386526 ttgethandler.go:10: Processing new GET Request
2023/09/15 11:08:19.386698 ttproxy.go:138: 	Request Query Params
2023/09/15 11:08:19.387067 ttutil.go:140: 	{
  "User": "ian.thomas",
  "Org": "2tsolutions",
  "Role": "clinical",
  "Nhs": "9000000009"
}
2023/09/15 11:08:19.387101 ttgethandler.go:15: Path = /beta/spa/consumer/patient
2023/09/15 11:08:19.387139 tttmplts.go:37: CGL Worker starting
2023/09/15 11:08:19.387135 tttmplts.go:30: PIXm Worker starting
2023/09/15 11:08:19.387611 tthttp.go:15: Creating PIXm PDQ - Server URL http://lac-demo-01.tianispirit.co.uk:8081/SpiritPIXFhir/r4/Patient?identifier=2.16.840.1.113883.2.1.4.1%7C9000000009
2023/09/15 11:08:19.389262 tthttp.go:160: Request Headers 
map[Content-Type:[application/json]]
2023/09/15 11:08:19.389299 tthttp.go:160: Request Headers 
map[Accept:[application/json] X-Api-Key:[FNhb#OhxWiEiMdf+@6085k5Zmt] X-Api-Secret:[9710ea0fb4ffb5d56c2e62c71c30bdfhjsyr56a79d]]
2023/09/15 11:08:19.575622 tthttp.go:174: Server Response - Status Code 404 
{"errors":[{"message":"No clients matching nhs number 9000000009","path":"\/"}],"status":404}
2023/09/15 11:08:19.578620 ttutil.go:140: 	{
  "data": {
    "client": {
      "basicDetails": {
        "address": {},
        "name": {}
      },
      "bbvInformation": {},
      "drugTestResults": {
        "results": {}
      },
      "riskInformation": {
        "mentalHealthDomain": {},
        "riskOfHarmToSelfDomain": {},
        "socialDomain": {},
        "substanceMisuseDomain": {}
      },
      "safeguardingInformation": {}
    },
    "keyWorker": {
      "name": {}
    }
  }
}
2023/09/15 11:08:19.578680 tttmplts.go:39: CGL Worker done
2023/09/15 11:08:19.578703 tttmplts.go:40: CGL Worker Status Code 404
2023/09/15 11:08:24.389983 tthttp.go:174: Server Response - Status Code 0 
2023/09/15 11:08:24.390265 tttmplts.go:32: PIXm Worker done
2023/09/15 11:08:24.390320 tttmplts.go:33: PIXm Worker Status Code 408
2023/09/15 11:08:24.390468 tthttp.go:56: Creating PDS Search Request - Server URL https://sandbox.api.service.nhs.uk/personal-demographics/FHIR/R4/Patient/9000000009
2023/09/15 11:08:24.390598 tthttp.go:160: Request Headers 
map[Accept:[*/*] Content-Type:[application/json] X-Request-Id:[833438ec-8809-4ad5-b68e-b6887fca2043]]
2023/09/15 11:08:24.718665 tthttp.go:174: Server Response - Status Code 200 
{"resourceType":"Patient","id":"9000000009","identifier":[{"system":"https://fhir.nhs.uk/Id/nhs-number","value":"9000000009","extension":[{"url":"https://fhir.hl7.org.uk/StructureDefinition/Extension-UKCore-NHSNumberVerificationStatus","valueCodeableConcept":{"coding":[{"system":"https://fhir.hl7.org.uk/CodeSystem/UKCore-NHSNumberVerificationStatus","version":"1.0.0","code":"01","display":"Number present and verified"}]}}]}],"meta":{"versionId":"2","security":[{"system":"http://terminology.hl7.org/CodeSystem/v3-Confidentiality","code":"U","display":"unrestricted"}]},"name":[{"id":"123","use":"usual","period":{"start":"2020-01-01","end":"2021-12-31"},"given":["Jane"],"family":"Smith","prefix":["Mrs"],"suffix":["MBE"]}],"gender":"female","birthDate":"2010-10-22","multipleBirthInteger":1,"deceasedDateTime":"2010-10-22T00:00:00+00:00","generalPractitioner":[{"id":"254406A3","type":"Organization","identifier":{"system":"https://fhir.nhs.uk/Id/ods-organization-code","value":"Y12345","period":{"start":"2020-01-01","end":"2021-12-31"}}}],"managingOrganization":{"type":"Organization","identifier":{"system":"https://fhir.nhs.uk/Id/ods-organization-code","value":"Y12345","period":{"start":"2020-01-01","end":"2021-12-31"}}},"extension":[{"url":"https://fhir.hl7.org.uk/StructureDefinition/Extension-UKCore-NominatedPharmacy","valueReference":{"identifier":{"system":"https://fhir.nhs.uk/Id/ods-organization-code","value":"Y12345"}}},{"url":"https://fhir.hl7.org.uk/StructureDefinition/Extension-UKCore-PreferredDispenserOrganization","valueReference":{"identifier":{"system":"https://fhir.nhs.uk/Id/ods-organization-code","value":"Y23456"}}},{"url":"https://fhir.hl7.org.uk/StructureDefinition/Extension-UKCore-MedicalApplianceSupplier","valueReference":{"identifier":{"system":"https://fhir.nhs.uk/Id/ods-organization-code","value":"Y34567"}}},{"url":"https://fhir.hl7.org.uk/StructureDefinition/Extension-UKCore-DeathNotificationStatus","extension":[{"url":"deathNotificationStatus","valueCodeableConcept":{"coding":[{"system":"https://fhir.hl7.org.uk/CodeSystem/UKCore-DeathNotificationStatus","version":"1.0.0","code":"2","display":"Formal - death notice received from Registrar of Deaths"}]}},{"url":"systemEffectiveDate","valueDateTime":"2010-10-22T00:00:00+00:00"}]},{"url":"https://fhir.hl7.org.uk/StructureDefinition/Extension-UKCore-NHSCommunication","extension":[{"url":"language","valueCodeableConcept":{"coding":[{"system":"https://fhir.hl7.org.uk/CodeSystem/UKCore-HumanLanguage","version":"1.0.0","code":"fr","display":"French"}]}},{"url":"interpreterRequired","valueBoolean":true}]},{"url":"https://fhir.hl7.org.uk/StructureDefinition/Extension-UKCore-ContactPreference","extension":[{"url":"PreferredWrittenCommunicationFormat","valueCodeableConcept":{"coding":[{"system":"https://fhir.hl7.org.uk/CodeSystem/UKCore-PreferredWrittenCommunicationFormat","code":"12","display":"Braille"}]}},{"url":"PreferredContactMethod","valueCodeableConcept":{"coding":[{"system":"https://fhir.hl7.org.uk/CodeSystem/UKCore-PreferredContactMethod","code":"1","display":"Letter"}]}},{"url":"PreferredContactTimes","valueString":"Not after 7pm"}]},{"url":"http://hl7.org/fhir/StructureDefinition/patient-birthPlace","valueAddress":{"city":"Manchester","district":"Greater Manchester","country":"GBR"}},{"url":"https://fhir.nhs.uk/StructureDefinition/Extension-PDS-RemovalFromRegistration","extension":[{"url":"removalFromRegistrationCode","valueCodeableConcept":{"coding":[{"system":"https://fhir.nhs.uk/CodeSystem/PDS-RemovalReasonExitCode","code":"SCT","display":"Transferred to Scotland"}]}},{"url":"effectiveTime","valuePeriod":{"start":"2020-01-01T00:00:00+00:00","end":"2021-12-31T00:00:00+00:00"}}]}],"telecom":[{"id":"789","period":{"start":"2020-01-01","end":"2021-12-31"},"system":"phone","value":"01632960587","use":"home"},{"id":"790","period":{"start":"2019-01-01","end":"2022-12-31"},"system":"email","value":"jane.smith@example.com","use":"home"},{"id":"OC789","period":{"start":"2020-01-01","end":"2021-12-31"},"system":"other","value":"01632960587","use":"home","extension":[{"url":"https://fhir.hl7.org.uk/StructureDefinition/Extension-UKCore-OtherContactSystem","valueCoding":{"system":"https://fhir.hl7.org.uk/CodeSystem/UKCore-OtherContactSystem","code":"textphone","display":"Minicom (Textphone)"}}]}],"contact":[{"id":"C123","period":{"start":"2020-01-01","end":"2021-12-31"},"relationship":[{"coding":[{"system":"http://terminology.hl7.org/CodeSystem/v2-0131","code":"C","display":"Emergency Contact"}]}],"telecom":[{"system":"phone","value":"01632960587"}]}],"address":[{"id":"456","period":{"start":"2020-01-01","end":"2021-12-31"},"use":"home","line":["1 Trevelyan Square","Boar Lane","City Centre","Leeds","West Yorkshire"],"postalCode":"LS1 6AE","extension":[{"url":"https://fhir.hl7.org.uk/StructureDefinition/Extension-UKCore-AddressKey","extension":[{"url":"type","valueCoding":{"system":"https://fhir.hl7.org.uk/CodeSystem/UKCore-AddressKeyType","code":"PAF"}},{"url":"value","valueString":"12345678"}]},{"url":"https://fhir.hl7.org.uk/StructureDefinition/Extension-UKCore-AddressKey","extension":[{"url":"type","valueCoding":{"system":"https://fhir.hl7.org.uk/CodeSystem/UKCore-AddressKeyType","code":"UPRN"}},{"url":"value","valueString":"123456789012"}]}]},{"id":"T456","period":{"start":"2020-01-01","end":"2021-12-31"},"use":"temp","text":"Student Accommodation","line":["1 Trevelyan Square","Boar Lane","City Centre","Leeds","West Yorkshire"],"postalCode":"LS1 6AE","extension":[{"url":"https://fhir.hl7.org.uk/StructureDefinition/Extension-UKCore-AddressKey","extension":[{"url":"type","valueCoding":{"system":"https://fhir.hl7.org.uk/CodeSystem/UKCore-AddressKeyType","code":"PAF"}},{"url":"value","valueString":"12345678"}]},{"url":"https://fhir.hl7.org.uk/StructureDefinition/Extension-UKCore-AddressKey","extension":[{"url":"type","valueCoding":{"system":"https://fhir.hl7.org.uk/CodeSystem/UKCore-AddressKeyType","code":"UPRN"}},{"url":"value","valueString":"123456789012"}]}]}]}
2023/09/15 11:08:24.907700 tttmplts.go:100: Caching 24 Templates
2023/09/15 11:08:24.912889 tttmplts.go:87: Processing Template allpatientSrvs_tmplt
2023/09/15 11:08:24.915792 ttproxy.go:149: Response Status Code 200
2023/09/15 11:11:25.550176 ttserver.go:52: ICB Workflow Service stopped
2023/09/15 11:11:28.662378 ttutil.go:133: -----------------------------------------------------------------------------------
2023/09/15 11:11:28.662754 ttdb.go:51: Opening DB Connection to mysql instance
User: root
Host: tuk.coil1nnpqdlr.eu-west-1.rds.amazonaws.com
Port: :3306
Name: tuk
Connect Timeout 2s
Read Timeout 5s
2023/09/15 11:11:28.662869 ttdb.go:54: Opened Database
2023/09/15 11:11:28.839478 ttdb.go:379: Persisting Template dsubcancel_tmplt
2023/09/15 11:11:28.900992 ttdb.go:385: Persisted Template dsubcancel_tmplt
2023/09/15 11:11:28.901042 ttdb.go:366: Persisted Template dsubcancel_tmplt.xml
2023/09/15 11:11:28.964820 ttdb.go:379: Persisting Template cgl_tmplt
2023/09/15 11:11:29.059747 ttdb.go:385: Persisted Template cgl_tmplt
2023/09/15 11:11:29.059780 ttdb.go:366: Persisted Template cgl_tmplt.html
2023/09/15 11:11:29.123161 ttdb.go:379: Persisting Template pdssearch_tmplt
2023/09/15 11:11:29.189271 ttdb.go:385: Persisted Template pdssearch_tmplt
2023/09/15 11:11:29.189316 ttdb.go:366: Persisted Template pdssearch_tmplt.html
2023/09/15 11:11:29.252883 ttdb.go:379: Persisting Template dsubsubscribe_tmplt
2023/09/15 11:11:29.316941 ttdb.go:385: Persisted Template dsubsubscribe_tmplt
2023/09/15 11:11:29.316996 ttdb.go:366: Persisted Template dsubsubscribe_tmplt.xml
2023/09/15 11:11:29.380797 ttdb.go:379: Persisting Template notification_tmplt
2023/09/15 11:11:29.442947 ttdb.go:385: Persisted Template notification_tmplt
2023/09/15 11:11:29.442989 ttdb.go:366: Persisted Template notification_tmplt.txt
2023/09/15 11:11:29.506541 ttdb.go:379: Persisting Template wfstate2t_tmplt
2023/09/15 11:11:29.625100 ttdb.go:385: Persisted Template wfstate2t_tmplt
2023/09/15 11:11:29.625252 ttdb.go:366: Persisted Template wfstate2t_tmplt.html
2023/09/15 11:11:29.690803 ttdb.go:379: Persisting Template publishfile2t_tmplt
2023/09/15 11:11:29.758881 ttdb.go:385: Persisted Template publishfile2t_tmplt
2023/09/15 11:11:29.759012 ttdb.go:366: Persisted Template publishfile2t_tmplt.html
2023/09/15 11:11:29.823552 ttdb.go:379: Persisting Template react_tmplt
2023/09/15 11:11:29.888189 ttdb.go:385: Persisted Template react_tmplt
2023/09/15 11:11:29.888321 ttdb.go:366: Persisted Template react_tmplt.html
2023/09/15 11:11:29.953155 ttdb.go:379: Persisting Template pdsretrieve_tmplt
2023/09/15 11:11:30.025540 ttdb.go:385: Persisted Template pdsretrieve_tmplt
2023/09/15 11:11:30.025703 ttdb.go:366: Persisted Template pdsretrieve_tmplt.html
2023/09/15 11:11:30.093901 ttdb.go:379: Persisting Template allpatientSrvs_tmplt
2023/09/15 11:11:30.158810 ttdb.go:385: Persisted Template allpatientSrvs_tmplt
2023/09/15 11:11:30.158858 ttdb.go:366: Persisted Template allpatientSrvs_tmplt.html
2023/09/15 11:11:30.223838 ttdb.go:379: Persisting Template spa2t_tmplt
2023/09/15 11:11:30.304238 ttdb.go:385: Persisted Template spa2t_tmplt
2023/09/15 11:11:30.304292 ttdb.go:366: Persisted Template spa2t_tmplt.html
2023/09/15 11:11:30.369811 ttdb.go:379: Persisting Template xdw2t_tmplt
2023/09/15 11:11:30.453456 ttdb.go:385: Persisted Template xdw2t_tmplt
2023/09/15 11:11:30.453617 ttdb.go:366: Persisted Template xdw2t_tmplt.html
2023/09/15 11:11:30.519704 ttdb.go:379: Persisting Template spaheader2t_tmplt
2023/09/15 11:11:30.591144 ttdb.go:385: Persisted Template spaheader2t_tmplt
2023/09/15 11:11:30.591297 ttdb.go:366: Persisted Template spaheader2t_tmplt.html
2023/09/15 11:11:30.658161 ttdb.go:379: Persisting Template pds_tmplt
2023/09/15 11:11:30.722797 ttdb.go:385: Persisted Template pds_tmplt
2023/09/15 11:11:30.722942 ttdb.go:366: Persisted Template pds_tmplt.html
2023/09/15 11:11:30.787363 ttdb.go:379: Persisting Template error_tmplt
2023/09/15 11:11:30.854758 ttdb.go:385: Persisted Template error_tmplt
2023/09/15 11:11:30.854906 ttdb.go:366: Persisted Template error_tmplt.html
2023/09/15 11:11:30.923327 ttdb.go:379: Persisting Template dsuback_tmplt
2023/09/15 11:11:30.988657 ttdb.go:385: Persisted Template dsuback_tmplt
2023/09/15 11:11:30.988775 ttdb.go:366: Persisted Template dsuback_tmplt.xml
2023/09/15 11:11:31.052589 ttdb.go:379: Persisting Template pixm_tmplt
2023/09/15 11:11:31.122144 ttdb.go:385: Persisted Template pixm_tmplt
2023/09/15 11:11:31.122326 ttdb.go:366: Persisted Template pixm_tmplt.html
2023/09/15 11:11:31.188316 ttdb.go:379: Persisting Template subscriptions2t_tmplt
2023/09/15 11:11:31.255435 ttdb.go:385: Persisted Template subscriptions2t_tmplt
2023/09/15 11:11:31.255465 ttdb.go:366: Persisted Template subscriptions2t_tmplt.html
2023/09/15 11:11:31.319500 ttdb.go:379: Persisting Template codemaps2t_tmplt
2023/09/15 11:11:31.387383 ttdb.go:385: Persisted Template codemaps2t_tmplt
2023/09/15 11:11:31.387449 ttdb.go:366: Persisted Template codemaps2t_tmplt.html
2023/09/15 11:11:31.451786 ttdb.go:379: Persisting Template mhdpublish_tmplt
2023/09/15 11:11:31.525644 ttdb.go:385: Persisted Template mhdpublish_tmplt
2023/09/15 11:11:31.525782 ttdb.go:366: Persisted Template mhdpublish_tmplt.json
2023/09/15 11:11:31.589056 ttdb.go:379: Persisting Template events_tmplt
2023/09/15 11:11:31.658501 ttdb.go:385: Persisted Template events_tmplt
2023/09/15 11:11:31.658530 ttdb.go:366: Persisted Template events_tmplt.html
2023/09/15 11:11:31.722102 ttdb.go:379: Persisting Template uploadfile2t_tmplt
2023/09/15 11:11:31.788619 ttdb.go:385: Persisted Template uploadfile2t_tmplt
2023/09/15 11:11:31.788700 ttdb.go:366: Persisted Template uploadfile2t_tmplt.html
2023/09/15 11:11:31.788914 ttserver.go:40: Starting ICB Workflow Service. Service Endpoint http://MacBook-Pro-3.lan:8080/
2023/09/15 11:11:34.302386 ttgethandler.go:10: Processing new GET Request
2023/09/15 11:11:34.302527 ttproxy.go:138: 	Request Query Params
2023/09/15 11:11:34.302868 ttutil.go:140: 	{
  "User": "ian.thomas",
  "Org": "2tsolutions",
  "Role": "clinical",
  "Nhs": "9000000009"
}
2023/09/15 11:11:34.302900 ttgethandler.go:15: Path = /beta/spa/consumer/patient
2023/09/15 11:11:34.302956 tttmplts.go:37: CGL Worker starting
2023/09/15 11:11:34.303126 tttmplts.go:30: PIXm Worker starting
2023/09/15 11:11:34.303317 tthttp.go:15: Creating PIXm PDQ - Server URL http://lac-demo-01.tianispirit.co.uk:8081/SpiritPIXFhir/r4/Patient?identifier=2.16.840.1.113883.2.1.4.1%7C9000000009
2023/09/15 11:11:34.304627 tthttp.go:160: Request Headers 
map[Content-Type:[application/json]]
2023/09/15 11:11:34.304760 tthttp.go:160: Request Headers 
map[Accept:[application/json] X-Api-Key:[FNhb#OhxWiEiMdf+@6085k5Zmt] X-Api-Secret:[9710ea0fb4ffb5d56c2e62c71c30bdfhjsyr56a79d]]
2023/09/15 11:11:34.504528 tthttp.go:174: Server Response - Status Code 404 
{"errors":[{"message":"No clients matching nhs number 9000000009","path":"\/"}],"status":404}
2023/09/15 11:11:34.511407 ttutil.go:140: 	{
  "data": {
    "client": {
      "basicDetails": {
        "address": {},
        "name": {}
      },
      "bbvInformation": {},
      "drugTestResults": {
        "results": {}
      },
      "riskInformation": {
        "mentalHealthDomain": {},
        "riskOfHarmToSelfDomain": {},
        "socialDomain": {},
        "substanceMisuseDomain": {}
      },
      "safeguardingInformation": {}
    },
    "keyWorker": {
      "name": {}
    }
  }
}
2023/09/15 11:11:34.511524 tttmplts.go:39: CGL Worker done
2023/09/15 11:11:34.511554 tttmplts.go:40: CGL Worker Status Code 404
2023/09/15 11:11:39.304661 tthttp.go:174: Server Response - Status Code 0 
2023/09/15 11:11:39.305858 tttmplts.go:32: PIXm Worker done
2023/09/15 11:11:39.305940 tttmplts.go:33: PIXm Worker Status Code 408
2023/09/15 11:11:39.306339 tthttp.go:56: Creating PDS Search Request - Server URL https://sandbox.api.service.nhs.uk/personal-demographics/FHIR/R4/Patient/9000000009
2023/09/15 11:11:39.306566 tthttp.go:160: Request Headers 
map[Accept:[*/*] Content-Type:[application/json] X-Request-Id:[481bc756-4ef2-4a46-9ede-328a8d48a039]]
2023/09/15 11:11:39.457230 tthttp.go:174: Server Response - Status Code 200 
{"resourceType":"Patient","id":"9000000009","identifier":[{"system":"https://fhir.nhs.uk/Id/nhs-number","value":"9000000009","extension":[{"url":"https://fhir.hl7.org.uk/StructureDefinition/Extension-UKCore-NHSNumberVerificationStatus","valueCodeableConcept":{"coding":[{"system":"https://fhir.hl7.org.uk/CodeSystem/UKCore-NHSNumberVerificationStatus","version":"1.0.0","code":"01","display":"Number present and verified"}]}}]}],"meta":{"versionId":"2","security":[{"system":"http://terminology.hl7.org/CodeSystem/v3-Confidentiality","code":"U","display":"unrestricted"}]},"name":[{"id":"123","use":"usual","period":{"start":"2020-01-01","end":"2021-12-31"},"given":["Jane"],"family":"Smith","prefix":["Mrs"],"suffix":["MBE"]}],"gender":"female","birthDate":"2010-10-22","multipleBirthInteger":1,"deceasedDateTime":"2010-10-22T00:00:00+00:00","generalPractitioner":[{"id":"254406A3","type":"Organization","identifier":{"system":"https://fhir.nhs.uk/Id/ods-organization-code","value":"Y12345","period":{"start":"2020-01-01","end":"2021-12-31"}}}],"managingOrganization":{"type":"Organization","identifier":{"system":"https://fhir.nhs.uk/Id/ods-organization-code","value":"Y12345","period":{"start":"2020-01-01","end":"2021-12-31"}}},"extension":[{"url":"https://fhir.hl7.org.uk/StructureDefinition/Extension-UKCore-NominatedPharmacy","valueReference":{"identifier":{"system":"https://fhir.nhs.uk/Id/ods-organization-code","value":"Y12345"}}},{"url":"https://fhir.hl7.org.uk/StructureDefinition/Extension-UKCore-PreferredDispenserOrganization","valueReference":{"identifier":{"system":"https://fhir.nhs.uk/Id/ods-organization-code","value":"Y23456"}}},{"url":"https://fhir.hl7.org.uk/StructureDefinition/Extension-UKCore-MedicalApplianceSupplier","valueReference":{"identifier":{"system":"https://fhir.nhs.uk/Id/ods-organization-code","value":"Y34567"}}},{"url":"https://fhir.hl7.org.uk/StructureDefinition/Extension-UKCore-DeathNotificationStatus","extension":[{"url":"deathNotificationStatus","valueCodeableConcept":{"coding":[{"system":"https://fhir.hl7.org.uk/CodeSystem/UKCore-DeathNotificationStatus","version":"1.0.0","code":"2","display":"Formal - death notice received from Registrar of Deaths"}]}},{"url":"systemEffectiveDate","valueDateTime":"2010-10-22T00:00:00+00:00"}]},{"url":"https://fhir.hl7.org.uk/StructureDefinition/Extension-UKCore-NHSCommunication","extension":[{"url":"language","valueCodeableConcept":{"coding":[{"system":"https://fhir.hl7.org.uk/CodeSystem/UKCore-HumanLanguage","version":"1.0.0","code":"fr","display":"French"}]}},{"url":"interpreterRequired","valueBoolean":true}]},{"url":"https://fhir.hl7.org.uk/StructureDefinition/Extension-UKCore-ContactPreference","extension":[{"url":"PreferredWrittenCommunicationFormat","valueCodeableConcept":{"coding":[{"system":"https://fhir.hl7.org.uk/CodeSystem/UKCore-PreferredWrittenCommunicationFormat","code":"12","display":"Braille"}]}},{"url":"PreferredContactMethod","valueCodeableConcept":{"coding":[{"system":"https://fhir.hl7.org.uk/CodeSystem/UKCore-PreferredContactMethod","code":"1","display":"Letter"}]}},{"url":"PreferredContactTimes","valueString":"Not after 7pm"}]},{"url":"http://hl7.org/fhir/StructureDefinition/patient-birthPlace","valueAddress":{"city":"Manchester","district":"Greater Manchester","country":"GBR"}},{"url":"https://fhir.nhs.uk/StructureDefinition/Extension-PDS-RemovalFromRegistration","extension":[{"url":"removalFromRegistrationCode","valueCodeableConcept":{"coding":[{"system":"https://fhir.nhs.uk/CodeSystem/PDS-RemovalReasonExitCode","code":"SCT","display":"Transferred to Scotland"}]}},{"url":"effectiveTime","valuePeriod":{"start":"2020-01-01T00:00:00+00:00","end":"2021-12-31T00:00:00+00:00"}}]}],"telecom":[{"id":"789","period":{"start":"2020-01-01","end":"2021-12-31"},"system":"phone","value":"01632960587","use":"home"},{"id":"790","period":{"start":"2019-01-01","end":"2022-12-31"},"system":"email","value":"jane.smith@example.com","use":"home"},{"id":"OC789","period":{"start":"2020-01-01","end":"2021-12-31"},"system":"other","value":"01632960587","use":"home","extension":[{"url":"https://fhir.hl7.org.uk/StructureDefinition/Extension-UKCore-OtherContactSystem","valueCoding":{"system":"https://fhir.hl7.org.uk/CodeSystem/UKCore-OtherContactSystem","code":"textphone","display":"Minicom (Textphone)"}}]}],"contact":[{"id":"C123","period":{"start":"2020-01-01","end":"2021-12-31"},"relationship":[{"coding":[{"system":"http://terminology.hl7.org/CodeSystem/v2-0131","code":"C","display":"Emergency Contact"}]}],"telecom":[{"system":"phone","value":"01632960587"}]}],"address":[{"id":"456","period":{"start":"2020-01-01","end":"2021-12-31"},"use":"home","line":["1 Trevelyan Square","Boar Lane","City Centre","Leeds","West Yorkshire"],"postalCode":"LS1 6AE","extension":[{"url":"https://fhir.hl7.org.uk/StructureDefinition/Extension-UKCore-AddressKey","extension":[{"url":"type","valueCoding":{"system":"https://fhir.hl7.org.uk/CodeSystem/UKCore-AddressKeyType","code":"PAF"}},{"url":"value","valueString":"12345678"}]},{"url":"https://fhir.hl7.org.uk/StructureDefinition/Extension-UKCore-AddressKey","extension":[{"url":"type","valueCoding":{"system":"https://fhir.hl7.org.uk/CodeSystem/UKCore-AddressKeyType","code":"UPRN"}},{"url":"value","valueString":"123456789012"}]}]},{"id":"T456","period":{"start":"2020-01-01","end":"2021-12-31"},"use":"temp","text":"Student Accommodation","line":["1 Trevelyan Square","Boar Lane","City Centre","Leeds","West Yorkshire"],"postalCode":"LS1 6AE","extension":[{"url":"https://fhir.hl7.org.uk/StructureDefinition/Extension-UKCore-AddressKey","extension":[{"url":"type","valueCoding":{"system":"https://fhir.hl7.org.uk/CodeSystem/UKCore-AddressKeyType","code":"PAF"}},{"url":"value","valueString":"12345678"}]},{"url":"https://fhir.hl7.org.uk/StructureDefinition/Extension-UKCore-AddressKey","extension":[{"url":"type","valueCoding":{"system":"https://fhir.hl7.org.uk/CodeSystem/UKCore-AddressKeyType","code":"UPRN"}},{"url":"value","valueString":"123456789012"}]}]}]}
2023/09/15 11:11:39.648365 tttmplts.go:100: Caching 24 Templates
2023/09/15 11:11:39.653525 tttmplts.go:87: Processing Template allpatientSrvs_tmplt
2023/09/15 11:11:39.656991 tttmplts.go:93: template: pdsretrieve_tmplt:82:48: executing "pdsretrieve_tmplt" at <$value.ValueString>: can't evaluate field ValueString in type struct { URL string "json:\"url,omitempty\""; Extension []struct { URL string "json:\"url,omitempty\""; ValueCoding struct { System string "json:\"system,omitempty\""; Code string "json:\"code,omitempty\"" } "json:\"valueCoding,omitempty\""; ValueString string "json:\"valueString,omitempty\"" } "json:\"extension,omitempty\"" }
2023/09/15 11:11:39.657302 ttproxy.go:105: template: pdsretrieve_tmplt:82:48: executing "pdsretrieve_tmplt" at <$value.ValueString>: can't evaluate field ValueString in type struct { URL string "json:\"url,omitempty\""; Extension []struct { URL string "json:\"url,omitempty\""; ValueCoding struct { System string "json:\"system,omitempty\""; Code string "json:\"code,omitempty\"" } "json:\"valueCoding,omitempty\""; ValueString string "json:\"valueString,omitempty\"" } "json:\"extension,omitempty\"" }
2023/09/15 11:11:39.657364 ttproxy.go:149: Response Status Code 500
2023/09/15 11:11:39.657388 ttproxy.go:151: 
2023/09/15 11:11:39.657408 ttproxy.go:152: Response Headers
2023/09/15 11:11:39.657561 ttutil.go:140: 	{
  "Access-Control-Allow-Origin": "*",
  "Content-Type": "",
  "Server": "Workflow Service"
}
2023/09/15 11:11:39.657590 ttproxy.go:154: ----------------
2023/09/15 11:11:39.657608 ttproxy.go:155: Response
2023/09/15 11:11:39.657625 ttproxy.go:156: ----------------
2023/09/15 11:11:39.658181 ttutil.go:140: 	{
  "Host": "MacBook-Pro-3.lan",
  "Path": "/beta/spa/consumer/patient",
  "Method": "GET",
  "SourceIP": "[::1]:65502",
  "ReqContentType": "",
  "RspContentType": "",
  "ResponseBody": "{\"resourceType\":\"Patient\",\"id\":\"9000000009\",\"identifier\":[{\"system\":\"https://fhir.nhs.uk/Id/nhs-number\",\"value\":\"9000000009\",\"extension\":[{\"url\":\"https://fhir.hl7.org.uk/StructureDefinition/Extension-UKCore-NHSNumberVerificationStatus\",\"valueCodeableConcept\":{\"coding\":[{\"system\":\"https://fhir.hl7.org.uk/CodeSystem/UKCore-NHSNumberVerificationStatus\",\"version\":\"1.0.0\",\"code\":\"01\",\"display\":\"Number present and verified\"}]}}]}],\"meta\":{\"versionId\":\"2\",\"security\":[{\"system\":\"http://terminology.hl7.org/CodeSystem/v3-Confidentiality\",\"code\":\"U\",\"display\":\"unrestricted\"}]},\"name\":[{\"id\":\"123\",\"use\":\"usual\",\"period\":{\"start\":\"2020-01-01\",\"end\":\"2021-12-31\"},\"given\":[\"Jane\"],\"family\":\"Smith\",\"prefix\":[\"Mrs\"],\"suffix\":[\"MBE\"]}],\"gender\":\"female\",\"birthDate\":\"2010-10-22\",\"multipleBirthInteger\":1,\"deceasedDateTime\":\"2010-10-22T00:00:00+00:00\",\"generalPractitioner\":[{\"id\":\"254406A3\",\"type\":\"Organization\",\"identifier\":{\"system\":\"https://fhir.nhs.uk/Id/ods-organization-code\",\"value\":\"Y12345\",\"period\":{\"start\":\"2020-01-01\",\"end\":\"2021-12-31\"}}}],\"managingOrganization\":{\"type\":\"Organization\",\"identifier\":{\"system\":\"https://fhir.nhs.uk/Id/ods-organization-code\",\"value\":\"Y12345\",\"period\":{\"start\":\"2020-01-01\",\"end\":\"2021-12-31\"}}},\"extension\":[{\"url\":\"https://fhir.hl7.org.uk/StructureDefinition/Extension-UKCore-NominatedPharmacy\",\"valueReference\":{\"identifier\":{\"system\":\"https://fhir.nhs.uk/Id/ods-organization-code\",\"value\":\"Y12345\"}}},{\"url\":\"https://fhir.hl7.org.uk/StructureDefinition/Extension-UKCore-PreferredDispenserOrganization\",\"valueReference\":{\"identifier\":{\"system\":\"https://fhir.nhs.uk/Id/ods-organization-code\",\"value\":\"Y23456\"}}},{\"url\":\"https://fhir.hl7.org.uk/StructureDefinition/Extension-UKCore-MedicalApplianceSupplier\",\"valueReference\":{\"identifier\":{\"system\":\"https://fhir.nhs.uk/Id/ods-organization-code\",\"value\":\"Y34567\"}}},{\"url\":\"https://fhir.hl7.org.uk/StructureDefinition/Extension-UKCore-DeathNotificationStatus\",\"extension\":[{\"url\":\"deathNotificationStatus\",\"valueCodeableConcept\":{\"coding\":[{\"system\":\"https://fhir.hl7.org.uk/CodeSystem/UKCore-DeathNotificationStatus\",\"version\":\"1.0.0\",\"code\":\"2\",\"display\":\"Formal - death notice received from Registrar of Deaths\"}]}},{\"url\":\"systemEffectiveDate\",\"valueDateTime\":\"2010-10-22T00:00:00+00:00\"}]},{\"url\":\"https://fhir.hl7.org.uk/StructureDefinition/Extension-UKCore-NHSCommunication\",\"extension\":[{\"url\":\"language\",\"valueCodeableConcept\":{\"coding\":[{\"system\":\"https://fhir.hl7.org.uk/CodeSystem/UKCore-HumanLanguage\",\"version\":\"1.0.0\",\"code\":\"fr\",\"display\":\"French\"}]}},{\"url\":\"interpreterRequired\",\"valueBoolean\":true}]},{\"url\":\"https://fhir.hl7.org.uk/StructureDefinition/Extension-UKCore-ContactPreference\",\"extension\":[{\"url\":\"PreferredWrittenCommunicationFormat\",\"valueCodeableConcept\":{\"coding\":[{\"system\":\"https://fhir.hl7.org.uk/CodeSystem/UKCore-PreferredWrittenCommunicationFormat\",\"code\":\"12\",\"display\":\"Braille\"}]}},{\"url\":\"PreferredContactMethod\",\"valueCodeableConcept\":{\"coding\":[{\"system\":\"https://fhir.hl7.org.uk/CodeSystem/UKCore-PreferredContactMethod\",\"code\":\"1\",\"display\":\"Letter\"}]}},{\"url\":\"PreferredContactTimes\",\"valueString\":\"Not after 7pm\"}]},{\"url\":\"http://hl7.org/fhir/StructureDefinition/patient-birthPlace\",\"valueAddress\":{\"city\":\"Manchester\",\"district\":\"Greater Manchester\",\"country\":\"GBR\"}},{\"url\":\"https://fhir.nhs.uk/StructureDefinition/Extension-PDS-RemovalFromRegistration\",\"extension\":[{\"url\":\"removalFromRegistrationCode\",\"valueCodeableConcept\":{\"coding\":[{\"system\":\"https://fhir.nhs.uk/CodeSystem/PDS-RemovalReasonExitCode\",\"code\":\"SCT\",\"display\":\"Transferred to Scotland\"}]}},{\"url\":\"effectiveTime\",\"valuePeriod\":{\"start\":\"2020-01-01T00:00:00+00:00\",\"end\":\"2021-12-31T00:00:00+00:00\"}}]}],\"telecom\":[{\"id\":\"789\",\"period\":{\"start\":\"2020-01-01\",\"end\":\"2021-12-31\"},\"system\":\"phone\",\"value\":\"01632960587\",\"use\":\"home\"},{\"id\":\"790\",\"period\":{\"start\":\"2019-01-01\",\"end\":\"2022-12-31\"},\"system\":\"email\",\"value\":\"jane.smith@example.com\",\"use\":\"home\"},{\"id\":\"OC789\",\"period\":{\"start\":\"2020-01-01\",\"end\":\"2021-12-31\"},\"system\":\"other\",\"value\":\"01632960587\",\"use\":\"home\",\"extension\":[{\"url\":\"https://fhir.hl7.org.uk/StructureDefinition/Extension-UKCore-OtherContactSystem\",\"valueCoding\":{\"system\":\"https://fhir.hl7.org.uk/CodeSystem/UKCore-OtherContactSystem\",\"code\":\"textphone\",\"display\":\"Minicom (Textphone)\"}}]}],\"contact\":[{\"id\":\"C123\",\"period\":{\"start\":\"2020-01-01\",\"end\":\"2021-12-31\"},\"relationship\":[{\"coding\":[{\"system\":\"http://terminology.hl7.org/CodeSystem/v2-0131\",\"code\":\"C\",\"display\":\"Emergency Contact\"}]}],\"telecom\":[{\"system\":\"phone\",\"value\":\"01632960587\"}]}],\"address\":[{\"id\":\"456\",\"period\":{\"start\":\"2020-01-01\",\"end\":\"2021-12-31\"},\"use\":\"home\",\"line\":[\"1 Trevelyan Square\",\"Boar Lane\",\"City Centre\",\"Leeds\",\"West Yorkshire\"],\"postalCode\":\"LS1 6AE\",\"extension\":[{\"url\":\"https://fhir.hl7.org.uk/StructureDefinition/Extension-UKCore-AddressKey\",\"extension\":[{\"url\":\"type\",\"valueCoding\":{\"system\":\"https://fhir.hl7.org.uk/CodeSystem/UKCore-AddressKeyType\",\"code\":\"PAF\"}},{\"url\":\"value\",\"valueString\":\"12345678\"}]},{\"url\":\"https://fhir.hl7.org.uk/StructureDefinition/Extension-UKCore-AddressKey\",\"extension\":[{\"url\":\"type\",\"valueCoding\":{\"system\":\"https://fhir.hl7.org.uk/CodeSystem/UKCore-AddressKeyType\",\"code\":\"UPRN\"}},{\"url\":\"value\",\"valueString\":\"123456789012\"}]}]},{\"id\":\"T456\",\"period\":{\"start\":\"2020-01-01\",\"end\":\"2021-12-31\"},\"use\":\"temp\",\"text\":\"Student Accommodation\",\"line\":[\"1 Trevelyan Square\",\"Boar Lane\",\"City Centre\",\"Leeds\",\"West Yorkshire\"],\"postalCode\":\"LS1 6AE\",\"extension\":[{\"url\":\"https://fhir.hl7.org.uk/StructureDefinition/Extension-UKCore-AddressKey\",\"extension\":[{\"url\":\"type\",\"valueCoding\":{\"system\":\"https://fhir.hl7.org.uk/CodeSystem/UKCore-AddressKeyType\",\"code\":\"PAF\"}},{\"url\":\"value\",\"valueString\":\"12345678\"}]},{\"url\":\"https://fhir.hl7.org.uk/StructureDefinition/Extension-UKCore-AddressKey\",\"extension\":[{\"url\":\"type\",\"valueCoding\":{\"system\":\"https://fhir.hl7.org.uk/CodeSystem/UKCore-AddressKeyType\",\"code\":\"UPRN\"}},{\"url\":\"value\",\"valueString\":\"123456789012\"}]}]}]}",
  "StatusCode": 500,
  "IsBase64": false,
  "Timeout": 0
}
2023/09/15 11:11:39.658258 ttproxy.go:158: -------------
2023/09/15 11:11:39.658296 ttproxy.go:160: Error template: pdsretrieve_tmplt:82:48: executing "pdsretrieve_tmplt" at <$value.ValueString>: can't evaluate field ValueString in type struct { URL string "json:\"url,omitempty\""; Extension []struct { URL string "json:\"url,omitempty\""; ValueCoding struct { System string "json:\"system,omitempty\""; Code string "json:\"code,omitempty\"" } "json:\"valueCoding,omitempty\""; ValueString string "json:\"valueString,omitempty\"" } "json:\"extension,omitempty\"" }
2023/09/15 11:11:39.658310 ttproxy.go:161: -------------
2023/09/15 11:15:11.424907 ttserver.go:52: ICB Workflow Service stopped
2023/09/15 11:15:13.432185 ttutil.go:133: -----------------------------------------------------------------------------------
2023/09/15 11:15:13.432654 ttdb.go:51: Opening DB Connection to mysql instance
User: root
Host: tuk.coil1nnpqdlr.eu-west-1.rds.amazonaws.com
Port: :3306
Name: tuk
Connect Timeout 2s
Read Timeout 5s
2023/09/15 11:15:13.432784 ttdb.go:54: Opened Database
2023/09/15 11:15:13.633660 ttdb.go:379: Persisting Template dsubcancel_tmplt
2023/09/15 11:15:13.697119 ttdb.go:385: Persisted Template dsubcancel_tmplt
2023/09/15 11:15:13.697161 ttdb.go:366: Persisted Template dsubcancel_tmplt.xml
2023/09/15 11:15:13.760950 ttdb.go:379: Persisting Template cgl_tmplt
2023/09/15 11:15:13.868275 ttdb.go:385: Persisted Template cgl_tmplt
2023/09/15 11:15:13.868454 ttdb.go:366: Persisted Template cgl_tmplt.html
2023/09/15 11:15:13.933355 ttdb.go:379: Persisting Template pdssearch_tmplt
2023/09/15 11:15:14.001088 ttdb.go:385: Persisted Template pdssearch_tmplt
2023/09/15 11:15:14.001248 ttdb.go:366: Persisted Template pdssearch_tmplt.html
2023/09/15 11:15:14.065133 ttdb.go:379: Persisting Template dsubsubscribe_tmplt
2023/09/15 11:15:14.130817 ttdb.go:385: Persisted Template dsubsubscribe_tmplt
2023/09/15 11:15:14.130861 ttdb.go:366: Persisted Template dsubsubscribe_tmplt.xml
2023/09/15 11:15:14.194419 ttdb.go:379: Persisting Template notification_tmplt
2023/09/15 11:15:14.258127 ttdb.go:385: Persisted Template notification_tmplt
2023/09/15 11:15:14.258233 ttdb.go:366: Persisted Template notification_tmplt.txt
2023/09/15 11:15:14.323135 ttdb.go:379: Persisting Template wfstate2t_tmplt
2023/09/15 11:15:14.441307 ttdb.go:385: Persisted Template wfstate2t_tmplt
2023/09/15 11:15:14.441463 ttdb.go:366: Persisted Template wfstate2t_tmplt.html
2023/09/15 11:15:14.506740 ttdb.go:379: Persisting Template publishfile2t_tmplt
2023/09/15 11:15:14.570713 ttdb.go:385: Persisted Template publishfile2t_tmplt
2023/09/15 11:15:14.570794 ttdb.go:366: Persisted Template publishfile2t_tmplt.html
2023/09/15 11:15:14.633670 ttdb.go:379: Persisting Template react_tmplt
2023/09/15 11:15:14.717069 ttdb.go:385: Persisted Template react_tmplt
2023/09/15 11:15:14.717202 ttdb.go:366: Persisted Template react_tmplt.html
2023/09/15 11:15:14.780548 ttdb.go:379: Persisting Template pdsretrieve_tmplt
2023/09/15 11:15:14.846236 ttdb.go:385: Persisted Template pdsretrieve_tmplt
2023/09/15 11:15:14.846386 ttdb.go:366: Persisted Template pdsretrieve_tmplt.html
2023/09/15 11:15:14.912174 ttdb.go:379: Persisting Template allpatientSrvs_tmplt
2023/09/15 11:15:14.977765 ttdb.go:385: Persisted Template allpatientSrvs_tmplt
2023/09/15 11:15:14.977929 ttdb.go:366: Persisted Template allpatientSrvs_tmplt.html
2023/09/15 11:15:15.043594 ttdb.go:379: Persisting Template spa2t_tmplt
2023/09/15 11:15:15.120998 ttdb.go:385: Persisted Template spa2t_tmplt
2023/09/15 11:15:15.121155 ttdb.go:366: Persisted Template spa2t_tmplt.html
2023/09/15 11:15:15.185411 ttdb.go:379: Persisting Template xdw2t_tmplt
2023/09/15 11:15:15.271313 ttdb.go:385: Persisted Template xdw2t_tmplt
2023/09/15 11:15:15.271343 ttdb.go:366: Persisted Template xdw2t_tmplt.html
2023/09/15 11:15:15.335404 ttdb.go:379: Persisting Template spaheader2t_tmplt
2023/09/15 11:15:15.402980 ttdb.go:385: Persisted Template spaheader2t_tmplt
2023/09/15 11:15:15.403043 ttdb.go:366: Persisted Template spaheader2t_tmplt.html
2023/09/15 11:15:15.465891 ttdb.go:379: Persisting Template pds_tmplt
2023/09/15 11:15:15.531624 ttdb.go:385: Persisted Template pds_tmplt
2023/09/15 11:15:15.531757 ttdb.go:366: Persisted Template pds_tmplt.html
2023/09/15 11:15:15.596272 ttdb.go:379: Persisting Template error_tmplt
2023/09/15 11:15:15.659691 ttdb.go:385: Persisted Template error_tmplt
2023/09/15 11:15:15.659832 ttdb.go:366: Persisted Template error_tmplt.html
2023/09/15 11:15:15.762038 ttdb.go:379: Persisting Template dsuback_tmplt
2023/09/15 11:15:15.825269 ttdb.go:385: Persisted Template dsuback_tmplt
2023/09/15 11:15:15.825400 ttdb.go:366: Persisted Template dsuback_tmplt.xml
2023/09/15 11:15:15.889676 ttdb.go:379: Persisting Template pixm_tmplt
2023/09/15 11:15:15.957595 ttdb.go:385: Persisted Template pixm_tmplt
2023/09/15 11:15:15.957727 ttdb.go:366: Persisted Template pixm_tmplt.html
2023/09/15 11:15:16.021602 ttdb.go:379: Persisting Template subscriptions2t_tmplt
2023/09/15 11:15:16.090491 ttdb.go:385: Persisted Template subscriptions2t_tmplt
2023/09/15 11:15:16.090630 ttdb.go:366: Persisted Template subscriptions2t_tmplt.html
2023/09/15 11:15:16.155171 ttdb.go:379: Persisting Template codemaps2t_tmplt
2023/09/15 11:15:16.227866 ttdb.go:385: Persisted Template codemaps2t_tmplt
2023/09/15 11:15:16.227984 ttdb.go:366: Persisted Template codemaps2t_tmplt.html
2023/09/15 11:15:16.291593 ttdb.go:379: Persisting Template mhdpublish_tmplt
2023/09/15 11:15:16.363193 ttdb.go:385: Persisted Template mhdpublish_tmplt
2023/09/15 11:15:16.363335 ttdb.go:366: Persisted Template mhdpublish_tmplt.json
2023/09/15 11:15:16.427790 ttdb.go:379: Persisting Template events_tmplt
2023/09/15 11:15:16.497853 ttdb.go:385: Persisted Template events_tmplt
2023/09/15 11:15:16.497990 ttdb.go:366: Persisted Template events_tmplt.html
2023/09/15 11:15:16.563229 ttdb.go:379: Persisting Template uploadfile2t_tmplt
2023/09/15 11:15:16.629636 ttdb.go:385: Persisted Template uploadfile2t_tmplt
2023/09/15 11:15:16.629754 ttdb.go:366: Persisted Template uploadfile2t_tmplt.html
2023/09/15 11:15:16.629964 ttserver.go:40: Starting ICB Workflow Service. Service Endpoint http://MacBook-Pro-3.lan:8080/
2023/09/15 11:15:19.970987 ttgethandler.go:10: Processing new GET Request
2023/09/15 11:15:19.971142 ttproxy.go:138: 	Request Query Params
2023/09/15 11:15:19.971515 ttutil.go:140: 	{
  "User": "ian.thomas",
  "Org": "2tsolutions",
  "Role": "clinical",
  "Nhs": "9000000009"
}
2023/09/15 11:15:19.971551 ttgethandler.go:15: Path = /beta/spa/consumer/patient
2023/09/15 11:15:19.971617 tttmplts.go:30: PIXm Worker starting
2023/09/15 11:15:19.971781 tthttp.go:15: Creating PIXm PDQ - Server URL http://lac-demo-01.tianispirit.co.uk:8081/SpiritPIXFhir/r4/Patient?identifier=2.16.840.1.113883.2.1.4.1%7C9000000009
2023/09/15 11:15:19.971609 tttmplts.go:37: CGL Worker starting
2023/09/15 11:15:19.974688 tthttp.go:160: Request Headers 
map[Content-Type:[application/json]]
2023/09/15 11:15:19.974740 tthttp.go:160: Request Headers 
map[Accept:[application/json] X-Api-Key:[FNhb#OhxWiEiMdf+@6085k5Zmt] X-Api-Secret:[9710ea0fb4ffb5d56c2e62c71c30bdfhjsyr56a79d]]
2023/09/15 11:15:20.426486 tthttp.go:174: Server Response - Status Code 404 
{"errors":[{"message":"No clients matching nhs number 9000000009","path":"\/"}],"status":404}
2023/09/15 11:15:20.432110 ttutil.go:140: 	{
  "data": {
    "client": {
      "basicDetails": {
        "address": {},
        "name": {}
      },
      "bbvInformation": {},
      "drugTestResults": {
        "results": {}
      },
      "riskInformation": {
        "mentalHealthDomain": {},
        "riskOfHarmToSelfDomain": {},
        "socialDomain": {},
        "substanceMisuseDomain": {}
      },
      "safeguardingInformation": {}
    },
    "keyWorker": {
      "name": {}
    }
  }
}
2023/09/15 11:15:20.432329 tttmplts.go:39: CGL Worker done
2023/09/15 11:15:20.432482 tttmplts.go:40: CGL Worker Status Code 404
2023/09/15 11:15:24.973567 tthttp.go:174: Server Response - Status Code 0 
2023/09/15 11:15:24.974339 tttmplts.go:32: PIXm Worker done
2023/09/15 11:15:24.974531 tttmplts.go:33: PIXm Worker Status Code 408
2023/09/15 11:15:24.974899 tthttp.go:56: Creating PDS Search Request - Server URL https://sandbox.api.service.nhs.uk/personal-demographics/FHIR/R4/Patient/9000000009
2023/09/15 11:15:24.975092 tthttp.go:160: Request Headers 
map[Accept:[*/*] Content-Type:[application/json] X-Request-Id:[9ad303f3-925c-40c4-b66f-c24b51e704c6]]
2023/09/15 11:15:25.116538 tthttp.go:174: Server Response - Status Code 200 
{"resourceType":"Patient","id":"9000000009","identifier":[{"system":"https://fhir.nhs.uk/Id/nhs-number","value":"9000000009","extension":[{"url":"https://fhir.hl7.org.uk/StructureDefinition/Extension-UKCore-NHSNumberVerificationStatus","valueCodeableConcept":{"coding":[{"system":"https://fhir.hl7.org.uk/CodeSystem/UKCore-NHSNumberVerificationStatus","version":"1.0.0","code":"01","display":"Number present and verified"}]}}]}],"meta":{"versionId":"2","security":[{"system":"http://terminology.hl7.org/CodeSystem/v3-Confidentiality","code":"U","display":"unrestricted"}]},"name":[{"id":"123","use":"usual","period":{"start":"2020-01-01","end":"2021-12-31"},"given":["Jane"],"family":"Smith","prefix":["Mrs"],"suffix":["MBE"]}],"gender":"female","birthDate":"2010-10-22","multipleBirthInteger":1,"deceasedDateTime":"2010-10-22T00:00:00+00:00","generalPractitioner":[{"id":"254406A3","type":"Organization","identifier":{"system":"https://fhir.nhs.uk/Id/ods-organization-code","value":"Y12345","period":{"start":"2020-01-01","end":"2021-12-31"}}}],"managingOrganization":{"type":"Organization","identifier":{"system":"https://fhir.nhs.uk/Id/ods-organization-code","value":"Y12345","period":{"start":"2020-01-01","end":"2021-12-31"}}},"extension":[{"url":"https://fhir.hl7.org.uk/StructureDefinition/Extension-UKCore-NominatedPharmacy","valueReference":{"identifier":{"system":"https://fhir.nhs.uk/Id/ods-organization-code","value":"Y12345"}}},{"url":"https://fhir.hl7.org.uk/StructureDefinition/Extension-UKCore-PreferredDispenserOrganization","valueReference":{"identifier":{"system":"https://fhir.nhs.uk/Id/ods-organization-code","value":"Y23456"}}},{"url":"https://fhir.hl7.org.uk/StructureDefinition/Extension-UKCore-MedicalApplianceSupplier","valueReference":{"identifier":{"system":"https://fhir.nhs.uk/Id/ods-organization-code","value":"Y34567"}}},{"url":"https://fhir.hl7.org.uk/StructureDefinition/Extension-UKCore-DeathNotificationStatus","extension":[{"url":"deathNotificationStatus","valueCodeableConcept":{"coding":[{"system":"https://fhir.hl7.org.uk/CodeSystem/UKCore-DeathNotificationStatus","version":"1.0.0","code":"2","display":"Formal - death notice received from Registrar of Deaths"}]}},{"url":"systemEffectiveDate","valueDateTime":"2010-10-22T00:00:00+00:00"}]},{"url":"https://fhir.hl7.org.uk/StructureDefinition/Extension-UKCore-NHSCommunication","extension":[{"url":"language","valueCodeableConcept":{"coding":[{"system":"https://fhir.hl7.org.uk/CodeSystem/UKCore-HumanLanguage","version":"1.0.0","code":"fr","display":"French"}]}},{"url":"interpreterRequired","valueBoolean":true}]},{"url":"https://fhir.hl7.org.uk/StructureDefinition/Extension-UKCore-ContactPreference","extension":[{"url":"PreferredWrittenCommunicationFormat","valueCodeableConcept":{"coding":[{"system":"https://fhir.hl7.org.uk/CodeSystem/UKCore-PreferredWrittenCommunicationFormat","code":"12","display":"Braille"}]}},{"url":"PreferredContactMethod","valueCodeableConcept":{"coding":[{"system":"https://fhir.hl7.org.uk/CodeSystem/UKCore-PreferredContactMethod","code":"1","display":"Letter"}]}},{"url":"PreferredContactTimes","valueString":"Not after 7pm"}]},{"url":"http://hl7.org/fhir/StructureDefinition/patient-birthPlace","valueAddress":{"city":"Manchester","district":"Greater Manchester","country":"GBR"}},{"url":"https://fhir.nhs.uk/StructureDefinition/Extension-PDS-RemovalFromRegistration","extension":[{"url":"removalFromRegistrationCode","valueCodeableConcept":{"coding":[{"system":"https://fhir.nhs.uk/CodeSystem/PDS-RemovalReasonExitCode","code":"SCT","display":"Transferred to Scotland"}]}},{"url":"effectiveTime","valuePeriod":{"start":"2020-01-01T00:00:00+00:00","end":"2021-12-31T00:00:00+00:00"}}]}],"telecom":[{"id":"789","period":{"start":"2020-01-01","end":"2021-12-31"},"system":"phone","value":"01632960587","use":"home"},{"id":"790","period":{"start":"2019-01-01","end":"2022-12-31"},"system":"email","value":"jane.smith@example.com","use":"home"},{"id":"OC789","period":{"start":"2020-01-01","end":"2021-12-31"},"system":"other","value":"01632960587","use":"home","extension":[{"url":"https://fhir.hl7.org.uk/StructureDefinition/Extension-UKCore-OtherContactSystem","valueCoding":{"system":"https://fhir.hl7.org.uk/CodeSystem/UKCore-OtherContactSystem","code":"textphone","display":"Minicom (Textphone)"}}]}],"contact":[{"id":"C123","period":{"start":"2020-01-01","end":"2021-12-31"},"relationship":[{"coding":[{"system":"http://terminology.hl7.org/CodeSystem/v2-0131","code":"C","display":"Emergency Contact"}]}],"telecom":[{"system":"phone","value":"01632960587"}]}],"address":[{"id":"456","period":{"start":"2020-01-01","end":"2021-12-31"},"use":"home","line":["1 Trevelyan Square","Boar Lane","City Centre","Leeds","West Yorkshire"],"postalCode":"LS1 6AE","extension":[{"url":"https://fhir.hl7.org.uk/StructureDefinition/Extension-UKCore-AddressKey","extension":[{"url":"type","valueCoding":{"system":"https://fhir.hl7.org.uk/CodeSystem/UKCore-AddressKeyType","code":"PAF"}},{"url":"value","valueString":"12345678"}]},{"url":"https://fhir.hl7.org.uk/StructureDefinition/Extension-UKCore-AddressKey","extension":[{"url":"type","valueCoding":{"system":"https://fhir.hl7.org.uk/CodeSystem/UKCore-AddressKeyType","code":"UPRN"}},{"url":"value","valueString":"123456789012"}]}]},{"id":"T456","period":{"start":"2020-01-01","end":"2021-12-31"},"use":"temp","text":"Student Accommodation","line":["1 Trevelyan Square","Boar Lane","City Centre","Leeds","West Yorkshire"],"postalCode":"LS1 6AE","extension":[{"url":"https://fhir.hl7.org.uk/StructureDefinition/Extension-UKCore-AddressKey","extension":[{"url":"type","valueCoding":{"system":"https://fhir.hl7.org.uk/CodeSystem/UKCore-AddressKeyType","code":"PAF"}},{"url":"value","valueString":"12345678"}]},{"url":"https://fhir.hl7.org.uk/StructureDefinition/Extension-UKCore-AddressKey","extension":[{"url":"type","valueCoding":{"system":"https://fhir.hl7.org.uk/CodeSystem/UKCore-AddressKeyType","code":"UPRN"}},{"url":"value","valueString":"123456789012"}]}]}]}
2023/09/15 11:15:25.304556 tttmplts.go:100: Caching 24 Templates
2023/09/15 11:15:25.316848 tttmplts.go:87: Processing Template allpatientSrvs_tmplt
2023/09/15 11:15:25.321177 ttproxy.go:149: Response Status Code 200
2023/09/15 11:23:48.813715 ttserver.go:52: ICB Workflow Service stopped
2023/09/15 11:23:50.668175 ttutil.go:133: -----------------------------------------------------------------------------------
2023/09/15 11:23:50.668679 ttdb.go:51: Opening DB Connection to mysql instance
User: root
Host: tuk.coil1nnpqdlr.eu-west-1.rds.amazonaws.com
Port: :3306
Name: tuk
Connect Timeout 2s
Read Timeout 5s
2023/09/15 11:23:50.668800 ttdb.go:54: Opened Database
2023/09/15 11:23:51.023235 ttdb.go:379: Persisting Template dsubcancel_tmplt
2023/09/15 11:23:51.130383 ttdb.go:385: Persisted Template dsubcancel_tmplt
2023/09/15 11:23:51.130647 ttdb.go:366: Persisted Template dsubcancel_tmplt.xml
2023/09/15 11:23:51.234787 ttdb.go:379: Persisting Template cgl_tmplt
2023/09/15 11:23:51.393707 ttdb.go:385: Persisted Template cgl_tmplt
2023/09/15 11:23:51.393841 ttdb.go:366: Persisted Template cgl_tmplt.html
2023/09/15 11:23:51.501299 ttdb.go:379: Persisting Template pdssearch_tmplt
2023/09/15 11:23:51.615104 ttdb.go:385: Persisted Template pdssearch_tmplt
2023/09/15 11:23:51.615176 ttdb.go:366: Persisted Template pdssearch_tmplt.html
2023/09/15 11:23:51.765571 ttdb.go:379: Persisting Template dsubsubscribe_tmplt
2023/09/15 11:23:51.888433 ttdb.go:385: Persisted Template dsubsubscribe_tmplt
2023/09/15 11:23:51.888608 ttdb.go:366: Persisted Template dsubsubscribe_tmplt.xml
2023/09/15 11:23:52.040938 ttdb.go:379: Persisting Template notification_tmplt
2023/09/15 11:23:52.175165 ttdb.go:385: Persisted Template notification_tmplt
2023/09/15 11:23:52.175207 ttdb.go:366: Persisted Template notification_tmplt.txt
2023/09/15 11:23:52.289269 ttdb.go:379: Persisting Template wfstate2t_tmplt
2023/09/15 11:23:52.492568 ttdb.go:385: Persisted Template wfstate2t_tmplt
2023/09/15 11:23:52.492780 ttdb.go:366: Persisted Template wfstate2t_tmplt.html
2023/09/15 11:23:52.594939 ttdb.go:379: Persisting Template publishfile2t_tmplt
2023/09/15 11:23:52.697529 ttdb.go:385: Persisted Template publishfile2t_tmplt
2023/09/15 11:23:52.697596 ttdb.go:366: Persisted Template publishfile2t_tmplt.html
2023/09/15 11:23:52.802889 ttdb.go:379: Persisting Template react_tmplt
2023/09/15 11:23:52.865380 ttdb.go:385: Persisted Template react_tmplt
2023/09/15 11:23:52.865513 ttdb.go:366: Persisted Template react_tmplt.html
2023/09/15 11:23:52.928316 ttdb.go:379: Persisting Template pdsretrieve_tmplt
2023/09/15 11:23:52.996653 ttdb.go:385: Persisted Template pdsretrieve_tmplt
2023/09/15 11:23:52.996809 ttdb.go:366: Persisted Template pdsretrieve_tmplt.html
2023/09/15 11:23:53.060153 ttdb.go:379: Persisting Template allpatientSrvs_tmplt
2023/09/15 11:23:53.123950 ttdb.go:385: Persisted Template allpatientSrvs_tmplt
2023/09/15 11:23:53.124103 ttdb.go:366: Persisted Template allpatientSrvs_tmplt.html
2023/09/15 11:23:53.186403 ttdb.go:379: Persisting Template spa2t_tmplt
2023/09/15 11:23:53.264068 ttdb.go:385: Persisted Template spa2t_tmplt
2023/09/15 11:23:53.264255 ttdb.go:366: Persisted Template spa2t_tmplt.html
2023/09/15 11:23:53.329546 ttdb.go:379: Persisting Template xdw2t_tmplt
2023/09/15 11:23:53.409465 ttdb.go:385: Persisted Template xdw2t_tmplt
2023/09/15 11:23:53.409600 ttdb.go:366: Persisted Template xdw2t_tmplt.html
2023/09/15 11:23:53.479216 ttdb.go:379: Persisting Template spaheader2t_tmplt
2023/09/15 11:23:53.549576 ttdb.go:385: Persisted Template spaheader2t_tmplt
2023/09/15 11:23:53.549743 ttdb.go:366: Persisted Template spaheader2t_tmplt.html
2023/09/15 11:23:53.612113 ttdb.go:379: Persisting Template pds_tmplt
2023/09/15 11:23:53.679671 ttdb.go:385: Persisted Template pds_tmplt
2023/09/15 11:23:53.679771 ttdb.go:366: Persisted Template pds_tmplt.html
2023/09/15 11:23:53.742679 ttdb.go:379: Persisting Template error_tmplt
2023/09/15 11:23:53.806258 ttdb.go:385: Persisted Template error_tmplt
2023/09/15 11:23:53.806398 ttdb.go:366: Persisted Template error_tmplt.html
2023/09/15 11:23:53.870351 ttdb.go:379: Persisting Template dsuback_tmplt
2023/09/15 11:23:53.934620 ttdb.go:385: Persisted Template dsuback_tmplt
2023/09/15 11:23:53.934755 ttdb.go:366: Persisted Template dsuback_tmplt.xml
2023/09/15 11:23:53.999888 ttdb.go:379: Persisting Template pixm_tmplt
2023/09/15 11:23:54.068831 ttdb.go:385: Persisted Template pixm_tmplt
2023/09/15 11:23:54.068957 ttdb.go:366: Persisted Template pixm_tmplt.html
2023/09/15 11:23:54.132004 ttdb.go:379: Persisting Template subscriptions2t_tmplt
2023/09/15 11:23:54.198318 ttdb.go:385: Persisted Template subscriptions2t_tmplt
2023/09/15 11:23:54.198455 ttdb.go:366: Persisted Template subscriptions2t_tmplt.html
2023/09/15 11:23:54.263244 ttdb.go:379: Persisting Template codemaps2t_tmplt
2023/09/15 11:23:54.331925 ttdb.go:385: Persisted Template codemaps2t_tmplt
2023/09/15 11:23:54.332059 ttdb.go:366: Persisted Template codemaps2t_tmplt.html
2023/09/15 11:23:54.396012 ttdb.go:379: Persisting Template mhdpublish_tmplt
2023/09/15 11:23:54.467425 ttdb.go:385: Persisted Template mhdpublish_tmplt
2023/09/15 11:23:54.467561 ttdb.go:366: Persisted Template mhdpublish_tmplt.json
2023/09/15 11:23:54.531708 ttdb.go:379: Persisting Template events_tmplt
2023/09/15 11:23:54.601537 ttdb.go:385: Persisted Template events_tmplt
2023/09/15 11:23:54.601675 ttdb.go:366: Persisted Template events_tmplt.html
2023/09/15 11:23:54.664478 ttdb.go:379: Persisting Template uploadfile2t_tmplt
2023/09/15 11:23:54.727653 ttdb.go:385: Persisted Template uploadfile2t_tmplt
2023/09/15 11:23:54.727815 ttdb.go:366: Persisted Template uploadfile2t_tmplt.html
2023/09/15 11:23:54.728135 ttserver.go:40: Starting ICB Workflow Service. Service Endpoint http://MacBook-Pro-3.lan:8080/
2023/09/15 11:23:57.448998 ttgethandler.go:10: Processing new GET Request
2023/09/15 11:23:57.449174 ttproxy.go:138: 	Request Query Params
2023/09/15 11:23:57.449538 ttutil.go:140: 	{
  "User": "ian.thomas",
  "Org": "2tsolutions",
  "Role": "clinical",
  "Nhs": "9000000009"
}
2023/09/15 11:23:57.449574 ttgethandler.go:15: Path = /beta/spa/consumer/patient
2023/09/15 11:23:57.449607 tttmplts.go:30: PIXm Worker starting
2023/09/15 11:23:57.449991 tthttp.go:15: Creating PIXm PDQ - Server URL http://lac-demo-01.tianispirit.co.uk:8081/SpiritPIXFhir/r4/Patient?identifier=2.16.840.1.113883.2.1.4.1%7C9000000009
2023/09/15 11:23:57.449603 tttmplts.go:37: CGL Worker starting
2023/09/15 11:23:57.453954 tthttp.go:160: Request Headers 
map[Accept:[application/json] X-Api-Key:[FNhb#OhxWiEiMdf+@6085k5Zmt] X-Api-Secret:[9710ea0fb4ffb5d56c2e62c71c30bdfhjsyr56a79d]]
2023/09/15 11:23:57.454076 tthttp.go:160: Request Headers 
map[Content-Type:[application/json]]
2023/09/15 11:23:57.651277 tthttp.go:174: Server Response - Status Code 404 
{"errors":[{"message":"No clients matching nhs number 9000000009","path":"\/"}],"status":404}
2023/09/15 11:23:57.654448 ttutil.go:140: 	{
  "data": {
    "client": {
      "basicDetails": {
        "address": {},
        "name": {}
      },
      "bbvInformation": {},
      "drugTestResults": {
        "results": {}
      },
      "riskInformation": {
        "mentalHealthDomain": {},
        "riskOfHarmToSelfDomain": {},
        "socialDomain": {},
        "substanceMisuseDomain": {}
      },
      "safeguardingInformation": {}
    },
    "keyWorker": {
      "name": {}
    }
  }
}
2023/09/15 11:23:57.654580 tttmplts.go:39: CGL Worker done
2023/09/15 11:23:57.654607 tttmplts.go:40: CGL Worker Status Code 404
2023/09/15 11:24:02.451393 tthttp.go:174: Server Response - Status Code 0 
2023/09/15 11:24:02.451843 tttmplts.go:32: PIXm Worker done
2023/09/15 11:24:02.451891 tttmplts.go:33: PIXm Worker Status Code 408
2023/09/15 11:24:02.452201 tthttp.go:56: Creating PDS Search Request - Server URL https://sandbox.api.service.nhs.uk/personal-demographics/FHIR/R4/Patient/9000000009
2023/09/15 11:24:02.452379 tthttp.go:160: Request Headers 
map[Accept:[*/*] Content-Type:[application/json] X-Request-Id:[943b02d8-fde1-4711-988b-aff724dab7a2]]
2023/09/15 11:24:02.618595 tthttp.go:174: Server Response - Status Code 200 
{"resourceType":"Patient","id":"9000000009","identifier":[{"system":"https://fhir.nhs.uk/Id/nhs-number","value":"9000000009","extension":[{"url":"https://fhir.hl7.org.uk/StructureDefinition/Extension-UKCore-NHSNumberVerificationStatus","valueCodeableConcept":{"coding":[{"system":"https://fhir.hl7.org.uk/CodeSystem/UKCore-NHSNumberVerificationStatus","version":"1.0.0","code":"01","display":"Number present and verified"}]}}]}],"meta":{"versionId":"2","security":[{"system":"http://terminology.hl7.org/CodeSystem/v3-Confidentiality","code":"U","display":"unrestricted"}]},"name":[{"id":"123","use":"usual","period":{"start":"2020-01-01","end":"2021-12-31"},"given":["Jane"],"family":"Smith","prefix":["Mrs"],"suffix":["MBE"]}],"gender":"female","birthDate":"2010-10-22","multipleBirthInteger":1,"deceasedDateTime":"2010-10-22T00:00:00+00:00","generalPractitioner":[{"id":"254406A3","type":"Organization","identifier":{"system":"https://fhir.nhs.uk/Id/ods-organization-code","value":"Y12345","period":{"start":"2020-01-01","end":"2021-12-31"}}}],"managingOrganization":{"type":"Organization","identifier":{"system":"https://fhir.nhs.uk/Id/ods-organization-code","value":"Y12345","period":{"start":"2020-01-01","end":"2021-12-31"}}},"extension":[{"url":"https://fhir.hl7.org.uk/StructureDefinition/Extension-UKCore-NominatedPharmacy","valueReference":{"identifier":{"system":"https://fhir.nhs.uk/Id/ods-organization-code","value":"Y12345"}}},{"url":"https://fhir.hl7.org.uk/StructureDefinition/Extension-UKCore-PreferredDispenserOrganization","valueReference":{"identifier":{"system":"https://fhir.nhs.uk/Id/ods-organization-code","value":"Y23456"}}},{"url":"https://fhir.hl7.org.uk/StructureDefinition/Extension-UKCore-MedicalApplianceSupplier","valueReference":{"identifier":{"system":"https://fhir.nhs.uk/Id/ods-organization-code","value":"Y34567"}}},{"url":"https://fhir.hl7.org.uk/StructureDefinition/Extension-UKCore-DeathNotificationStatus","extension":[{"url":"deathNotificationStatus","valueCodeableConcept":{"coding":[{"system":"https://fhir.hl7.org.uk/CodeSystem/UKCore-DeathNotificationStatus","version":"1.0.0","code":"2","display":"Formal - death notice received from Registrar of Deaths"}]}},{"url":"systemEffectiveDate","valueDateTime":"2010-10-22T00:00:00+00:00"}]},{"url":"https://fhir.hl7.org.uk/StructureDefinition/Extension-UKCore-NHSCommunication","extension":[{"url":"language","valueCodeableConcept":{"coding":[{"system":"https://fhir.hl7.org.uk/CodeSystem/UKCore-HumanLanguage","version":"1.0.0","code":"fr","display":"French"}]}},{"url":"interpreterRequired","valueBoolean":true}]},{"url":"https://fhir.hl7.org.uk/StructureDefinition/Extension-UKCore-ContactPreference","extension":[{"url":"PreferredWrittenCommunicationFormat","valueCodeableConcept":{"coding":[{"system":"https://fhir.hl7.org.uk/CodeSystem/UKCore-PreferredWrittenCommunicationFormat","code":"12","display":"Braille"}]}},{"url":"PreferredContactMethod","valueCodeableConcept":{"coding":[{"system":"https://fhir.hl7.org.uk/CodeSystem/UKCore-PreferredContactMethod","code":"1","display":"Letter"}]}},{"url":"PreferredContactTimes","valueString":"Not after 7pm"}]},{"url":"http://hl7.org/fhir/StructureDefinition/patient-birthPlace","valueAddress":{"city":"Manchester","district":"Greater Manchester","country":"GBR"}},{"url":"https://fhir.nhs.uk/StructureDefinition/Extension-PDS-RemovalFromRegistration","extension":[{"url":"removalFromRegistrationCode","valueCodeableConcept":{"coding":[{"system":"https://fhir.nhs.uk/CodeSystem/PDS-RemovalReasonExitCode","code":"SCT","display":"Transferred to Scotland"}]}},{"url":"effectiveTime","valuePeriod":{"start":"2020-01-01T00:00:00+00:00","end":"2021-12-31T00:00:00+00:00"}}]}],"telecom":[{"id":"789","period":{"start":"2020-01-01","end":"2021-12-31"},"system":"phone","value":"01632960587","use":"home"},{"id":"790","period":{"start":"2019-01-01","end":"2022-12-31"},"system":"email","value":"jane.smith@example.com","use":"home"},{"id":"OC789","period":{"start":"2020-01-01","end":"2021-12-31"},"system":"other","value":"01632960587","use":"home","extension":[{"url":"https://fhir.hl7.org.uk/StructureDefinition/Extension-UKCore-OtherContactSystem","valueCoding":{"system":"https://fhir.hl7.org.uk/CodeSystem/UKCore-OtherContactSystem","code":"textphone","display":"Minicom (Textphone)"}}]}],"contact":[{"id":"C123","period":{"start":"2020-01-01","end":"2021-12-31"},"relationship":[{"coding":[{"system":"http://terminology.hl7.org/CodeSystem/v2-0131","code":"C","display":"Emergency Contact"}]}],"telecom":[{"system":"phone","value":"01632960587"}]}],"address":[{"id":"456","period":{"start":"2020-01-01","end":"2021-12-31"},"use":"home","line":["1 Trevelyan Square","Boar Lane","City Centre","Leeds","West Yorkshire"],"postalCode":"LS1 6AE","extension":[{"url":"https://fhir.hl7.org.uk/StructureDefinition/Extension-UKCore-AddressKey","extension":[{"url":"type","valueCoding":{"system":"https://fhir.hl7.org.uk/CodeSystem/UKCore-AddressKeyType","code":"PAF"}},{"url":"value","valueString":"12345678"}]},{"url":"https://fhir.hl7.org.uk/StructureDefinition/Extension-UKCore-AddressKey","extension":[{"url":"type","valueCoding":{"system":"https://fhir.hl7.org.uk/CodeSystem/UKCore-AddressKeyType","code":"UPRN"}},{"url":"value","valueString":"123456789012"}]}]},{"id":"T456","period":{"start":"2020-01-01","end":"2021-12-31"},"use":"temp","text":"Student Accommodation","line":["1 Trevelyan Square","Boar Lane","City Centre","Leeds","West Yorkshire"],"postalCode":"LS1 6AE","extension":[{"url":"https://fhir.hl7.org.uk/StructureDefinition/Extension-UKCore-AddressKey","extension":[{"url":"type","valueCoding":{"system":"https://fhir.hl7.org.uk/CodeSystem/UKCore-AddressKeyType","code":"PAF"}},{"url":"value","valueString":"12345678"}]},{"url":"https://fhir.hl7.org.uk/StructureDefinition/Extension-UKCore-AddressKey","extension":[{"url":"type","valueCoding":{"system":"https://fhir.hl7.org.uk/CodeSystem/UKCore-AddressKeyType","code":"UPRN"}},{"url":"value","valueString":"123456789012"}]}]}]}
2023/09/15 11:24:02.806852 tttmplts.go:100: Caching 24 Templates
2023/09/15 11:24:02.814939 tttmplts.go:87: Processing Template allpatientSrvs_tmplt
2023/09/15 11:24:02.819490 ttproxy.go:149: Response Status Code 200
2023/09/15 11:28:51.711723 ttserver.go:52: ICB Workflow Service stopped
2023/09/15 11:28:53.498164 ttutil.go:133: -----------------------------------------------------------------------------------
2023/09/15 11:28:53.498646 ttdb.go:51: Opening DB Connection to mysql instance
User: root
Host: tuk.coil1nnpqdlr.eu-west-1.rds.amazonaws.com
Port: :3306
Name: tuk
Connect Timeout 2s
Read Timeout 5s
2023/09/15 11:28:53.498776 ttdb.go:54: Opened Database
2023/09/15 11:28:53.706936 ttdb.go:379: Persisting Template dsubcancel_tmplt
2023/09/15 11:28:53.769571 ttdb.go:385: Persisted Template dsubcancel_tmplt
2023/09/15 11:28:53.769626 ttdb.go:366: Persisted Template dsubcancel_tmplt.xml
2023/09/15 11:28:53.832086 ttdb.go:379: Persisting Template cgl_tmplt
2023/09/15 11:28:53.926583 ttdb.go:385: Persisted Template cgl_tmplt
2023/09/15 11:28:53.926763 ttdb.go:366: Persisted Template cgl_tmplt.html
2023/09/15 11:28:53.993712 ttdb.go:379: Persisting Template pdssearch_tmplt
2023/09/15 11:28:54.063434 ttdb.go:385: Persisted Template pdssearch_tmplt
2023/09/15 11:28:54.063492 ttdb.go:366: Persisted Template pdssearch_tmplt.html
2023/09/15 11:28:54.128197 ttdb.go:379: Persisting Template dsubsubscribe_tmplt
2023/09/15 11:28:54.192732 ttdb.go:385: Persisted Template dsubsubscribe_tmplt
2023/09/15 11:28:54.192823 ttdb.go:366: Persisted Template dsubsubscribe_tmplt.xml
2023/09/15 11:28:54.256764 ttdb.go:379: Persisting Template notification_tmplt
2023/09/15 11:28:54.320704 ttdb.go:385: Persisted Template notification_tmplt
2023/09/15 11:28:54.320776 ttdb.go:366: Persisted Template notification_tmplt.txt
2023/09/15 11:28:54.384570 ttdb.go:379: Persisting Template wfstate2t_tmplt
2023/09/15 11:28:54.504288 ttdb.go:385: Persisted Template wfstate2t_tmplt
2023/09/15 11:28:54.504387 ttdb.go:366: Persisted Template wfstate2t_tmplt.html
2023/09/15 11:28:54.569284 ttdb.go:379: Persisting Template publishfile2t_tmplt
2023/09/15 11:28:54.636193 ttdb.go:385: Persisted Template publishfile2t_tmplt
2023/09/15 11:28:54.636385 ttdb.go:366: Persisted Template publishfile2t_tmplt.html
2023/09/15 11:28:54.699291 ttdb.go:379: Persisting Template react_tmplt
2023/09/15 11:28:54.764446 ttdb.go:385: Persisted Template react_tmplt
2023/09/15 11:28:54.764599 ttdb.go:366: Persisted Template react_tmplt.html
2023/09/15 11:28:54.831356 ttdb.go:379: Persisting Template pdsretrieve_tmplt
2023/09/15 11:28:54.896873 ttdb.go:385: Persisted Template pdsretrieve_tmplt
2023/09/15 11:28:54.897069 ttdb.go:366: Persisted Template pdsretrieve_tmplt.html
2023/09/15 11:28:54.963826 ttdb.go:379: Persisting Template allpatientSrvs_tmplt
2023/09/15 11:28:55.030479 ttdb.go:385: Persisted Template allpatientSrvs_tmplt
2023/09/15 11:28:55.030559 ttdb.go:366: Persisted Template allpatientSrvs_tmplt.html
2023/09/15 11:28:55.095081 ttdb.go:379: Persisting Template spa2t_tmplt
2023/09/15 11:28:55.170540 ttdb.go:385: Persisted Template spa2t_tmplt
2023/09/15 11:28:55.170573 ttdb.go:366: Persisted Template spa2t_tmplt.html
2023/09/15 11:28:55.234001 ttdb.go:379: Persisting Template xdw2t_tmplt
2023/09/15 11:28:55.311841 ttdb.go:385: Persisted Template xdw2t_tmplt
2023/09/15 11:28:55.311941 ttdb.go:366: Persisted Template xdw2t_tmplt.html
2023/09/15 11:28:55.375534 ttdb.go:379: Persisting Template spaheader2t_tmplt
2023/09/15 11:28:55.446464 ttdb.go:385: Persisted Template spaheader2t_tmplt
2023/09/15 11:28:55.446609 ttdb.go:366: Persisted Template spaheader2t_tmplt.html
2023/09/15 11:28:55.510476 ttdb.go:379: Persisting Template pds_tmplt
2023/09/15 11:28:55.574987 ttdb.go:385: Persisted Template pds_tmplt
2023/09/15 11:28:55.575095 ttdb.go:366: Persisted Template pds_tmplt.html
2023/09/15 11:28:55.639890 ttdb.go:379: Persisting Template error_tmplt
2023/09/15 11:28:55.706705 ttdb.go:385: Persisted Template error_tmplt
2023/09/15 11:28:55.706850 ttdb.go:366: Persisted Template error_tmplt.html
2023/09/15 11:28:55.773886 ttdb.go:379: Persisting Template dsuback_tmplt
2023/09/15 11:28:55.837181 ttdb.go:385: Persisted Template dsuback_tmplt
2023/09/15 11:28:55.837353 ttdb.go:366: Persisted Template dsuback_tmplt.xml
2023/09/15 11:28:55.900194 ttdb.go:379: Persisting Template pixm_tmplt
2023/09/15 11:28:55.965545 ttdb.go:385: Persisted Template pixm_tmplt
2023/09/15 11:28:55.965698 ttdb.go:366: Persisted Template pixm_tmplt.html
2023/09/15 11:28:56.030257 ttdb.go:379: Persisting Template subscriptions2t_tmplt
2023/09/15 11:28:56.097098 ttdb.go:385: Persisted Template subscriptions2t_tmplt
2023/09/15 11:28:56.097212 ttdb.go:366: Persisted Template subscriptions2t_tmplt.html
2023/09/15 11:28:56.160460 ttdb.go:379: Persisting Template codemaps2t_tmplt
2023/09/15 11:28:56.226260 ttdb.go:385: Persisted Template codemaps2t_tmplt
2023/09/15 11:28:56.226343 ttdb.go:366: Persisted Template codemaps2t_tmplt.html
2023/09/15 11:28:56.290271 ttdb.go:379: Persisting Template mhdpublish_tmplt
2023/09/15 11:28:56.360812 ttdb.go:385: Persisted Template mhdpublish_tmplt
2023/09/15 11:28:56.360975 ttdb.go:366: Persisted Template mhdpublish_tmplt.json
2023/09/15 11:28:56.423684 ttdb.go:379: Persisting Template events_tmplt
2023/09/15 11:28:56.493676 ttdb.go:385: Persisted Template events_tmplt
2023/09/15 11:28:56.493879 ttdb.go:366: Persisted Template events_tmplt.html
2023/09/15 11:28:56.556749 ttdb.go:379: Persisting Template uploadfile2t_tmplt
2023/09/15 11:28:56.619271 ttdb.go:385: Persisted Template uploadfile2t_tmplt
2023/09/15 11:28:56.619484 ttdb.go:366: Persisted Template uploadfile2t_tmplt.html
2023/09/15 11:28:56.619758 ttserver.go:40: Starting ICB Workflow Service. Service Endpoint http://MacBook-Pro-3.lan:8080/
2023/09/15 11:28:59.863825 ttgethandler.go:10: Processing new GET Request
2023/09/15 11:28:59.864036 ttproxy.go:138: 	Request Query Params
2023/09/15 11:28:59.864469 ttutil.go:140: 	{
  "User": "ian.thomas",
  "Org": "2tsolutions",
  "Role": "clinical",
  "Nhs": "9000000009"
}
2023/09/15 11:28:59.864517 ttgethandler.go:15: Path = /beta/spa/consumer/patient
2023/09/15 11:28:59.864565 tttmplts.go:37: CGL Worker starting
2023/09/15 11:28:59.864564 tttmplts.go:30: PIXm Worker starting
2023/09/15 11:28:59.864938 tthttp.go:15: Creating PIXm PDQ - Server URL http://lac-demo-01.tianispirit.co.uk:8081/SpiritPIXFhir/r4/Patient?identifier=2.16.840.1.113883.2.1.4.1%7C9000000009
2023/09/15 11:28:59.866307 tthttp.go:160: Request Headers 
map[Content-Type:[application/json]]
2023/09/15 11:28:59.866376 tthttp.go:160: Request Headers 
map[Accept:[application/json] X-Api-Key:[FNhb#OhxWiEiMdf+@6085k5Zmt] X-Api-Secret:[9710ea0fb4ffb5d56c2e62c71c30bdfhjsyr56a79d]]
2023/09/15 11:29:00.226010 tthttp.go:174: Server Response - Status Code 404 
{"errors":[{"message":"No clients matching nhs number 9000000009","path":"\/"}],"status":404}
2023/09/15 11:29:00.232433 ttutil.go:140: 	{
  "data": {
    "client": {
      "basicDetails": {
        "address": {},
        "name": {}
      },
      "bbvInformation": {},
      "drugTestResults": {
        "results": {}
      },
      "riskInformation": {
        "mentalHealthDomain": {},
        "riskOfHarmToSelfDomain": {},
        "socialDomain": {},
        "substanceMisuseDomain": {}
      },
      "safeguardingInformation": {}
    },
    "keyWorker": {
      "name": {}
    }
  }
}
2023/09/15 11:29:00.232566 tttmplts.go:39: CGL Worker done
2023/09/15 11:29:00.232603 tttmplts.go:40: CGL Worker Status Code 404
2023/09/15 11:29:04.867239 tthttp.go:174: Server Response - Status Code 0 
2023/09/15 11:29:04.867551 tttmplts.go:32: PIXm Worker done
2023/09/15 11:29:04.867618 tttmplts.go:33: PIXm Worker Status Code 408
2023/09/15 11:29:04.867823 tthttp.go:56: Creating PDS Search Request - Server URL https://sandbox.api.service.nhs.uk/personal-demographics/FHIR/R4/Patient/9000000009
2023/09/15 11:29:04.867990 tthttp.go:160: Request Headers 
map[Accept:[*/*] Content-Type:[application/json] X-Request-Id:[c23b4ad5-3f7f-475a-b0f8-046122788e2f]]
2023/09/15 11:29:05.020971 tthttp.go:174: Server Response - Status Code 200 
{"resourceType":"Patient","id":"9000000009","identifier":[{"system":"https://fhir.nhs.uk/Id/nhs-number","value":"9000000009","extension":[{"url":"https://fhir.hl7.org.uk/StructureDefinition/Extension-UKCore-NHSNumberVerificationStatus","valueCodeableConcept":{"coding":[{"system":"https://fhir.hl7.org.uk/CodeSystem/UKCore-NHSNumberVerificationStatus","version":"1.0.0","code":"01","display":"Number present and verified"}]}}]}],"meta":{"versionId":"2","security":[{"system":"http://terminology.hl7.org/CodeSystem/v3-Confidentiality","code":"U","display":"unrestricted"}]},"name":[{"id":"123","use":"usual","period":{"start":"2020-01-01","end":"2021-12-31"},"given":["Jane"],"family":"Smith","prefix":["Mrs"],"suffix":["MBE"]}],"gender":"female","birthDate":"2010-10-22","multipleBirthInteger":1,"deceasedDateTime":"2010-10-22T00:00:00+00:00","generalPractitioner":[{"id":"254406A3","type":"Organization","identifier":{"system":"https://fhir.nhs.uk/Id/ods-organization-code","value":"Y12345","period":{"start":"2020-01-01","end":"2021-12-31"}}}],"managingOrganization":{"type":"Organization","identifier":{"system":"https://fhir.nhs.uk/Id/ods-organization-code","value":"Y12345","period":{"start":"2020-01-01","end":"2021-12-31"}}},"extension":[{"url":"https://fhir.hl7.org.uk/StructureDefinition/Extension-UKCore-NominatedPharmacy","valueReference":{"identifier":{"system":"https://fhir.nhs.uk/Id/ods-organization-code","value":"Y12345"}}},{"url":"https://fhir.hl7.org.uk/StructureDefinition/Extension-UKCore-PreferredDispenserOrganization","valueReference":{"identifier":{"system":"https://fhir.nhs.uk/Id/ods-organization-code","value":"Y23456"}}},{"url":"https://fhir.hl7.org.uk/StructureDefinition/Extension-UKCore-MedicalApplianceSupplier","valueReference":{"identifier":{"system":"https://fhir.nhs.uk/Id/ods-organization-code","value":"Y34567"}}},{"url":"https://fhir.hl7.org.uk/StructureDefinition/Extension-UKCore-DeathNotificationStatus","extension":[{"url":"deathNotificationStatus","valueCodeableConcept":{"coding":[{"system":"https://fhir.hl7.org.uk/CodeSystem/UKCore-DeathNotificationStatus","version":"1.0.0","code":"2","display":"Formal - death notice received from Registrar of Deaths"}]}},{"url":"systemEffectiveDate","valueDateTime":"2010-10-22T00:00:00+00:00"}]},{"url":"https://fhir.hl7.org.uk/StructureDefinition/Extension-UKCore-NHSCommunication","extension":[{"url":"language","valueCodeableConcept":{"coding":[{"system":"https://fhir.hl7.org.uk/CodeSystem/UKCore-HumanLanguage","version":"1.0.0","code":"fr","display":"French"}]}},{"url":"interpreterRequired","valueBoolean":true}]},{"url":"https://fhir.hl7.org.uk/StructureDefinition/Extension-UKCore-ContactPreference","extension":[{"url":"PreferredWrittenCommunicationFormat","valueCodeableConcept":{"coding":[{"system":"https://fhir.hl7.org.uk/CodeSystem/UKCore-PreferredWrittenCommunicationFormat","code":"12","display":"Braille"}]}},{"url":"PreferredContactMethod","valueCodeableConcept":{"coding":[{"system":"https://fhir.hl7.org.uk/CodeSystem/UKCore-PreferredContactMethod","code":"1","display":"Letter"}]}},{"url":"PreferredContactTimes","valueString":"Not after 7pm"}]},{"url":"http://hl7.org/fhir/StructureDefinition/patient-birthPlace","valueAddress":{"city":"Manchester","district":"Greater Manchester","country":"GBR"}},{"url":"https://fhir.nhs.uk/StructureDefinition/Extension-PDS-RemovalFromRegistration","extension":[{"url":"removalFromRegistrationCode","valueCodeableConcept":{"coding":[{"system":"https://fhir.nhs.uk/CodeSystem/PDS-RemovalReasonExitCode","code":"SCT","display":"Transferred to Scotland"}]}},{"url":"effectiveTime","valuePeriod":{"start":"2020-01-01T00:00:00+00:00","end":"2021-12-31T00:00:00+00:00"}}]}],"telecom":[{"id":"789","period":{"start":"2020-01-01","end":"2021-12-31"},"system":"phone","value":"01632960587","use":"home"},{"id":"790","period":{"start":"2019-01-01","end":"2022-12-31"},"system":"email","value":"jane.smith@example.com","use":"home"},{"id":"OC789","period":{"start":"2020-01-01","end":"2021-12-31"},"system":"other","value":"01632960587","use":"home","extension":[{"url":"https://fhir.hl7.org.uk/StructureDefinition/Extension-UKCore-OtherContactSystem","valueCoding":{"system":"https://fhir.hl7.org.uk/CodeSystem/UKCore-OtherContactSystem","code":"textphone","display":"Minicom (Textphone)"}}]}],"contact":[{"id":"C123","period":{"start":"2020-01-01","end":"2021-12-31"},"relationship":[{"coding":[{"system":"http://terminology.hl7.org/CodeSystem/v2-0131","code":"C","display":"Emergency Contact"}]}],"telecom":[{"system":"phone","value":"01632960587"}]}],"address":[{"id":"456","period":{"start":"2020-01-01","end":"2021-12-31"},"use":"home","line":["1 Trevelyan Square","Boar Lane","City Centre","Leeds","West Yorkshire"],"postalCode":"LS1 6AE","extension":[{"url":"https://fhir.hl7.org.uk/StructureDefinition/Extension-UKCore-AddressKey","extension":[{"url":"type","valueCoding":{"system":"https://fhir.hl7.org.uk/CodeSystem/UKCore-AddressKeyType","code":"PAF"}},{"url":"value","valueString":"12345678"}]},{"url":"https://fhir.hl7.org.uk/StructureDefinition/Extension-UKCore-AddressKey","extension":[{"url":"type","valueCoding":{"system":"https://fhir.hl7.org.uk/CodeSystem/UKCore-AddressKeyType","code":"UPRN"}},{"url":"value","valueString":"123456789012"}]}]},{"id":"T456","period":{"start":"2020-01-01","end":"2021-12-31"},"use":"temp","text":"Student Accommodation","line":["1 Trevelyan Square","Boar Lane","City Centre","Leeds","West Yorkshire"],"postalCode":"LS1 6AE","extension":[{"url":"https://fhir.hl7.org.uk/StructureDefinition/Extension-UKCore-AddressKey","extension":[{"url":"type","valueCoding":{"system":"https://fhir.hl7.org.uk/CodeSystem/UKCore-AddressKeyType","code":"PAF"}},{"url":"value","valueString":"12345678"}]},{"url":"https://fhir.hl7.org.uk/StructureDefinition/Extension-UKCore-AddressKey","extension":[{"url":"type","valueCoding":{"system":"https://fhir.hl7.org.uk/CodeSystem/UKCore-AddressKeyType","code":"UPRN"}},{"url":"value","valueString":"123456789012"}]}]}]}
2023/09/15 11:29:05.383792 tttmplts.go:100: Caching 24 Templates
2023/09/15 11:29:05.387415 tttmplts.go:104: Template pdsretrieve_tmplt caused Error template: pdsretrieve_tmplt:117: unexpected EOF
2023/09/15 11:29:05.387933 server.go:3217: http: panic serving [::1]:49475: runtime error: invalid memory address or nil pointer dereference
goroutine 23 [running]:
net/http.(*conn).serve.func1()
	/Users/IanThomas/sdk/go1.20.5/src/net/http/server.go:1854 +0xbf
panic({0x1434ca0, 0x17e4e70})
	/Users/IanThomas/sdk/go1.20.5/src/runtime/panic.go:890 +0x263
html/template.(*Template).New(0x14c1682?, {0xc000028150?, 0xc000509fc0?})
	/Users/IanThomas/sdk/go1.20.5/src/html/template/template.go:305 +0x37
main.(*Trans).cacheTemplates(0xc00024e000)
	/Users/IanThomas/go/src/ttxdwuser/main/tttmplts.go:103 +0x1d2
main.(*Trans).setResponseFromTemplate(0xc00024e000)
	/Users/IanThomas/go/src/ttxdwuser/main/tttmplts.go:85 +0x45
main.(*Trans).setPatientTemplate(0xc00024e000)
	/Users/IanThomas/go/src/ttxdwuser/main/tttmplts.go:53 +0x1b1
main.(*Trans).newGetHandler(0xc00024e000)
	/Users/IanThomas/go/src/ttxdwuser/main/ttgethandler.go:28 +0xd94
main.(*Trans).newProxyTrans(0xc00024e000)
	/Users/IanThomas/go/src/ttxdwuser/main/ttproxy.go:73 +0x4d1
main.Handle_HTTP_Request({0x15657d0, 0xc00022a0e0}, 0xc000236000)
	/Users/IanThomas/go/src/ttxdwuser/main/ttproxy.go:15 +0xeb
net/http.HandlerFunc.ServeHTTP(0xc00023801f?, {0x15657d0?, 0xc00022a0e0?}, 0x1064cee?)
	/Users/IanThomas/sdk/go1.20.5/src/net/http/server.go:2122 +0x2f
net/http.serverHandler.ServeHTTP({0xc0002120c0?}, {0x15657d0, 0xc00022a0e0}, 0xc000236000)
	/Users/IanThomas/sdk/go1.20.5/src/net/http/server.go:2936 +0x316
net/http.(*conn).serve(0xc0000ccd80, {0x15659c8, 0xc0000b32c0})
	/Users/IanThomas/sdk/go1.20.5/src/net/http/server.go:1995 +0x612
created by net/http.(*Server).Serve
	/Users/IanThomas/sdk/go1.20.5/src/net/http/server.go:3089 +0x5ed
2023/09/15 11:29:42.017985 ttserver.go:52: ICB Workflow Service stopped
2023/09/15 11:29:43.479790 ttutil.go:133: -----------------------------------------------------------------------------------
2023/09/15 11:29:43.480262 ttdb.go:51: Opening DB Connection to mysql instance
User: root
Host: tuk.coil1nnpqdlr.eu-west-1.rds.amazonaws.com
Port: :3306
Name: tuk
Connect Timeout 2s
Read Timeout 5s
2023/09/15 11:29:43.480390 ttdb.go:54: Opened Database
2023/09/15 11:29:43.671329 ttdb.go:379: Persisting Template dsubcancel_tmplt
2023/09/15 11:29:43.752502 ttdb.go:385: Persisted Template dsubcancel_tmplt
2023/09/15 11:29:43.752556 ttdb.go:366: Persisted Template dsubcancel_tmplt.xml
2023/09/15 11:29:43.819178 ttdb.go:379: Persisting Template cgl_tmplt
2023/09/15 11:29:43.922628 ttdb.go:385: Persisted Template cgl_tmplt
2023/09/15 11:29:43.922662 ttdb.go:366: Persisted Template cgl_tmplt.html
2023/09/15 11:29:43.990558 ttdb.go:379: Persisting Template pdssearch_tmplt
2023/09/15 11:29:44.061263 ttdb.go:385: Persisted Template pdssearch_tmplt
2023/09/15 11:29:44.061301 ttdb.go:366: Persisted Template pdssearch_tmplt.html
2023/09/15 11:29:44.130506 ttdb.go:379: Persisting Template dsubsubscribe_tmplt
2023/09/15 11:29:44.198956 ttdb.go:385: Persisted Template dsubsubscribe_tmplt
2023/09/15 11:29:44.199137 ttdb.go:366: Persisted Template dsubsubscribe_tmplt.xml
2023/09/15 11:29:44.267930 ttdb.go:379: Persisting Template notification_tmplt
2023/09/15 11:29:44.339165 ttdb.go:385: Persisted Template notification_tmplt
2023/09/15 11:29:44.339336 ttdb.go:366: Persisted Template notification_tmplt.txt
2023/09/15 11:29:44.409368 ttdb.go:379: Persisting Template wfstate2t_tmplt
2023/09/15 11:29:44.541417 ttdb.go:385: Persisted Template wfstate2t_tmplt
2023/09/15 11:29:44.541598 ttdb.go:366: Persisted Template wfstate2t_tmplt.html
2023/09/15 11:29:44.611476 ttdb.go:379: Persisting Template publishfile2t_tmplt
2023/09/15 11:29:44.682286 ttdb.go:385: Persisted Template publishfile2t_tmplt
2023/09/15 11:29:44.682441 ttdb.go:366: Persisted Template publishfile2t_tmplt.html
2023/09/15 11:29:44.752244 ttdb.go:379: Persisting Template react_tmplt
2023/09/15 11:29:44.824720 ttdb.go:385: Persisted Template react_tmplt
2023/09/15 11:29:44.824904 ttdb.go:366: Persisted Template react_tmplt.html
2023/09/15 11:29:44.895413 ttdb.go:379: Persisting Template pdsretrieve_tmplt
2023/09/15 11:29:44.966599 ttdb.go:385: Persisted Template pdsretrieve_tmplt
2023/09/15 11:29:44.966705 ttdb.go:366: Persisted Template pdsretrieve_tmplt.html
2023/09/15 11:29:45.035879 ttdb.go:379: Persisting Template allpatientSrvs_tmplt
2023/09/15 11:29:45.106312 ttdb.go:385: Persisted Template allpatientSrvs_tmplt
2023/09/15 11:29:45.106350 ttdb.go:366: Persisted Template allpatientSrvs_tmplt.html
2023/09/15 11:29:45.174271 ttdb.go:379: Persisting Template spa2t_tmplt
2023/09/15 11:29:45.256268 ttdb.go:385: Persisted Template spa2t_tmplt
2023/09/15 11:29:45.256339 ttdb.go:366: Persisted Template spa2t_tmplt.html
2023/09/15 11:29:45.322786 ttdb.go:379: Persisting Template xdw2t_tmplt
2023/09/15 11:29:45.409395 ttdb.go:385: Persisted Template xdw2t_tmplt
2023/09/15 11:29:45.409503 ttdb.go:366: Persisted Template xdw2t_tmplt.html
2023/09/15 11:29:45.478322 ttdb.go:379: Persisting Template spaheader2t_tmplt
2023/09/15 11:29:45.553648 ttdb.go:385: Persisted Template spaheader2t_tmplt
2023/09/15 11:29:45.553795 ttdb.go:366: Persisted Template spaheader2t_tmplt.html
2023/09/15 11:29:45.622882 ttdb.go:379: Persisting Template pds_tmplt
2023/09/15 11:29:45.691350 ttdb.go:385: Persisted Template pds_tmplt
2023/09/15 11:29:45.691373 ttdb.go:366: Persisted Template pds_tmplt.html
2023/09/15 11:29:45.769900 ttdb.go:379: Persisting Template error_tmplt
2023/09/15 11:29:45.838970 ttdb.go:385: Persisted Template error_tmplt
2023/09/15 11:29:45.839131 ttdb.go:366: Persisted Template error_tmplt.html
2023/09/15 11:29:45.907837 ttdb.go:379: Persisting Template dsuback_tmplt
2023/09/15 11:29:45.975819 ttdb.go:385: Persisted Template dsuback_tmplt
2023/09/15 11:29:45.975955 ttdb.go:366: Persisted Template dsuback_tmplt.xml
2023/09/15 11:29:46.046384 ttdb.go:379: Persisting Template pixm_tmplt
2023/09/15 11:29:46.119627 ttdb.go:385: Persisted Template pixm_tmplt
2023/09/15 11:29:46.119783 ttdb.go:366: Persisted Template pixm_tmplt.html
2023/09/15 11:29:46.186723 ttdb.go:379: Persisting Template subscriptions2t_tmplt
2023/09/15 11:29:46.259672 ttdb.go:385: Persisted Template subscriptions2t_tmplt
2023/09/15 11:29:46.259849 ttdb.go:366: Persisted Template subscriptions2t_tmplt.html
2023/09/15 11:29:46.329851 ttdb.go:379: Persisting Template codemaps2t_tmplt
2023/09/15 11:29:46.403506 ttdb.go:385: Persisted Template codemaps2t_tmplt
2023/09/15 11:29:46.403659 ttdb.go:366: Persisted Template codemaps2t_tmplt.html
2023/09/15 11:29:46.471534 ttdb.go:379: Persisting Template mhdpublish_tmplt
2023/09/15 11:29:46.553006 ttdb.go:385: Persisted Template mhdpublish_tmplt
2023/09/15 11:29:46.553084 ttdb.go:366: Persisted Template mhdpublish_tmplt.json
2023/09/15 11:29:46.624184 ttdb.go:379: Persisting Template events_tmplt
2023/09/15 11:29:46.699684 ttdb.go:385: Persisted Template events_tmplt
2023/09/15 11:29:46.699834 ttdb.go:366: Persisted Template events_tmplt.html
2023/09/15 11:29:46.768269 ttdb.go:379: Persisting Template uploadfile2t_tmplt
2023/09/15 11:29:46.840126 ttdb.go:385: Persisted Template uploadfile2t_tmplt
2023/09/15 11:29:46.840270 ttdb.go:366: Persisted Template uploadfile2t_tmplt.html
2023/09/15 11:29:46.840555 ttserver.go:40: Starting ICB Workflow Service. Service Endpoint http://MacBook-Pro-3.lan:8080/
2023/09/15 11:29:49.449925 ttgethandler.go:10: Processing new GET Request
2023/09/15 11:29:49.450110 ttproxy.go:138: 	Request Query Params
2023/09/15 11:29:49.450491 ttutil.go:140: 	{
  "User": "ian.thomas",
  "Org": "2tsolutions",
  "Role": "clinical",
  "Nhs": "9000000009"
}
2023/09/15 11:29:49.450536 ttgethandler.go:15: Path = /beta/spa/consumer/patient
2023/09/15 11:29:49.450578 tttmplts.go:37: CGL Worker starting
2023/09/15 11:29:49.450573 tttmplts.go:30: PIXm Worker starting
2023/09/15 11:29:49.451059 tthttp.go:15: Creating PIXm PDQ - Server URL http://lac-demo-01.tianispirit.co.uk:8081/SpiritPIXFhir/r4/Patient?identifier=2.16.840.1.113883.2.1.4.1%7C9000000009
2023/09/15 11:29:49.453077 tthttp.go:160: Request Headers 
map[Content-Type:[application/json]]
2023/09/15 11:29:49.453138 tthttp.go:160: Request Headers 
map[Accept:[application/json] X-Api-Key:[FNhb#OhxWiEiMdf+@6085k5Zmt] X-Api-Secret:[9710ea0fb4ffb5d56c2e62c71c30bdfhjsyr56a79d]]
2023/09/15 11:29:49.639342 tthttp.go:174: Server Response - Status Code 404 
{"errors":[{"message":"No clients matching nhs number 9000000009","path":"\/"}],"status":404}
2023/09/15 11:29:49.642406 ttutil.go:140: 	{
  "data": {
    "client": {
      "basicDetails": {
        "address": {},
        "name": {}
      },
      "bbvInformation": {},
      "drugTestResults": {
        "results": {}
      },
      "riskInformation": {
        "mentalHealthDomain": {},
        "riskOfHarmToSelfDomain": {},
        "socialDomain": {},
        "substanceMisuseDomain": {}
      },
      "safeguardingInformation": {}
    },
    "keyWorker": {
      "name": {}
    }
  }
}
2023/09/15 11:29:49.642492 tttmplts.go:39: CGL Worker done
2023/09/15 11:29:49.642513 tttmplts.go:40: CGL Worker Status Code 404
2023/09/15 11:29:54.452757 tthttp.go:174: Server Response - Status Code 0 
2023/09/15 11:29:54.453126 tttmplts.go:32: PIXm Worker done
2023/09/15 11:29:54.453196 tttmplts.go:33: PIXm Worker Status Code 408
2023/09/15 11:29:54.453442 tthttp.go:56: Creating PDS Search Request - Server URL https://sandbox.api.service.nhs.uk/personal-demographics/FHIR/R4/Patient/9000000009
2023/09/15 11:29:54.453609 tthttp.go:160: Request Headers 
map[Accept:[*/*] Content-Type:[application/json] X-Request-Id:[f8a32c3f-4a7e-42a4-9bbf-817d2b3ad15f]]
2023/09/15 11:29:54.608121 tthttp.go:174: Server Response - Status Code 200 
{"resourceType":"Patient","id":"9000000009","identifier":[{"system":"https://fhir.nhs.uk/Id/nhs-number","value":"9000000009","extension":[{"url":"https://fhir.hl7.org.uk/StructureDefinition/Extension-UKCore-NHSNumberVerificationStatus","valueCodeableConcept":{"coding":[{"system":"https://fhir.hl7.org.uk/CodeSystem/UKCore-NHSNumberVerificationStatus","version":"1.0.0","code":"01","display":"Number present and verified"}]}}]}],"meta":{"versionId":"2","security":[{"system":"http://terminology.hl7.org/CodeSystem/v3-Confidentiality","code":"U","display":"unrestricted"}]},"name":[{"id":"123","use":"usual","period":{"start":"2020-01-01","end":"2021-12-31"},"given":["Jane"],"family":"Smith","prefix":["Mrs"],"suffix":["MBE"]}],"gender":"female","birthDate":"2010-10-22","multipleBirthInteger":1,"deceasedDateTime":"2010-10-22T00:00:00+00:00","generalPractitioner":[{"id":"254406A3","type":"Organization","identifier":{"system":"https://fhir.nhs.uk/Id/ods-organization-code","value":"Y12345","period":{"start":"2020-01-01","end":"2021-12-31"}}}],"managingOrganization":{"type":"Organization","identifier":{"system":"https://fhir.nhs.uk/Id/ods-organization-code","value":"Y12345","period":{"start":"2020-01-01","end":"2021-12-31"}}},"extension":[{"url":"https://fhir.hl7.org.uk/StructureDefinition/Extension-UKCore-NominatedPharmacy","valueReference":{"identifier":{"system":"https://fhir.nhs.uk/Id/ods-organization-code","value":"Y12345"}}},{"url":"https://fhir.hl7.org.uk/StructureDefinition/Extension-UKCore-PreferredDispenserOrganization","valueReference":{"identifier":{"system":"https://fhir.nhs.uk/Id/ods-organization-code","value":"Y23456"}}},{"url":"https://fhir.hl7.org.uk/StructureDefinition/Extension-UKCore-MedicalApplianceSupplier","valueReference":{"identifier":{"system":"https://fhir.nhs.uk/Id/ods-organization-code","value":"Y34567"}}},{"url":"https://fhir.hl7.org.uk/StructureDefinition/Extension-UKCore-DeathNotificationStatus","extension":[{"url":"deathNotificationStatus","valueCodeableConcept":{"coding":[{"system":"https://fhir.hl7.org.uk/CodeSystem/UKCore-DeathNotificationStatus","version":"1.0.0","code":"2","display":"Formal - death notice received from Registrar of Deaths"}]}},{"url":"systemEffectiveDate","valueDateTime":"2010-10-22T00:00:00+00:00"}]},{"url":"https://fhir.hl7.org.uk/StructureDefinition/Extension-UKCore-NHSCommunication","extension":[{"url":"language","valueCodeableConcept":{"coding":[{"system":"https://fhir.hl7.org.uk/CodeSystem/UKCore-HumanLanguage","version":"1.0.0","code":"fr","display":"French"}]}},{"url":"interpreterRequired","valueBoolean":true}]},{"url":"https://fhir.hl7.org.uk/StructureDefinition/Extension-UKCore-ContactPreference","extension":[{"url":"PreferredWrittenCommunicationFormat","valueCodeableConcept":{"coding":[{"system":"https://fhir.hl7.org.uk/CodeSystem/UKCore-PreferredWrittenCommunicationFormat","code":"12","display":"Braille"}]}},{"url":"PreferredContactMethod","valueCodeableConcept":{"coding":[{"system":"https://fhir.hl7.org.uk/CodeSystem/UKCore-PreferredContactMethod","code":"1","display":"Letter"}]}},{"url":"PreferredContactTimes","valueString":"Not after 7pm"}]},{"url":"http://hl7.org/fhir/StructureDefinition/patient-birthPlace","valueAddress":{"city":"Manchester","district":"Greater Manchester","country":"GBR"}},{"url":"https://fhir.nhs.uk/StructureDefinition/Extension-PDS-RemovalFromRegistration","extension":[{"url":"removalFromRegistrationCode","valueCodeableConcept":{"coding":[{"system":"https://fhir.nhs.uk/CodeSystem/PDS-RemovalReasonExitCode","code":"SCT","display":"Transferred to Scotland"}]}},{"url":"effectiveTime","valuePeriod":{"start":"2020-01-01T00:00:00+00:00","end":"2021-12-31T00:00:00+00:00"}}]}],"telecom":[{"id":"789","period":{"start":"2020-01-01","end":"2021-12-31"},"system":"phone","value":"01632960587","use":"home"},{"id":"790","period":{"start":"2019-01-01","end":"2022-12-31"},"system":"email","value":"jane.smith@example.com","use":"home"},{"id":"OC789","period":{"start":"2020-01-01","end":"2021-12-31"},"system":"other","value":"01632960587","use":"home","extension":[{"url":"https://fhir.hl7.org.uk/StructureDefinition/Extension-UKCore-OtherContactSystem","valueCoding":{"system":"https://fhir.hl7.org.uk/CodeSystem/UKCore-OtherContactSystem","code":"textphone","display":"Minicom (Textphone)"}}]}],"contact":[{"id":"C123","period":{"start":"2020-01-01","end":"2021-12-31"},"relationship":[{"coding":[{"system":"http://terminology.hl7.org/CodeSystem/v2-0131","code":"C","display":"Emergency Contact"}]}],"telecom":[{"system":"phone","value":"01632960587"}]}],"address":[{"id":"456","period":{"start":"2020-01-01","end":"2021-12-31"},"use":"home","line":["1 Trevelyan Square","Boar Lane","City Centre","Leeds","West Yorkshire"],"postalCode":"LS1 6AE","extension":[{"url":"https://fhir.hl7.org.uk/StructureDefinition/Extension-UKCore-AddressKey","extension":[{"url":"type","valueCoding":{"system":"https://fhir.hl7.org.uk/CodeSystem/UKCore-AddressKeyType","code":"PAF"}},{"url":"value","valueString":"12345678"}]},{"url":"https://fhir.hl7.org.uk/StructureDefinition/Extension-UKCore-AddressKey","extension":[{"url":"type","valueCoding":{"system":"https://fhir.hl7.org.uk/CodeSystem/UKCore-AddressKeyType","code":"UPRN"}},{"url":"value","valueString":"123456789012"}]}]},{"id":"T456","period":{"start":"2020-01-01","end":"2021-12-31"},"use":"temp","text":"Student Accommodation","line":["1 Trevelyan Square","Boar Lane","City Centre","Leeds","West Yorkshire"],"postalCode":"LS1 6AE","extension":[{"url":"https://fhir.hl7.org.uk/StructureDefinition/Extension-UKCore-AddressKey","extension":[{"url":"type","valueCoding":{"system":"https://fhir.hl7.org.uk/CodeSystem/UKCore-AddressKeyType","code":"PAF"}},{"url":"value","valueString":"12345678"}]},{"url":"https://fhir.hl7.org.uk/StructureDefinition/Extension-UKCore-AddressKey","extension":[{"url":"type","valueCoding":{"system":"https://fhir.hl7.org.uk/CodeSystem/UKCore-AddressKeyType","code":"UPRN"}},{"url":"value","valueString":"123456789012"}]}]}]}
2023/09/15 11:29:54.810780 tttmplts.go:100: Caching 24 Templates
2023/09/15 11:29:54.819532 tttmplts.go:87: Processing Template allpatientSrvs_tmplt
2023/09/15 11:29:54.822896 ttproxy.go:149: Response Status Code 200
2023/09/15 11:32:26.818541 ttserver.go:52: ICB Workflow Service stopped
2023/09/15 11:32:28.332629 ttutil.go:133: -----------------------------------------------------------------------------------
2023/09/15 11:32:28.332983 ttdb.go:51: Opening DB Connection to mysql instance
User: root
Host: tuk.coil1nnpqdlr.eu-west-1.rds.amazonaws.com
Port: :3306
Name: tuk
Connect Timeout 2s
Read Timeout 5s
2023/09/15 11:32:28.333114 ttdb.go:54: Opened Database
2023/09/15 11:32:28.511266 ttdb.go:379: Persisting Template dsubcancel_tmplt
2023/09/15 11:32:28.574251 ttdb.go:385: Persisted Template dsubcancel_tmplt
2023/09/15 11:32:28.574343 ttdb.go:366: Persisted Template dsubcancel_tmplt.xml
2023/09/15 11:32:28.638305 ttdb.go:379: Persisting Template cgl_tmplt
2023/09/15 11:32:28.734268 ttdb.go:385: Persisted Template cgl_tmplt
2023/09/15 11:32:28.734297 ttdb.go:366: Persisted Template cgl_tmplt.html
2023/09/15 11:32:28.799955 ttdb.go:379: Persisting Template pdssearch_tmplt
2023/09/15 11:32:28.869866 ttdb.go:385: Persisted Template pdssearch_tmplt
2023/09/15 11:32:28.869951 ttdb.go:366: Persisted Template pdssearch_tmplt.html
2023/09/15 11:32:28.934844 ttdb.go:379: Persisting Template dsubsubscribe_tmplt
2023/09/15 11:32:28.997538 ttdb.go:385: Persisted Template dsubsubscribe_tmplt
2023/09/15 11:32:28.997567 ttdb.go:366: Persisted Template dsubsubscribe_tmplt.xml
2023/09/15 11:32:29.068803 ttdb.go:379: Persisting Template notification_tmplt
2023/09/15 11:32:29.134717 ttdb.go:385: Persisted Template notification_tmplt
2023/09/15 11:32:29.134872 ttdb.go:366: Persisted Template notification_tmplt.txt
2023/09/15 11:32:29.198948 ttdb.go:379: Persisting Template wfstate2t_tmplt
2023/09/15 11:32:29.318868 ttdb.go:385: Persisted Template wfstate2t_tmplt
2023/09/15 11:32:29.318919 ttdb.go:366: Persisted Template wfstate2t_tmplt.html
2023/09/15 11:32:29.383326 ttdb.go:379: Persisting Template publishfile2t_tmplt
2023/09/15 11:32:29.446845 ttdb.go:385: Persisted Template publishfile2t_tmplt
2023/09/15 11:32:29.446891 ttdb.go:366: Persisted Template publishfile2t_tmplt.html
2023/09/15 11:32:29.511605 ttdb.go:379: Persisting Template react_tmplt
2023/09/15 11:32:29.587564 ttdb.go:385: Persisted Template react_tmplt
2023/09/15 11:32:29.587647 ttdb.go:366: Persisted Template react_tmplt.html
2023/09/15 11:32:29.659401 ttdb.go:379: Persisting Template pdsretrieve_tmplt
2023/09/15 11:32:29.723625 ttdb.go:385: Persisted Template pdsretrieve_tmplt
2023/09/15 11:32:29.723693 ttdb.go:366: Persisted Template pdsretrieve_tmplt.html
2023/09/15 11:32:29.787956 ttdb.go:379: Persisting Template allpatientSrvs_tmplt
2023/09/15 11:32:29.861059 ttdb.go:385: Persisted Template allpatientSrvs_tmplt
2023/09/15 11:32:29.861221 ttdb.go:366: Persisted Template allpatientSrvs_tmplt.html
2023/09/15 11:32:29.924533 ttdb.go:379: Persisting Template spa2t_tmplt
2023/09/15 11:32:30.002909 ttdb.go:385: Persisted Template spa2t_tmplt
2023/09/15 11:32:30.003063 ttdb.go:366: Persisted Template spa2t_tmplt.html
2023/09/15 11:32:30.073498 ttdb.go:379: Persisting Template xdw2t_tmplt
2023/09/15 11:32:30.155823 ttdb.go:385: Persisted Template xdw2t_tmplt
2023/09/15 11:32:30.156026 ttdb.go:366: Persisted Template xdw2t_tmplt.html
2023/09/15 11:32:30.223369 ttdb.go:379: Persisting Template spaheader2t_tmplt
2023/09/15 11:32:30.298350 ttdb.go:385: Persisted Template spaheader2t_tmplt
2023/09/15 11:32:30.298381 ttdb.go:366: Persisted Template spaheader2t_tmplt.html
2023/09/15 11:32:30.361681 ttdb.go:379: Persisting Template pds_tmplt
2023/09/15 11:32:30.425983 ttdb.go:385: Persisted Template pds_tmplt
2023/09/15 11:32:30.426059 ttdb.go:366: Persisted Template pds_tmplt.html
2023/09/15 11:32:30.490661 ttdb.go:379: Persisting Template error_tmplt
2023/09/15 11:32:30.559495 ttdb.go:385: Persisted Template error_tmplt
2023/09/15 11:32:30.559611 ttdb.go:366: Persisted Template error_tmplt.html
2023/09/15 11:32:30.623846 ttdb.go:379: Persisting Template dsuback_tmplt
2023/09/15 11:32:30.687703 ttdb.go:385: Persisted Template dsuback_tmplt
2023/09/15 11:32:30.687842 ttdb.go:366: Persisted Template dsuback_tmplt.xml
2023/09/15 11:32:30.771621 ttdb.go:379: Persisting Template pixm_tmplt
2023/09/15 11:32:30.944498 ttdb.go:385: Persisted Template pixm_tmplt
2023/09/15 11:32:30.944635 ttdb.go:366: Persisted Template pixm_tmplt.html
2023/09/15 11:32:31.056471 ttdb.go:379: Persisting Template subscriptions2t_tmplt
2023/09/15 11:32:31.185833 ttdb.go:385: Persisted Template subscriptions2t_tmplt
2023/09/15 11:32:31.185983 ttdb.go:366: Persisted Template subscriptions2t_tmplt.html
2023/09/15 11:32:31.312097 ttdb.go:379: Persisting Template codemaps2t_tmplt
2023/09/15 11:32:31.490838 ttdb.go:385: Persisted Template codemaps2t_tmplt
2023/09/15 11:32:31.490972 ttdb.go:366: Persisted Template codemaps2t_tmplt.html
2023/09/15 11:32:31.631466 ttdb.go:379: Persisting Template mhdpublish_tmplt
2023/09/15 11:32:31.802233 ttdb.go:385: Persisted Template mhdpublish_tmplt
2023/09/15 11:32:31.802385 ttdb.go:366: Persisted Template mhdpublish_tmplt.json
2023/09/15 11:32:31.932406 ttdb.go:379: Persisting Template events_tmplt
2023/09/15 11:32:32.060483 ttdb.go:385: Persisted Template events_tmplt
2023/09/15 11:32:32.060635 ttdb.go:366: Persisted Template events_tmplt.html
2023/09/15 11:32:32.228728 ttdb.go:379: Persisting Template uploadfile2t_tmplt
2023/09/15 11:32:32.353299 ttdb.go:385: Persisted Template uploadfile2t_tmplt
2023/09/15 11:32:32.353450 ttdb.go:366: Persisted Template uploadfile2t_tmplt.html
2023/09/15 11:32:32.353741 ttserver.go:40: Starting ICB Workflow Service. Service Endpoint http://MacBook-Pro-3.lan:8080/
2023/09/15 11:32:35.450410 ttgethandler.go:10: Processing new GET Request
2023/09/15 11:32:35.450587 ttproxy.go:138: 	Request Query Params
2023/09/15 11:32:35.450966 ttutil.go:140: 	{
  "User": "ian.thomas",
  "Org": "2tsolutions",
  "Role": "clinical",
  "Nhs": "9000000009"
}
2023/09/15 11:32:35.451006 ttgethandler.go:15: Path = /beta/spa/consumer/patient
2023/09/15 11:32:35.451045 tttmplts.go:37: CGL Worker starting
2023/09/15 11:32:35.451046 tttmplts.go:30: PIXm Worker starting
2023/09/15 11:32:35.451224 tthttp.go:15: Creating PIXm PDQ - Server URL http://lac-demo-01.tianispirit.co.uk:8081/SpiritPIXFhir/r4/Patient?identifier=2.16.840.1.113883.2.1.4.1%7C9000000009
2023/09/15 11:32:35.452522 tthttp.go:160: Request Headers 
map[Content-Type:[application/json]]
2023/09/15 11:32:35.452583 tthttp.go:160: Request Headers 
map[Accept:[application/json] X-Api-Key:[FNhb#OhxWiEiMdf+@6085k5Zmt] X-Api-Secret:[9710ea0fb4ffb5d56c2e62c71c30bdfhjsyr56a79d]]
2023/09/15 11:32:35.634547 tthttp.go:174: Server Response - Status Code 404 
{"errors":[{"message":"No clients matching nhs number 9000000009","path":"\/"}],"status":404}
2023/09/15 11:32:35.639850 ttutil.go:140: 	{
  "data": {
    "client": {
      "basicDetails": {
        "address": {},
        "name": {}
      },
      "bbvInformation": {},
      "drugTestResults": {
        "results": {}
      },
      "riskInformation": {
        "mentalHealthDomain": {},
        "riskOfHarmToSelfDomain": {},
        "socialDomain": {},
        "substanceMisuseDomain": {}
      },
      "safeguardingInformation": {}
    },
    "keyWorker": {
      "name": {}
    }
  }
}
2023/09/15 11:32:35.639953 tttmplts.go:39: CGL Worker done
2023/09/15 11:32:35.639986 tttmplts.go:40: CGL Worker Status Code 404
2023/09/15 11:32:40.453128 tthttp.go:174: Server Response - Status Code 0 
2023/09/15 11:32:40.453663 tttmplts.go:32: PIXm Worker done
2023/09/15 11:32:40.453751 tttmplts.go:33: PIXm Worker Status Code 408
2023/09/15 11:32:40.454788 tthttp.go:56: Creating PDS Search Request - Server URL https://sandbox.api.service.nhs.uk/personal-demographics/FHIR/R4/Patient/9000000009
2023/09/15 11:32:40.455093 tthttp.go:160: Request Headers 
map[Accept:[*/*] Content-Type:[application/json] X-Request-Id:[b790075f-57e2-4d41-bb92-c6b2009e6e08]]
2023/09/15 11:32:40.608695 tthttp.go:174: Server Response - Status Code 200 
{"resourceType":"Patient","id":"9000000009","identifier":[{"system":"https://fhir.nhs.uk/Id/nhs-number","value":"9000000009","extension":[{"url":"https://fhir.hl7.org.uk/StructureDefinition/Extension-UKCore-NHSNumberVerificationStatus","valueCodeableConcept":{"coding":[{"system":"https://fhir.hl7.org.uk/CodeSystem/UKCore-NHSNumberVerificationStatus","version":"1.0.0","code":"01","display":"Number present and verified"}]}}]}],"meta":{"versionId":"2","security":[{"system":"http://terminology.hl7.org/CodeSystem/v3-Confidentiality","code":"U","display":"unrestricted"}]},"name":[{"id":"123","use":"usual","period":{"start":"2020-01-01","end":"2021-12-31"},"given":["Jane"],"family":"Smith","prefix":["Mrs"],"suffix":["MBE"]}],"gender":"female","birthDate":"2010-10-22","multipleBirthInteger":1,"deceasedDateTime":"2010-10-22T00:00:00+00:00","generalPractitioner":[{"id":"254406A3","type":"Organization","identifier":{"system":"https://fhir.nhs.uk/Id/ods-organization-code","value":"Y12345","period":{"start":"2020-01-01","end":"2021-12-31"}}}],"managingOrganization":{"type":"Organization","identifier":{"system":"https://fhir.nhs.uk/Id/ods-organization-code","value":"Y12345","period":{"start":"2020-01-01","end":"2021-12-31"}}},"extension":[{"url":"https://fhir.hl7.org.uk/StructureDefinition/Extension-UKCore-NominatedPharmacy","valueReference":{"identifier":{"system":"https://fhir.nhs.uk/Id/ods-organization-code","value":"Y12345"}}},{"url":"https://fhir.hl7.org.uk/StructureDefinition/Extension-UKCore-PreferredDispenserOrganization","valueReference":{"identifier":{"system":"https://fhir.nhs.uk/Id/ods-organization-code","value":"Y23456"}}},{"url":"https://fhir.hl7.org.uk/StructureDefinition/Extension-UKCore-MedicalApplianceSupplier","valueReference":{"identifier":{"system":"https://fhir.nhs.uk/Id/ods-organization-code","value":"Y34567"}}},{"url":"https://fhir.hl7.org.uk/StructureDefinition/Extension-UKCore-DeathNotificationStatus","extension":[{"url":"deathNotificationStatus","valueCodeableConcept":{"coding":[{"system":"https://fhir.hl7.org.uk/CodeSystem/UKCore-DeathNotificationStatus","version":"1.0.0","code":"2","display":"Formal - death notice received from Registrar of Deaths"}]}},{"url":"systemEffectiveDate","valueDateTime":"2010-10-22T00:00:00+00:00"}]},{"url":"https://fhir.hl7.org.uk/StructureDefinition/Extension-UKCore-NHSCommunication","extension":[{"url":"language","valueCodeableConcept":{"coding":[{"system":"https://fhir.hl7.org.uk/CodeSystem/UKCore-HumanLanguage","version":"1.0.0","code":"fr","display":"French"}]}},{"url":"interpreterRequired","valueBoolean":true}]},{"url":"https://fhir.hl7.org.uk/StructureDefinition/Extension-UKCore-ContactPreference","extension":[{"url":"PreferredWrittenCommunicationFormat","valueCodeableConcept":{"coding":[{"system":"https://fhir.hl7.org.uk/CodeSystem/UKCore-PreferredWrittenCommunicationFormat","code":"12","display":"Braille"}]}},{"url":"PreferredContactMethod","valueCodeableConcept":{"coding":[{"system":"https://fhir.hl7.org.uk/CodeSystem/UKCore-PreferredContactMethod","code":"1","display":"Letter"}]}},{"url":"PreferredContactTimes","valueString":"Not after 7pm"}]},{"url":"http://hl7.org/fhir/StructureDefinition/patient-birthPlace","valueAddress":{"city":"Manchester","district":"Greater Manchester","country":"GBR"}},{"url":"https://fhir.nhs.uk/StructureDefinition/Extension-PDS-RemovalFromRegistration","extension":[{"url":"removalFromRegistrationCode","valueCodeableConcept":{"coding":[{"system":"https://fhir.nhs.uk/CodeSystem/PDS-RemovalReasonExitCode","code":"SCT","display":"Transferred to Scotland"}]}},{"url":"effectiveTime","valuePeriod":{"start":"2020-01-01T00:00:00+00:00","end":"2021-12-31T00:00:00+00:00"}}]}],"telecom":[{"id":"789","period":{"start":"2020-01-01","end":"2021-12-31"},"system":"phone","value":"01632960587","use":"home"},{"id":"790","period":{"start":"2019-01-01","end":"2022-12-31"},"system":"email","value":"jane.smith@example.com","use":"home"},{"id":"OC789","period":{"start":"2020-01-01","end":"2021-12-31"},"system":"other","value":"01632960587","use":"home","extension":[{"url":"https://fhir.hl7.org.uk/StructureDefinition/Extension-UKCore-OtherContactSystem","valueCoding":{"system":"https://fhir.hl7.org.uk/CodeSystem/UKCore-OtherContactSystem","code":"textphone","display":"Minicom (Textphone)"}}]}],"contact":[{"id":"C123","period":{"start":"2020-01-01","end":"2021-12-31"},"relationship":[{"coding":[{"system":"http://terminology.hl7.org/CodeSystem/v2-0131","code":"C","display":"Emergency Contact"}]}],"telecom":[{"system":"phone","value":"01632960587"}]}],"address":[{"id":"456","period":{"start":"2020-01-01","end":"2021-12-31"},"use":"home","line":["1 Trevelyan Square","Boar Lane","City Centre","Leeds","West Yorkshire"],"postalCode":"LS1 6AE","extension":[{"url":"https://fhir.hl7.org.uk/StructureDefinition/Extension-UKCore-AddressKey","extension":[{"url":"type","valueCoding":{"system":"https://fhir.hl7.org.uk/CodeSystem/UKCore-AddressKeyType","code":"PAF"}},{"url":"value","valueString":"12345678"}]},{"url":"https://fhir.hl7.org.uk/StructureDefinition/Extension-UKCore-AddressKey","extension":[{"url":"type","valueCoding":{"system":"https://fhir.hl7.org.uk/CodeSystem/UKCore-AddressKeyType","code":"UPRN"}},{"url":"value","valueString":"123456789012"}]}]},{"id":"T456","period":{"start":"2020-01-01","end":"2021-12-31"},"use":"temp","text":"Student Accommodation","line":["1 Trevelyan Square","Boar Lane","City Centre","Leeds","West Yorkshire"],"postalCode":"LS1 6AE","extension":[{"url":"https://fhir.hl7.org.uk/StructureDefinition/Extension-UKCore-AddressKey","extension":[{"url":"type","valueCoding":{"system":"https://fhir.hl7.org.uk/CodeSystem/UKCore-AddressKeyType","code":"PAF"}},{"url":"value","valueString":"12345678"}]},{"url":"https://fhir.hl7.org.uk/StructureDefinition/Extension-UKCore-AddressKey","extension":[{"url":"type","valueCoding":{"system":"https://fhir.hl7.org.uk/CodeSystem/UKCore-AddressKeyType","code":"UPRN"}},{"url":"value","valueString":"123456789012"}]}]}]}
2023/09/15 11:32:40.795308 tttmplts.go:100: Caching 24 Templates
2023/09/15 11:32:40.801213 tttmplts.go:87: Processing Template allpatientSrvs_tmplt
2023/09/15 11:32:40.804410 ttproxy.go:149: Response Status Code 200
2023/09/15 11:42:51.175296 ttserver.go:52: ICB Workflow Service stopped
2023/09/15 11:42:53.841835 ttutil.go:133: -----------------------------------------------------------------------------------
2023/09/15 11:42:53.842335 ttdb.go:51: Opening DB Connection to mysql instance
User: root
Host: tuk.coil1nnpqdlr.eu-west-1.rds.amazonaws.com
Port: :3306
Name: tuk
Connect Timeout 2s
Read Timeout 5s
2023/09/15 11:42:53.842463 ttdb.go:54: Opened Database
2023/09/15 11:42:54.034230 ttdb.go:379: Persisting Template dsubcancel_tmplt
2023/09/15 11:42:54.099661 ttdb.go:385: Persisted Template dsubcancel_tmplt
2023/09/15 11:42:54.099710 ttdb.go:366: Persisted Template dsubcancel_tmplt.xml
2023/09/15 11:42:54.165257 ttdb.go:379: Persisting Template cgl_tmplt
2023/09/15 11:42:54.268083 ttdb.go:385: Persisted Template cgl_tmplt
2023/09/15 11:42:54.268129 ttdb.go:366: Persisted Template cgl_tmplt.html
2023/09/15 11:42:54.333799 ttdb.go:379: Persisting Template pdssearch_tmplt
2023/09/15 11:42:54.403386 ttdb.go:385: Persisted Template pdssearch_tmplt
2023/09/15 11:42:54.403547 ttdb.go:366: Persisted Template pdssearch_tmplt.html
2023/09/15 11:42:54.469762 ttdb.go:379: Persisting Template dsubsubscribe_tmplt
2023/09/15 11:42:54.536335 ttdb.go:385: Persisted Template dsubsubscribe_tmplt
2023/09/15 11:42:54.536493 ttdb.go:366: Persisted Template dsubsubscribe_tmplt.xml
2023/09/15 11:42:54.601095 ttdb.go:379: Persisting Template notification_tmplt
2023/09/15 11:42:54.668618 ttdb.go:385: Persisted Template notification_tmplt
2023/09/15 11:42:54.668763 ttdb.go:366: Persisted Template notification_tmplt.txt
2023/09/15 11:42:54.734547 ttdb.go:379: Persisting Template wfstate2t_tmplt
2023/09/15 11:42:54.855289 ttdb.go:385: Persisted Template wfstate2t_tmplt
2023/09/15 11:42:54.855464 ttdb.go:366: Persisted Template wfstate2t_tmplt.html
2023/09/15 11:42:54.923128 ttdb.go:379: Persisting Template publishfile2t_tmplt
2023/09/15 11:42:54.990408 ttdb.go:385: Persisted Template publishfile2t_tmplt
2023/09/15 11:42:54.990547 ttdb.go:366: Persisted Template publishfile2t_tmplt.html
2023/09/15 11:42:55.056829 ttdb.go:379: Persisting Template react_tmplt
2023/09/15 11:42:55.122554 ttdb.go:385: Persisted Template react_tmplt
2023/09/15 11:42:55.122663 ttdb.go:366: Persisted Template react_tmplt.html
2023/09/15 11:42:55.189241 ttdb.go:379: Persisting Template pdsretrieve_tmplt
2023/09/15 11:42:55.259999 ttdb.go:385: Persisted Template pdsretrieve_tmplt
2023/09/15 11:42:55.260155 ttdb.go:366: Persisted Template pdsretrieve_tmplt.html
2023/09/15 11:42:55.326824 ttdb.go:379: Persisting Template allpatientSrvs_tmplt
2023/09/15 11:42:55.393153 ttdb.go:385: Persisted Template allpatientSrvs_tmplt
2023/09/15 11:42:55.393210 ttdb.go:366: Persisted Template allpatientSrvs_tmplt.html
2023/09/15 11:42:55.459900 ttdb.go:379: Persisting Template spa2t_tmplt
2023/09/15 11:42:55.537631 ttdb.go:385: Persisted Template spa2t_tmplt
2023/09/15 11:42:55.537682 ttdb.go:366: Persisted Template spa2t_tmplt.html
2023/09/15 11:42:55.602631 ttdb.go:379: Persisting Template xdw2t_tmplt
2023/09/15 11:42:55.687248 ttdb.go:385: Persisted Template xdw2t_tmplt
2023/09/15 11:42:55.687319 ttdb.go:366: Persisted Template xdw2t_tmplt.html
2023/09/15 11:42:55.753792 ttdb.go:379: Persisting Template spaheader2t_tmplt
2023/09/15 11:42:55.824519 ttdb.go:385: Persisted Template spaheader2t_tmplt
2023/09/15 11:42:55.824573 ttdb.go:366: Persisted Template spaheader2t_tmplt.html
2023/09/15 11:42:55.890397 ttdb.go:379: Persisting Template pds_tmplt
2023/09/15 11:42:55.957320 ttdb.go:385: Persisted Template pds_tmplt
2023/09/15 11:42:55.957444 ttdb.go:366: Persisted Template pds_tmplt.html
2023/09/15 11:42:56.023912 ttdb.go:379: Persisting Template error_tmplt
2023/09/15 11:42:56.091175 ttdb.go:385: Persisted Template error_tmplt
2023/09/15 11:42:56.091358 ttdb.go:366: Persisted Template error_tmplt.html
2023/09/15 11:42:56.159279 ttdb.go:379: Persisting Template dsuback_tmplt
2023/09/15 11:42:56.226932 ttdb.go:385: Persisted Template dsuback_tmplt
2023/09/15 11:42:56.227073 ttdb.go:366: Persisted Template dsuback_tmplt.xml
2023/09/15 11:42:56.296322 ttdb.go:379: Persisting Template pixm_tmplt
2023/09/15 11:42:56.365065 ttdb.go:385: Persisted Template pixm_tmplt
2023/09/15 11:42:56.365214 ttdb.go:366: Persisted Template pixm_tmplt.html
2023/09/15 11:42:56.430874 ttdb.go:379: Persisting Template subscriptions2t_tmplt
2023/09/15 11:42:56.499176 ttdb.go:385: Persisted Template subscriptions2t_tmplt
2023/09/15 11:42:56.499328 ttdb.go:366: Persisted Template subscriptions2t_tmplt.html
2023/09/15 11:42:56.566153 ttdb.go:379: Persisting Template codemaps2t_tmplt
2023/09/15 11:42:56.635867 ttdb.go:385: Persisted Template codemaps2t_tmplt
2023/09/15 11:42:56.635910 ttdb.go:366: Persisted Template codemaps2t_tmplt.html
2023/09/15 11:42:56.700467 ttdb.go:379: Persisting Template mhdpublish_tmplt
2023/09/15 11:42:56.774409 ttdb.go:385: Persisted Template mhdpublish_tmplt
2023/09/15 11:42:56.774497 ttdb.go:366: Persisted Template mhdpublish_tmplt.json
2023/09/15 11:42:56.840366 ttdb.go:379: Persisting Template events_tmplt
2023/09/15 11:42:56.911063 ttdb.go:385: Persisted Template events_tmplt
2023/09/15 11:42:56.911169 ttdb.go:366: Persisted Template events_tmplt.html
2023/09/15 11:42:56.977432 ttdb.go:379: Persisting Template uploadfile2t_tmplt
2023/09/15 11:42:57.042167 ttdb.go:385: Persisted Template uploadfile2t_tmplt
2023/09/15 11:42:57.042319 ttdb.go:366: Persisted Template uploadfile2t_tmplt.html
2023/09/15 11:42:57.042612 ttserver.go:40: Starting ICB Workflow Service. Service Endpoint http://MacBook-Pro-3.lan:8080/
2023/09/15 11:43:01.226095 ttgethandler.go:10: Processing new GET Request
2023/09/15 11:43:01.226296 ttproxy.go:138: 	Request Query Params
2023/09/15 11:43:01.227340 ttutil.go:140: 	{
  "User": "ian.thomas",
  "Org": "2tsolutions",
  "Role": "clinical",
  "Nhs": "9000000009"
}
2023/09/15 11:43:01.227404 ttgethandler.go:15: Path = /beta/spa/consumer/patient
2023/09/15 11:43:01.227479 tttmplts.go:37: CGL Worker starting
2023/09/15 11:43:01.227641 tttmplts.go:30: PIXm Worker starting
2023/09/15 11:43:01.227819 tthttp.go:15: Creating PIXm PDQ - Server URL http://lac-demo-01.tianispirit.co.uk:8081/SpiritPIXFhir/r4/Patient?identifier=2.16.840.1.113883.2.1.4.1%7C9000000009
2023/09/15 11:43:01.230554 tthttp.go:160: Request Headers 
map[Accept:[application/json] X-Api-Key:[FNhb#OhxWiEiMdf+@6085k5Zmt] X-Api-Secret:[9710ea0fb4ffb5d56c2e62c71c30bdfhjsyr56a79d]]
2023/09/15 11:43:01.230589 tthttp.go:160: Request Headers 
map[Content-Type:[application/json]]
2023/09/15 11:43:01.452840 tthttp.go:174: Server Response - Status Code 404 
{"errors":[{"message":"No clients matching nhs number 9000000009","path":"\/"}],"status":404}
2023/09/15 11:43:01.457731 ttutil.go:140: 	{
  "data": {
    "client": {
      "basicDetails": {
        "address": {},
        "name": {}
      },
      "bbvInformation": {},
      "drugTestResults": {
        "results": {}
      },
      "riskInformation": {
        "mentalHealthDomain": {},
        "riskOfHarmToSelfDomain": {},
        "socialDomain": {},
        "substanceMisuseDomain": {}
      },
      "safeguardingInformation": {}
    },
    "keyWorker": {
      "name": {}
    }
  }
}
2023/09/15 11:43:01.457894 tttmplts.go:39: CGL Worker done
2023/09/15 11:43:01.457937 tttmplts.go:40: CGL Worker Status Code 404
2023/09/15 11:43:06.229034 tthttp.go:174: Server Response - Status Code 0 
2023/09/15 11:43:06.230001 tttmplts.go:32: PIXm Worker done
2023/09/15 11:43:06.230117 tttmplts.go:33: PIXm Worker Status Code 408
2023/09/15 11:43:06.230584 tthttp.go:56: Creating PDS Search Request - Server URL https://sandbox.api.service.nhs.uk/personal-demographics/FHIR/R4/Patient/9000000009
2023/09/15 11:43:06.230806 tthttp.go:160: Request Headers 
map[Accept:[*/*] Content-Type:[application/json] X-Request-Id:[0b699396-1dfc-43d7-b388-97d55b472bae]]
2023/09/15 11:43:06.455576 tthttp.go:174: Server Response - Status Code 200 
{"resourceType":"Patient","id":"9000000009","identifier":[{"system":"https://fhir.nhs.uk/Id/nhs-number","value":"9000000009","extension":[{"url":"https://fhir.hl7.org.uk/StructureDefinition/Extension-UKCore-NHSNumberVerificationStatus","valueCodeableConcept":{"coding":[{"system":"https://fhir.hl7.org.uk/CodeSystem/UKCore-NHSNumberVerificationStatus","version":"1.0.0","code":"01","display":"Number present and verified"}]}}]}],"meta":{"versionId":"2","security":[{"system":"http://terminology.hl7.org/CodeSystem/v3-Confidentiality","code":"U","display":"unrestricted"}]},"name":[{"id":"123","use":"usual","period":{"start":"2020-01-01","end":"2021-12-31"},"given":["Jane"],"family":"Smith","prefix":["Mrs"],"suffix":["MBE"]}],"gender":"female","birthDate":"2010-10-22","multipleBirthInteger":1,"deceasedDateTime":"2010-10-22T00:00:00+00:00","generalPractitioner":[{"id":"254406A3","type":"Organization","identifier":{"system":"https://fhir.nhs.uk/Id/ods-organization-code","value":"Y12345","period":{"start":"2020-01-01","end":"2021-12-31"}}}],"managingOrganization":{"type":"Organization","identifier":{"system":"https://fhir.nhs.uk/Id/ods-organization-code","value":"Y12345","period":{"start":"2020-01-01","end":"2021-12-31"}}},"extension":[{"url":"https://fhir.hl7.org.uk/StructureDefinition/Extension-UKCore-NominatedPharmacy","valueReference":{"identifier":{"system":"https://fhir.nhs.uk/Id/ods-organization-code","value":"Y12345"}}},{"url":"https://fhir.hl7.org.uk/StructureDefinition/Extension-UKCore-PreferredDispenserOrganization","valueReference":{"identifier":{"system":"https://fhir.nhs.uk/Id/ods-organization-code","value":"Y23456"}}},{"url":"https://fhir.hl7.org.uk/StructureDefinition/Extension-UKCore-MedicalApplianceSupplier","valueReference":{"identifier":{"system":"https://fhir.nhs.uk/Id/ods-organization-code","value":"Y34567"}}},{"url":"https://fhir.hl7.org.uk/StructureDefinition/Extension-UKCore-DeathNotificationStatus","extension":[{"url":"deathNotificationStatus","valueCodeableConcept":{"coding":[{"system":"https://fhir.hl7.org.uk/CodeSystem/UKCore-DeathNotificationStatus","version":"1.0.0","code":"2","display":"Formal - death notice received from Registrar of Deaths"}]}},{"url":"systemEffectiveDate","valueDateTime":"2010-10-22T00:00:00+00:00"}]},{"url":"https://fhir.hl7.org.uk/StructureDefinition/Extension-UKCore-NHSCommunication","extension":[{"url":"language","valueCodeableConcept":{"coding":[{"system":"https://fhir.hl7.org.uk/CodeSystem/UKCore-HumanLanguage","version":"1.0.0","code":"fr","display":"French"}]}},{"url":"interpreterRequired","valueBoolean":true}]},{"url":"https://fhir.hl7.org.uk/StructureDefinition/Extension-UKCore-ContactPreference","extension":[{"url":"PreferredWrittenCommunicationFormat","valueCodeableConcept":{"coding":[{"system":"https://fhir.hl7.org.uk/CodeSystem/UKCore-PreferredWrittenCommunicationFormat","code":"12","display":"Braille"}]}},{"url":"PreferredContactMethod","valueCodeableConcept":{"coding":[{"system":"https://fhir.hl7.org.uk/CodeSystem/UKCore-PreferredContactMethod","code":"1","display":"Letter"}]}},{"url":"PreferredContactTimes","valueString":"Not after 7pm"}]},{"url":"http://hl7.org/fhir/StructureDefinition/patient-birthPlace","valueAddress":{"city":"Manchester","district":"Greater Manchester","country":"GBR"}},{"url":"https://fhir.nhs.uk/StructureDefinition/Extension-PDS-RemovalFromRegistration","extension":[{"url":"removalFromRegistrationCode","valueCodeableConcept":{"coding":[{"system":"https://fhir.nhs.uk/CodeSystem/PDS-RemovalReasonExitCode","code":"SCT","display":"Transferred to Scotland"}]}},{"url":"effectiveTime","valuePeriod":{"start":"2020-01-01T00:00:00+00:00","end":"2021-12-31T00:00:00+00:00"}}]}],"telecom":[{"id":"789","period":{"start":"2020-01-01","end":"2021-12-31"},"system":"phone","value":"01632960587","use":"home"},{"id":"790","period":{"start":"2019-01-01","end":"2022-12-31"},"system":"email","value":"jane.smith@example.com","use":"home"},{"id":"OC789","period":{"start":"2020-01-01","end":"2021-12-31"},"system":"other","value":"01632960587","use":"home","extension":[{"url":"https://fhir.hl7.org.uk/StructureDefinition/Extension-UKCore-OtherContactSystem","valueCoding":{"system":"https://fhir.hl7.org.uk/CodeSystem/UKCore-OtherContactSystem","code":"textphone","display":"Minicom (Textphone)"}}]}],"contact":[{"id":"C123","period":{"start":"2020-01-01","end":"2021-12-31"},"relationship":[{"coding":[{"system":"http://terminology.hl7.org/CodeSystem/v2-0131","code":"C","display":"Emergency Contact"}]}],"telecom":[{"system":"phone","value":"01632960587"}]}],"address":[{"id":"456","period":{"start":"2020-01-01","end":"2021-12-31"},"use":"home","line":["1 Trevelyan Square","Boar Lane","City Centre","Leeds","West Yorkshire"],"postalCode":"LS1 6AE","extension":[{"url":"https://fhir.hl7.org.uk/StructureDefinition/Extension-UKCore-AddressKey","extension":[{"url":"type","valueCoding":{"system":"https://fhir.hl7.org.uk/CodeSystem/UKCore-AddressKeyType","code":"PAF"}},{"url":"value","valueString":"12345678"}]},{"url":"https://fhir.hl7.org.uk/StructureDefinition/Extension-UKCore-AddressKey","extension":[{"url":"type","valueCoding":{"system":"https://fhir.hl7.org.uk/CodeSystem/UKCore-AddressKeyType","code":"UPRN"}},{"url":"value","valueString":"123456789012"}]}]},{"id":"T456","period":{"start":"2020-01-01","end":"2021-12-31"},"use":"temp","text":"Student Accommodation","line":["1 Trevelyan Square","Boar Lane","City Centre","Leeds","West Yorkshire"],"postalCode":"LS1 6AE","extension":[{"url":"https://fhir.hl7.org.uk/StructureDefinition/Extension-UKCore-AddressKey","extension":[{"url":"type","valueCoding":{"system":"https://fhir.hl7.org.uk/CodeSystem/UKCore-AddressKeyType","code":"PAF"}},{"url":"value","valueString":"12345678"}]},{"url":"https://fhir.hl7.org.uk/StructureDefinition/Extension-UKCore-AddressKey","extension":[{"url":"type","valueCoding":{"system":"https://fhir.hl7.org.uk/CodeSystem/UKCore-AddressKeyType","code":"UPRN"}},{"url":"value","valueString":"123456789012"}]}]}]}
2023/09/15 11:43:06.653719 tttmplts.go:100: Caching 24 Templates
2023/09/15 11:43:06.660190 tttmplts.go:104: Template pds_tmplt caused Error template: pds_tmplt:39: unexpected EOF
2023/09/15 11:43:06.661129 server.go:3217: http: panic serving [::1]:49773: runtime error: invalid memory address or nil pointer dereference
goroutine 20 [running]:
net/http.(*conn).serve.func1()
	/Users/IanThomas/sdk/go1.20.5/src/net/http/server.go:1854 +0xbf
panic({0x1434ca0, 0x17e4e70})
	/Users/IanThomas/sdk/go1.20.5/src/runtime/panic.go:890 +0x263
html/template.(*Template).New(0x14c1682?, {0xc0001b2400?, 0xc000545fc0?})
	/Users/IanThomas/sdk/go1.20.5/src/html/template/template.go:305 +0x37
main.(*Trans).cacheTemplates(0xc0000e8000)
	/Users/IanThomas/go/src/ttxdwuser/main/tttmplts.go:103 +0x1d2
main.(*Trans).setResponseFromTemplate(0xc0000e8000)
	/Users/IanThomas/go/src/ttxdwuser/main/tttmplts.go:85 +0x45
main.(*Trans).setPatientTemplate(0xc0000e8000)
	/Users/IanThomas/go/src/ttxdwuser/main/tttmplts.go:53 +0x1b1
main.(*Trans).newGetHandler(0xc0000e8000)
	/Users/IanThomas/go/src/ttxdwuser/main/ttgethandler.go:28 +0xd94
main.(*Trans).newProxyTrans(0xc0000e8000)
	/Users/IanThomas/go/src/ttxdwuser/main/ttproxy.go:73 +0x4d1
main.Handle_HTTP_Request({0x15657d0, 0xc0000aa1c0}, 0xc0000c6100)
	/Users/IanThomas/go/src/ttxdwuser/main/ttproxy.go:15 +0xeb
net/http.HandlerFunc.ServeHTTP(0xc0000d601f?, {0x15657d0?, 0xc0000aa1c0?}, 0x1064cee?)
	/Users/IanThomas/sdk/go1.20.5/src/net/http/server.go:2122 +0x2f
net/http.serverHandler.ServeHTTP({0xc0000ae240?}, {0x15657d0, 0xc0000aa1c0}, 0xc0000c6100)
	/Users/IanThomas/sdk/go1.20.5/src/net/http/server.go:2936 +0x316
net/http.(*conn).serve(0xc0001a7950, {0x15659c8, 0xc000199e30})
	/Users/IanThomas/sdk/go1.20.5/src/net/http/server.go:1995 +0x612
created by net/http.(*Server).Serve
	/Users/IanThomas/sdk/go1.20.5/src/net/http/server.go:3089 +0x5ed
2023/09/15 11:43:24.152208 ttserver.go:52: ICB Workflow Service stopped
2023/09/15 11:43:25.745118 ttutil.go:133: -----------------------------------------------------------------------------------
2023/09/15 11:43:25.745625 ttdb.go:51: Opening DB Connection to mysql instance
User: root
Host: tuk.coil1nnpqdlr.eu-west-1.rds.amazonaws.com
Port: :3306
Name: tuk
Connect Timeout 2s
Read Timeout 5s
2023/09/15 11:43:25.745741 ttdb.go:54: Opened Database
2023/09/15 11:43:25.950738 ttdb.go:379: Persisting Template dsubcancel_tmplt
2023/09/15 11:43:26.015729 ttdb.go:385: Persisted Template dsubcancel_tmplt
2023/09/15 11:43:26.015782 ttdb.go:366: Persisted Template dsubcancel_tmplt.xml
2023/09/15 11:43:26.079830 ttdb.go:379: Persisting Template cgl_tmplt
2023/09/15 11:43:26.178729 ttdb.go:385: Persisted Template cgl_tmplt
2023/09/15 11:43:26.178884 ttdb.go:366: Persisted Template cgl_tmplt.html
2023/09/15 11:43:26.242491 ttdb.go:379: Persisting Template pdssearch_tmplt
2023/09/15 11:43:26.312627 ttdb.go:385: Persisted Template pdssearch_tmplt
2023/09/15 11:43:26.312683 ttdb.go:366: Persisted Template pdssearch_tmplt.html
2023/09/15 11:43:26.376111 ttdb.go:379: Persisting Template dsubsubscribe_tmplt
2023/09/15 11:43:26.439510 ttdb.go:385: Persisted Template dsubsubscribe_tmplt
2023/09/15 11:43:26.439606 ttdb.go:366: Persisted Template dsubsubscribe_tmplt.xml
2023/09/15 11:43:26.503403 ttdb.go:379: Persisting Template notification_tmplt
2023/09/15 11:43:26.569165 ttdb.go:385: Persisted Template notification_tmplt
2023/09/15 11:43:26.569316 ttdb.go:366: Persisted Template notification_tmplt.txt
2023/09/15 11:43:26.634101 ttdb.go:379: Persisting Template wfstate2t_tmplt
2023/09/15 11:43:26.756756 ttdb.go:385: Persisted Template wfstate2t_tmplt
2023/09/15 11:43:26.756862 ttdb.go:366: Persisted Template wfstate2t_tmplt.html
2023/09/15 11:43:26.821491 ttdb.go:379: Persisting Template publishfile2t_tmplt
2023/09/15 11:43:26.887681 ttdb.go:385: Persisted Template publishfile2t_tmplt
2023/09/15 11:43:26.887875 ttdb.go:366: Persisted Template publishfile2t_tmplt.html
2023/09/15 11:43:26.950803 ttdb.go:379: Persisting Template react_tmplt
2023/09/15 11:43:27.015828 ttdb.go:385: Persisted Template react_tmplt
2023/09/15 11:43:27.015985 ttdb.go:366: Persisted Template react_tmplt.html
2023/09/15 11:43:27.079509 ttdb.go:379: Persisting Template pdsretrieve_tmplt
2023/09/15 11:43:27.147139 ttdb.go:385: Persisted Template pdsretrieve_tmplt
2023/09/15 11:43:27.147162 ttdb.go:366: Persisted Template pdsretrieve_tmplt.html
2023/09/15 11:43:27.209576 ttdb.go:379: Persisting Template allpatientSrvs_tmplt
2023/09/15 11:43:27.273724 ttdb.go:385: Persisted Template allpatientSrvs_tmplt
2023/09/15 11:43:27.273749 ttdb.go:366: Persisted Template allpatientSrvs_tmplt.html
2023/09/15 11:43:27.337694 ttdb.go:379: Persisting Template spa2t_tmplt
2023/09/15 11:43:27.415708 ttdb.go:385: Persisted Template spa2t_tmplt
2023/09/15 11:43:27.415750 ttdb.go:366: Persisted Template spa2t_tmplt.html
2023/09/15 11:43:27.480549 ttdb.go:379: Persisting Template xdw2t_tmplt
2023/09/15 11:43:27.562245 ttdb.go:385: Persisted Template xdw2t_tmplt
2023/09/15 11:43:27.562393 ttdb.go:366: Persisted Template xdw2t_tmplt.html
2023/09/15 11:43:27.626517 ttdb.go:379: Persisting Template spaheader2t_tmplt
2023/09/15 11:43:27.699869 ttdb.go:385: Persisted Template spaheader2t_tmplt
2023/09/15 11:43:27.700106 ttdb.go:366: Persisted Template spaheader2t_tmplt.html
2023/09/15 11:43:27.768770 ttdb.go:379: Persisting Template pds_tmplt
2023/09/15 11:43:27.834666 ttdb.go:385: Persisted Template pds_tmplt
2023/09/15 11:43:27.834824 ttdb.go:366: Persisted Template pds_tmplt.html
2023/09/15 11:43:27.900604 ttdb.go:379: Persisting Template error_tmplt
2023/09/15 11:43:27.965252 ttdb.go:385: Persisted Template error_tmplt
2023/09/15 11:43:27.965444 ttdb.go:366: Persisted Template error_tmplt.html
2023/09/15 11:43:28.030455 ttdb.go:379: Persisting Template dsuback_tmplt
2023/09/15 11:43:28.094933 ttdb.go:385: Persisted Template dsuback_tmplt
2023/09/15 11:43:28.095157 ttdb.go:366: Persisted Template dsuback_tmplt.xml
2023/09/15 11:43:28.160764 ttdb.go:379: Persisting Template pixm_tmplt
2023/09/15 11:43:28.229632 ttdb.go:385: Persisted Template pixm_tmplt
2023/09/15 11:43:28.229709 ttdb.go:366: Persisted Template pixm_tmplt.html
2023/09/15 11:43:28.300166 ttdb.go:379: Persisting Template subscriptions2t_tmplt
2023/09/15 11:43:28.367390 ttdb.go:385: Persisted Template subscriptions2t_tmplt
2023/09/15 11:43:28.367600 ttdb.go:366: Persisted Template subscriptions2t_tmplt.html
2023/09/15 11:43:28.433281 ttdb.go:379: Persisting Template codemaps2t_tmplt
2023/09/15 11:43:28.505135 ttdb.go:385: Persisted Template codemaps2t_tmplt
2023/09/15 11:43:28.505310 ttdb.go:366: Persisted Template codemaps2t_tmplt.html
2023/09/15 11:43:28.570322 ttdb.go:379: Persisting Template mhdpublish_tmplt
2023/09/15 11:43:28.642080 ttdb.go:385: Persisted Template mhdpublish_tmplt
2023/09/15 11:43:28.642267 ttdb.go:366: Persisted Template mhdpublish_tmplt.json
2023/09/15 11:43:28.705798 ttdb.go:379: Persisting Template events_tmplt
2023/09/15 11:43:28.784134 ttdb.go:385: Persisted Template events_tmplt
2023/09/15 11:43:28.784279 ttdb.go:366: Persisted Template events_tmplt.html
2023/09/15 11:43:28.850963 ttdb.go:379: Persisting Template uploadfile2t_tmplt
2023/09/15 11:43:28.913591 ttdb.go:385: Persisted Template uploadfile2t_tmplt
2023/09/15 11:43:28.913745 ttdb.go:366: Persisted Template uploadfile2t_tmplt.html
2023/09/15 11:43:28.914067 ttserver.go:40: Starting ICB Workflow Service. Service Endpoint http://MacBook-Pro-3.lan:8080/
2023/09/15 11:43:31.574386 ttgethandler.go:10: Processing new GET Request
2023/09/15 11:43:31.574576 ttproxy.go:138: 	Request Query Params
2023/09/15 11:43:31.574966 ttutil.go:140: 	{
  "User": "ian.thomas",
  "Org": "2tsolutions",
  "Role": "clinical",
  "Nhs": "9000000009"
}
2023/09/15 11:43:31.575006 ttgethandler.go:15: Path = /beta/spa/consumer/patient
2023/09/15 11:43:31.575060 tttmplts.go:37: CGL Worker starting
2023/09/15 11:43:31.575061 tttmplts.go:30: PIXm Worker starting
2023/09/15 11:43:31.575670 tthttp.go:15: Creating PIXm PDQ - Server URL http://lac-demo-01.tianispirit.co.uk:8081/SpiritPIXFhir/r4/Patient?identifier=2.16.840.1.113883.2.1.4.1%7C9000000009
2023/09/15 11:43:31.576902 tthttp.go:160: Request Headers 
map[Accept:[application/json] X-Api-Key:[FNhb#OhxWiEiMdf+@6085k5Zmt] X-Api-Secret:[9710ea0fb4ffb5d56c2e62c71c30bdfhjsyr56a79d]]
2023/09/15 11:43:31.576920 tthttp.go:160: Request Headers 
map[Content-Type:[application/json]]
2023/09/15 11:43:31.756734 tthttp.go:174: Server Response - Status Code 404 
{"errors":[{"message":"No clients matching nhs number 9000000009","path":"\/"}],"status":404}
2023/09/15 11:43:31.762109 ttutil.go:140: 	{
  "data": {
    "client": {
      "basicDetails": {
        "address": {},
        "name": {}
      },
      "bbvInformation": {},
      "drugTestResults": {
        "results": {}
      },
      "riskInformation": {
        "mentalHealthDomain": {},
        "riskOfHarmToSelfDomain": {},
        "socialDomain": {},
        "substanceMisuseDomain": {}
      },
      "safeguardingInformation": {}
    },
    "keyWorker": {
      "name": {}
    }
  }
}
2023/09/15 11:43:31.762227 tttmplts.go:39: CGL Worker done
2023/09/15 11:43:31.762278 tttmplts.go:40: CGL Worker Status Code 404
2023/09/15 11:43:36.577573 tthttp.go:174: Server Response - Status Code 0 
2023/09/15 11:43:36.578008 tttmplts.go:32: PIXm Worker done
2023/09/15 11:43:36.578052 tttmplts.go:33: PIXm Worker Status Code 408
2023/09/15 11:43:36.578287 tthttp.go:56: Creating PDS Search Request - Server URL https://sandbox.api.service.nhs.uk/personal-demographics/FHIR/R4/Patient/9000000009
2023/09/15 11:43:36.578446 tthttp.go:160: Request Headers 
map[Accept:[*/*] Content-Type:[application/json] X-Request-Id:[e2902b4b-840b-461d-a58b-2b738b16fe2f]]
2023/09/15 11:43:36.852531 tthttp.go:174: Server Response - Status Code 200 
{"resourceType":"Patient","id":"9000000009","identifier":[{"system":"https://fhir.nhs.uk/Id/nhs-number","value":"9000000009","extension":[{"url":"https://fhir.hl7.org.uk/StructureDefinition/Extension-UKCore-NHSNumberVerificationStatus","valueCodeableConcept":{"coding":[{"system":"https://fhir.hl7.org.uk/CodeSystem/UKCore-NHSNumberVerificationStatus","version":"1.0.0","code":"01","display":"Number present and verified"}]}}]}],"meta":{"versionId":"2","security":[{"system":"http://terminology.hl7.org/CodeSystem/v3-Confidentiality","code":"U","display":"unrestricted"}]},"name":[{"id":"123","use":"usual","period":{"start":"2020-01-01","end":"2021-12-31"},"given":["Jane"],"family":"Smith","prefix":["Mrs"],"suffix":["MBE"]}],"gender":"female","birthDate":"2010-10-22","multipleBirthInteger":1,"deceasedDateTime":"2010-10-22T00:00:00+00:00","generalPractitioner":[{"id":"254406A3","type":"Organization","identifier":{"system":"https://fhir.nhs.uk/Id/ods-organization-code","value":"Y12345","period":{"start":"2020-01-01","end":"2021-12-31"}}}],"managingOrganization":{"type":"Organization","identifier":{"system":"https://fhir.nhs.uk/Id/ods-organization-code","value":"Y12345","period":{"start":"2020-01-01","end":"2021-12-31"}}},"extension":[{"url":"https://fhir.hl7.org.uk/StructureDefinition/Extension-UKCore-NominatedPharmacy","valueReference":{"identifier":{"system":"https://fhir.nhs.uk/Id/ods-organization-code","value":"Y12345"}}},{"url":"https://fhir.hl7.org.uk/StructureDefinition/Extension-UKCore-PreferredDispenserOrganization","valueReference":{"identifier":{"system":"https://fhir.nhs.uk/Id/ods-organization-code","value":"Y23456"}}},{"url":"https://fhir.hl7.org.uk/StructureDefinition/Extension-UKCore-MedicalApplianceSupplier","valueReference":{"identifier":{"system":"https://fhir.nhs.uk/Id/ods-organization-code","value":"Y34567"}}},{"url":"https://fhir.hl7.org.uk/StructureDefinition/Extension-UKCore-DeathNotificationStatus","extension":[{"url":"deathNotificationStatus","valueCodeableConcept":{"coding":[{"system":"https://fhir.hl7.org.uk/CodeSystem/UKCore-DeathNotificationStatus","version":"1.0.0","code":"2","display":"Formal - death notice received from Registrar of Deaths"}]}},{"url":"systemEffectiveDate","valueDateTime":"2010-10-22T00:00:00+00:00"}]},{"url":"https://fhir.hl7.org.uk/StructureDefinition/Extension-UKCore-NHSCommunication","extension":[{"url":"language","valueCodeableConcept":{"coding":[{"system":"https://fhir.hl7.org.uk/CodeSystem/UKCore-HumanLanguage","version":"1.0.0","code":"fr","display":"French"}]}},{"url":"interpreterRequired","valueBoolean":true}]},{"url":"https://fhir.hl7.org.uk/StructureDefinition/Extension-UKCore-ContactPreference","extension":[{"url":"PreferredWrittenCommunicationFormat","valueCodeableConcept":{"coding":[{"system":"https://fhir.hl7.org.uk/CodeSystem/UKCore-PreferredWrittenCommunicationFormat","code":"12","display":"Braille"}]}},{"url":"PreferredContactMethod","valueCodeableConcept":{"coding":[{"system":"https://fhir.hl7.org.uk/CodeSystem/UKCore-PreferredContactMethod","code":"1","display":"Letter"}]}},{"url":"PreferredContactTimes","valueString":"Not after 7pm"}]},{"url":"http://hl7.org/fhir/StructureDefinition/patient-birthPlace","valueAddress":{"city":"Manchester","district":"Greater Manchester","country":"GBR"}},{"url":"https://fhir.nhs.uk/StructureDefinition/Extension-PDS-RemovalFromRegistration","extension":[{"url":"removalFromRegistrationCode","valueCodeableConcept":{"coding":[{"system":"https://fhir.nhs.uk/CodeSystem/PDS-RemovalReasonExitCode","code":"SCT","display":"Transferred to Scotland"}]}},{"url":"effectiveTime","valuePeriod":{"start":"2020-01-01T00:00:00+00:00","end":"2021-12-31T00:00:00+00:00"}}]}],"telecom":[{"id":"789","period":{"start":"2020-01-01","end":"2021-12-31"},"system":"phone","value":"01632960587","use":"home"},{"id":"790","period":{"start":"2019-01-01","end":"2022-12-31"},"system":"email","value":"jane.smith@example.com","use":"home"},{"id":"OC789","period":{"start":"2020-01-01","end":"2021-12-31"},"system":"other","value":"01632960587","use":"home","extension":[{"url":"https://fhir.hl7.org.uk/StructureDefinition/Extension-UKCore-OtherContactSystem","valueCoding":{"system":"https://fhir.hl7.org.uk/CodeSystem/UKCore-OtherContactSystem","code":"textphone","display":"Minicom (Textphone)"}}]}],"contact":[{"id":"C123","period":{"start":"2020-01-01","end":"2021-12-31"},"relationship":[{"coding":[{"system":"http://terminology.hl7.org/CodeSystem/v2-0131","code":"C","display":"Emergency Contact"}]}],"telecom":[{"system":"phone","value":"01632960587"}]}],"address":[{"id":"456","period":{"start":"2020-01-01","end":"2021-12-31"},"use":"home","line":["1 Trevelyan Square","Boar Lane","City Centre","Leeds","West Yorkshire"],"postalCode":"LS1 6AE","extension":[{"url":"https://fhir.hl7.org.uk/StructureDefinition/Extension-UKCore-AddressKey","extension":[{"url":"type","valueCoding":{"system":"https://fhir.hl7.org.uk/CodeSystem/UKCore-AddressKeyType","code":"PAF"}},{"url":"value","valueString":"12345678"}]},{"url":"https://fhir.hl7.org.uk/StructureDefinition/Extension-UKCore-AddressKey","extension":[{"url":"type","valueCoding":{"system":"https://fhir.hl7.org.uk/CodeSystem/UKCore-AddressKeyType","code":"UPRN"}},{"url":"value","valueString":"123456789012"}]}]},{"id":"T456","period":{"start":"2020-01-01","end":"2021-12-31"},"use":"temp","text":"Student Accommodation","line":["1 Trevelyan Square","Boar Lane","City Centre","Leeds","West Yorkshire"],"postalCode":"LS1 6AE","extension":[{"url":"https://fhir.hl7.org.uk/StructureDefinition/Extension-UKCore-AddressKey","extension":[{"url":"type","valueCoding":{"system":"https://fhir.hl7.org.uk/CodeSystem/UKCore-AddressKeyType","code":"PAF"}},{"url":"value","valueString":"12345678"}]},{"url":"https://fhir.hl7.org.uk/StructureDefinition/Extension-UKCore-AddressKey","extension":[{"url":"type","valueCoding":{"system":"https://fhir.hl7.org.uk/CodeSystem/UKCore-AddressKeyType","code":"UPRN"}},{"url":"value","valueString":"123456789012"}]}]}]}
2023/09/15 11:43:37.178003 tttmplts.go:100: Caching 24 Templates
2023/09/15 11:43:37.183748 tttmplts.go:87: Processing Template allpatientSrvs_tmplt
2023/09/15 11:43:37.187001 tttmplts.go:93: template: pds_tmplt:6:46: executing "pds_tmplt" at <ne .PDSRetrieveResponse.DeceasedDateTime "">: error calling ne: incompatible types for comparison
2023/09/15 11:43:37.187302 ttproxy.go:105: template: pds_tmplt:6:46: executing "pds_tmplt" at <ne .PDSRetrieveResponse.DeceasedDateTime "">: error calling ne: incompatible types for comparison
2023/09/15 11:43:37.187371 ttproxy.go:149: Response Status Code 500
2023/09/15 11:43:37.187394 ttproxy.go:151: 
2023/09/15 11:43:37.187417 ttproxy.go:152: Response Headers
2023/09/15 11:43:37.187582 ttutil.go:140: 	{
  "Access-Control-Allow-Origin": "*",
  "Content-Type": "",
  "Server": "Workflow Service"
}
2023/09/15 11:43:37.187606 ttproxy.go:154: ----------------
2023/09/15 11:43:37.187628 ttproxy.go:155: Response
2023/09/15 11:43:37.187645 ttproxy.go:156: ----------------
2023/09/15 11:43:37.188119 ttutil.go:140: 	{
  "Host": "MacBook-Pro-3.lan",
  "Path": "/beta/spa/consumer/patient",
  "Method": "GET",
  "SourceIP": "[::1]:49786",
  "ReqContentType": "",
  "RspContentType": "",
  "ResponseBody": "{\"resourceType\":\"Patient\",\"id\":\"9000000009\",\"identifier\":[{\"system\":\"https://fhir.nhs.uk/Id/nhs-number\",\"value\":\"9000000009\",\"extension\":[{\"url\":\"https://fhir.hl7.org.uk/StructureDefinition/Extension-UKCore-NHSNumberVerificationStatus\",\"valueCodeableConcept\":{\"coding\":[{\"system\":\"https://fhir.hl7.org.uk/CodeSystem/UKCore-NHSNumberVerificationStatus\",\"version\":\"1.0.0\",\"code\":\"01\",\"display\":\"Number present and verified\"}]}}]}],\"meta\":{\"versionId\":\"2\",\"security\":[{\"system\":\"http://terminology.hl7.org/CodeSystem/v3-Confidentiality\",\"code\":\"U\",\"display\":\"unrestricted\"}]},\"name\":[{\"id\":\"123\",\"use\":\"usual\",\"period\":{\"start\":\"2020-01-01\",\"end\":\"2021-12-31\"},\"given\":[\"Jane\"],\"family\":\"Smith\",\"prefix\":[\"Mrs\"],\"suffix\":[\"MBE\"]}],\"gender\":\"female\",\"birthDate\":\"2010-10-22\",\"multipleBirthInteger\":1,\"deceasedDateTime\":\"2010-10-22T00:00:00+00:00\",\"generalPractitioner\":[{\"id\":\"254406A3\",\"type\":\"Organization\",\"identifier\":{\"system\":\"https://fhir.nhs.uk/Id/ods-organization-code\",\"value\":\"Y12345\",\"period\":{\"start\":\"2020-01-01\",\"end\":\"2021-12-31\"}}}],\"managingOrganization\":{\"type\":\"Organization\",\"identifier\":{\"system\":\"https://fhir.nhs.uk/Id/ods-organization-code\",\"value\":\"Y12345\",\"period\":{\"start\":\"2020-01-01\",\"end\":\"2021-12-31\"}}},\"extension\":[{\"url\":\"https://fhir.hl7.org.uk/StructureDefinition/Extension-UKCore-NominatedPharmacy\",\"valueReference\":{\"identifier\":{\"system\":\"https://fhir.nhs.uk/Id/ods-organization-code\",\"value\":\"Y12345\"}}},{\"url\":\"https://fhir.hl7.org.uk/StructureDefinition/Extension-UKCore-PreferredDispenserOrganization\",\"valueReference\":{\"identifier\":{\"system\":\"https://fhir.nhs.uk/Id/ods-organization-code\",\"value\":\"Y23456\"}}},{\"url\":\"https://fhir.hl7.org.uk/StructureDefinition/Extension-UKCore-MedicalApplianceSupplier\",\"valueReference\":{\"identifier\":{\"system\":\"https://fhir.nhs.uk/Id/ods-organization-code\",\"value\":\"Y34567\"}}},{\"url\":\"https://fhir.hl7.org.uk/StructureDefinition/Extension-UKCore-DeathNotificationStatus\",\"extension\":[{\"url\":\"deathNotificationStatus\",\"valueCodeableConcept\":{\"coding\":[{\"system\":\"https://fhir.hl7.org.uk/CodeSystem/UKCore-DeathNotificationStatus\",\"version\":\"1.0.0\",\"code\":\"2\",\"display\":\"Formal - death notice received from Registrar of Deaths\"}]}},{\"url\":\"systemEffectiveDate\",\"valueDateTime\":\"2010-10-22T00:00:00+00:00\"}]},{\"url\":\"https://fhir.hl7.org.uk/StructureDefinition/Extension-UKCore-NHSCommunication\",\"extension\":[{\"url\":\"language\",\"valueCodeableConcept\":{\"coding\":[{\"system\":\"https://fhir.hl7.org.uk/CodeSystem/UKCore-HumanLanguage\",\"version\":\"1.0.0\",\"code\":\"fr\",\"display\":\"French\"}]}},{\"url\":\"interpreterRequired\",\"valueBoolean\":true}]},{\"url\":\"https://fhir.hl7.org.uk/StructureDefinition/Extension-UKCore-ContactPreference\",\"extension\":[{\"url\":\"PreferredWrittenCommunicationFormat\",\"valueCodeableConcept\":{\"coding\":[{\"system\":\"https://fhir.hl7.org.uk/CodeSystem/UKCore-PreferredWrittenCommunicationFormat\",\"code\":\"12\",\"display\":\"Braille\"}]}},{\"url\":\"PreferredContactMethod\",\"valueCodeableConcept\":{\"coding\":[{\"system\":\"https://fhir.hl7.org.uk/CodeSystem/UKCore-PreferredContactMethod\",\"code\":\"1\",\"display\":\"Letter\"}]}},{\"url\":\"PreferredContactTimes\",\"valueString\":\"Not after 7pm\"}]},{\"url\":\"http://hl7.org/fhir/StructureDefinition/patient-birthPlace\",\"valueAddress\":{\"city\":\"Manchester\",\"district\":\"Greater Manchester\",\"country\":\"GBR\"}},{\"url\":\"https://fhir.nhs.uk/StructureDefinition/Extension-PDS-RemovalFromRegistration\",\"extension\":[{\"url\":\"removalFromRegistrationCode\",\"valueCodeableConcept\":{\"coding\":[{\"system\":\"https://fhir.nhs.uk/CodeSystem/PDS-RemovalReasonExitCode\",\"code\":\"SCT\",\"display\":\"Transferred to Scotland\"}]}},{\"url\":\"effectiveTime\",\"valuePeriod\":{\"start\":\"2020-01-01T00:00:00+00:00\",\"end\":\"2021-12-31T00:00:00+00:00\"}}]}],\"telecom\":[{\"id\":\"789\",\"period\":{\"start\":\"2020-01-01\",\"end\":\"2021-12-31\"},\"system\":\"phone\",\"value\":\"01632960587\",\"use\":\"home\"},{\"id\":\"790\",\"period\":{\"start\":\"2019-01-01\",\"end\":\"2022-12-31\"},\"system\":\"email\",\"value\":\"jane.smith@example.com\",\"use\":\"home\"},{\"id\":\"OC789\",\"period\":{\"start\":\"2020-01-01\",\"end\":\"2021-12-31\"},\"system\":\"other\",\"value\":\"01632960587\",\"use\":\"home\",\"extension\":[{\"url\":\"https://fhir.hl7.org.uk/StructureDefinition/Extension-UKCore-OtherContactSystem\",\"valueCoding\":{\"system\":\"https://fhir.hl7.org.uk/CodeSystem/UKCore-OtherContactSystem\",\"code\":\"textphone\",\"display\":\"Minicom (Textphone)\"}}]}],\"contact\":[{\"id\":\"C123\",\"period\":{\"start\":\"2020-01-01\",\"end\":\"2021-12-31\"},\"relationship\":[{\"coding\":[{\"system\":\"http://terminology.hl7.org/CodeSystem/v2-0131\",\"code\":\"C\",\"display\":\"Emergency Contact\"}]}],\"telecom\":[{\"system\":\"phone\",\"value\":\"01632960587\"}]}],\"address\":[{\"id\":\"456\",\"period\":{\"start\":\"2020-01-01\",\"end\":\"2021-12-31\"},\"use\":\"home\",\"line\":[\"1 Trevelyan Square\",\"Boar Lane\",\"City Centre\",\"Leeds\",\"West Yorkshire\"],\"postalCode\":\"LS1 6AE\",\"extension\":[{\"url\":\"https://fhir.hl7.org.uk/StructureDefinition/Extension-UKCore-AddressKey\",\"extension\":[{\"url\":\"type\",\"valueCoding\":{\"system\":\"https://fhir.hl7.org.uk/CodeSystem/UKCore-AddressKeyType\",\"code\":\"PAF\"}},{\"url\":\"value\",\"valueString\":\"12345678\"}]},{\"url\":\"https://fhir.hl7.org.uk/StructureDefinition/Extension-UKCore-AddressKey\",\"extension\":[{\"url\":\"type\",\"valueCoding\":{\"system\":\"https://fhir.hl7.org.uk/CodeSystem/UKCore-AddressKeyType\",\"code\":\"UPRN\"}},{\"url\":\"value\",\"valueString\":\"123456789012\"}]}]},{\"id\":\"T456\",\"period\":{\"start\":\"2020-01-01\",\"end\":\"2021-12-31\"},\"use\":\"temp\",\"text\":\"Student Accommodation\",\"line\":[\"1 Trevelyan Square\",\"Boar Lane\",\"City Centre\",\"Leeds\",\"West Yorkshire\"],\"postalCode\":\"LS1 6AE\",\"extension\":[{\"url\":\"https://fhir.hl7.org.uk/StructureDefinition/Extension-UKCore-AddressKey\",\"extension\":[{\"url\":\"type\",\"valueCoding\":{\"system\":\"https://fhir.hl7.org.uk/CodeSystem/UKCore-AddressKeyType\",\"code\":\"PAF\"}},{\"url\":\"value\",\"valueString\":\"12345678\"}]},{\"url\":\"https://fhir.hl7.org.uk/StructureDefinition/Extension-UKCore-AddressKey\",\"extension\":[{\"url\":\"type\",\"valueCoding\":{\"system\":\"https://fhir.hl7.org.uk/CodeSystem/UKCore-AddressKeyType\",\"code\":\"UPRN\"}},{\"url\":\"value\",\"valueString\":\"123456789012\"}]}]}]}",
  "StatusCode": 500,
  "IsBase64": false,
  "Timeout": 0
}
2023/09/15 11:43:37.188146 ttproxy.go:158: -------------
2023/09/15 11:43:37.188174 ttproxy.go:160: Error template: pds_tmplt:6:46: executing "pds_tmplt" at <ne .PDSRetrieveResponse.DeceasedDateTime "">: error calling ne: incompatible types for comparison
2023/09/15 11:43:37.188202 ttproxy.go:161: -------------
2023/09/15 11:47:16.012151 ttserver.go:52: ICB Workflow Service stopped
2023/09/15 11:47:17.571253 ttutil.go:133: -----------------------------------------------------------------------------------
2023/09/15 11:47:17.571751 ttdb.go:51: Opening DB Connection to mysql instance
User: root
Host: tuk.coil1nnpqdlr.eu-west-1.rds.amazonaws.com
Port: :3306
Name: tuk
Connect Timeout 2s
Read Timeout 5s
2023/09/15 11:47:17.571925 ttdb.go:54: Opened Database
2023/09/15 11:47:17.771143 ttdb.go:379: Persisting Template dsubcancel_tmplt
2023/09/15 11:47:17.833961 ttdb.go:385: Persisted Template dsubcancel_tmplt
2023/09/15 11:47:17.834026 ttdb.go:366: Persisted Template dsubcancel_tmplt.xml
2023/09/15 11:47:17.895790 ttdb.go:379: Persisting Template cgl_tmplt
2023/09/15 11:47:17.993387 ttdb.go:385: Persisted Template cgl_tmplt
2023/09/15 11:47:17.993563 ttdb.go:366: Persisted Template cgl_tmplt.html
2023/09/15 11:47:18.055948 ttdb.go:379: Persisting Template pdssearch_tmplt
2023/09/15 11:47:18.118541 ttdb.go:385: Persisted Template pdssearch_tmplt
2023/09/15 11:47:18.118581 ttdb.go:366: Persisted Template pdssearch_tmplt.html
2023/09/15 11:47:18.180350 ttdb.go:379: Persisting Template dsubsubscribe_tmplt
2023/09/15 11:47:18.243917 ttdb.go:385: Persisted Template dsubsubscribe_tmplt
2023/09/15 11:47:18.244000 ttdb.go:366: Persisted Template dsubsubscribe_tmplt.xml
2023/09/15 11:47:18.306657 ttdb.go:379: Persisting Template notification_tmplt
2023/09/15 11:47:18.371192 ttdb.go:385: Persisted Template notification_tmplt
2023/09/15 11:47:18.371293 ttdb.go:366: Persisted Template notification_tmplt.txt
2023/09/15 11:47:18.436563 ttdb.go:379: Persisting Template wfstate2t_tmplt
2023/09/15 11:47:18.551984 ttdb.go:385: Persisted Template wfstate2t_tmplt
2023/09/15 11:47:18.552091 ttdb.go:366: Persisted Template wfstate2t_tmplt.html
2023/09/15 11:47:18.614983 ttdb.go:379: Persisting Template publishfile2t_tmplt
2023/09/15 11:47:18.677769 ttdb.go:385: Persisted Template publishfile2t_tmplt
2023/09/15 11:47:18.677929 ttdb.go:366: Persisted Template publishfile2t_tmplt.html
2023/09/15 11:47:18.738967 ttdb.go:379: Persisting Template react_tmplt
2023/09/15 11:47:18.801256 ttdb.go:385: Persisted Template react_tmplt
2023/09/15 11:47:18.801437 ttdb.go:366: Persisted Template react_tmplt.html
2023/09/15 11:47:18.862932 ttdb.go:379: Persisting Template pdsretrieve_tmplt
2023/09/15 11:47:18.927945 ttdb.go:385: Persisted Template pdsretrieve_tmplt
2023/09/15 11:47:18.928116 ttdb.go:366: Persisted Template pdsretrieve_tmplt.html
2023/09/15 11:47:18.991359 ttdb.go:379: Persisting Template allpatientSrvs_tmplt
2023/09/15 11:47:19.055008 ttdb.go:385: Persisted Template allpatientSrvs_tmplt
2023/09/15 11:47:19.055170 ttdb.go:366: Persisted Template allpatientSrvs_tmplt.html
2023/09/15 11:47:19.116409 ttdb.go:379: Persisting Template spa2t_tmplt
2023/09/15 11:47:19.190798 ttdb.go:385: Persisted Template spa2t_tmplt
2023/09/15 11:47:19.190832 ttdb.go:366: Persisted Template spa2t_tmplt.html
2023/09/15 11:47:19.253889 ttdb.go:379: Persisting Template xdw2t_tmplt
2023/09/15 11:47:19.329210 ttdb.go:385: Persisted Template xdw2t_tmplt
2023/09/15 11:47:19.329330 ttdb.go:366: Persisted Template xdw2t_tmplt.html
2023/09/15 11:47:19.393055 ttdb.go:379: Persisting Template spaheader2t_tmplt
2023/09/15 11:47:19.461009 ttdb.go:385: Persisted Template spaheader2t_tmplt
2023/09/15 11:47:19.461131 ttdb.go:366: Persisted Template spaheader2t_tmplt.html
2023/09/15 11:47:19.527733 ttdb.go:379: Persisting Template pds_tmplt
2023/09/15 11:47:19.593173 ttdb.go:385: Persisted Template pds_tmplt
2023/09/15 11:47:19.593300 ttdb.go:366: Persisted Template pds_tmplt.html
2023/09/15 11:47:19.658481 ttdb.go:379: Persisting Template error_tmplt
2023/09/15 11:47:19.723469 ttdb.go:385: Persisted Template error_tmplt
2023/09/15 11:47:19.723607 ttdb.go:366: Persisted Template error_tmplt.html
2023/09/15 11:47:19.786501 ttdb.go:379: Persisting Template dsuback_tmplt
2023/09/15 11:47:19.848282 ttdb.go:385: Persisted Template dsuback_tmplt
2023/09/15 11:47:19.848415 ttdb.go:366: Persisted Template dsuback_tmplt.xml
2023/09/15 11:47:19.912678 ttdb.go:379: Persisting Template pixm_tmplt
2023/09/15 11:47:19.980333 ttdb.go:385: Persisted Template pixm_tmplt
2023/09/15 11:47:19.980518 ttdb.go:366: Persisted Template pixm_tmplt.html
2023/09/15 11:47:20.044989 ttdb.go:379: Persisting Template subscriptions2t_tmplt
2023/09/15 11:47:20.111114 ttdb.go:385: Persisted Template subscriptions2t_tmplt
2023/09/15 11:47:20.111278 ttdb.go:366: Persisted Template subscriptions2t_tmplt.html
2023/09/15 11:47:20.173759 ttdb.go:379: Persisting Template codemaps2t_tmplt
2023/09/15 11:47:20.242139 ttdb.go:385: Persisted Template codemaps2t_tmplt
2023/09/15 11:47:20.242298 ttdb.go:366: Persisted Template codemaps2t_tmplt.html
2023/09/15 11:47:20.308062 ttdb.go:379: Persisting Template mhdpublish_tmplt
2023/09/15 11:47:20.377835 ttdb.go:385: Persisted Template mhdpublish_tmplt
2023/09/15 11:47:20.378051 ttdb.go:366: Persisted Template mhdpublish_tmplt.json
2023/09/15 11:47:20.442774 ttdb.go:379: Persisting Template events_tmplt
2023/09/15 11:47:20.511519 ttdb.go:385: Persisted Template events_tmplt
2023/09/15 11:47:20.511703 ttdb.go:366: Persisted Template events_tmplt.html
2023/09/15 11:47:20.575713 ttdb.go:379: Persisting Template uploadfile2t_tmplt
2023/09/15 11:47:20.639988 ttdb.go:385: Persisted Template uploadfile2t_tmplt
2023/09/15 11:47:20.640166 ttdb.go:366: Persisted Template uploadfile2t_tmplt.html
2023/09/15 11:47:20.640557 ttserver.go:40: Starting ICB Workflow Service. Service Endpoint http://MacBook-Pro-3.lan:8080/
2023/09/15 11:47:23.310583 ttgethandler.go:10: Processing new GET Request
2023/09/15 11:47:23.310802 ttproxy.go:138: 	Request Query Params
2023/09/15 11:47:23.311353 ttutil.go:140: 	{
  "User": "ian.thomas",
  "Org": "2tsolutions",
  "Role": "clinical",
  "Nhs": "9000000009"
}
2023/09/15 11:47:23.311417 ttgethandler.go:15: Path = /beta/spa/consumer/patient
2023/09/15 11:47:23.311481 tttmplts.go:37: CGL Worker starting
2023/09/15 11:47:23.311488 tttmplts.go:30: PIXm Worker starting
2023/09/15 11:47:23.312435 tthttp.go:15: Creating PIXm PDQ - Server URL http://lac-demo-01.tianispirit.co.uk:8081/SpiritPIXFhir/r4/Patient?identifier=2.16.840.1.113883.2.1.4.1%7C9000000009
2023/09/15 11:47:23.314786 tthttp.go:160: Request Headers 
map[Content-Type:[application/json]]
2023/09/15 11:47:23.314914 tthttp.go:160: Request Headers 
map[Accept:[application/json] X-Api-Key:[FNhb#OhxWiEiMdf+@6085k5Zmt] X-Api-Secret:[9710ea0fb4ffb5d56c2e62c71c30bdfhjsyr56a79d]]
2023/09/15 11:47:23.500895 tthttp.go:174: Server Response - Status Code 404 
{"errors":[{"message":"No clients matching nhs number 9000000009","path":"\/"}],"status":404}
2023/09/15 11:47:23.504466 ttutil.go:140: 	{
  "data": {
    "client": {
      "basicDetails": {
        "address": {},
        "name": {}
      },
      "bbvInformation": {},
      "drugTestResults": {
        "results": {}
      },
      "riskInformation": {
        "mentalHealthDomain": {},
        "riskOfHarmToSelfDomain": {},
        "socialDomain": {},
        "substanceMisuseDomain": {}
      },
      "safeguardingInformation": {}
    },
    "keyWorker": {
      "name": {}
    }
  }
}
2023/09/15 11:47:23.504620 tttmplts.go:39: CGL Worker done
2023/09/15 11:47:23.504650 tttmplts.go:40: CGL Worker Status Code 404
2023/09/15 11:47:28.313296 tthttp.go:174: Server Response - Status Code 0 
2023/09/15 11:47:28.313682 tttmplts.go:32: PIXm Worker done
2023/09/15 11:47:28.313735 tttmplts.go:33: PIXm Worker Status Code 408
2023/09/15 11:47:28.314151 tthttp.go:56: Creating PDS Search Request - Server URL https://sandbox.api.service.nhs.uk/personal-demographics/FHIR/R4/Patient/9000000009
2023/09/15 11:47:28.314333 tthttp.go:160: Request Headers 
map[Accept:[*/*] Content-Type:[application/json] X-Request-Id:[6706dd0c-4ae3-4ef8-b2f4-5cd29b1294a9]]
2023/09/15 11:47:29.116160 tthttp.go:174: Server Response - Status Code 200 
{"resourceType":"Patient","id":"9000000009","identifier":[{"system":"https://fhir.nhs.uk/Id/nhs-number","value":"9000000009","extension":[{"url":"https://fhir.hl7.org.uk/StructureDefinition/Extension-UKCore-NHSNumberVerificationStatus","valueCodeableConcept":{"coding":[{"system":"https://fhir.hl7.org.uk/CodeSystem/UKCore-NHSNumberVerificationStatus","version":"1.0.0","code":"01","display":"Number present and verified"}]}}]}],"meta":{"versionId":"2","security":[{"system":"http://terminology.hl7.org/CodeSystem/v3-Confidentiality","code":"U","display":"unrestricted"}]},"name":[{"id":"123","use":"usual","period":{"start":"2020-01-01","end":"2021-12-31"},"given":["Jane"],"family":"Smith","prefix":["Mrs"],"suffix":["MBE"]}],"gender":"female","birthDate":"2010-10-22","multipleBirthInteger":1,"deceasedDateTime":"2010-10-22T00:00:00+00:00","generalPractitioner":[{"id":"254406A3","type":"Organization","identifier":{"system":"https://fhir.nhs.uk/Id/ods-organization-code","value":"Y12345","period":{"start":"2020-01-01","end":"2021-12-31"}}}],"managingOrganization":{"type":"Organization","identifier":{"system":"https://fhir.nhs.uk/Id/ods-organization-code","value":"Y12345","period":{"start":"2020-01-01","end":"2021-12-31"}}},"extension":[{"url":"https://fhir.hl7.org.uk/StructureDefinition/Extension-UKCore-NominatedPharmacy","valueReference":{"identifier":{"system":"https://fhir.nhs.uk/Id/ods-organization-code","value":"Y12345"}}},{"url":"https://fhir.hl7.org.uk/StructureDefinition/Extension-UKCore-PreferredDispenserOrganization","valueReference":{"identifier":{"system":"https://fhir.nhs.uk/Id/ods-organization-code","value":"Y23456"}}},{"url":"https://fhir.hl7.org.uk/StructureDefinition/Extension-UKCore-MedicalApplianceSupplier","valueReference":{"identifier":{"system":"https://fhir.nhs.uk/Id/ods-organization-code","value":"Y34567"}}},{"url":"https://fhir.hl7.org.uk/StructureDefinition/Extension-UKCore-DeathNotificationStatus","extension":[{"url":"deathNotificationStatus","valueCodeableConcept":{"coding":[{"system":"https://fhir.hl7.org.uk/CodeSystem/UKCore-DeathNotificationStatus","version":"1.0.0","code":"2","display":"Formal - death notice received from Registrar of Deaths"}]}},{"url":"systemEffectiveDate","valueDateTime":"2010-10-22T00:00:00+00:00"}]},{"url":"https://fhir.hl7.org.uk/StructureDefinition/Extension-UKCore-NHSCommunication","extension":[{"url":"language","valueCodeableConcept":{"coding":[{"system":"https://fhir.hl7.org.uk/CodeSystem/UKCore-HumanLanguage","version":"1.0.0","code":"fr","display":"French"}]}},{"url":"interpreterRequired","valueBoolean":true}]},{"url":"https://fhir.hl7.org.uk/StructureDefinition/Extension-UKCore-ContactPreference","extension":[{"url":"PreferredWrittenCommunicationFormat","valueCodeableConcept":{"coding":[{"system":"https://fhir.hl7.org.uk/CodeSystem/UKCore-PreferredWrittenCommunicationFormat","code":"12","display":"Braille"}]}},{"url":"PreferredContactMethod","valueCodeableConcept":{"coding":[{"system":"https://fhir.hl7.org.uk/CodeSystem/UKCore-PreferredContactMethod","code":"1","display":"Letter"}]}},{"url":"PreferredContactTimes","valueString":"Not after 7pm"}]},{"url":"http://hl7.org/fhir/StructureDefinition/patient-birthPlace","valueAddress":{"city":"Manchester","district":"Greater Manchester","country":"GBR"}},{"url":"https://fhir.nhs.uk/StructureDefinition/Extension-PDS-RemovalFromRegistration","extension":[{"url":"removalFromRegistrationCode","valueCodeableConcept":{"coding":[{"system":"https://fhir.nhs.uk/CodeSystem/PDS-RemovalReasonExitCode","code":"SCT","display":"Transferred to Scotland"}]}},{"url":"effectiveTime","valuePeriod":{"start":"2020-01-01T00:00:00+00:00","end":"2021-12-31T00:00:00+00:00"}}]}],"telecom":[{"id":"789","period":{"start":"2020-01-01","end":"2021-12-31"},"system":"phone","value":"01632960587","use":"home"},{"id":"790","period":{"start":"2019-01-01","end":"2022-12-31"},"system":"email","value":"jane.smith@example.com","use":"home"},{"id":"OC789","period":{"start":"2020-01-01","end":"2021-12-31"},"system":"other","value":"01632960587","use":"home","extension":[{"url":"https://fhir.hl7.org.uk/StructureDefinition/Extension-UKCore-OtherContactSystem","valueCoding":{"system":"https://fhir.hl7.org.uk/CodeSystem/UKCore-OtherContactSystem","code":"textphone","display":"Minicom (Textphone)"}}]}],"contact":[{"id":"C123","period":{"start":"2020-01-01","end":"2021-12-31"},"relationship":[{"coding":[{"system":"http://terminology.hl7.org/CodeSystem/v2-0131","code":"C","display":"Emergency Contact"}]}],"telecom":[{"system":"phone","value":"01632960587"}]}],"address":[{"id":"456","period":{"start":"2020-01-01","end":"2021-12-31"},"use":"home","line":["1 Trevelyan Square","Boar Lane","City Centre","Leeds","West Yorkshire"],"postalCode":"LS1 6AE","extension":[{"url":"https://fhir.hl7.org.uk/StructureDefinition/Extension-UKCore-AddressKey","extension":[{"url":"type","valueCoding":{"system":"https://fhir.hl7.org.uk/CodeSystem/UKCore-AddressKeyType","code":"PAF"}},{"url":"value","valueString":"12345678"}]},{"url":"https://fhir.hl7.org.uk/StructureDefinition/Extension-UKCore-AddressKey","extension":[{"url":"type","valueCoding":{"system":"https://fhir.hl7.org.uk/CodeSystem/UKCore-AddressKeyType","code":"UPRN"}},{"url":"value","valueString":"123456789012"}]}]},{"id":"T456","period":{"start":"2020-01-01","end":"2021-12-31"},"use":"temp","text":"Student Accommodation","line":["1 Trevelyan Square","Boar Lane","City Centre","Leeds","West Yorkshire"],"postalCode":"LS1 6AE","extension":[{"url":"https://fhir.hl7.org.uk/StructureDefinition/Extension-UKCore-AddressKey","extension":[{"url":"type","valueCoding":{"system":"https://fhir.hl7.org.uk/CodeSystem/UKCore-AddressKeyType","code":"PAF"}},{"url":"value","valueString":"12345678"}]},{"url":"https://fhir.hl7.org.uk/StructureDefinition/Extension-UKCore-AddressKey","extension":[{"url":"type","valueCoding":{"system":"https://fhir.hl7.org.uk/CodeSystem/UKCore-AddressKeyType","code":"UPRN"}},{"url":"value","valueString":"123456789012"}]}]}]}
2023/09/15 11:47:29.476321 tttmplts.go:100: Caching 24 Templates
2023/09/15 11:47:29.481226 tttmplts.go:104: Template pds_tmplt caused Error template: pds_tmplt:8: unexpected "(" in operand
2023/09/15 11:47:29.481770 server.go:3217: http: panic serving [::1]:49874: runtime error: invalid memory address or nil pointer dereference
goroutine 51 [running]:
net/http.(*conn).serve.func1()
	/Users/IanThomas/sdk/go1.20.5/src/net/http/server.go:1854 +0xbf
panic({0x1434ca0, 0x17e4e70})
	/Users/IanThomas/sdk/go1.20.5/src/runtime/panic.go:890 +0x263
html/template.(*Template).New(0x14c1682?, {0xc00060fd20?, 0xc000633fc0?})
	/Users/IanThomas/sdk/go1.20.5/src/html/template/template.go:305 +0x37
main.(*Trans).cacheTemplates(0xc000380000)
	/Users/IanThomas/go/src/ttxdwuser/main/tttmplts.go:103 +0x1d2
main.(*Trans).setResponseFromTemplate(0xc000380000)
	/Users/IanThomas/go/src/ttxdwuser/main/tttmplts.go:85 +0x45
main.(*Trans).setPatientTemplate(0xc000380000)
	/Users/IanThomas/go/src/ttxdwuser/main/tttmplts.go:53 +0x1b1
main.(*Trans).newGetHandler(0xc000380000)
	/Users/IanThomas/go/src/ttxdwuser/main/ttgethandler.go:28 +0xd94
main.(*Trans).newProxyTrans(0xc000380000)
	/Users/IanThomas/go/src/ttxdwuser/main/ttproxy.go:73 +0x4d1
main.Handle_HTTP_Request({0x15657d0, 0xc000128700}, 0xc000164000)
	/Users/IanThomas/go/src/ttxdwuser/main/ttproxy.go:15 +0xeb
net/http.HandlerFunc.ServeHTTP(0xc00016601f?, {0x15657d0?, 0xc000128700?}, 0x1064cee?)
	/Users/IanThomas/sdk/go1.20.5/src/net/http/server.go:2122 +0x2f
net/http.serverHandler.ServeHTTP({0xc000110450?}, {0x15657d0, 0xc000128700}, 0xc000164000)
	/Users/IanThomas/sdk/go1.20.5/src/net/http/server.go:2936 +0x316
net/http.(*conn).serve(0xc00022d560, {0x15659c8, 0xc00020fa70})
	/Users/IanThomas/sdk/go1.20.5/src/net/http/server.go:1995 +0x612
created by net/http.(*Server).Serve
	/Users/IanThomas/sdk/go1.20.5/src/net/http/server.go:3089 +0x5ed
2023/09/15 11:48:38.119282 ttserver.go:52: ICB Workflow Service stopped
2023/09/15 11:48:39.814428 ttutil.go:133: -----------------------------------------------------------------------------------
2023/09/15 11:48:39.814904 ttdb.go:51: Opening DB Connection to mysql instance
User: root
Host: tuk.coil1nnpqdlr.eu-west-1.rds.amazonaws.com
Port: :3306
Name: tuk
Connect Timeout 2s
Read Timeout 5s
2023/09/15 11:48:39.815029 ttdb.go:54: Opened Database
2023/09/15 11:48:40.008263 ttdb.go:379: Persisting Template dsubcancel_tmplt
2023/09/15 11:48:40.077264 ttdb.go:385: Persisted Template dsubcancel_tmplt
2023/09/15 11:48:40.077314 ttdb.go:366: Persisted Template dsubcancel_tmplt.xml
2023/09/15 11:48:40.142445 ttdb.go:379: Persisting Template cgl_tmplt
2023/09/15 11:48:40.237488 ttdb.go:385: Persisted Template cgl_tmplt
2023/09/15 11:48:40.237525 ttdb.go:366: Persisted Template cgl_tmplt.html
2023/09/15 11:48:40.300219 ttdb.go:379: Persisting Template pdssearch_tmplt
2023/09/15 11:48:40.366615 ttdb.go:385: Persisted Template pdssearch_tmplt
2023/09/15 11:48:40.366791 ttdb.go:366: Persisted Template pdssearch_tmplt.html
2023/09/15 11:48:40.430216 ttdb.go:379: Persisting Template dsubsubscribe_tmplt
2023/09/15 11:48:40.491448 ttdb.go:385: Persisted Template dsubsubscribe_tmplt
2023/09/15 11:48:40.491536 ttdb.go:366: Persisted Template dsubsubscribe_tmplt.xml
2023/09/15 11:48:40.553771 ttdb.go:379: Persisting Template notification_tmplt
2023/09/15 11:48:40.616907 ttdb.go:385: Persisted Template notification_tmplt
2023/09/15 11:48:40.616995 ttdb.go:366: Persisted Template notification_tmplt.txt
2023/09/15 11:48:40.678360 ttdb.go:379: Persisting Template wfstate2t_tmplt
2023/09/15 11:48:40.791909 ttdb.go:385: Persisted Template wfstate2t_tmplt
2023/09/15 11:48:40.792072 ttdb.go:366: Persisted Template wfstate2t_tmplt.html
2023/09/15 11:48:40.856539 ttdb.go:379: Persisting Template publishfile2t_tmplt
2023/09/15 11:48:40.923902 ttdb.go:385: Persisted Template publishfile2t_tmplt
2023/09/15 11:48:40.924010 ttdb.go:366: Persisted Template publishfile2t_tmplt.html
2023/09/15 11:48:40.986746 ttdb.go:379: Persisting Template react_tmplt
2023/09/15 11:48:41.049043 ttdb.go:385: Persisted Template react_tmplt
2023/09/15 11:48:41.049134 ttdb.go:366: Persisted Template react_tmplt.html
2023/09/15 11:48:41.111038 ttdb.go:379: Persisting Template pdsretrieve_tmplt
2023/09/15 11:48:41.176380 ttdb.go:385: Persisted Template pdsretrieve_tmplt
2023/09/15 11:48:41.176544 ttdb.go:366: Persisted Template pdsretrieve_tmplt.html
2023/09/15 11:48:41.240711 ttdb.go:379: Persisting Template allpatientSrvs_tmplt
2023/09/15 11:48:41.304220 ttdb.go:385: Persisted Template allpatientSrvs_tmplt
2023/09/15 11:48:41.304351 ttdb.go:366: Persisted Template allpatientSrvs_tmplt.html
2023/09/15 11:48:41.367424 ttdb.go:379: Persisting Template spa2t_tmplt
2023/09/15 11:48:41.443740 ttdb.go:385: Persisted Template spa2t_tmplt
2023/09/15 11:48:41.443789 ttdb.go:366: Persisted Template spa2t_tmplt.html
2023/09/15 11:48:41.505109 ttdb.go:379: Persisting Template xdw2t_tmplt
2023/09/15 11:48:41.580364 ttdb.go:385: Persisted Template xdw2t_tmplt
2023/09/15 11:48:41.580441 ttdb.go:366: Persisted Template xdw2t_tmplt.html
2023/09/15 11:48:41.645604 ttdb.go:379: Persisting Template spaheader2t_tmplt
2023/09/15 11:48:41.714012 ttdb.go:385: Persisted Template spaheader2t_tmplt
2023/09/15 11:48:41.714142 ttdb.go:366: Persisted Template spaheader2t_tmplt.html
2023/09/15 11:48:41.778358 ttdb.go:379: Persisting Template pds_tmplt
2023/09/15 11:48:41.840696 ttdb.go:385: Persisted Template pds_tmplt
2023/09/15 11:48:41.840840 ttdb.go:366: Persisted Template pds_tmplt.html
2023/09/15 11:48:41.903221 ttdb.go:379: Persisting Template error_tmplt
2023/09/15 11:48:41.968144 ttdb.go:385: Persisted Template error_tmplt
2023/09/15 11:48:41.968284 ttdb.go:366: Persisted Template error_tmplt.html
2023/09/15 11:48:42.030889 ttdb.go:379: Persisting Template dsuback_tmplt
2023/09/15 11:48:42.093301 ttdb.go:385: Persisted Template dsuback_tmplt
2023/09/15 11:48:42.093455 ttdb.go:366: Persisted Template dsuback_tmplt.xml
2023/09/15 11:48:42.156913 ttdb.go:379: Persisting Template pixm_tmplt
2023/09/15 11:48:42.223054 ttdb.go:385: Persisted Template pixm_tmplt
2023/09/15 11:48:42.223197 ttdb.go:366: Persisted Template pixm_tmplt.html
2023/09/15 11:48:42.284946 ttdb.go:379: Persisting Template subscriptions2t_tmplt
2023/09/15 11:48:42.350268 ttdb.go:385: Persisted Template subscriptions2t_tmplt
2023/09/15 11:48:42.350404 ttdb.go:366: Persisted Template subscriptions2t_tmplt.html
2023/09/15 11:48:42.413193 ttdb.go:379: Persisting Template codemaps2t_tmplt
2023/09/15 11:48:42.481174 ttdb.go:385: Persisted Template codemaps2t_tmplt
2023/09/15 11:48:42.481305 ttdb.go:366: Persisted Template codemaps2t_tmplt.html
2023/09/15 11:48:42.544399 ttdb.go:379: Persisting Template mhdpublish_tmplt
2023/09/15 11:48:42.615223 ttdb.go:385: Persisted Template mhdpublish_tmplt
2023/09/15 11:48:42.615365 ttdb.go:366: Persisted Template mhdpublish_tmplt.json
2023/09/15 11:48:42.677131 ttdb.go:379: Persisting Template events_tmplt
2023/09/15 11:48:42.747383 ttdb.go:385: Persisted Template events_tmplt
2023/09/15 11:48:42.747540 ttdb.go:366: Persisted Template events_tmplt.html
2023/09/15 11:48:42.810648 ttdb.go:379: Persisting Template uploadfile2t_tmplt
2023/09/15 11:48:42.873738 ttdb.go:385: Persisted Template uploadfile2t_tmplt
2023/09/15 11:48:42.873892 ttdb.go:366: Persisted Template uploadfile2t_tmplt.html
2023/09/15 11:48:42.874216 ttserver.go:40: Starting ICB Workflow Service. Service Endpoint http://MacBook-Pro-3.lan:8080/
2023/09/15 11:48:45.330359 ttgethandler.go:10: Processing new GET Request
2023/09/15 11:48:45.330622 ttproxy.go:138: 	Request Query Params
2023/09/15 11:48:45.331238 ttutil.go:140: 	{
  "User": "ian.thomas",
  "Org": "2tsolutions",
  "Role": "clinical",
  "Nhs": "9000000009"
}
2023/09/15 11:48:45.331310 ttgethandler.go:15: Path = /beta/spa/consumer/patient
2023/09/15 11:48:45.331386 tttmplts.go:37: CGL Worker starting
2023/09/15 11:48:45.331397 tttmplts.go:30: PIXm Worker starting
2023/09/15 11:48:45.331755 tthttp.go:15: Creating PIXm PDQ - Server URL http://lac-demo-01.tianispirit.co.uk:8081/SpiritPIXFhir/r4/Patient?identifier=2.16.840.1.113883.2.1.4.1%7C9000000009
2023/09/15 11:48:45.334463 tthttp.go:160: Request Headers 
map[Accept:[application/json] X-Api-Key:[FNhb#OhxWiEiMdf+@6085k5Zmt] X-Api-Secret:[9710ea0fb4ffb5d56c2e62c71c30bdfhjsyr56a79d]]
2023/09/15 11:48:45.334494 tthttp.go:160: Request Headers 
map[Content-Type:[application/json]]
2023/09/15 11:48:45.520209 tthttp.go:174: Server Response - Status Code 404 
{"errors":[{"message":"No clients matching nhs number 9000000009","path":"\/"}],"status":404}
2023/09/15 11:48:45.523945 ttutil.go:140: 	{
  "data": {
    "client": {
      "basicDetails": {
        "address": {},
        "name": {}
      },
      "bbvInformation": {},
      "drugTestResults": {
        "results": {}
      },
      "riskInformation": {
        "mentalHealthDomain": {},
        "riskOfHarmToSelfDomain": {},
        "socialDomain": {},
        "substanceMisuseDomain": {}
      },
      "safeguardingInformation": {}
    },
    "keyWorker": {
      "name": {}
    }
  }
}
2023/09/15 11:48:45.524068 tttmplts.go:39: CGL Worker done
2023/09/15 11:48:45.524097 tttmplts.go:40: CGL Worker Status Code 404
2023/09/15 11:48:50.333758 tthttp.go:174: Server Response - Status Code 0 
2023/09/15 11:48:50.334208 tttmplts.go:32: PIXm Worker done
2023/09/15 11:48:50.334272 tttmplts.go:33: PIXm Worker Status Code 408
2023/09/15 11:48:50.334524 tthttp.go:56: Creating PDS Search Request - Server URL https://sandbox.api.service.nhs.uk/personal-demographics/FHIR/R4/Patient/9000000009
2023/09/15 11:48:50.334745 tthttp.go:160: Request Headers 
map[Accept:[*/*] Content-Type:[application/json] X-Request-Id:[f9398f65-4979-4144-b824-48fa3f69359e]]
2023/09/15 11:48:50.611518 tthttp.go:174: Server Response - Status Code 200 
{"resourceType":"Patient","id":"9000000009","identifier":[{"system":"https://fhir.nhs.uk/Id/nhs-number","value":"9000000009","extension":[{"url":"https://fhir.hl7.org.uk/StructureDefinition/Extension-UKCore-NHSNumberVerificationStatus","valueCodeableConcept":{"coding":[{"system":"https://fhir.hl7.org.uk/CodeSystem/UKCore-NHSNumberVerificationStatus","version":"1.0.0","code":"01","display":"Number present and verified"}]}}]}],"meta":{"versionId":"2","security":[{"system":"http://terminology.hl7.org/CodeSystem/v3-Confidentiality","code":"U","display":"unrestricted"}]},"name":[{"id":"123","use":"usual","period":{"start":"2020-01-01","end":"2021-12-31"},"given":["Jane"],"family":"Smith","prefix":["Mrs"],"suffix":["MBE"]}],"gender":"female","birthDate":"2010-10-22","multipleBirthInteger":1,"deceasedDateTime":"2010-10-22T00:00:00+00:00","generalPractitioner":[{"id":"254406A3","type":"Organization","identifier":{"system":"https://fhir.nhs.uk/Id/ods-organization-code","value":"Y12345","period":{"start":"2020-01-01","end":"2021-12-31"}}}],"managingOrganization":{"type":"Organization","identifier":{"system":"https://fhir.nhs.uk/Id/ods-organization-code","value":"Y12345","period":{"start":"2020-01-01","end":"2021-12-31"}}},"extension":[{"url":"https://fhir.hl7.org.uk/StructureDefinition/Extension-UKCore-NominatedPharmacy","valueReference":{"identifier":{"system":"https://fhir.nhs.uk/Id/ods-organization-code","value":"Y12345"}}},{"url":"https://fhir.hl7.org.uk/StructureDefinition/Extension-UKCore-PreferredDispenserOrganization","valueReference":{"identifier":{"system":"https://fhir.nhs.uk/Id/ods-organization-code","value":"Y23456"}}},{"url":"https://fhir.hl7.org.uk/StructureDefinition/Extension-UKCore-MedicalApplianceSupplier","valueReference":{"identifier":{"system":"https://fhir.nhs.uk/Id/ods-organization-code","value":"Y34567"}}},{"url":"https://fhir.hl7.org.uk/StructureDefinition/Extension-UKCore-DeathNotificationStatus","extension":[{"url":"deathNotificationStatus","valueCodeableConcept":{"coding":[{"system":"https://fhir.hl7.org.uk/CodeSystem/UKCore-DeathNotificationStatus","version":"1.0.0","code":"2","display":"Formal - death notice received from Registrar of Deaths"}]}},{"url":"systemEffectiveDate","valueDateTime":"2010-10-22T00:00:00+00:00"}]},{"url":"https://fhir.hl7.org.uk/StructureDefinition/Extension-UKCore-NHSCommunication","extension":[{"url":"language","valueCodeableConcept":{"coding":[{"system":"https://fhir.hl7.org.uk/CodeSystem/UKCore-HumanLanguage","version":"1.0.0","code":"fr","display":"French"}]}},{"url":"interpreterRequired","valueBoolean":true}]},{"url":"https://fhir.hl7.org.uk/StructureDefinition/Extension-UKCore-ContactPreference","extension":[{"url":"PreferredWrittenCommunicationFormat","valueCodeableConcept":{"coding":[{"system":"https://fhir.hl7.org.uk/CodeSystem/UKCore-PreferredWrittenCommunicationFormat","code":"12","display":"Braille"}]}},{"url":"PreferredContactMethod","valueCodeableConcept":{"coding":[{"system":"https://fhir.hl7.org.uk/CodeSystem/UKCore-PreferredContactMethod","code":"1","display":"Letter"}]}},{"url":"PreferredContactTimes","valueString":"Not after 7pm"}]},{"url":"http://hl7.org/fhir/StructureDefinition/patient-birthPlace","valueAddress":{"city":"Manchester","district":"Greater Manchester","country":"GBR"}},{"url":"https://fhir.nhs.uk/StructureDefinition/Extension-PDS-RemovalFromRegistration","extension":[{"url":"removalFromRegistrationCode","valueCodeableConcept":{"coding":[{"system":"https://fhir.nhs.uk/CodeSystem/PDS-RemovalReasonExitCode","code":"SCT","display":"Transferred to Scotland"}]}},{"url":"effectiveTime","valuePeriod":{"start":"2020-01-01T00:00:00+00:00","end":"2021-12-31T00:00:00+00:00"}}]}],"telecom":[{"id":"789","period":{"start":"2020-01-01","end":"2021-12-31"},"system":"phone","value":"01632960587","use":"home"},{"id":"790","period":{"start":"2019-01-01","end":"2022-12-31"},"system":"email","value":"jane.smith@example.com","use":"home"},{"id":"OC789","period":{"start":"2020-01-01","end":"2021-12-31"},"system":"other","value":"01632960587","use":"home","extension":[{"url":"https://fhir.hl7.org.uk/StructureDefinition/Extension-UKCore-OtherContactSystem","valueCoding":{"system":"https://fhir.hl7.org.uk/CodeSystem/UKCore-OtherContactSystem","code":"textphone","display":"Minicom (Textphone)"}}]}],"contact":[{"id":"C123","period":{"start":"2020-01-01","end":"2021-12-31"},"relationship":[{"coding":[{"system":"http://terminology.hl7.org/CodeSystem/v2-0131","code":"C","display":"Emergency Contact"}]}],"telecom":[{"system":"phone","value":"01632960587"}]}],"address":[{"id":"456","period":{"start":"2020-01-01","end":"2021-12-31"},"use":"home","line":["1 Trevelyan Square","Boar Lane","City Centre","Leeds","West Yorkshire"],"postalCode":"LS1 6AE","extension":[{"url":"https://fhir.hl7.org.uk/StructureDefinition/Extension-UKCore-AddressKey","extension":[{"url":"type","valueCoding":{"system":"https://fhir.hl7.org.uk/CodeSystem/UKCore-AddressKeyType","code":"PAF"}},{"url":"value","valueString":"12345678"}]},{"url":"https://fhir.hl7.org.uk/StructureDefinition/Extension-UKCore-AddressKey","extension":[{"url":"type","valueCoding":{"system":"https://fhir.hl7.org.uk/CodeSystem/UKCore-AddressKeyType","code":"UPRN"}},{"url":"value","valueString":"123456789012"}]}]},{"id":"T456","period":{"start":"2020-01-01","end":"2021-12-31"},"use":"temp","text":"Student Accommodation","line":["1 Trevelyan Square","Boar Lane","City Centre","Leeds","West Yorkshire"],"postalCode":"LS1 6AE","extension":[{"url":"https://fhir.hl7.org.uk/StructureDefinition/Extension-UKCore-AddressKey","extension":[{"url":"type","valueCoding":{"system":"https://fhir.hl7.org.uk/CodeSystem/UKCore-AddressKeyType","code":"PAF"}},{"url":"value","valueString":"12345678"}]},{"url":"https://fhir.hl7.org.uk/StructureDefinition/Extension-UKCore-AddressKey","extension":[{"url":"type","valueCoding":{"system":"https://fhir.hl7.org.uk/CodeSystem/UKCore-AddressKeyType","code":"UPRN"}},{"url":"value","valueString":"123456789012"}]}]}]}
2023/09/15 11:48:50.797404 tttmplts.go:100: Caching 24 Templates
2023/09/15 11:48:50.806419 tttmplts.go:87: Processing Template allpatientSrvs_tmplt
2023/09/15 11:48:50.809250 tttmplts.go:93: template: pds_tmplt:8:21: executing "pds_tmplt" at <len .PDSRetrieveResponse.DeceasedDateTime>: error calling len: len of type time.Time
2023/09/15 11:48:50.809461 ttproxy.go:105: template: pds_tmplt:8:21: executing "pds_tmplt" at <len .PDSRetrieveResponse.DeceasedDateTime>: error calling len: len of type time.Time
2023/09/15 11:48:50.809516 ttproxy.go:149: Response Status Code 500
2023/09/15 11:48:50.809548 ttproxy.go:151: 
2023/09/15 11:48:50.809558 ttproxy.go:152: Response Headers
2023/09/15 11:48:50.809664 ttutil.go:140: 	{
  "Access-Control-Allow-Origin": "*",
  "Content-Type": "",
  "Server": "Workflow Service"
}
2023/09/15 11:48:50.809679 ttproxy.go:154: ----------------
2023/09/15 11:48:50.809689 ttproxy.go:155: Response
2023/09/15 11:48:50.809698 ttproxy.go:156: ----------------
2023/09/15 11:48:50.810009 ttutil.go:140: 	{
  "Host": "MacBook-Pro-3.lan",
  "Path": "/beta/spa/consumer/patient",
  "Method": "GET",
  "SourceIP": "[::1]:49904",
  "ReqContentType": "",
  "RspContentType": "",
  "ResponseBody": "{\"resourceType\":\"Patient\",\"id\":\"9000000009\",\"identifier\":[{\"system\":\"https://fhir.nhs.uk/Id/nhs-number\",\"value\":\"9000000009\",\"extension\":[{\"url\":\"https://fhir.hl7.org.uk/StructureDefinition/Extension-UKCore-NHSNumberVerificationStatus\",\"valueCodeableConcept\":{\"coding\":[{\"system\":\"https://fhir.hl7.org.uk/CodeSystem/UKCore-NHSNumberVerificationStatus\",\"version\":\"1.0.0\",\"code\":\"01\",\"display\":\"Number present and verified\"}]}}]}],\"meta\":{\"versionId\":\"2\",\"security\":[{\"system\":\"http://terminology.hl7.org/CodeSystem/v3-Confidentiality\",\"code\":\"U\",\"display\":\"unrestricted\"}]},\"name\":[{\"id\":\"123\",\"use\":\"usual\",\"period\":{\"start\":\"2020-01-01\",\"end\":\"2021-12-31\"},\"given\":[\"Jane\"],\"family\":\"Smith\",\"prefix\":[\"Mrs\"],\"suffix\":[\"MBE\"]}],\"gender\":\"female\",\"birthDate\":\"2010-10-22\",\"multipleBirthInteger\":1,\"deceasedDateTime\":\"2010-10-22T00:00:00+00:00\",\"generalPractitioner\":[{\"id\":\"254406A3\",\"type\":\"Organization\",\"identifier\":{\"system\":\"https://fhir.nhs.uk/Id/ods-organization-code\",\"value\":\"Y12345\",\"period\":{\"start\":\"2020-01-01\",\"end\":\"2021-12-31\"}}}],\"managingOrganization\":{\"type\":\"Organization\",\"identifier\":{\"system\":\"https://fhir.nhs.uk/Id/ods-organization-code\",\"value\":\"Y12345\",\"period\":{\"start\":\"2020-01-01\",\"end\":\"2021-12-31\"}}},\"extension\":[{\"url\":\"https://fhir.hl7.org.uk/StructureDefinition/Extension-UKCore-NominatedPharmacy\",\"valueReference\":{\"identifier\":{\"system\":\"https://fhir.nhs.uk/Id/ods-organization-code\",\"value\":\"Y12345\"}}},{\"url\":\"https://fhir.hl7.org.uk/StructureDefinition/Extension-UKCore-PreferredDispenserOrganization\",\"valueReference\":{\"identifier\":{\"system\":\"https://fhir.nhs.uk/Id/ods-organization-code\",\"value\":\"Y23456\"}}},{\"url\":\"https://fhir.hl7.org.uk/StructureDefinition/Extension-UKCore-MedicalApplianceSupplier\",\"valueReference\":{\"identifier\":{\"system\":\"https://fhir.nhs.uk/Id/ods-organization-code\",\"value\":\"Y34567\"}}},{\"url\":\"https://fhir.hl7.org.uk/StructureDefinition/Extension-UKCore-DeathNotificationStatus\",\"extension\":[{\"url\":\"deathNotificationStatus\",\"valueCodeableConcept\":{\"coding\":[{\"system\":\"https://fhir.hl7.org.uk/CodeSystem/UKCore-DeathNotificationStatus\",\"version\":\"1.0.0\",\"code\":\"2\",\"display\":\"Formal - death notice received from Registrar of Deaths\"}]}},{\"url\":\"systemEffectiveDate\",\"valueDateTime\":\"2010-10-22T00:00:00+00:00\"}]},{\"url\":\"https://fhir.hl7.org.uk/StructureDefinition/Extension-UKCore-NHSCommunication\",\"extension\":[{\"url\":\"language\",\"valueCodeableConcept\":{\"coding\":[{\"system\":\"https://fhir.hl7.org.uk/CodeSystem/UKCore-HumanLanguage\",\"version\":\"1.0.0\",\"code\":\"fr\",\"display\":\"French\"}]}},{\"url\":\"interpreterRequired\",\"valueBoolean\":true}]},{\"url\":\"https://fhir.hl7.org.uk/StructureDefinition/Extension-UKCore-ContactPreference\",\"extension\":[{\"url\":\"PreferredWrittenCommunicationFormat\",\"valueCodeableConcept\":{\"coding\":[{\"system\":\"https://fhir.hl7.org.uk/CodeSystem/UKCore-PreferredWrittenCommunicationFormat\",\"code\":\"12\",\"display\":\"Braille\"}]}},{\"url\":\"PreferredContactMethod\",\"valueCodeableConcept\":{\"coding\":[{\"system\":\"https://fhir.hl7.org.uk/CodeSystem/UKCore-PreferredContactMethod\",\"code\":\"1\",\"display\":\"Letter\"}]}},{\"url\":\"PreferredContactTimes\",\"valueString\":\"Not after 7pm\"}]},{\"url\":\"http://hl7.org/fhir/StructureDefinition/patient-birthPlace\",\"valueAddress\":{\"city\":\"Manchester\",\"district\":\"Greater Manchester\",\"country\":\"GBR\"}},{\"url\":\"https://fhir.nhs.uk/StructureDefinition/Extension-PDS-RemovalFromRegistration\",\"extension\":[{\"url\":\"removalFromRegistrationCode\",\"valueCodeableConcept\":{\"coding\":[{\"system\":\"https://fhir.nhs.uk/CodeSystem/PDS-RemovalReasonExitCode\",\"code\":\"SCT\",\"display\":\"Transferred to Scotland\"}]}},{\"url\":\"effectiveTime\",\"valuePeriod\":{\"start\":\"2020-01-01T00:00:00+00:00\",\"end\":\"2021-12-31T00:00:00+00:00\"}}]}],\"telecom\":[{\"id\":\"789\",\"period\":{\"start\":\"2020-01-01\",\"end\":\"2021-12-31\"},\"system\":\"phone\",\"value\":\"01632960587\",\"use\":\"home\"},{\"id\":\"790\",\"period\":{\"start\":\"2019-01-01\",\"end\":\"2022-12-31\"},\"system\":\"email\",\"value\":\"jane.smith@example.com\",\"use\":\"home\"},{\"id\":\"OC789\",\"period\":{\"start\":\"2020-01-01\",\"end\":\"2021-12-31\"},\"system\":\"other\",\"value\":\"01632960587\",\"use\":\"home\",\"extension\":[{\"url\":\"https://fhir.hl7.org.uk/StructureDefinition/Extension-UKCore-OtherContactSystem\",\"valueCoding\":{\"system\":\"https://fhir.hl7.org.uk/CodeSystem/UKCore-OtherContactSystem\",\"code\":\"textphone\",\"display\":\"Minicom (Textphone)\"}}]}],\"contact\":[{\"id\":\"C123\",\"period\":{\"start\":\"2020-01-01\",\"end\":\"2021-12-31\"},\"relationship\":[{\"coding\":[{\"system\":\"http://terminology.hl7.org/CodeSystem/v2-0131\",\"code\":\"C\",\"display\":\"Emergency Contact\"}]}],\"telecom\":[{\"system\":\"phone\",\"value\":\"01632960587\"}]}],\"address\":[{\"id\":\"456\",\"period\":{\"start\":\"2020-01-01\",\"end\":\"2021-12-31\"},\"use\":\"home\",\"line\":[\"1 Trevelyan Square\",\"Boar Lane\",\"City Centre\",\"Leeds\",\"West Yorkshire\"],\"postalCode\":\"LS1 6AE\",\"extension\":[{\"url\":\"https://fhir.hl7.org.uk/StructureDefinition/Extension-UKCore-AddressKey\",\"extension\":[{\"url\":\"type\",\"valueCoding\":{\"system\":\"https://fhir.hl7.org.uk/CodeSystem/UKCore-AddressKeyType\",\"code\":\"PAF\"}},{\"url\":\"value\",\"valueString\":\"12345678\"}]},{\"url\":\"https://fhir.hl7.org.uk/StructureDefinition/Extension-UKCore-AddressKey\",\"extension\":[{\"url\":\"type\",\"valueCoding\":{\"system\":\"https://fhir.hl7.org.uk/CodeSystem/UKCore-AddressKeyType\",\"code\":\"UPRN\"}},{\"url\":\"value\",\"valueString\":\"123456789012\"}]}]},{\"id\":\"T456\",\"period\":{\"start\":\"2020-01-01\",\"end\":\"2021-12-31\"},\"use\":\"temp\",\"text\":\"Student Accommodation\",\"line\":[\"1 Trevelyan Square\",\"Boar Lane\",\"City Centre\",\"Leeds\",\"West Yorkshire\"],\"postalCode\":\"LS1 6AE\",\"extension\":[{\"url\":\"https://fhir.hl7.org.uk/StructureDefinition/Extension-UKCore-AddressKey\",\"extension\":[{\"url\":\"type\",\"valueCoding\":{\"system\":\"https://fhir.hl7.org.uk/CodeSystem/UKCore-AddressKeyType\",\"code\":\"PAF\"}},{\"url\":\"value\",\"valueString\":\"12345678\"}]},{\"url\":\"https://fhir.hl7.org.uk/StructureDefinition/Extension-UKCore-AddressKey\",\"extension\":[{\"url\":\"type\",\"valueCoding\":{\"system\":\"https://fhir.hl7.org.uk/CodeSystem/UKCore-AddressKeyType\",\"code\":\"UPRN\"}},{\"url\":\"value\",\"valueString\":\"123456789012\"}]}]}]}",
  "StatusCode": 500,
  "IsBase64": false,
  "Timeout": 0
}
2023/09/15 11:48:50.810080 ttproxy.go:158: -------------
2023/09/15 11:48:50.810090 ttproxy.go:160: Error template: pds_tmplt:8:21: executing "pds_tmplt" at <len .PDSRetrieveResponse.DeceasedDateTime>: error calling len: len of type time.Time
2023/09/15 11:48:50.810104 ttproxy.go:161: -------------
2023/09/15 11:52:55.415597 ttserver.go:52: ICB Workflow Service stopped
2023/09/15 11:52:57.217798 ttutil.go:133: -----------------------------------------------------------------------------------
2023/09/15 11:52:57.218290 ttdb.go:51: Opening DB Connection to mysql instance
User: root
Host: tuk.coil1nnpqdlr.eu-west-1.rds.amazonaws.com
Port: :3306
Name: tuk
Connect Timeout 2s
Read Timeout 5s
2023/09/15 11:52:57.218420 ttdb.go:54: Opened Database
2023/09/15 11:52:57.486929 ttdb.go:379: Persisting Template dsubcancel_tmplt
2023/09/15 11:52:57.596435 ttdb.go:385: Persisted Template dsubcancel_tmplt
2023/09/15 11:52:57.596673 ttdb.go:366: Persisted Template dsubcancel_tmplt.xml
2023/09/15 11:52:57.723658 ttdb.go:379: Persisting Template cgl_tmplt
2023/09/15 11:52:57.905933 ttdb.go:385: Persisted Template cgl_tmplt
2023/09/15 11:52:57.906013 ttdb.go:366: Persisted Template cgl_tmplt.html
2023/09/15 11:52:58.020193 ttdb.go:379: Persisting Template pdssearch_tmplt
2023/09/15 11:52:58.122565 ttdb.go:385: Persisted Template pdssearch_tmplt
2023/09/15 11:52:58.122760 ttdb.go:366: Persisted Template pdssearch_tmplt.html
2023/09/15 11:52:58.230544 ttdb.go:379: Persisting Template dsubsubscribe_tmplt
2023/09/15 11:52:58.334875 ttdb.go:385: Persisted Template dsubsubscribe_tmplt
2023/09/15 11:52:58.334982 ttdb.go:366: Persisted Template dsubsubscribe_tmplt.xml
2023/09/15 11:52:58.438936 ttdb.go:379: Persisting Template notification_tmplt
2023/09/15 11:52:58.532587 ttdb.go:385: Persisted Template notification_tmplt
2023/09/15 11:52:58.532749 ttdb.go:366: Persisted Template notification_tmplt.txt
2023/09/15 11:52:58.658999 ttdb.go:379: Persisting Template wfstate2t_tmplt
2023/09/15 11:52:58.843794 ttdb.go:385: Persisted Template wfstate2t_tmplt
2023/09/15 11:52:58.843831 ttdb.go:366: Persisted Template wfstate2t_tmplt.html
2023/09/15 11:52:58.949877 ttdb.go:379: Persisting Template publishfile2t_tmplt
2023/09/15 11:52:59.053305 ttdb.go:385: Persisted Template publishfile2t_tmplt
2023/09/15 11:52:59.053331 ttdb.go:366: Persisted Template publishfile2t_tmplt.html
2023/09/15 11:52:59.165579 ttdb.go:379: Persisting Template react_tmplt
2023/09/15 11:52:59.302563 ttdb.go:385: Persisted Template react_tmplt
2023/09/15 11:52:59.302816 ttdb.go:366: Persisted Template react_tmplt.html
2023/09/15 11:52:59.422126 ttdb.go:379: Persisting Template pdsretrieve_tmplt
2023/09/15 11:52:59.514754 ttdb.go:385: Persisted Template pdsretrieve_tmplt
2023/09/15 11:52:59.514863 ttdb.go:366: Persisted Template pdsretrieve_tmplt.html
2023/09/15 11:52:59.637092 ttdb.go:379: Persisting Template allpatientSrvs_tmplt
2023/09/15 11:52:59.743520 ttdb.go:385: Persisted Template allpatientSrvs_tmplt
2023/09/15 11:52:59.743660 ttdb.go:366: Persisted Template allpatientSrvs_tmplt.html
2023/09/15 11:52:59.859756 ttdb.go:379: Persisting Template spa2t_tmplt
2023/09/15 11:52:59.981317 ttdb.go:385: Persisted Template spa2t_tmplt
2023/09/15 11:52:59.981472 ttdb.go:366: Persisted Template spa2t_tmplt.html
2023/09/15 11:53:00.189441 ttdb.go:379: Persisting Template xdw2t_tmplt
2023/09/15 11:53:00.320957 ttdb.go:385: Persisted Template xdw2t_tmplt
2023/09/15 11:53:00.321181 ttdb.go:366: Persisted Template xdw2t_tmplt.html
2023/09/15 11:53:00.489146 ttdb.go:379: Persisting Template spaheader2t_tmplt
2023/09/15 11:53:00.631137 ttdb.go:385: Persisted Template spaheader2t_tmplt
2023/09/15 11:53:00.631340 ttdb.go:366: Persisted Template spaheader2t_tmplt.html
2023/09/15 11:53:00.749493 ttdb.go:379: Persisting Template pds_tmplt
2023/09/15 11:53:00.869285 ttdb.go:385: Persisted Template pds_tmplt
2023/09/15 11:53:00.869464 ttdb.go:366: Persisted Template pds_tmplt.html
2023/09/15 11:53:00.999655 ttdb.go:379: Persisting Template error_tmplt
2023/09/15 11:53:01.101074 ttdb.go:385: Persisted Template error_tmplt
2023/09/15 11:53:01.101219 ttdb.go:366: Persisted Template error_tmplt.html
2023/09/15 11:53:01.178557 ttdb.go:379: Persisting Template dsuback_tmplt
2023/09/15 11:53:01.333710 ttdb.go:385: Persisted Template dsuback_tmplt
2023/09/15 11:53:01.333863 ttdb.go:366: Persisted Template dsuback_tmplt.xml
2023/09/15 11:53:01.482747 ttdb.go:379: Persisting Template pixm_tmplt
2023/09/15 11:53:01.628594 ttdb.go:385: Persisted Template pixm_tmplt
2023/09/15 11:53:01.628698 ttdb.go:366: Persisted Template pixm_tmplt.html
2023/09/15 11:53:01.760732 ttdb.go:379: Persisting Template subscriptions2t_tmplt
2023/09/15 11:53:01.885990 ttdb.go:385: Persisted Template subscriptions2t_tmplt
2023/09/15 11:53:01.886229 ttdb.go:366: Persisted Template subscriptions2t_tmplt.html
2023/09/15 11:53:02.003948 ttdb.go:379: Persisting Template codemaps2t_tmplt
2023/09/15 11:53:02.149564 ttdb.go:385: Persisted Template codemaps2t_tmplt
2023/09/15 11:53:02.150174 ttdb.go:366: Persisted Template codemaps2t_tmplt.html
2023/09/15 11:53:02.274826 ttdb.go:379: Persisting Template mhdpublish_tmplt
2023/09/15 11:53:02.416345 ttdb.go:385: Persisted Template mhdpublish_tmplt
2023/09/15 11:53:02.416546 ttdb.go:366: Persisted Template mhdpublish_tmplt.json
2023/09/15 11:53:02.547187 ttdb.go:379: Persisting Template events_tmplt
2023/09/15 11:53:02.675303 ttdb.go:385: Persisted Template events_tmplt
2023/09/15 11:53:02.675442 ttdb.go:366: Persisted Template events_tmplt.html
2023/09/15 11:53:02.797875 ttdb.go:379: Persisting Template uploadfile2t_tmplt
2023/09/15 11:53:02.948998 ttdb.go:385: Persisted Template uploadfile2t_tmplt
2023/09/15 11:53:02.949222 ttdb.go:366: Persisted Template uploadfile2t_tmplt.html
2023/09/15 11:53:02.949552 ttserver.go:40: Starting ICB Workflow Service. Service Endpoint http://MacBook-Pro-3.lan:8080/
2023/09/15 11:53:06.285086 ttgethandler.go:10: Processing new GET Request
2023/09/15 11:53:06.285246 ttproxy.go:138: 	Request Query Params
2023/09/15 11:53:06.285596 ttutil.go:140: 	{
  "User": "ian.thomas",
  "Org": "2tsolutions",
  "Role": "clinical",
  "Nhs": "9000000009"
}
2023/09/15 11:53:06.285639 ttgethandler.go:15: Path = /beta/spa/consumer/patient
2023/09/15 11:53:06.285686 tttmplts.go:37: CGL Worker starting
2023/09/15 11:53:06.285692 tttmplts.go:30: PIXm Worker starting
2023/09/15 11:53:06.286129 tthttp.go:15: Creating PIXm PDQ - Server URL http://lac-demo-01.tianispirit.co.uk:8081/SpiritPIXFhir/r4/Patient?identifier=2.16.840.1.113883.2.1.4.1%7C9000000009
2023/09/15 11:53:06.287683 tthttp.go:160: Request Headers 
map[Content-Type:[application/json]]
2023/09/15 11:53:06.287717 tthttp.go:160: Request Headers 
map[Accept:[application/json] X-Api-Key:[FNhb#OhxWiEiMdf+@6085k5Zmt] X-Api-Secret:[9710ea0fb4ffb5d56c2e62c71c30bdfhjsyr56a79d]]
2023/09/15 11:53:06.605136 tthttp.go:174: Server Response - Status Code 404 
{"errors":[{"message":"No clients matching nhs number 9000000009","path":"\/"}],"status":404}
2023/09/15 11:53:06.611625 ttutil.go:140: 	{
  "data": {
    "client": {
      "basicDetails": {
        "address": {},
        "name": {}
      },
      "bbvInformation": {},
      "drugTestResults": {
        "results": {}
      },
      "riskInformation": {
        "mentalHealthDomain": {},
        "riskOfHarmToSelfDomain": {},
        "socialDomain": {},
        "substanceMisuseDomain": {}
      },
      "safeguardingInformation": {}
    },
    "keyWorker": {
      "name": {}
    }
  }
}
2023/09/15 11:53:06.611796 tttmplts.go:39: CGL Worker done
2023/09/15 11:53:06.611847 tttmplts.go:40: CGL Worker Status Code 404
2023/09/15 11:53:11.287416 tthttp.go:174: Server Response - Status Code 0 
2023/09/15 11:53:11.287823 tttmplts.go:32: PIXm Worker done
2023/09/15 11:53:11.287909 tttmplts.go:33: PIXm Worker Status Code 408
2023/09/15 11:53:11.288083 tthttp.go:56: Creating PDS Search Request - Server URL https://sandbox.api.service.nhs.uk/personal-demographics/FHIR/R4/Patient/9000000009
2023/09/15 11:53:11.288220 tthttp.go:160: Request Headers 
map[Accept:[*/*] Content-Type:[application/json] X-Request-Id:[62ef6f49-004c-4945-babf-ca1eaacaafc7]]
2023/09/15 11:53:11.613511 tthttp.go:174: Server Response - Status Code 200 
{"resourceType":"Patient","id":"9000000009","identifier":[{"system":"https://fhir.nhs.uk/Id/nhs-number","value":"9000000009","extension":[{"url":"https://fhir.hl7.org.uk/StructureDefinition/Extension-UKCore-NHSNumberVerificationStatus","valueCodeableConcept":{"coding":[{"system":"https://fhir.hl7.org.uk/CodeSystem/UKCore-NHSNumberVerificationStatus","version":"1.0.0","code":"01","display":"Number present and verified"}]}}]}],"meta":{"versionId":"2","security":[{"system":"http://terminology.hl7.org/CodeSystem/v3-Confidentiality","code":"U","display":"unrestricted"}]},"name":[{"id":"123","use":"usual","period":{"start":"2020-01-01","end":"2021-12-31"},"given":["Jane"],"family":"Smith","prefix":["Mrs"],"suffix":["MBE"]}],"gender":"female","birthDate":"2010-10-22","multipleBirthInteger":1,"deceasedDateTime":"2010-10-22T00:00:00+00:00","generalPractitioner":[{"id":"254406A3","type":"Organization","identifier":{"system":"https://fhir.nhs.uk/Id/ods-organization-code","value":"Y12345","period":{"start":"2020-01-01","end":"2021-12-31"}}}],"managingOrganization":{"type":"Organization","identifier":{"system":"https://fhir.nhs.uk/Id/ods-organization-code","value":"Y12345","period":{"start":"2020-01-01","end":"2021-12-31"}}},"extension":[{"url":"https://fhir.hl7.org.uk/StructureDefinition/Extension-UKCore-NominatedPharmacy","valueReference":{"identifier":{"system":"https://fhir.nhs.uk/Id/ods-organization-code","value":"Y12345"}}},{"url":"https://fhir.hl7.org.uk/StructureDefinition/Extension-UKCore-PreferredDispenserOrganization","valueReference":{"identifier":{"system":"https://fhir.nhs.uk/Id/ods-organization-code","value":"Y23456"}}},{"url":"https://fhir.hl7.org.uk/StructureDefinition/Extension-UKCore-MedicalApplianceSupplier","valueReference":{"identifier":{"system":"https://fhir.nhs.uk/Id/ods-organization-code","value":"Y34567"}}},{"url":"https://fhir.hl7.org.uk/StructureDefinition/Extension-UKCore-DeathNotificationStatus","extension":[{"url":"deathNotificationStatus","valueCodeableConcept":{"coding":[{"system":"https://fhir.hl7.org.uk/CodeSystem/UKCore-DeathNotificationStatus","version":"1.0.0","code":"2","display":"Formal - death notice received from Registrar of Deaths"}]}},{"url":"systemEffectiveDate","valueDateTime":"2010-10-22T00:00:00+00:00"}]},{"url":"https://fhir.hl7.org.uk/StructureDefinition/Extension-UKCore-NHSCommunication","extension":[{"url":"language","valueCodeableConcept":{"coding":[{"system":"https://fhir.hl7.org.uk/CodeSystem/UKCore-HumanLanguage","version":"1.0.0","code":"fr","display":"French"}]}},{"url":"interpreterRequired","valueBoolean":true}]},{"url":"https://fhir.hl7.org.uk/StructureDefinition/Extension-UKCore-ContactPreference","extension":[{"url":"PreferredWrittenCommunicationFormat","valueCodeableConcept":{"coding":[{"system":"https://fhir.hl7.org.uk/CodeSystem/UKCore-PreferredWrittenCommunicationFormat","code":"12","display":"Braille"}]}},{"url":"PreferredContactMethod","valueCodeableConcept":{"coding":[{"system":"https://fhir.hl7.org.uk/CodeSystem/UKCore-PreferredContactMethod","code":"1","display":"Letter"}]}},{"url":"PreferredContactTimes","valueString":"Not after 7pm"}]},{"url":"http://hl7.org/fhir/StructureDefinition/patient-birthPlace","valueAddress":{"city":"Manchester","district":"Greater Manchester","country":"GBR"}},{"url":"https://fhir.nhs.uk/StructureDefinition/Extension-PDS-RemovalFromRegistration","extension":[{"url":"removalFromRegistrationCode","valueCodeableConcept":{"coding":[{"system":"https://fhir.nhs.uk/CodeSystem/PDS-RemovalReasonExitCode","code":"SCT","display":"Transferred to Scotland"}]}},{"url":"effectiveTime","valuePeriod":{"start":"2020-01-01T00:00:00+00:00","end":"2021-12-31T00:00:00+00:00"}}]}],"telecom":[{"id":"789","period":{"start":"2020-01-01","end":"2021-12-31"},"system":"phone","value":"01632960587","use":"home"},{"id":"790","period":{"start":"2019-01-01","end":"2022-12-31"},"system":"email","value":"jane.smith@example.com","use":"home"},{"id":"OC789","period":{"start":"2020-01-01","end":"2021-12-31"},"system":"other","value":"01632960587","use":"home","extension":[{"url":"https://fhir.hl7.org.uk/StructureDefinition/Extension-UKCore-OtherContactSystem","valueCoding":{"system":"https://fhir.hl7.org.uk/CodeSystem/UKCore-OtherContactSystem","code":"textphone","display":"Minicom (Textphone)"}}]}],"contact":[{"id":"C123","period":{"start":"2020-01-01","end":"2021-12-31"},"relationship":[{"coding":[{"system":"http://terminology.hl7.org/CodeSystem/v2-0131","code":"C","display":"Emergency Contact"}]}],"telecom":[{"system":"phone","value":"01632960587"}]}],"address":[{"id":"456","period":{"start":"2020-01-01","end":"2021-12-31"},"use":"home","line":["1 Trevelyan Square","Boar Lane","City Centre","Leeds","West Yorkshire"],"postalCode":"LS1 6AE","extension":[{"url":"https://fhir.hl7.org.uk/StructureDefinition/Extension-UKCore-AddressKey","extension":[{"url":"type","valueCoding":{"system":"https://fhir.hl7.org.uk/CodeSystem/UKCore-AddressKeyType","code":"PAF"}},{"url":"value","valueString":"12345678"}]},{"url":"https://fhir.hl7.org.uk/StructureDefinition/Extension-UKCore-AddressKey","extension":[{"url":"type","valueCoding":{"system":"https://fhir.hl7.org.uk/CodeSystem/UKCore-AddressKeyType","code":"UPRN"}},{"url":"value","valueString":"123456789012"}]}]},{"id":"T456","period":{"start":"2020-01-01","end":"2021-12-31"},"use":"temp","text":"Student Accommodation","line":["1 Trevelyan Square","Boar Lane","City Centre","Leeds","West Yorkshire"],"postalCode":"LS1 6AE","extension":[{"url":"https://fhir.hl7.org.uk/StructureDefinition/Extension-UKCore-AddressKey","extension":[{"url":"type","valueCoding":{"system":"https://fhir.hl7.org.uk/CodeSystem/UKCore-AddressKeyType","code":"PAF"}},{"url":"value","valueString":"12345678"}]},{"url":"https://fhir.hl7.org.uk/StructureDefinition/Extension-UKCore-AddressKey","extension":[{"url":"type","valueCoding":{"system":"https://fhir.hl7.org.uk/CodeSystem/UKCore-AddressKeyType","code":"UPRN"}},{"url":"value","valueString":"123456789012"}]}]}]}
2023/09/15 11:53:11.998529 tttmplts.go:100: Caching 24 Templates
2023/09/15 11:53:12.004087 tttmplts.go:87: Processing Template allpatientSrvs_tmplt
2023/09/15 11:53:12.007620 ttproxy.go:149: Response Status Code 200
2023/09/15 11:55:44.630221 ttserver.go:52: ICB Workflow Service stopped
2023/09/15 11:55:46.583166 ttutil.go:133: -----------------------------------------------------------------------------------
2023/09/15 11:55:46.583636 ttdb.go:51: Opening DB Connection to mysql instance
User: root
Host: tuk.coil1nnpqdlr.eu-west-1.rds.amazonaws.com
Port: :3306
Name: tuk
Connect Timeout 2s
Read Timeout 5s
2023/09/15 11:55:46.583765 ttdb.go:54: Opened Database
2023/09/15 11:55:46.764031 ttdb.go:379: Persisting Template dsubcancel_tmplt
2023/09/15 11:55:46.824341 ttdb.go:385: Persisted Template dsubcancel_tmplt
2023/09/15 11:55:46.824397 ttdb.go:366: Persisted Template dsubcancel_tmplt.xml
2023/09/15 11:55:46.883916 ttdb.go:379: Persisting Template cgl_tmplt
2023/09/15 11:55:46.974752 ttdb.go:385: Persisted Template cgl_tmplt
2023/09/15 11:55:46.974902 ttdb.go:366: Persisted Template cgl_tmplt.html
2023/09/15 11:55:47.052992 ttdb.go:379: Persisting Template pdssearch_tmplt
2023/09/15 11:55:47.117344 ttdb.go:385: Persisted Template pdssearch_tmplt
2023/09/15 11:55:47.117509 ttdb.go:366: Persisted Template pdssearch_tmplt.html
2023/09/15 11:55:47.177604 ttdb.go:379: Persisting Template dsubsubscribe_tmplt
2023/09/15 11:55:47.239625 ttdb.go:385: Persisted Template dsubsubscribe_tmplt
2023/09/15 11:55:47.239689 ttdb.go:366: Persisted Template dsubsubscribe_tmplt.xml
2023/09/15 11:55:47.299826 ttdb.go:379: Persisting Template notification_tmplt
2023/09/15 11:55:47.359928 ttdb.go:385: Persisted Template notification_tmplt
2023/09/15 11:55:47.360006 ttdb.go:366: Persisted Template notification_tmplt.txt
2023/09/15 11:55:47.420001 ttdb.go:379: Persisting Template wfstate2t_tmplt
2023/09/15 11:55:47.531659 ttdb.go:385: Persisted Template wfstate2t_tmplt
2023/09/15 11:55:47.531833 ttdb.go:366: Persisted Template wfstate2t_tmplt.html
2023/09/15 11:55:47.592485 ttdb.go:379: Persisting Template publishfile2t_tmplt
2023/09/15 11:55:47.652464 ttdb.go:385: Persisted Template publishfile2t_tmplt
2023/09/15 11:55:47.652578 ttdb.go:366: Persisted Template publishfile2t_tmplt.html
2023/09/15 11:55:47.712766 ttdb.go:379: Persisting Template react_tmplt
2023/09/15 11:55:47.773773 ttdb.go:385: Persisted Template react_tmplt
2023/09/15 11:55:47.773925 ttdb.go:366: Persisted Template react_tmplt.html
2023/09/15 11:55:47.834922 ttdb.go:379: Persisting Template pdsretrieve_tmplt
2023/09/15 11:55:47.896766 ttdb.go:385: Persisted Template pdsretrieve_tmplt
2023/09/15 11:55:47.896923 ttdb.go:366: Persisted Template pdsretrieve_tmplt.html
2023/09/15 11:55:47.959578 ttdb.go:379: Persisting Template allpatientSrvs_tmplt
2023/09/15 11:55:48.020537 ttdb.go:385: Persisted Template allpatientSrvs_tmplt
2023/09/15 11:55:48.020692 ttdb.go:366: Persisted Template allpatientSrvs_tmplt.html
2023/09/15 11:55:48.081607 ttdb.go:379: Persisting Template spa2t_tmplt
2023/09/15 11:55:48.156744 ttdb.go:385: Persisted Template spa2t_tmplt
2023/09/15 11:55:48.156879 ttdb.go:366: Persisted Template spa2t_tmplt.html
2023/09/15 11:55:48.218215 ttdb.go:379: Persisting Template xdw2t_tmplt
2023/09/15 11:55:48.294074 ttdb.go:385: Persisted Template xdw2t_tmplt
2023/09/15 11:55:48.294112 ttdb.go:366: Persisted Template xdw2t_tmplt.html
2023/09/15 11:55:48.355716 ttdb.go:379: Persisting Template spaheader2t_tmplt
2023/09/15 11:55:48.417341 ttdb.go:385: Persisted Template spaheader2t_tmplt
2023/09/15 11:55:48.417402 ttdb.go:366: Persisted Template spaheader2t_tmplt.html
2023/09/15 11:55:48.482739 ttdb.go:379: Persisting Template pds_tmplt
2023/09/15 11:55:48.543696 ttdb.go:385: Persisted Template pds_tmplt
2023/09/15 11:55:48.543833 ttdb.go:366: Persisted Template pds_tmplt.html
2023/09/15 11:55:48.603704 ttdb.go:379: Persisting Template error_tmplt
2023/09/15 11:55:48.662268 ttdb.go:385: Persisted Template error_tmplt
2023/09/15 11:55:48.662348 ttdb.go:366: Persisted Template error_tmplt.html
2023/09/15 11:55:48.722081 ttdb.go:379: Persisting Template dsuback_tmplt
2023/09/15 11:55:48.782437 ttdb.go:385: Persisted Template dsuback_tmplt
2023/09/15 11:55:48.782587 ttdb.go:366: Persisted Template dsuback_tmplt.xml
2023/09/15 11:55:48.843621 ttdb.go:379: Persisting Template pixm_tmplt
2023/09/15 11:55:48.909071 ttdb.go:385: Persisted Template pixm_tmplt
2023/09/15 11:55:48.909222 ttdb.go:366: Persisted Template pixm_tmplt.html
2023/09/15 11:55:48.969378 ttdb.go:379: Persisting Template subscriptions2t_tmplt
2023/09/15 11:55:49.034262 ttdb.go:385: Persisted Template subscriptions2t_tmplt
2023/09/15 11:55:49.034417 ttdb.go:366: Persisted Template subscriptions2t_tmplt.html
2023/09/15 11:55:49.094287 ttdb.go:379: Persisting Template codemaps2t_tmplt
2023/09/15 11:55:49.159984 ttdb.go:385: Persisted Template codemaps2t_tmplt
2023/09/15 11:55:49.160137 ttdb.go:366: Persisted Template codemaps2t_tmplt.html
2023/09/15 11:55:49.219166 ttdb.go:379: Persisting Template mhdpublish_tmplt
2023/09/15 11:55:49.287571 ttdb.go:385: Persisted Template mhdpublish_tmplt
2023/09/15 11:55:49.287714 ttdb.go:366: Persisted Template mhdpublish_tmplt.json
2023/09/15 11:55:49.346433 ttdb.go:379: Persisting Template events_tmplt
2023/09/15 11:55:49.410488 ttdb.go:385: Persisted Template events_tmplt
2023/09/15 11:55:49.410714 ttdb.go:366: Persisted Template events_tmplt.html
2023/09/15 11:55:49.470248 ttdb.go:379: Persisting Template uploadfile2t_tmplt
2023/09/15 11:55:49.531048 ttdb.go:385: Persisted Template uploadfile2t_tmplt
2023/09/15 11:55:49.531204 ttdb.go:366: Persisted Template uploadfile2t_tmplt.html
2023/09/15 11:55:49.531464 ttserver.go:40: Starting ICB Workflow Service. Service Endpoint http://MacBook-Pro-3.lan:8080/
2023/09/15 11:55:53.394759 ttgethandler.go:10: Processing new GET Request
2023/09/15 11:55:53.394970 ttproxy.go:138: 	Request Query Params
2023/09/15 11:55:53.395321 ttutil.go:140: 	{
  "User": "ian.thomas",
  "Org": "2tsolutions",
  "Role": "clinical",
  "Nhs": "9000000009"
}
2023/09/15 11:55:53.395357 ttgethandler.go:15: Path = /beta/spa/consumer/patient
2023/09/15 11:55:53.395398 tttmplts.go:37: CGL Worker starting
2023/09/15 11:55:53.395397 tttmplts.go:30: PIXm Worker starting
2023/09/15 11:55:53.395898 tthttp.go:15: Creating PIXm PDQ - Server URL http://lac-demo-01.tianispirit.co.uk:8081/SpiritPIXFhir/r4/Patient?identifier=2.16.840.1.113883.2.1.4.1%7C9000000009
2023/09/15 11:55:53.397011 tthttp.go:160: Request Headers 
map[Content-Type:[application/json]]
2023/09/15 11:55:53.397080 tthttp.go:160: Request Headers 
map[Accept:[application/json] X-Api-Key:[FNhb#OhxWiEiMdf+@6085k5Zmt] X-Api-Secret:[9710ea0fb4ffb5d56c2e62c71c30bdfhjsyr56a79d]]
2023/09/15 11:55:53.596050 tthttp.go:174: Server Response - Status Code 404 
{"errors":[{"message":"No clients matching nhs number 9000000009","path":"\/"}],"status":404}
2023/09/15 11:55:53.599920 ttutil.go:140: 	{
  "data": {
    "client": {
      "basicDetails": {
        "address": {},
        "name": {}
      },
      "bbvInformation": {},
      "drugTestResults": {
        "results": {}
      },
      "riskInformation": {
        "mentalHealthDomain": {},
        "riskOfHarmToSelfDomain": {},
        "socialDomain": {},
        "substanceMisuseDomain": {}
      },
      "safeguardingInformation": {}
    },
    "keyWorker": {
      "name": {}
    }
  }
}
2023/09/15 11:55:53.600060 tttmplts.go:39: CGL Worker done
2023/09/15 11:55:53.600095 tttmplts.go:40: CGL Worker Status Code 404
2023/09/15 11:55:58.397542 tthttp.go:174: Server Response - Status Code 0 
2023/09/15 11:55:58.401465 tttmplts.go:32: PIXm Worker done
2023/09/15 11:55:58.401546 tttmplts.go:33: PIXm Worker Status Code 408
2023/09/15 11:55:58.401976 tthttp.go:56: Creating PDS Search Request - Server URL https://sandbox.api.service.nhs.uk/personal-demographics/FHIR/R4/Patient/9000000009
2023/09/15 11:55:58.402266 tthttp.go:160: Request Headers 
map[Accept:[*/*] Content-Type:[application/json] X-Request-Id:[27b23078-b22b-446a-8fc8-c9b96f965777]]
2023/09/15 11:55:58.539467 tthttp.go:174: Server Response - Status Code 200 
{"resourceType":"Patient","id":"9000000009","identifier":[{"system":"https://fhir.nhs.uk/Id/nhs-number","value":"9000000009","extension":[{"url":"https://fhir.hl7.org.uk/StructureDefinition/Extension-UKCore-NHSNumberVerificationStatus","valueCodeableConcept":{"coding":[{"system":"https://fhir.hl7.org.uk/CodeSystem/UKCore-NHSNumberVerificationStatus","version":"1.0.0","code":"01","display":"Number present and verified"}]}}]}],"meta":{"versionId":"2","security":[{"system":"http://terminology.hl7.org/CodeSystem/v3-Confidentiality","code":"U","display":"unrestricted"}]},"name":[{"id":"123","use":"usual","period":{"start":"2020-01-01","end":"2021-12-31"},"given":["Jane"],"family":"Smith","prefix":["Mrs"],"suffix":["MBE"]}],"gender":"female","birthDate":"2010-10-22","multipleBirthInteger":1,"deceasedDateTime":"2010-10-22T00:00:00+00:00","generalPractitioner":[{"id":"254406A3","type":"Organization","identifier":{"system":"https://fhir.nhs.uk/Id/ods-organization-code","value":"Y12345","period":{"start":"2020-01-01","end":"2021-12-31"}}}],"managingOrganization":{"type":"Organization","identifier":{"system":"https://fhir.nhs.uk/Id/ods-organization-code","value":"Y12345","period":{"start":"2020-01-01","end":"2021-12-31"}}},"extension":[{"url":"https://fhir.hl7.org.uk/StructureDefinition/Extension-UKCore-NominatedPharmacy","valueReference":{"identifier":{"system":"https://fhir.nhs.uk/Id/ods-organization-code","value":"Y12345"}}},{"url":"https://fhir.hl7.org.uk/StructureDefinition/Extension-UKCore-PreferredDispenserOrganization","valueReference":{"identifier":{"system":"https://fhir.nhs.uk/Id/ods-organization-code","value":"Y23456"}}},{"url":"https://fhir.hl7.org.uk/StructureDefinition/Extension-UKCore-MedicalApplianceSupplier","valueReference":{"identifier":{"system":"https://fhir.nhs.uk/Id/ods-organization-code","value":"Y34567"}}},{"url":"https://fhir.hl7.org.uk/StructureDefinition/Extension-UKCore-DeathNotificationStatus","extension":[{"url":"deathNotificationStatus","valueCodeableConcept":{"coding":[{"system":"https://fhir.hl7.org.uk/CodeSystem/UKCore-DeathNotificationStatus","version":"1.0.0","code":"2","display":"Formal - death notice received from Registrar of Deaths"}]}},{"url":"systemEffectiveDate","valueDateTime":"2010-10-22T00:00:00+00:00"}]},{"url":"https://fhir.hl7.org.uk/StructureDefinition/Extension-UKCore-NHSCommunication","extension":[{"url":"language","valueCodeableConcept":{"coding":[{"system":"https://fhir.hl7.org.uk/CodeSystem/UKCore-HumanLanguage","version":"1.0.0","code":"fr","display":"French"}]}},{"url":"interpreterRequired","valueBoolean":true}]},{"url":"https://fhir.hl7.org.uk/StructureDefinition/Extension-UKCore-ContactPreference","extension":[{"url":"PreferredWrittenCommunicationFormat","valueCodeableConcept":{"coding":[{"system":"https://fhir.hl7.org.uk/CodeSystem/UKCore-PreferredWrittenCommunicationFormat","code":"12","display":"Braille"}]}},{"url":"PreferredContactMethod","valueCodeableConcept":{"coding":[{"system":"https://fhir.hl7.org.uk/CodeSystem/UKCore-PreferredContactMethod","code":"1","display":"Letter"}]}},{"url":"PreferredContactTimes","valueString":"Not after 7pm"}]},{"url":"http://hl7.org/fhir/StructureDefinition/patient-birthPlace","valueAddress":{"city":"Manchester","district":"Greater Manchester","country":"GBR"}},{"url":"https://fhir.nhs.uk/StructureDefinition/Extension-PDS-RemovalFromRegistration","extension":[{"url":"removalFromRegistrationCode","valueCodeableConcept":{"coding":[{"system":"https://fhir.nhs.uk/CodeSystem/PDS-RemovalReasonExitCode","code":"SCT","display":"Transferred to Scotland"}]}},{"url":"effectiveTime","valuePeriod":{"start":"2020-01-01T00:00:00+00:00","end":"2021-12-31T00:00:00+00:00"}}]}],"telecom":[{"id":"789","period":{"start":"2020-01-01","end":"2021-12-31"},"system":"phone","value":"01632960587","use":"home"},{"id":"790","period":{"start":"2019-01-01","end":"2022-12-31"},"system":"email","value":"jane.smith@example.com","use":"home"},{"id":"OC789","period":{"start":"2020-01-01","end":"2021-12-31"},"system":"other","value":"01632960587","use":"home","extension":[{"url":"https://fhir.hl7.org.uk/StructureDefinition/Extension-UKCore-OtherContactSystem","valueCoding":{"system":"https://fhir.hl7.org.uk/CodeSystem/UKCore-OtherContactSystem","code":"textphone","display":"Minicom (Textphone)"}}]}],"contact":[{"id":"C123","period":{"start":"2020-01-01","end":"2021-12-31"},"relationship":[{"coding":[{"system":"http://terminology.hl7.org/CodeSystem/v2-0131","code":"C","display":"Emergency Contact"}]}],"telecom":[{"system":"phone","value":"01632960587"}]}],"address":[{"id":"456","period":{"start":"2020-01-01","end":"2021-12-31"},"use":"home","line":["1 Trevelyan Square","Boar Lane","City Centre","Leeds","West Yorkshire"],"postalCode":"LS1 6AE","extension":[{"url":"https://fhir.hl7.org.uk/StructureDefinition/Extension-UKCore-AddressKey","extension":[{"url":"type","valueCoding":{"system":"https://fhir.hl7.org.uk/CodeSystem/UKCore-AddressKeyType","code":"PAF"}},{"url":"value","valueString":"12345678"}]},{"url":"https://fhir.hl7.org.uk/StructureDefinition/Extension-UKCore-AddressKey","extension":[{"url":"type","valueCoding":{"system":"https://fhir.hl7.org.uk/CodeSystem/UKCore-AddressKeyType","code":"UPRN"}},{"url":"value","valueString":"123456789012"}]}]},{"id":"T456","period":{"start":"2020-01-01","end":"2021-12-31"},"use":"temp","text":"Student Accommodation","line":["1 Trevelyan Square","Boar Lane","City Centre","Leeds","West Yorkshire"],"postalCode":"LS1 6AE","extension":[{"url":"https://fhir.hl7.org.uk/StructureDefinition/Extension-UKCore-AddressKey","extension":[{"url":"type","valueCoding":{"system":"https://fhir.hl7.org.uk/CodeSystem/UKCore-AddressKeyType","code":"PAF"}},{"url":"value","valueString":"12345678"}]},{"url":"https://fhir.hl7.org.uk/StructureDefinition/Extension-UKCore-AddressKey","extension":[{"url":"type","valueCoding":{"system":"https://fhir.hl7.org.uk/CodeSystem/UKCore-AddressKeyType","code":"UPRN"}},{"url":"value","valueString":"123456789012"}]}]}]}
2023/09/15 11:55:58.717815 tttmplts.go:100: Caching 24 Templates
2023/09/15 11:55:58.726462 tttmplts.go:87: Processing Template allpatientSrvs_tmplt
2023/09/15 11:55:58.731365 ttproxy.go:149: Response Status Code 200
2023/09/15 11:57:20.959401 ttserver.go:52: ICB Workflow Service stopped
2023/09/15 11:57:23.606284 ttutil.go:133: -----------------------------------------------------------------------------------
2023/09/15 11:57:23.606770 ttdb.go:51: Opening DB Connection to mysql instance
User: root
Host: tuk.coil1nnpqdlr.eu-west-1.rds.amazonaws.com
Port: :3306
Name: tuk
Connect Timeout 2s
Read Timeout 5s
2023/09/15 11:57:23.606902 ttdb.go:54: Opened Database
2023/09/15 11:57:23.929772 ttdb.go:379: Persisting Template dsubcancel_tmplt
2023/09/15 11:57:24.049042 ttdb.go:385: Persisted Template dsubcancel_tmplt
2023/09/15 11:57:24.049121 ttdb.go:366: Persisted Template dsubcancel_tmplt.xml
2023/09/15 11:57:24.150585 ttdb.go:379: Persisting Template cgl_tmplt
2023/09/15 11:57:24.357084 ttdb.go:385: Persisted Template cgl_tmplt
2023/09/15 11:57:24.357283 ttdb.go:366: Persisted Template cgl_tmplt.html
2023/09/15 11:57:24.463642 ttdb.go:379: Persisting Template pdssearch_tmplt
2023/09/15 11:57:24.605959 ttdb.go:385: Persisted Template pdssearch_tmplt
2023/09/15 11:57:24.606186 ttdb.go:366: Persisted Template pdssearch_tmplt.html
2023/09/15 11:57:24.755596 ttdb.go:379: Persisting Template dsubsubscribe_tmplt
2023/09/15 11:57:24.876730 ttdb.go:385: Persisted Template dsubsubscribe_tmplt
2023/09/15 11:57:24.876945 ttdb.go:366: Persisted Template dsubsubscribe_tmplt.xml
2023/09/15 11:57:24.947032 ttdb.go:379: Persisting Template notification_tmplt
2023/09/15 11:57:25.012558 ttdb.go:385: Persisted Template notification_tmplt
2023/09/15 11:57:25.012740 ttdb.go:366: Persisted Template notification_tmplt.txt
2023/09/15 11:57:25.079160 ttdb.go:379: Persisting Template wfstate2t_tmplt
2023/09/15 11:57:25.197797 ttdb.go:385: Persisted Template wfstate2t_tmplt
2023/09/15 11:57:25.197833 ttdb.go:366: Persisted Template wfstate2t_tmplt.html
2023/09/15 11:57:25.261698 ttdb.go:379: Persisting Template publishfile2t_tmplt
2023/09/15 11:57:25.326760 ttdb.go:385: Persisted Template publishfile2t_tmplt
2023/09/15 11:57:25.326829 ttdb.go:366: Persisted Template publishfile2t_tmplt.html
2023/09/15 11:57:25.392687 ttdb.go:379: Persisting Template react_tmplt
2023/09/15 11:57:25.458358 ttdb.go:385: Persisted Template react_tmplt
2023/09/15 11:57:25.458487 ttdb.go:366: Persisted Template react_tmplt.html
2023/09/15 11:57:25.524070 ttdb.go:379: Persisting Template pdsretrieve_tmplt
2023/09/15 11:57:25.593455 ttdb.go:385: Persisted Template pdsretrieve_tmplt
2023/09/15 11:57:25.593591 ttdb.go:366: Persisted Template pdsretrieve_tmplt.html
2023/09/15 11:57:25.659809 ttdb.go:379: Persisting Template allpatientSrvs_tmplt
2023/09/15 11:57:25.726355 ttdb.go:385: Persisted Template allpatientSrvs_tmplt
2023/09/15 11:57:25.726511 ttdb.go:366: Persisted Template allpatientSrvs_tmplt.html
2023/09/15 11:57:25.790806 ttdb.go:379: Persisting Template spa2t_tmplt
2023/09/15 11:57:25.869970 ttdb.go:385: Persisted Template spa2t_tmplt
2023/09/15 11:57:25.870121 ttdb.go:366: Persisted Template spa2t_tmplt.html
2023/09/15 11:57:25.933971 ttdb.go:379: Persisting Template xdw2t_tmplt
2023/09/15 11:57:26.015457 ttdb.go:385: Persisted Template xdw2t_tmplt
2023/09/15 11:57:26.015598 ttdb.go:366: Persisted Template xdw2t_tmplt.html
2023/09/15 11:57:26.080206 ttdb.go:379: Persisting Template spaheader2t_tmplt
2023/09/15 11:57:26.151965 ttdb.go:385: Persisted Template spaheader2t_tmplt
2023/09/15 11:57:26.152101 ttdb.go:366: Persisted Template spaheader2t_tmplt.html
2023/09/15 11:57:26.217834 ttdb.go:379: Persisting Template pds_tmplt
2023/09/15 11:57:26.282579 ttdb.go:385: Persisted Template pds_tmplt
2023/09/15 11:57:26.282717 ttdb.go:366: Persisted Template pds_tmplt.html
2023/09/15 11:57:26.347968 ttdb.go:379: Persisting Template error_tmplt
2023/09/15 11:57:26.416603 ttdb.go:385: Persisted Template error_tmplt
2023/09/15 11:57:26.416747 ttdb.go:366: Persisted Template error_tmplt.html
2023/09/15 11:57:26.481502 ttdb.go:379: Persisting Template dsuback_tmplt
2023/09/15 11:57:26.546761 ttdb.go:385: Persisted Template dsuback_tmplt
2023/09/15 11:57:26.546885 ttdb.go:366: Persisted Template dsuback_tmplt.xml
2023/09/15 11:57:26.613331 ttdb.go:379: Persisting Template pixm_tmplt
2023/09/15 11:57:26.682751 ttdb.go:385: Persisted Template pixm_tmplt
2023/09/15 11:57:26.682936 ttdb.go:366: Persisted Template pixm_tmplt.html
2023/09/15 11:57:26.750427 ttdb.go:379: Persisting Template subscriptions2t_tmplt
2023/09/15 11:57:26.817900 ttdb.go:385: Persisted Template subscriptions2t_tmplt
2023/09/15 11:57:26.818071 ttdb.go:366: Persisted Template subscriptions2t_tmplt.html
2023/09/15 11:57:26.882637 ttdb.go:379: Persisting Template codemaps2t_tmplt
2023/09/15 11:57:26.952165 ttdb.go:385: Persisted Template codemaps2t_tmplt
2023/09/15 11:57:26.952315 ttdb.go:366: Persisted Template codemaps2t_tmplt.html
2023/09/15 11:57:27.017134 ttdb.go:379: Persisting Template mhdpublish_tmplt
2023/09/15 11:57:27.088201 ttdb.go:385: Persisted Template mhdpublish_tmplt
2023/09/15 11:57:27.088236 ttdb.go:366: Persisted Template mhdpublish_tmplt.json
2023/09/15 11:57:27.153262 ttdb.go:379: Persisting Template events_tmplt
2023/09/15 11:57:27.224097 ttdb.go:385: Persisted Template events_tmplt
2023/09/15 11:57:27.224228 ttdb.go:366: Persisted Template events_tmplt.html
2023/09/15 11:57:27.289621 ttdb.go:379: Persisting Template uploadfile2t_tmplt
2023/09/15 11:57:27.363822 ttdb.go:385: Persisted Template uploadfile2t_tmplt
2023/09/15 11:57:27.363981 ttdb.go:366: Persisted Template uploadfile2t_tmplt.html
2023/09/15 11:57:27.364378 ttserver.go:40: Starting ICB Workflow Service. Service Endpoint http://MacBook-Pro-3.lan:8080/
2023/09/15 11:57:30.544742 ttgethandler.go:10: Processing new GET Request
2023/09/15 11:57:30.544957 ttproxy.go:138: 	Request Query Params
2023/09/15 11:57:30.545319 ttutil.go:140: 	{
  "User": "ian.thomas",
  "Org": "2tsolutions",
  "Role": "clinical",
  "Nhs": "9000000009"
}
2023/09/15 11:57:30.545365 ttgethandler.go:15: Path = /beta/spa/consumer/patient
2023/09/15 11:57:30.545422 tttmplts.go:37: CGL Worker starting
2023/09/15 11:57:30.545418 tttmplts.go:30: PIXm Worker starting
2023/09/15 11:57:30.545903 tthttp.go:15: Creating PIXm PDQ - Server URL http://lac-demo-01.tianispirit.co.uk:8081/SpiritPIXFhir/r4/Patient?identifier=2.16.840.1.113883.2.1.4.1%7C9000000009
2023/09/15 11:57:30.548759 tthttp.go:160: Request Headers 
map[Content-Type:[application/json]]
2023/09/15 11:57:30.548801 tthttp.go:160: Request Headers 
map[Accept:[application/json] X-Api-Key:[FNhb#OhxWiEiMdf+@6085k5Zmt] X-Api-Secret:[9710ea0fb4ffb5d56c2e62c71c30bdfhjsyr56a79d]]
2023/09/15 11:57:30.937588 tthttp.go:174: Server Response - Status Code 404 
{"errors":[{"message":"No clients matching nhs number 9000000009","path":"\/"}],"status":404}
2023/09/15 11:57:30.945963 ttutil.go:140: 	{
  "data": {
    "client": {
      "basicDetails": {
        "address": {},
        "name": {}
      },
      "bbvInformation": {},
      "drugTestResults": {
        "results": {}
      },
      "riskInformation": {
        "mentalHealthDomain": {},
        "riskOfHarmToSelfDomain": {},
        "socialDomain": {},
        "substanceMisuseDomain": {}
      },
      "safeguardingInformation": {}
    },
    "keyWorker": {
      "name": {}
    }
  }
}
2023/09/15 11:57:30.946074 tttmplts.go:39: CGL Worker done
2023/09/15 11:57:30.946131 tttmplts.go:40: CGL Worker Status Code 404
2023/09/15 11:57:35.548530 tthttp.go:174: Server Response - Status Code 0 
2023/09/15 11:57:35.548985 tttmplts.go:32: PIXm Worker done
2023/09/15 11:57:35.549071 tttmplts.go:33: PIXm Worker Status Code 408
2023/09/15 11:57:35.549433 tthttp.go:56: Creating PDS Search Request - Server URL https://sandbox.api.service.nhs.uk/personal-demographics/FHIR/R4/Patient/9000000009
2023/09/15 11:57:35.549674 tthttp.go:160: Request Headers 
map[Accept:[*/*] Content-Type:[application/json] X-Request-Id:[396d395e-912d-497a-95c1-28fed4cfd950]]
2023/09/15 11:57:35.693592 tthttp.go:174: Server Response - Status Code 200 
{"resourceType":"Patient","id":"9000000009","identifier":[{"system":"https://fhir.nhs.uk/Id/nhs-number","value":"9000000009","extension":[{"url":"https://fhir.hl7.org.uk/StructureDefinition/Extension-UKCore-NHSNumberVerificationStatus","valueCodeableConcept":{"coding":[{"system":"https://fhir.hl7.org.uk/CodeSystem/UKCore-NHSNumberVerificationStatus","version":"1.0.0","code":"01","display":"Number present and verified"}]}}]}],"meta":{"versionId":"2","security":[{"system":"http://terminology.hl7.org/CodeSystem/v3-Confidentiality","code":"U","display":"unrestricted"}]},"name":[{"id":"123","use":"usual","period":{"start":"2020-01-01","end":"2021-12-31"},"given":["Jane"],"family":"Smith","prefix":["Mrs"],"suffix":["MBE"]}],"gender":"female","birthDate":"2010-10-22","multipleBirthInteger":1,"deceasedDateTime":"2010-10-22T00:00:00+00:00","generalPractitioner":[{"id":"254406A3","type":"Organization","identifier":{"system":"https://fhir.nhs.uk/Id/ods-organization-code","value":"Y12345","period":{"start":"2020-01-01","end":"2021-12-31"}}}],"managingOrganization":{"type":"Organization","identifier":{"system":"https://fhir.nhs.uk/Id/ods-organization-code","value":"Y12345","period":{"start":"2020-01-01","end":"2021-12-31"}}},"extension":[{"url":"https://fhir.hl7.org.uk/StructureDefinition/Extension-UKCore-NominatedPharmacy","valueReference":{"identifier":{"system":"https://fhir.nhs.uk/Id/ods-organization-code","value":"Y12345"}}},{"url":"https://fhir.hl7.org.uk/StructureDefinition/Extension-UKCore-PreferredDispenserOrganization","valueReference":{"identifier":{"system":"https://fhir.nhs.uk/Id/ods-organization-code","value":"Y23456"}}},{"url":"https://fhir.hl7.org.uk/StructureDefinition/Extension-UKCore-MedicalApplianceSupplier","valueReference":{"identifier":{"system":"https://fhir.nhs.uk/Id/ods-organization-code","value":"Y34567"}}},{"url":"https://fhir.hl7.org.uk/StructureDefinition/Extension-UKCore-DeathNotificationStatus","extension":[{"url":"deathNotificationStatus","valueCodeableConcept":{"coding":[{"system":"https://fhir.hl7.org.uk/CodeSystem/UKCore-DeathNotificationStatus","version":"1.0.0","code":"2","display":"Formal - death notice received from Registrar of Deaths"}]}},{"url":"systemEffectiveDate","valueDateTime":"2010-10-22T00:00:00+00:00"}]},{"url":"https://fhir.hl7.org.uk/StructureDefinition/Extension-UKCore-NHSCommunication","extension":[{"url":"language","valueCodeableConcept":{"coding":[{"system":"https://fhir.hl7.org.uk/CodeSystem/UKCore-HumanLanguage","version":"1.0.0","code":"fr","display":"French"}]}},{"url":"interpreterRequired","valueBoolean":true}]},{"url":"https://fhir.hl7.org.uk/StructureDefinition/Extension-UKCore-ContactPreference","extension":[{"url":"PreferredWrittenCommunicationFormat","valueCodeableConcept":{"coding":[{"system":"https://fhir.hl7.org.uk/CodeSystem/UKCore-PreferredWrittenCommunicationFormat","code":"12","display":"Braille"}]}},{"url":"PreferredContactMethod","valueCodeableConcept":{"coding":[{"system":"https://fhir.hl7.org.uk/CodeSystem/UKCore-PreferredContactMethod","code":"1","display":"Letter"}]}},{"url":"PreferredContactTimes","valueString":"Not after 7pm"}]},{"url":"http://hl7.org/fhir/StructureDefinition/patient-birthPlace","valueAddress":{"city":"Manchester","district":"Greater Manchester","country":"GBR"}},{"url":"https://fhir.nhs.uk/StructureDefinition/Extension-PDS-RemovalFromRegistration","extension":[{"url":"removalFromRegistrationCode","valueCodeableConcept":{"coding":[{"system":"https://fhir.nhs.uk/CodeSystem/PDS-RemovalReasonExitCode","code":"SCT","display":"Transferred to Scotland"}]}},{"url":"effectiveTime","valuePeriod":{"start":"2020-01-01T00:00:00+00:00","end":"2021-12-31T00:00:00+00:00"}}]}],"telecom":[{"id":"789","period":{"start":"2020-01-01","end":"2021-12-31"},"system":"phone","value":"01632960587","use":"home"},{"id":"790","period":{"start":"2019-01-01","end":"2022-12-31"},"system":"email","value":"jane.smith@example.com","use":"home"},{"id":"OC789","period":{"start":"2020-01-01","end":"2021-12-31"},"system":"other","value":"01632960587","use":"home","extension":[{"url":"https://fhir.hl7.org.uk/StructureDefinition/Extension-UKCore-OtherContactSystem","valueCoding":{"system":"https://fhir.hl7.org.uk/CodeSystem/UKCore-OtherContactSystem","code":"textphone","display":"Minicom (Textphone)"}}]}],"contact":[{"id":"C123","period":{"start":"2020-01-01","end":"2021-12-31"},"relationship":[{"coding":[{"system":"http://terminology.hl7.org/CodeSystem/v2-0131","code":"C","display":"Emergency Contact"}]}],"telecom":[{"system":"phone","value":"01632960587"}]}],"address":[{"id":"456","period":{"start":"2020-01-01","end":"2021-12-31"},"use":"home","line":["1 Trevelyan Square","Boar Lane","City Centre","Leeds","West Yorkshire"],"postalCode":"LS1 6AE","extension":[{"url":"https://fhir.hl7.org.uk/StructureDefinition/Extension-UKCore-AddressKey","extension":[{"url":"type","valueCoding":{"system":"https://fhir.hl7.org.uk/CodeSystem/UKCore-AddressKeyType","code":"PAF"}},{"url":"value","valueString":"12345678"}]},{"url":"https://fhir.hl7.org.uk/StructureDefinition/Extension-UKCore-AddressKey","extension":[{"url":"type","valueCoding":{"system":"https://fhir.hl7.org.uk/CodeSystem/UKCore-AddressKeyType","code":"UPRN"}},{"url":"value","valueString":"123456789012"}]}]},{"id":"T456","period":{"start":"2020-01-01","end":"2021-12-31"},"use":"temp","text":"Student Accommodation","line":["1 Trevelyan Square","Boar Lane","City Centre","Leeds","West Yorkshire"],"postalCode":"LS1 6AE","extension":[{"url":"https://fhir.hl7.org.uk/StructureDefinition/Extension-UKCore-AddressKey","extension":[{"url":"type","valueCoding":{"system":"https://fhir.hl7.org.uk/CodeSystem/UKCore-AddressKeyType","code":"PAF"}},{"url":"value","valueString":"12345678"}]},{"url":"https://fhir.hl7.org.uk/StructureDefinition/Extension-UKCore-AddressKey","extension":[{"url":"type","valueCoding":{"system":"https://fhir.hl7.org.uk/CodeSystem/UKCore-AddressKeyType","code":"UPRN"}},{"url":"value","valueString":"123456789012"}]}]}]}
2023/09/15 11:57:35.890007 tttmplts.go:100: Caching 24 Templates
2023/09/15 11:57:35.900963 tttmplts.go:87: Processing Template allpatientSrvs_tmplt
2023/09/15 11:57:35.905807 ttproxy.go:149: Response Status Code 200
2023/09/15 12:00:18.658814 ttserver.go:52: ICB Workflow Service stopped
