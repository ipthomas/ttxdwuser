2023/09/15 17:07:52.152167 ttutil.go:133: -----------------------------------------------------------------------------------
2023/09/15 17:07:52.152536 ttdb.go:51: Opening DB Connection to mysql instance
User: root
Host: tuk.coil1nnpqdlr.eu-west-1.rds.amazonaws.com
Port: :3306
Name: tuk
Connect Timeout 2s
Read Timeout 5s
2023/09/15 17:07:52.152646 ttdb.go:54: Opened Database
2023/09/15 17:07:52.368235 ttdb.go:379: Persisting Template dsubcancel_tmplt
2023/09/15 17:07:52.433027 ttdb.go:385: Persisted Template dsubcancel_tmplt
2023/09/15 17:07:52.433093 ttdb.go:366: Persisted Template dsubcancel_tmplt.xml
2023/09/15 17:07:52.496886 ttdb.go:379: Persisting Template cgl_tmplt
2023/09/15 17:07:52.592236 ttdb.go:385: Persisted Template cgl_tmplt
2023/09/15 17:07:52.592311 ttdb.go:366: Persisted Template cgl_tmplt.html
2023/09/15 17:07:52.655403 ttdb.go:379: Persisting Template pdssearch_tmplt
2023/09/15 17:07:52.722332 ttdb.go:385: Persisted Template pdssearch_tmplt
2023/09/15 17:07:52.722486 ttdb.go:366: Persisted Template pdssearch_tmplt.html
2023/09/15 17:07:52.785682 ttdb.go:379: Persisting Template dsubsubscribe_tmplt
2023/09/15 17:07:52.848826 ttdb.go:385: Persisted Template dsubsubscribe_tmplt
2023/09/15 17:07:52.848883 ttdb.go:366: Persisted Template dsubsubscribe_tmplt.xml
2023/09/15 17:07:52.912894 ttdb.go:379: Persisting Template notification_tmplt
2023/09/15 17:07:52.975095 ttdb.go:385: Persisted Template notification_tmplt
2023/09/15 17:07:52.975142 ttdb.go:366: Persisted Template notification_tmplt.txt
2023/09/15 17:07:53.040676 ttdb.go:379: Persisting Template wfstate2t_tmplt
2023/09/15 17:07:53.164183 ttdb.go:385: Persisted Template wfstate2t_tmplt
2023/09/15 17:07:53.164228 ttdb.go:366: Persisted Template wfstate2t_tmplt.html
2023/09/15 17:07:53.232541 ttdb.go:379: Persisting Template publishfile2t_tmplt
2023/09/15 17:07:53.298073 ttdb.go:385: Persisted Template publishfile2t_tmplt
2023/09/15 17:07:53.298232 ttdb.go:366: Persisted Template publishfile2t_tmplt.html
2023/09/15 17:07:53.360431 ttdb.go:379: Persisting Template react_tmplt
2023/09/15 17:07:53.421793 ttdb.go:385: Persisted Template react_tmplt
2023/09/15 17:07:53.421819 ttdb.go:366: Persisted Template react_tmplt.html
2023/09/15 17:07:53.487974 ttdb.go:379: Persisting Template pdsretrieve_tmplt
2023/09/15 17:07:53.554557 ttdb.go:385: Persisted Template pdsretrieve_tmplt
2023/09/15 17:07:53.554705 ttdb.go:366: Persisted Template pdsretrieve_tmplt.html
2023/09/15 17:07:53.618704 ttdb.go:379: Persisting Template allpatientSrvs_tmplt
2023/09/15 17:07:53.682706 ttdb.go:385: Persisted Template allpatientSrvs_tmplt
2023/09/15 17:07:53.682739 ttdb.go:366: Persisted Template allpatientSrvs_tmplt.html
2023/09/15 17:07:53.745828 ttdb.go:379: Persisting Template spa2t_tmplt
2023/09/15 17:07:53.822247 ttdb.go:385: Persisted Template spa2t_tmplt
2023/09/15 17:07:53.822327 ttdb.go:366: Persisted Template spa2t_tmplt.html
2023/09/15 17:07:53.885715 ttdb.go:379: Persisting Template xdw2t_tmplt
2023/09/15 17:07:53.966248 ttdb.go:385: Persisted Template xdw2t_tmplt
2023/09/15 17:07:53.966306 ttdb.go:366: Persisted Template xdw2t_tmplt.html
2023/09/15 17:07:54.029173 ttdb.go:379: Persisting Template spaheader2t_tmplt
2023/09/15 17:07:54.099868 ttdb.go:385: Persisted Template spaheader2t_tmplt
2023/09/15 17:07:54.099959 ttdb.go:366: Persisted Template spaheader2t_tmplt.html
2023/09/15 17:07:54.163053 ttdb.go:379: Persisting Template pds_tmplt
2023/09/15 17:07:54.226639 ttdb.go:385: Persisted Template pds_tmplt
2023/09/15 17:07:54.226703 ttdb.go:366: Persisted Template pds_tmplt.html
2023/09/15 17:07:54.290971 ttdb.go:379: Persisting Template error_tmplt
2023/09/15 17:07:54.353916 ttdb.go:385: Persisted Template error_tmplt
2023/09/15 17:07:54.354081 ttdb.go:366: Persisted Template error_tmplt.html
2023/09/15 17:07:54.418844 ttdb.go:379: Persisting Template dsuback_tmplt
2023/09/15 17:07:54.489185 ttdb.go:385: Persisted Template dsuback_tmplt
2023/09/15 17:07:54.489358 ttdb.go:366: Persisted Template dsuback_tmplt.xml
2023/09/15 17:07:54.553975 ttdb.go:379: Persisting Template pixm_tmplt
2023/09/15 17:07:54.622868 ttdb.go:385: Persisted Template pixm_tmplt
2023/09/15 17:07:54.622992 ttdb.go:366: Persisted Template pixm_tmplt.html
2023/09/15 17:07:54.686077 ttdb.go:379: Persisting Template subscriptions2t_tmplt
2023/09/15 17:07:54.751871 ttdb.go:385: Persisted Template subscriptions2t_tmplt
2023/09/15 17:07:54.752012 ttdb.go:366: Persisted Template subscriptions2t_tmplt.html
2023/09/15 17:07:54.816542 ttdb.go:379: Persisting Template codemaps2t_tmplt
2023/09/15 17:07:54.887106 ttdb.go:385: Persisted Template codemaps2t_tmplt
2023/09/15 17:07:54.887306 ttdb.go:366: Persisted Template codemaps2t_tmplt.html
2023/09/15 17:07:54.952749 ttdb.go:379: Persisting Template mhdpublish_tmplt
2023/09/15 17:07:55.018807 ttdb.go:385: Persisted Template mhdpublish_tmplt
2023/09/15 17:07:55.018843 ttdb.go:366: Persisted Template mhdpublish_tmplt.json
2023/09/15 17:07:55.081698 ttdb.go:379: Persisting Template events_tmplt
2023/09/15 17:07:55.146855 ttdb.go:385: Persisted Template events_tmplt
2023/09/15 17:07:55.146925 ttdb.go:366: Persisted Template events_tmplt.html
2023/09/15 17:07:55.209499 ttdb.go:379: Persisting Template uploadfile2t_tmplt
2023/09/15 17:07:55.274919 ttdb.go:385: Persisted Template uploadfile2t_tmplt
2023/09/15 17:07:55.275019 ttdb.go:366: Persisted Template uploadfile2t_tmplt.html
2023/09/15 17:07:55.275233 ttserver.go:40: Starting ICB Workflow Service. Service Endpoint http://MacBook-Pro-3.lan:8080/
2023/09/15 17:08:00.118973 ttgethandler.go:10: Processing new GET Request
2023/09/15 17:08:00.119073 ttproxy.go:138: 	Request Query Params
2023/09/15 17:08:00.119336 ttutil.go:140: 	{
  "User": "ian.thomas",
  "Org": "2tsolutions",
  "Role": "clinical",
  "Nhs": "9000000009"
}
2023/09/15 17:08:00.119363 ttgethandler.go:15: Path = /beta/spa/consumer/patient
2023/09/15 17:08:00.119389 tttmplts.go:37: CGL Worker starting
2023/09/15 17:08:00.119394 tttmplts.go:30: PIXm Worker starting
2023/09/15 17:08:00.120383 tthttp.go:15: Creating PIXm PDQ - Server URL http://lac-demo-01.tianispirit.co.uk:8081/SpiritPIXFhir/r4/Patient?identifier=2.16.840.1.113883.2.1.4.1%7C9000000009
2023/09/15 17:08:00.123828 tthttp.go:160: Request Headers 
map[Content-Type:[application/json]]
2023/09/15 17:08:00.123864 tthttp.go:160: Request Headers 
map[Accept:[application/json] X-Api-Key:[FNhb#OhxWiEiMdf+@6085k5Zmt] X-Api-Secret:[9710ea0fb4ffb5d56c2e62c71c30bdfhjsyr56a79d]]
2023/09/15 17:08:00.351794 tthttp.go:174: Server Response - Status Code 404 
{"errors":[{"message":"No clients matching nhs number 9000000009","path":"\/"}],"status":404}
2023/09/15 17:08:00.356551 ttutil.go:140: 	{
  "data": {
    "client": {
      "basicDetails": {
        "address": {},
        "name": {}
      },
      "bbvInformation": {},
      "drugTestResults": {
        "results": {}
      },
      "riskInformation": {
        "mentalHealthDomain": {},
        "riskOfHarmToSelfDomain": {},
        "socialDomain": {},
        "substanceMisuseDomain": {}
      },
      "safeguardingInformation": {}
    },
    "keyWorker": {
      "name": {}
    }
  }
}
2023/09/15 17:08:00.356629 tttmplts.go:39: CGL Worker done
2023/09/15 17:08:00.356652 tttmplts.go:40: CGL Worker Status Code 404
2023/09/15 17:08:05.121122 tthttp.go:174: Server Response - Status Code 0 
2023/09/15 17:08:05.121747 tttmplts.go:32: PIXm Worker done
2023/09/15 17:08:05.121844 tttmplts.go:33: PIXm Worker Status Code 408
2023/09/15 17:08:05.122417 tthttp.go:56: Creating PDS Search Request - Server URL https://sandbox.api.service.nhs.uk/personal-demographics/FHIR/R4/Patient/9000000009
2023/09/15 17:08:05.122646 tthttp.go:160: Request Headers 
map[Accept:[*/*] Content-Type:[application/json] X-Request-Id:[dccb55b2-0676-4b48-8ba7-7a6079acdcb9]]
2023/09/15 17:08:05.342354 tthttp.go:174: Server Response - Status Code 200 
{"resourceType":"Patient","id":"9000000009","identifier":[{"system":"https://fhir.nhs.uk/Id/nhs-number","value":"9000000009","extension":[{"url":"https://fhir.hl7.org.uk/StructureDefinition/Extension-UKCore-NHSNumberVerificationStatus","valueCodeableConcept":{"coding":[{"system":"https://fhir.hl7.org.uk/CodeSystem/UKCore-NHSNumberVerificationStatus","version":"1.0.0","code":"01","display":"Number present and verified"}]}}]}],"meta":{"versionId":"2","security":[{"system":"http://terminology.hl7.org/CodeSystem/v3-Confidentiality","code":"U","display":"unrestricted"}]},"name":[{"id":"123","use":"usual","period":{"start":"2020-01-01","end":"2021-12-31"},"given":["Jane"],"family":"Smith","prefix":["Mrs"],"suffix":["MBE"]}],"gender":"female","birthDate":"2010-10-22","multipleBirthInteger":1,"deceasedDateTime":"2010-10-22T00:00:00+00:00","generalPractitioner":[{"id":"254406A3","type":"Organization","identifier":{"system":"https://fhir.nhs.uk/Id/ods-organization-code","value":"Y12345","period":{"start":"2020-01-01","end":"2021-12-31"}}}],"managingOrganization":{"type":"Organization","identifier":{"system":"https://fhir.nhs.uk/Id/ods-organization-code","value":"Y12345","period":{"start":"2020-01-01","end":"2021-12-31"}}},"extension":[{"url":"https://fhir.hl7.org.uk/StructureDefinition/Extension-UKCore-NominatedPharmacy","valueReference":{"identifier":{"system":"https://fhir.nhs.uk/Id/ods-organization-code","value":"Y12345"}}},{"url":"https://fhir.hl7.org.uk/StructureDefinition/Extension-UKCore-PreferredDispenserOrganization","valueReference":{"identifier":{"system":"https://fhir.nhs.uk/Id/ods-organization-code","value":"Y23456"}}},{"url":"https://fhir.hl7.org.uk/StructureDefinition/Extension-UKCore-MedicalApplianceSupplier","valueReference":{"identifier":{"system":"https://fhir.nhs.uk/Id/ods-organization-code","value":"Y34567"}}},{"url":"https://fhir.hl7.org.uk/StructureDefinition/Extension-UKCore-DeathNotificationStatus","extension":[{"url":"deathNotificationStatus","valueCodeableConcept":{"coding":[{"system":"https://fhir.hl7.org.uk/CodeSystem/UKCore-DeathNotificationStatus","version":"1.0.0","code":"2","display":"Formal - death notice received from Registrar of Deaths"}]}},{"url":"systemEffectiveDate","valueDateTime":"2010-10-22T00:00:00+00:00"}]},{"url":"https://fhir.hl7.org.uk/StructureDefinition/Extension-UKCore-NHSCommunication","extension":[{"url":"language","valueCodeableConcept":{"coding":[{"system":"https://fhir.hl7.org.uk/CodeSystem/UKCore-HumanLanguage","version":"1.0.0","code":"fr","display":"French"}]}},{"url":"interpreterRequired","valueBoolean":true}]},{"url":"https://fhir.hl7.org.uk/StructureDefinition/Extension-UKCore-ContactPreference","extension":[{"url":"PreferredWrittenCommunicationFormat","valueCodeableConcept":{"coding":[{"system":"https://fhir.hl7.org.uk/CodeSystem/UKCore-PreferredWrittenCommunicationFormat","code":"12","display":"Braille"}]}},{"url":"PreferredContactMethod","valueCodeableConcept":{"coding":[{"system":"https://fhir.hl7.org.uk/CodeSystem/UKCore-PreferredContactMethod","code":"1","display":"Letter"}]}},{"url":"PreferredContactTimes","valueString":"Not after 7pm"}]},{"url":"http://hl7.org/fhir/StructureDefinition/patient-birthPlace","valueAddress":{"city":"Manchester","district":"Greater Manchester","country":"GBR"}},{"url":"https://fhir.nhs.uk/StructureDefinition/Extension-PDS-RemovalFromRegistration","extension":[{"url":"removalFromRegistrationCode","valueCodeableConcept":{"coding":[{"system":"https://fhir.nhs.uk/CodeSystem/PDS-RemovalReasonExitCode","code":"SCT","display":"Transferred to Scotland"}]}},{"url":"effectiveTime","valuePeriod":{"start":"2020-01-01T00:00:00+00:00","end":"2021-12-31T00:00:00+00:00"}}]}],"telecom":[{"id":"789","period":{"start":"2020-01-01","end":"2021-12-31"},"system":"phone","value":"01632960587","use":"home"},{"id":"790","period":{"start":"2019-01-01","end":"2022-12-31"},"system":"email","value":"jane.smith@example.com","use":"home"},{"id":"OC789","period":{"start":"2020-01-01","end":"2021-12-31"},"system":"other","value":"01632960587","use":"home","extension":[{"url":"https://fhir.hl7.org.uk/StructureDefinition/Extension-UKCore-OtherContactSystem","valueCoding":{"system":"https://fhir.hl7.org.uk/CodeSystem/UKCore-OtherContactSystem","code":"textphone","display":"Minicom (Textphone)"}}]}],"contact":[{"id":"C123","period":{"start":"2020-01-01","end":"2021-12-31"},"relationship":[{"coding":[{"system":"http://terminology.hl7.org/CodeSystem/v2-0131","code":"C","display":"Emergency Contact"}]}],"telecom":[{"system":"phone","value":"01632960587"}]}],"address":[{"id":"456","period":{"start":"2020-01-01","end":"2021-12-31"},"use":"home","line":["1 Trevelyan Square","Boar Lane","City Centre","Leeds","West Yorkshire"],"postalCode":"LS1 6AE","extension":[{"url":"https://fhir.hl7.org.uk/StructureDefinition/Extension-UKCore-AddressKey","extension":[{"url":"type","valueCoding":{"system":"https://fhir.hl7.org.uk/CodeSystem/UKCore-AddressKeyType","code":"PAF"}},{"url":"value","valueString":"12345678"}]},{"url":"https://fhir.hl7.org.uk/StructureDefinition/Extension-UKCore-AddressKey","extension":[{"url":"type","valueCoding":{"system":"https://fhir.hl7.org.uk/CodeSystem/UKCore-AddressKeyType","code":"UPRN"}},{"url":"value","valueString":"123456789012"}]}]},{"id":"T456","period":{"start":"2020-01-01","end":"2021-12-31"},"use":"temp","text":"Student Accommodation","line":["1 Trevelyan Square","Boar Lane","City Centre","Leeds","West Yorkshire"],"postalCode":"LS1 6AE","extension":[{"url":"https://fhir.hl7.org.uk/StructureDefinition/Extension-UKCore-AddressKey","extension":[{"url":"type","valueCoding":{"system":"https://fhir.hl7.org.uk/CodeSystem/UKCore-AddressKeyType","code":"PAF"}},{"url":"value","valueString":"12345678"}]},{"url":"https://fhir.hl7.org.uk/StructureDefinition/Extension-UKCore-AddressKey","extension":[{"url":"type","valueCoding":{"system":"https://fhir.hl7.org.uk/CodeSystem/UKCore-AddressKeyType","code":"UPRN"}},{"url":"value","valueString":"123456789012"}]}]}]}
2023/09/15 17:08:05.530576 tttmplts.go:100: Caching 24 Templates
2023/09/15 17:08:05.542479 tttmplts.go:87: Processing Template allpatientSrvs_tmplt
2023/09/15 17:08:05.547585 ttproxy.go:149: Response Status Code 200
2023/09/15 17:35:49.926500 ttserver.go:52: ICB Workflow Service stopped
2023/09/15 17:35:52.866568 ttutil.go:133: -----------------------------------------------------------------------------------
2023/09/15 17:35:52.867085 ttdb.go:51: Opening DB Connection to mysql instance
User: root
Host: tuk.coil1nnpqdlr.eu-west-1.rds.amazonaws.com
Port: :3306
Name: tuk
Connect Timeout 2s
Read Timeout 5s
2023/09/15 17:35:52.867222 ttdb.go:54: Opened Database
2023/09/15 17:35:53.082189 ttdb.go:379: Persisting Template dsubcancel_tmplt
2023/09/15 17:35:53.150135 ttdb.go:385: Persisted Template dsubcancel_tmplt
2023/09/15 17:35:53.150200 ttdb.go:366: Persisted Template dsubcancel_tmplt.xml
2023/09/15 17:35:53.216996 ttdb.go:379: Persisting Template cgl_tmplt
2023/09/15 17:35:53.318259 ttdb.go:385: Persisted Template cgl_tmplt
2023/09/15 17:35:53.318366 ttdb.go:366: Persisted Template cgl_tmplt.html
2023/09/15 17:35:53.385019 ttdb.go:379: Persisting Template pdssearch_tmplt
2023/09/15 17:35:53.460942 ttdb.go:385: Persisted Template pdssearch_tmplt
2023/09/15 17:35:53.461037 ttdb.go:366: Persisted Template pdssearch_tmplt.html
2023/09/15 17:35:53.527403 ttdb.go:379: Persisting Template dsubsubscribe_tmplt
2023/09/15 17:35:53.594567 ttdb.go:385: Persisted Template dsubsubscribe_tmplt
2023/09/15 17:35:53.594591 ttdb.go:366: Persisted Template dsubsubscribe_tmplt.xml
2023/09/15 17:35:53.658904 ttdb.go:379: Persisting Template notification_tmplt
2023/09/15 17:35:53.726073 ttdb.go:385: Persisted Template notification_tmplt
2023/09/15 17:35:53.726105 ttdb.go:366: Persisted Template notification_tmplt.txt
2023/09/15 17:35:53.794172 ttdb.go:379: Persisting Template wfstate2t_tmplt
2023/09/15 17:35:53.914939 ttdb.go:385: Persisted Template wfstate2t_tmplt
2023/09/15 17:35:53.915038 ttdb.go:366: Persisted Template wfstate2t_tmplt.html
2023/09/15 17:35:53.983308 ttdb.go:379: Persisting Template publishfile2t_tmplt
2023/09/15 17:35:54.050952 ttdb.go:385: Persisted Template publishfile2t_tmplt
2023/09/15 17:35:54.051043 ttdb.go:366: Persisted Template publishfile2t_tmplt.html
2023/09/15 17:35:54.117330 ttdb.go:379: Persisting Template react_tmplt
2023/09/15 17:35:54.184078 ttdb.go:385: Persisted Template react_tmplt
2023/09/15 17:35:54.184212 ttdb.go:366: Persisted Template react_tmplt.html
2023/09/15 17:35:54.252033 ttdb.go:379: Persisting Template pdsretrieve_tmplt
2023/09/15 17:35:54.321973 ttdb.go:385: Persisted Template pdsretrieve_tmplt
2023/09/15 17:35:54.322047 ttdb.go:366: Persisted Template pdsretrieve_tmplt.html
2023/09/15 17:35:54.389500 ttdb.go:379: Persisting Template allpatientSrvs_tmplt
2023/09/15 17:35:54.456781 ttdb.go:385: Persisted Template allpatientSrvs_tmplt
2023/09/15 17:35:54.456853 ttdb.go:366: Persisted Template allpatientSrvs_tmplt.html
2023/09/15 17:35:54.522231 ttdb.go:379: Persisting Template spa2t_tmplt
2023/09/15 17:35:54.599089 ttdb.go:385: Persisted Template spa2t_tmplt
2023/09/15 17:35:54.599144 ttdb.go:366: Persisted Template spa2t_tmplt.html
2023/09/15 17:35:54.665634 ttdb.go:379: Persisting Template xdw2t_tmplt
2023/09/15 17:35:54.744157 ttdb.go:385: Persisted Template xdw2t_tmplt
2023/09/15 17:35:54.744201 ttdb.go:366: Persisted Template xdw2t_tmplt.html
2023/09/15 17:35:54.811145 ttdb.go:379: Persisting Template spaheader2t_tmplt
2023/09/15 17:35:54.885139 ttdb.go:385: Persisted Template spaheader2t_tmplt
2023/09/15 17:35:54.885232 ttdb.go:366: Persisted Template spaheader2t_tmplt.html
2023/09/15 17:35:54.951420 ttdb.go:379: Persisting Template pds_tmplt
2023/09/15 17:35:55.017959 ttdb.go:385: Persisted Template pds_tmplt
2023/09/15 17:35:55.018029 ttdb.go:366: Persisted Template pds_tmplt.html
2023/09/15 17:35:55.085103 ttdb.go:379: Persisting Template error_tmplt
2023/09/15 17:35:55.154670 ttdb.go:385: Persisted Template error_tmplt
2023/09/15 17:35:55.154754 ttdb.go:366: Persisted Template error_tmplt.html
2023/09/15 17:35:55.221738 ttdb.go:379: Persisting Template dsuback_tmplt
2023/09/15 17:35:55.288261 ttdb.go:385: Persisted Template dsuback_tmplt
2023/09/15 17:35:55.288355 ttdb.go:366: Persisted Template dsuback_tmplt.xml
2023/09/15 17:35:55.354282 ttdb.go:379: Persisting Template pixm_tmplt
2023/09/15 17:35:55.426520 ttdb.go:385: Persisted Template pixm_tmplt
2023/09/15 17:35:55.426600 ttdb.go:366: Persisted Template pixm_tmplt.html
2023/09/15 17:35:55.493315 ttdb.go:379: Persisting Template subscriptions2t_tmplt
2023/09/15 17:35:55.564126 ttdb.go:385: Persisted Template subscriptions2t_tmplt
2023/09/15 17:35:55.564179 ttdb.go:366: Persisted Template subscriptions2t_tmplt.html
2023/09/15 17:35:55.630844 ttdb.go:379: Persisting Template codemaps2t_tmplt
2023/09/15 17:35:55.702736 ttdb.go:385: Persisted Template codemaps2t_tmplt
2023/09/15 17:35:55.702824 ttdb.go:366: Persisted Template codemaps2t_tmplt.html
2023/09/15 17:35:55.776522 ttdb.go:379: Persisting Template mhdpublish_tmplt
2023/09/15 17:35:55.853886 ttdb.go:385: Persisted Template mhdpublish_tmplt
2023/09/15 17:35:55.853911 ttdb.go:366: Persisted Template mhdpublish_tmplt.json
2023/09/15 17:35:55.919680 ttdb.go:379: Persisting Template events_tmplt
2023/09/15 17:35:55.991359 ttdb.go:385: Persisted Template events_tmplt
2023/09/15 17:35:55.991390 ttdb.go:366: Persisted Template events_tmplt.html
2023/09/15 17:35:56.056735 ttdb.go:379: Persisting Template uploadfile2t_tmplt
2023/09/15 17:35:56.125694 ttdb.go:385: Persisted Template uploadfile2t_tmplt
2023/09/15 17:35:56.125778 ttdb.go:366: Persisted Template uploadfile2t_tmplt.html
2023/09/15 17:35:56.125930 ttserver.go:40: Starting ICB Workflow Service. Service Endpoint http://MacBook-Pro-3.lan:8080/
2023/09/15 17:36:04.953745 ttgethandler.go:10: Processing new GET Request
2023/09/15 17:36:04.953828 ttproxy.go:138: 	Request Query Params
2023/09/15 17:36:04.954122 ttutil.go:140: 	{
  "User": "ian.thomas",
  "Org": "2tsolutions",
  "Role": "clinical",
  "Nhs": "9000000009"
}
2023/09/15 17:36:04.954153 ttgethandler.go:15: Path = /beta/spa/consumer/patient
2023/09/15 17:36:04.954180 tttmplts.go:37: CGL Worker starting
2023/09/15 17:36:04.954187 tttmplts.go:30: PIXm Worker starting
2023/09/15 17:36:04.954287 tthttp.go:15: Creating PIXm PDQ - Server URL http://lac-demo-01.tianispirit.co.uk:8081/SpiritPIXFhir/r4/Patient?identifier=2.16.840.1.113883.2.1.4.1%7C9000000009
2023/09/15 17:36:04.955669 tthttp.go:160: Request Headers 
map[Accept:[application/json] X-Api-Key:[FNhb#OhxWiEiMdf+@6085k5Zmt] X-Api-Secret:[9710ea0fb4ffb5d56c2e62c71c30bdfhjsyr56a79d]]
2023/09/15 17:36:04.955732 tthttp.go:160: Request Headers 
map[Content-Type:[application/json]]
2023/09/15 17:36:05.727541 tthttp.go:174: Server Response - Status Code 404 
{"errors":[{"message":"No clients matching nhs number 9000000009","path":"\/"}],"status":404}
2023/09/15 17:36:05.730686 ttutil.go:140: 	{
  "data": {
    "client": {
      "basicDetails": {
        "address": {},
        "name": {}
      },
      "bbvInformation": {},
      "drugTestResults": {
        "results": {}
      },
      "riskInformation": {
        "mentalHealthDomain": {},
        "riskOfHarmToSelfDomain": {},
        "socialDomain": {},
        "substanceMisuseDomain": {}
      },
      "safeguardingInformation": {}
    },
    "keyWorker": {
      "name": {}
    }
  }
}
2023/09/15 17:36:05.730754 tttmplts.go:39: CGL Worker done
2023/09/15 17:36:05.730773 tttmplts.go:40: CGL Worker Status Code 404
2023/09/15 17:36:09.955462 tthttp.go:174: Server Response - Status Code 0 
2023/09/15 17:36:09.955641 tttmplts.go:32: PIXm Worker done
2023/09/15 17:36:09.955684 tttmplts.go:33: PIXm Worker Status Code 408
2023/09/15 17:36:09.955912 tthttp.go:56: Creating PDS Search Request - Server URL https://sandbox.api.service.nhs.uk/personal-demographics/FHIR/R4/Patient/9000000009
2023/09/15 17:36:09.955984 tthttp.go:160: Request Headers 
map[Accept:[*/*] Content-Type:[application/json] X-Request-Id:[9871a8d3-3dbb-4e71-88e0-b0ef8ff1a48a]]
2023/09/15 17:36:10.526200 tthttp.go:174: Server Response - Status Code 200 
{"resourceType":"Patient","id":"9000000009","identifier":[{"system":"https://fhir.nhs.uk/Id/nhs-number","value":"9000000009","extension":[{"url":"https://fhir.hl7.org.uk/StructureDefinition/Extension-UKCore-NHSNumberVerificationStatus","valueCodeableConcept":{"coding":[{"system":"https://fhir.hl7.org.uk/CodeSystem/UKCore-NHSNumberVerificationStatus","version":"1.0.0","code":"01","display":"Number present and verified"}]}}]}],"meta":{"versionId":"2","security":[{"system":"http://terminology.hl7.org/CodeSystem/v3-Confidentiality","code":"U","display":"unrestricted"}]},"name":[{"id":"123","use":"usual","period":{"start":"2020-01-01","end":"2021-12-31"},"given":["Jane"],"family":"Smith","prefix":["Mrs"],"suffix":["MBE"]}],"gender":"female","birthDate":"2010-10-22","multipleBirthInteger":1,"deceasedDateTime":"2010-10-22T00:00:00+00:00","generalPractitioner":[{"id":"254406A3","type":"Organization","identifier":{"system":"https://fhir.nhs.uk/Id/ods-organization-code","value":"Y12345","period":{"start":"2020-01-01","end":"2021-12-31"}}}],"managingOrganization":{"type":"Organization","identifier":{"system":"https://fhir.nhs.uk/Id/ods-organization-code","value":"Y12345","period":{"start":"2020-01-01","end":"2021-12-31"}}},"extension":[{"url":"https://fhir.hl7.org.uk/StructureDefinition/Extension-UKCore-NominatedPharmacy","valueReference":{"identifier":{"system":"https://fhir.nhs.uk/Id/ods-organization-code","value":"Y12345"}}},{"url":"https://fhir.hl7.org.uk/StructureDefinition/Extension-UKCore-PreferredDispenserOrganization","valueReference":{"identifier":{"system":"https://fhir.nhs.uk/Id/ods-organization-code","value":"Y23456"}}},{"url":"https://fhir.hl7.org.uk/StructureDefinition/Extension-UKCore-MedicalApplianceSupplier","valueReference":{"identifier":{"system":"https://fhir.nhs.uk/Id/ods-organization-code","value":"Y34567"}}},{"url":"https://fhir.hl7.org.uk/StructureDefinition/Extension-UKCore-DeathNotificationStatus","extension":[{"url":"deathNotificationStatus","valueCodeableConcept":{"coding":[{"system":"https://fhir.hl7.org.uk/CodeSystem/UKCore-DeathNotificationStatus","version":"1.0.0","code":"2","display":"Formal - death notice received from Registrar of Deaths"}]}},{"url":"systemEffectiveDate","valueDateTime":"2010-10-22T00:00:00+00:00"}]},{"url":"https://fhir.hl7.org.uk/StructureDefinition/Extension-UKCore-NHSCommunication","extension":[{"url":"language","valueCodeableConcept":{"coding":[{"system":"https://fhir.hl7.org.uk/CodeSystem/UKCore-HumanLanguage","version":"1.0.0","code":"fr","display":"French"}]}},{"url":"interpreterRequired","valueBoolean":true}]},{"url":"https://fhir.hl7.org.uk/StructureDefinition/Extension-UKCore-ContactPreference","extension":[{"url":"PreferredWrittenCommunicationFormat","valueCodeableConcept":{"coding":[{"system":"https://fhir.hl7.org.uk/CodeSystem/UKCore-PreferredWrittenCommunicationFormat","code":"12","display":"Braille"}]}},{"url":"PreferredContactMethod","valueCodeableConcept":{"coding":[{"system":"https://fhir.hl7.org.uk/CodeSystem/UKCore-PreferredContactMethod","code":"1","display":"Letter"}]}},{"url":"PreferredContactTimes","valueString":"Not after 7pm"}]},{"url":"http://hl7.org/fhir/StructureDefinition/patient-birthPlace","valueAddress":{"city":"Manchester","district":"Greater Manchester","country":"GBR"}},{"url":"https://fhir.nhs.uk/StructureDefinition/Extension-PDS-RemovalFromRegistration","extension":[{"url":"removalFromRegistrationCode","valueCodeableConcept":{"coding":[{"system":"https://fhir.nhs.uk/CodeSystem/PDS-RemovalReasonExitCode","code":"SCT","display":"Transferred to Scotland"}]}},{"url":"effectiveTime","valuePeriod":{"start":"2020-01-01T00:00:00+00:00","end":"2021-12-31T00:00:00+00:00"}}]}],"telecom":[{"id":"789","period":{"start":"2020-01-01","end":"2021-12-31"},"system":"phone","value":"01632960587","use":"home"},{"id":"790","period":{"start":"2019-01-01","end":"2022-12-31"},"system":"email","value":"jane.smith@example.com","use":"home"},{"id":"OC789","period":{"start":"2020-01-01","end":"2021-12-31"},"system":"other","value":"01632960587","use":"home","extension":[{"url":"https://fhir.hl7.org.uk/StructureDefinition/Extension-UKCore-OtherContactSystem","valueCoding":{"system":"https://fhir.hl7.org.uk/CodeSystem/UKCore-OtherContactSystem","code":"textphone","display":"Minicom (Textphone)"}}]}],"contact":[{"id":"C123","period":{"start":"2020-01-01","end":"2021-12-31"},"relationship":[{"coding":[{"system":"http://terminology.hl7.org/CodeSystem/v2-0131","code":"C","display":"Emergency Contact"}]}],"telecom":[{"system":"phone","value":"01632960587"}]}],"address":[{"id":"456","period":{"start":"2020-01-01","end":"2021-12-31"},"use":"home","line":["1 Trevelyan Square","Boar Lane","City Centre","Leeds","West Yorkshire"],"postalCode":"LS1 6AE","extension":[{"url":"https://fhir.hl7.org.uk/StructureDefinition/Extension-UKCore-AddressKey","extension":[{"url":"type","valueCoding":{"system":"https://fhir.hl7.org.uk/CodeSystem/UKCore-AddressKeyType","code":"PAF"}},{"url":"value","valueString":"12345678"}]},{"url":"https://fhir.hl7.org.uk/StructureDefinition/Extension-UKCore-AddressKey","extension":[{"url":"type","valueCoding":{"system":"https://fhir.hl7.org.uk/CodeSystem/UKCore-AddressKeyType","code":"UPRN"}},{"url":"value","valueString":"123456789012"}]}]},{"id":"T456","period":{"start":"2020-01-01","end":"2021-12-31"},"use":"temp","text":"Student Accommodation","line":["1 Trevelyan Square","Boar Lane","City Centre","Leeds","West Yorkshire"],"postalCode":"LS1 6AE","extension":[{"url":"https://fhir.hl7.org.uk/StructureDefinition/Extension-UKCore-AddressKey","extension":[{"url":"type","valueCoding":{"system":"https://fhir.hl7.org.uk/CodeSystem/UKCore-AddressKeyType","code":"PAF"}},{"url":"value","valueString":"12345678"}]},{"url":"https://fhir.hl7.org.uk/StructureDefinition/Extension-UKCore-AddressKey","extension":[{"url":"type","valueCoding":{"system":"https://fhir.hl7.org.uk/CodeSystem/UKCore-AddressKeyType","code":"UPRN"}},{"url":"value","valueString":"123456789012"}]}]}]}
2023/09/15 17:36:10.723867 tttmplts.go:100: Caching 24 Templates
2023/09/15 17:36:10.728546 tttmplts.go:87: Processing Template allpatientSrvs_tmplt
2023/09/15 17:36:10.731669 tttmplts.go:93: template: pdsretrieve_tmplt:174:38: executing "pdsretrieve_tmplt" at <.Url>: can't evaluate field Url in type struct { URL string "json:\"url,omitempty\""; ValueReference struct { Identifier struct { System string "json:\"system,omitempty\""; Value string "json:\"value,omitempty\"" } "json:\"identifier,omitempty\"" } "json:\"valueReference,omitempty\""; Extension []struct { URL string "json:\"url,omitempty\""; ValueCodeableConcept struct { Coding []struct { System string "json:\"system,omitempty\""; Version string "json:\"version,omitempty\""; Code string "json:\"code,omitempty\""; Display string "json:\"display,omitempty\"" } "json:\"coding,omitempty\"" } "json:\"valueCodeableConcept,omitempty\""; ValueDateTime time.Time "json:\"valueDateTime,omitempty\"" } "json:\"extension,omitempty\""; ValueAddress struct { City string "json:\"city,omitempty\""; District string "json:\"district,omitempty\""; Country string "json:\"country,omitempty\"" } "json:\"valueAddress,omitempty\"" }
2023/09/15 17:36:10.731841 ttproxy.go:105: template: pdsretrieve_tmplt:174:38: executing "pdsretrieve_tmplt" at <.Url>: can't evaluate field Url in type struct { URL string "json:\"url,omitempty\""; ValueReference struct { Identifier struct { System string "json:\"system,omitempty\""; Value string "json:\"value,omitempty\"" } "json:\"identifier,omitempty\"" } "json:\"valueReference,omitempty\""; Extension []struct { URL string "json:\"url,omitempty\""; ValueCodeableConcept struct { Coding []struct { System string "json:\"system,omitempty\""; Version string "json:\"version,omitempty\""; Code string "json:\"code,omitempty\""; Display string "json:\"display,omitempty\"" } "json:\"coding,omitempty\"" } "json:\"valueCodeableConcept,omitempty\""; ValueDateTime time.Time "json:\"valueDateTime,omitempty\"" } "json:\"extension,omitempty\""; ValueAddress struct { City string "json:\"city,omitempty\""; District string "json:\"district,omitempty\""; Country string "json:\"country,omitempty\"" } "json:\"valueAddress,omitempty\"" }
2023/09/15 17:36:10.731868 ttproxy.go:149: Response Status Code 500
2023/09/15 17:36:10.731883 ttproxy.go:151: 
2023/09/15 17:36:10.731890 ttproxy.go:152: Response Headers
2023/09/15 17:36:10.731945 ttutil.go:140: 	{
  "Access-Control-Allow-Origin": "*",
  "Content-Type": "",
  "Server": "Workflow Service"
}
2023/09/15 17:36:10.731956 ttproxy.go:154: ----------------
2023/09/15 17:36:10.731966 ttproxy.go:155: Response
2023/09/15 17:36:10.731973 ttproxy.go:156: ----------------
2023/09/15 17:36:10.732196 ttutil.go:140: 	{
  "Host": "MacBook-Pro-3.lan",
  "Path": "/beta/spa/consumer/patient",
  "Method": "GET",
  "SourceIP": "[::1]:56724",
  "ReqContentType": "",
  "RspContentType": "",
  "ResponseBody": "{\"resourceType\":\"Patient\",\"id\":\"9000000009\",\"identifier\":[{\"system\":\"https://fhir.nhs.uk/Id/nhs-number\",\"value\":\"9000000009\",\"extension\":[{\"url\":\"https://fhir.hl7.org.uk/StructureDefinition/Extension-UKCore-NHSNumberVerificationStatus\",\"valueCodeableConcept\":{\"coding\":[{\"system\":\"https://fhir.hl7.org.uk/CodeSystem/UKCore-NHSNumberVerificationStatus\",\"version\":\"1.0.0\",\"code\":\"01\",\"display\":\"Number present and verified\"}]}}]}],\"meta\":{\"versionId\":\"2\",\"security\":[{\"system\":\"http://terminology.hl7.org/CodeSystem/v3-Confidentiality\",\"code\":\"U\",\"display\":\"unrestricted\"}]},\"name\":[{\"id\":\"123\",\"use\":\"usual\",\"period\":{\"start\":\"2020-01-01\",\"end\":\"2021-12-31\"},\"given\":[\"Jane\"],\"family\":\"Smith\",\"prefix\":[\"Mrs\"],\"suffix\":[\"MBE\"]}],\"gender\":\"female\",\"birthDate\":\"2010-10-22\",\"multipleBirthInteger\":1,\"deceasedDateTime\":\"2010-10-22T00:00:00+00:00\",\"generalPractitioner\":[{\"id\":\"254406A3\",\"type\":\"Organization\",\"identifier\":{\"system\":\"https://fhir.nhs.uk/Id/ods-organization-code\",\"value\":\"Y12345\",\"period\":{\"start\":\"2020-01-01\",\"end\":\"2021-12-31\"}}}],\"managingOrganization\":{\"type\":\"Organization\",\"identifier\":{\"system\":\"https://fhir.nhs.uk/Id/ods-organization-code\",\"value\":\"Y12345\",\"period\":{\"start\":\"2020-01-01\",\"end\":\"2021-12-31\"}}},\"extension\":[{\"url\":\"https://fhir.hl7.org.uk/StructureDefinition/Extension-UKCore-NominatedPharmacy\",\"valueReference\":{\"identifier\":{\"system\":\"https://fhir.nhs.uk/Id/ods-organization-code\",\"value\":\"Y12345\"}}},{\"url\":\"https://fhir.hl7.org.uk/StructureDefinition/Extension-UKCore-PreferredDispenserOrganization\",\"valueReference\":{\"identifier\":{\"system\":\"https://fhir.nhs.uk/Id/ods-organization-code\",\"value\":\"Y23456\"}}},{\"url\":\"https://fhir.hl7.org.uk/StructureDefinition/Extension-UKCore-MedicalApplianceSupplier\",\"valueReference\":{\"identifier\":{\"system\":\"https://fhir.nhs.uk/Id/ods-organization-code\",\"value\":\"Y34567\"}}},{\"url\":\"https://fhir.hl7.org.uk/StructureDefinition/Extension-UKCore-DeathNotificationStatus\",\"extension\":[{\"url\":\"deathNotificationStatus\",\"valueCodeableConcept\":{\"coding\":[{\"system\":\"https://fhir.hl7.org.uk/CodeSystem/UKCore-DeathNotificationStatus\",\"version\":\"1.0.0\",\"code\":\"2\",\"display\":\"Formal - death notice received from Registrar of Deaths\"}]}},{\"url\":\"systemEffectiveDate\",\"valueDateTime\":\"2010-10-22T00:00:00+00:00\"}]},{\"url\":\"https://fhir.hl7.org.uk/StructureDefinition/Extension-UKCore-NHSCommunication\",\"extension\":[{\"url\":\"language\",\"valueCodeableConcept\":{\"coding\":[{\"system\":\"https://fhir.hl7.org.uk/CodeSystem/UKCore-HumanLanguage\",\"version\":\"1.0.0\",\"code\":\"fr\",\"display\":\"French\"}]}},{\"url\":\"interpreterRequired\",\"valueBoolean\":true}]},{\"url\":\"https://fhir.hl7.org.uk/StructureDefinition/Extension-UKCore-ContactPreference\",\"extension\":[{\"url\":\"PreferredWrittenCommunicationFormat\",\"valueCodeableConcept\":{\"coding\":[{\"system\":\"https://fhir.hl7.org.uk/CodeSystem/UKCore-PreferredWrittenCommunicationFormat\",\"code\":\"12\",\"display\":\"Braille\"}]}},{\"url\":\"PreferredContactMethod\",\"valueCodeableConcept\":{\"coding\":[{\"system\":\"https://fhir.hl7.org.uk/CodeSystem/UKCore-PreferredContactMethod\",\"code\":\"1\",\"display\":\"Letter\"}]}},{\"url\":\"PreferredContactTimes\",\"valueString\":\"Not after 7pm\"}]},{\"url\":\"http://hl7.org/fhir/StructureDefinition/patient-birthPlace\",\"valueAddress\":{\"city\":\"Manchester\",\"district\":\"Greater Manchester\",\"country\":\"GBR\"}},{\"url\":\"https://fhir.nhs.uk/StructureDefinition/Extension-PDS-RemovalFromRegistration\",\"extension\":[{\"url\":\"removalFromRegistrationCode\",\"valueCodeableConcept\":{\"coding\":[{\"system\":\"https://fhir.nhs.uk/CodeSystem/PDS-RemovalReasonExitCode\",\"code\":\"SCT\",\"display\":\"Transferred to Scotland\"}]}},{\"url\":\"effectiveTime\",\"valuePeriod\":{\"start\":\"2020-01-01T00:00:00+00:00\",\"end\":\"2021-12-31T00:00:00+00:00\"}}]}],\"telecom\":[{\"id\":\"789\",\"period\":{\"start\":\"2020-01-01\",\"end\":\"2021-12-31\"},\"system\":\"phone\",\"value\":\"01632960587\",\"use\":\"home\"},{\"id\":\"790\",\"period\":{\"start\":\"2019-01-01\",\"end\":\"2022-12-31\"},\"system\":\"email\",\"value\":\"jane.smith@example.com\",\"use\":\"home\"},{\"id\":\"OC789\",\"period\":{\"start\":\"2020-01-01\",\"end\":\"2021-12-31\"},\"system\":\"other\",\"value\":\"01632960587\",\"use\":\"home\",\"extension\":[{\"url\":\"https://fhir.hl7.org.uk/StructureDefinition/Extension-UKCore-OtherContactSystem\",\"valueCoding\":{\"system\":\"https://fhir.hl7.org.uk/CodeSystem/UKCore-OtherContactSystem\",\"code\":\"textphone\",\"display\":\"Minicom (Textphone)\"}}]}],\"contact\":[{\"id\":\"C123\",\"period\":{\"start\":\"2020-01-01\",\"end\":\"2021-12-31\"},\"relationship\":[{\"coding\":[{\"system\":\"http://terminology.hl7.org/CodeSystem/v2-0131\",\"code\":\"C\",\"display\":\"Emergency Contact\"}]}],\"telecom\":[{\"system\":\"phone\",\"value\":\"01632960587\"}]}],\"address\":[{\"id\":\"456\",\"period\":{\"start\":\"2020-01-01\",\"end\":\"2021-12-31\"},\"use\":\"home\",\"line\":[\"1 Trevelyan Square\",\"Boar Lane\",\"City Centre\",\"Leeds\",\"West Yorkshire\"],\"postalCode\":\"LS1 6AE\",\"extension\":[{\"url\":\"https://fhir.hl7.org.uk/StructureDefinition/Extension-UKCore-AddressKey\",\"extension\":[{\"url\":\"type\",\"valueCoding\":{\"system\":\"https://fhir.hl7.org.uk/CodeSystem/UKCore-AddressKeyType\",\"code\":\"PAF\"}},{\"url\":\"value\",\"valueString\":\"12345678\"}]},{\"url\":\"https://fhir.hl7.org.uk/StructureDefinition/Extension-UKCore-AddressKey\",\"extension\":[{\"url\":\"type\",\"valueCoding\":{\"system\":\"https://fhir.hl7.org.uk/CodeSystem/UKCore-AddressKeyType\",\"code\":\"UPRN\"}},{\"url\":\"value\",\"valueString\":\"123456789012\"}]}]},{\"id\":\"T456\",\"period\":{\"start\":\"2020-01-01\",\"end\":\"2021-12-31\"},\"use\":\"temp\",\"text\":\"Student Accommodation\",\"line\":[\"1 Trevelyan Square\",\"Boar Lane\",\"City Centre\",\"Leeds\",\"West Yorkshire\"],\"postalCode\":\"LS1 6AE\",\"extension\":[{\"url\":\"https://fhir.hl7.org.uk/StructureDefinition/Extension-UKCore-AddressKey\",\"extension\":[{\"url\":\"type\",\"valueCoding\":{\"system\":\"https://fhir.hl7.org.uk/CodeSystem/UKCore-AddressKeyType\",\"code\":\"PAF\"}},{\"url\":\"value\",\"valueString\":\"12345678\"}]},{\"url\":\"https://fhir.hl7.org.uk/StructureDefinition/Extension-UKCore-AddressKey\",\"extension\":[{\"url\":\"type\",\"valueCoding\":{\"system\":\"https://fhir.hl7.org.uk/CodeSystem/UKCore-AddressKeyType\",\"code\":\"UPRN\"}},{\"url\":\"value\",\"valueString\":\"123456789012\"}]}]}]}",
  "StatusCode": 500,
  "IsBase64": false,
  "Timeout": 0
}
2023/09/15 17:36:10.732226 ttproxy.go:158: -------------
2023/09/15 17:36:10.732234 ttproxy.go:160: Error template: pdsretrieve_tmplt:174:38: executing "pdsretrieve_tmplt" at <.Url>: can't evaluate field Url in type struct { URL string "json:\"url,omitempty\""; ValueReference struct { Identifier struct { System string "json:\"system,omitempty\""; Value string "json:\"value,omitempty\"" } "json:\"identifier,omitempty\"" } "json:\"valueReference,omitempty\""; Extension []struct { URL string "json:\"url,omitempty\""; ValueCodeableConcept struct { Coding []struct { System string "json:\"system,omitempty\""; Version string "json:\"version,omitempty\""; Code string "json:\"code,omitempty\""; Display string "json:\"display,omitempty\"" } "json:\"coding,omitempty\"" } "json:\"valueCodeableConcept,omitempty\""; ValueDateTime time.Time "json:\"valueDateTime,omitempty\"" } "json:\"extension,omitempty\""; ValueAddress struct { City string "json:\"city,omitempty\""; District string "json:\"district,omitempty\""; Country string "json:\"country,omitempty\"" } "json:\"valueAddress,omitempty\"" }
2023/09/15 17:36:10.732241 ttproxy.go:161: -------------
2023/09/15 17:36:51.268869 ttserver.go:52: ICB Workflow Service stopped
2023/09/15 17:36:53.349826 ttutil.go:133: -----------------------------------------------------------------------------------
2023/09/15 17:36:53.350356 ttdb.go:51: Opening DB Connection to mysql instance
User: root
Host: tuk.coil1nnpqdlr.eu-west-1.rds.amazonaws.com
Port: :3306
Name: tuk
Connect Timeout 2s
Read Timeout 5s
2023/09/15 17:36:53.350492 ttdb.go:54: Opened Database
2023/09/15 17:36:53.534598 ttdb.go:379: Persisting Template dsubcancel_tmplt
2023/09/15 17:36:53.599455 ttdb.go:385: Persisted Template dsubcancel_tmplt
2023/09/15 17:36:53.599535 ttdb.go:366: Persisted Template dsubcancel_tmplt.xml
2023/09/15 17:36:53.672211 ttdb.go:379: Persisting Template cgl_tmplt
2023/09/15 17:36:53.767513 ttdb.go:385: Persisted Template cgl_tmplt
2023/09/15 17:36:53.767546 ttdb.go:366: Persisted Template cgl_tmplt.html
2023/09/15 17:36:53.831258 ttdb.go:379: Persisting Template pdssearch_tmplt
2023/09/15 17:36:53.896042 ttdb.go:385: Persisted Template pdssearch_tmplt
2023/09/15 17:36:53.896080 ttdb.go:366: Persisted Template pdssearch_tmplt.html
2023/09/15 17:36:53.960201 ttdb.go:379: Persisting Template dsubsubscribe_tmplt
2023/09/15 17:36:54.022361 ttdb.go:385: Persisted Template dsubsubscribe_tmplt
2023/09/15 17:36:54.022396 ttdb.go:366: Persisted Template dsubsubscribe_tmplt.xml
2023/09/15 17:36:54.085611 ttdb.go:379: Persisting Template notification_tmplt
2023/09/15 17:36:54.152743 ttdb.go:385: Persisted Template notification_tmplt
2023/09/15 17:36:54.152831 ttdb.go:366: Persisted Template notification_tmplt.txt
2023/09/15 17:36:54.216075 ttdb.go:379: Persisting Template wfstate2t_tmplt
2023/09/15 17:36:54.333453 ttdb.go:385: Persisted Template wfstate2t_tmplt
2023/09/15 17:36:54.333481 ttdb.go:366: Persisted Template wfstate2t_tmplt.html
2023/09/15 17:36:54.397040 ttdb.go:379: Persisting Template publishfile2t_tmplt
2023/09/15 17:36:54.461367 ttdb.go:385: Persisted Template publishfile2t_tmplt
2023/09/15 17:36:54.461401 ttdb.go:366: Persisted Template publishfile2t_tmplt.html
2023/09/15 17:36:54.525022 ttdb.go:379: Persisting Template react_tmplt
2023/09/15 17:36:54.593809 ttdb.go:385: Persisted Template react_tmplt
2023/09/15 17:36:54.593952 ttdb.go:366: Persisted Template react_tmplt.html
2023/09/15 17:36:54.657783 ttdb.go:379: Persisting Template pdsretrieve_tmplt
2023/09/15 17:36:54.725843 ttdb.go:385: Persisted Template pdsretrieve_tmplt
2023/09/15 17:36:54.725982 ttdb.go:366: Persisted Template pdsretrieve_tmplt.html
2023/09/15 17:36:54.791641 ttdb.go:379: Persisting Template allpatientSrvs_tmplt
2023/09/15 17:36:54.859595 ttdb.go:385: Persisted Template allpatientSrvs_tmplt
2023/09/15 17:36:54.859749 ttdb.go:366: Persisted Template allpatientSrvs_tmplt.html
2023/09/15 17:36:54.931097 ttdb.go:379: Persisting Template spa2t_tmplt
2023/09/15 17:36:55.008247 ttdb.go:385: Persisted Template spa2t_tmplt
2023/09/15 17:36:55.008346 ttdb.go:366: Persisted Template spa2t_tmplt.html
2023/09/15 17:36:55.073416 ttdb.go:379: Persisting Template xdw2t_tmplt
2023/09/15 17:36:55.153879 ttdb.go:385: Persisted Template xdw2t_tmplt
2023/09/15 17:36:55.153916 ttdb.go:366: Persisted Template xdw2t_tmplt.html
2023/09/15 17:36:55.217864 ttdb.go:379: Persisting Template spaheader2t_tmplt
2023/09/15 17:36:55.284113 ttdb.go:385: Persisted Template spaheader2t_tmplt
2023/09/15 17:36:55.284151 ttdb.go:366: Persisted Template spaheader2t_tmplt.html
2023/09/15 17:36:55.348137 ttdb.go:379: Persisting Template pds_tmplt
2023/09/15 17:36:55.414179 ttdb.go:385: Persisted Template pds_tmplt
2023/09/15 17:36:55.414230 ttdb.go:366: Persisted Template pds_tmplt.html
2023/09/15 17:36:55.477700 ttdb.go:379: Persisting Template error_tmplt
2023/09/15 17:36:55.542075 ttdb.go:385: Persisted Template error_tmplt
2023/09/15 17:36:55.542163 ttdb.go:366: Persisted Template error_tmplt.html
2023/09/15 17:36:55.605314 ttdb.go:379: Persisting Template dsuback_tmplt
2023/09/15 17:36:55.668522 ttdb.go:385: Persisted Template dsuback_tmplt
2023/09/15 17:36:55.668609 ttdb.go:366: Persisted Template dsuback_tmplt.xml
2023/09/15 17:36:55.732231 ttdb.go:379: Persisting Template pixm_tmplt
2023/09/15 17:36:55.801597 ttdb.go:385: Persisted Template pixm_tmplt
2023/09/15 17:36:55.801630 ttdb.go:366: Persisted Template pixm_tmplt.html
2023/09/15 17:36:55.865503 ttdb.go:379: Persisting Template subscriptions2t_tmplt
2023/09/15 17:36:55.933196 ttdb.go:385: Persisted Template subscriptions2t_tmplt
2023/09/15 17:36:55.933371 ttdb.go:366: Persisted Template subscriptions2t_tmplt.html
2023/09/15 17:36:55.996015 ttdb.go:379: Persisting Template codemaps2t_tmplt
2023/09/15 17:36:56.065146 ttdb.go:385: Persisted Template codemaps2t_tmplt
2023/09/15 17:36:56.065267 ttdb.go:366: Persisted Template codemaps2t_tmplt.html
2023/09/15 17:36:56.128526 ttdb.go:379: Persisting Template mhdpublish_tmplt
2023/09/15 17:36:56.198359 ttdb.go:385: Persisted Template mhdpublish_tmplt
2023/09/15 17:36:56.198410 ttdb.go:366: Persisted Template mhdpublish_tmplt.json
2023/09/15 17:36:56.262411 ttdb.go:379: Persisting Template events_tmplt
2023/09/15 17:36:56.332652 ttdb.go:385: Persisted Template events_tmplt
2023/09/15 17:36:56.332721 ttdb.go:366: Persisted Template events_tmplt.html
2023/09/15 17:36:56.398108 ttdb.go:379: Persisting Template uploadfile2t_tmplt
2023/09/15 17:36:56.464191 ttdb.go:385: Persisted Template uploadfile2t_tmplt
2023/09/15 17:36:56.464242 ttdb.go:366: Persisted Template uploadfile2t_tmplt.html
2023/09/15 17:36:56.464362 ttserver.go:40: Starting ICB Workflow Service. Service Endpoint http://MacBook-Pro-3.lan:8080/
2023/09/15 17:36:59.283454 ttgethandler.go:10: Processing new GET Request
2023/09/15 17:36:59.283628 ttproxy.go:138: 	Request Query Params
2023/09/15 17:36:59.283978 ttutil.go:140: 	{
  "User": "ian.thomas",
  "Org": "2tsolutions",
  "Role": "clinical",
  "Nhs": "9000000009"
}
2023/09/15 17:36:59.284019 ttgethandler.go:15: Path = /beta/spa/consumer/patient
2023/09/15 17:36:59.284096 tttmplts.go:30: PIXm Worker starting
2023/09/15 17:36:59.284251 tthttp.go:15: Creating PIXm PDQ - Server URL http://lac-demo-01.tianispirit.co.uk:8081/SpiritPIXFhir/r4/Patient?identifier=2.16.840.1.113883.2.1.4.1%7C9000000009
2023/09/15 17:36:59.284105 tttmplts.go:37: CGL Worker starting
2023/09/15 17:36:59.285923 tthttp.go:160: Request Headers 
map[Content-Type:[application/json]]
2023/09/15 17:36:59.285939 tthttp.go:160: Request Headers 
map[Accept:[application/json] X-Api-Key:[FNhb#OhxWiEiMdf+@6085k5Zmt] X-Api-Secret:[9710ea0fb4ffb5d56c2e62c71c30bdfhjsyr56a79d]]
2023/09/15 17:36:59.465956 tthttp.go:174: Server Response - Status Code 404 
{"errors":[{"message":"No clients matching nhs number 9000000009","path":"\/"}],"status":404}
2023/09/15 17:36:59.472500 ttutil.go:140: 	{
  "data": {
    "client": {
      "basicDetails": {
        "address": {},
        "name": {}
      },
      "bbvInformation": {},
      "drugTestResults": {
        "results": {}
      },
      "riskInformation": {
        "mentalHealthDomain": {},
        "riskOfHarmToSelfDomain": {},
        "socialDomain": {},
        "substanceMisuseDomain": {}
      },
      "safeguardingInformation": {}
    },
    "keyWorker": {
      "name": {}
    }
  }
}
2023/09/15 17:36:59.472630 tttmplts.go:39: CGL Worker done
2023/09/15 17:36:59.472733 tttmplts.go:40: CGL Worker Status Code 404
2023/09/15 17:37:04.285609 tthttp.go:174: Server Response - Status Code 0 
2023/09/15 17:37:04.286014 tttmplts.go:32: PIXm Worker done
2023/09/15 17:37:04.286058 tttmplts.go:33: PIXm Worker Status Code 408
2023/09/15 17:37:04.286245 tthttp.go:56: Creating PDS Search Request - Server URL https://sandbox.api.service.nhs.uk/personal-demographics/FHIR/R4/Patient/9000000009
2023/09/15 17:37:04.286409 tthttp.go:160: Request Headers 
map[Accept:[*/*] Content-Type:[application/json] X-Request-Id:[f2e1c291-89e1-4085-8c8d-ef3758140213]]
2023/09/15 17:37:04.460724 tthttp.go:174: Server Response - Status Code 200 
{"resourceType":"Patient","id":"9000000009","identifier":[{"system":"https://fhir.nhs.uk/Id/nhs-number","value":"9000000009","extension":[{"url":"https://fhir.hl7.org.uk/StructureDefinition/Extension-UKCore-NHSNumberVerificationStatus","valueCodeableConcept":{"coding":[{"system":"https://fhir.hl7.org.uk/CodeSystem/UKCore-NHSNumberVerificationStatus","version":"1.0.0","code":"01","display":"Number present and verified"}]}}]}],"meta":{"versionId":"2","security":[{"system":"http://terminology.hl7.org/CodeSystem/v3-Confidentiality","code":"U","display":"unrestricted"}]},"name":[{"id":"123","use":"usual","period":{"start":"2020-01-01","end":"2021-12-31"},"given":["Jane"],"family":"Smith","prefix":["Mrs"],"suffix":["MBE"]}],"gender":"female","birthDate":"2010-10-22","multipleBirthInteger":1,"deceasedDateTime":"2010-10-22T00:00:00+00:00","generalPractitioner":[{"id":"254406A3","type":"Organization","identifier":{"system":"https://fhir.nhs.uk/Id/ods-organization-code","value":"Y12345","period":{"start":"2020-01-01","end":"2021-12-31"}}}],"managingOrganization":{"type":"Organization","identifier":{"system":"https://fhir.nhs.uk/Id/ods-organization-code","value":"Y12345","period":{"start":"2020-01-01","end":"2021-12-31"}}},"extension":[{"url":"https://fhir.hl7.org.uk/StructureDefinition/Extension-UKCore-NominatedPharmacy","valueReference":{"identifier":{"system":"https://fhir.nhs.uk/Id/ods-organization-code","value":"Y12345"}}},{"url":"https://fhir.hl7.org.uk/StructureDefinition/Extension-UKCore-PreferredDispenserOrganization","valueReference":{"identifier":{"system":"https://fhir.nhs.uk/Id/ods-organization-code","value":"Y23456"}}},{"url":"https://fhir.hl7.org.uk/StructureDefinition/Extension-UKCore-MedicalApplianceSupplier","valueReference":{"identifier":{"system":"https://fhir.nhs.uk/Id/ods-organization-code","value":"Y34567"}}},{"url":"https://fhir.hl7.org.uk/StructureDefinition/Extension-UKCore-DeathNotificationStatus","extension":[{"url":"deathNotificationStatus","valueCodeableConcept":{"coding":[{"system":"https://fhir.hl7.org.uk/CodeSystem/UKCore-DeathNotificationStatus","version":"1.0.0","code":"2","display":"Formal - death notice received from Registrar of Deaths"}]}},{"url":"systemEffectiveDate","valueDateTime":"2010-10-22T00:00:00+00:00"}]},{"url":"https://fhir.hl7.org.uk/StructureDefinition/Extension-UKCore-NHSCommunication","extension":[{"url":"language","valueCodeableConcept":{"coding":[{"system":"https://fhir.hl7.org.uk/CodeSystem/UKCore-HumanLanguage","version":"1.0.0","code":"fr","display":"French"}]}},{"url":"interpreterRequired","valueBoolean":true}]},{"url":"https://fhir.hl7.org.uk/StructureDefinition/Extension-UKCore-ContactPreference","extension":[{"url":"PreferredWrittenCommunicationFormat","valueCodeableConcept":{"coding":[{"system":"https://fhir.hl7.org.uk/CodeSystem/UKCore-PreferredWrittenCommunicationFormat","code":"12","display":"Braille"}]}},{"url":"PreferredContactMethod","valueCodeableConcept":{"coding":[{"system":"https://fhir.hl7.org.uk/CodeSystem/UKCore-PreferredContactMethod","code":"1","display":"Letter"}]}},{"url":"PreferredContactTimes","valueString":"Not after 7pm"}]},{"url":"http://hl7.org/fhir/StructureDefinition/patient-birthPlace","valueAddress":{"city":"Manchester","district":"Greater Manchester","country":"GBR"}},{"url":"https://fhir.nhs.uk/StructureDefinition/Extension-PDS-RemovalFromRegistration","extension":[{"url":"removalFromRegistrationCode","valueCodeableConcept":{"coding":[{"system":"https://fhir.nhs.uk/CodeSystem/PDS-RemovalReasonExitCode","code":"SCT","display":"Transferred to Scotland"}]}},{"url":"effectiveTime","valuePeriod":{"start":"2020-01-01T00:00:00+00:00","end":"2021-12-31T00:00:00+00:00"}}]}],"telecom":[{"id":"789","period":{"start":"2020-01-01","end":"2021-12-31"},"system":"phone","value":"01632960587","use":"home"},{"id":"790","period":{"start":"2019-01-01","end":"2022-12-31"},"system":"email","value":"jane.smith@example.com","use":"home"},{"id":"OC789","period":{"start":"2020-01-01","end":"2021-12-31"},"system":"other","value":"01632960587","use":"home","extension":[{"url":"https://fhir.hl7.org.uk/StructureDefinition/Extension-UKCore-OtherContactSystem","valueCoding":{"system":"https://fhir.hl7.org.uk/CodeSystem/UKCore-OtherContactSystem","code":"textphone","display":"Minicom (Textphone)"}}]}],"contact":[{"id":"C123","period":{"start":"2020-01-01","end":"2021-12-31"},"relationship":[{"coding":[{"system":"http://terminology.hl7.org/CodeSystem/v2-0131","code":"C","display":"Emergency Contact"}]}],"telecom":[{"system":"phone","value":"01632960587"}]}],"address":[{"id":"456","period":{"start":"2020-01-01","end":"2021-12-31"},"use":"home","line":["1 Trevelyan Square","Boar Lane","City Centre","Leeds","West Yorkshire"],"postalCode":"LS1 6AE","extension":[{"url":"https://fhir.hl7.org.uk/StructureDefinition/Extension-UKCore-AddressKey","extension":[{"url":"type","valueCoding":{"system":"https://fhir.hl7.org.uk/CodeSystem/UKCore-AddressKeyType","code":"PAF"}},{"url":"value","valueString":"12345678"}]},{"url":"https://fhir.hl7.org.uk/StructureDefinition/Extension-UKCore-AddressKey","extension":[{"url":"type","valueCoding":{"system":"https://fhir.hl7.org.uk/CodeSystem/UKCore-AddressKeyType","code":"UPRN"}},{"url":"value","valueString":"123456789012"}]}]},{"id":"T456","period":{"start":"2020-01-01","end":"2021-12-31"},"use":"temp","text":"Student Accommodation","line":["1 Trevelyan Square","Boar Lane","City Centre","Leeds","West Yorkshire"],"postalCode":"LS1 6AE","extension":[{"url":"https://fhir.hl7.org.uk/StructureDefinition/Extension-UKCore-AddressKey","extension":[{"url":"type","valueCoding":{"system":"https://fhir.hl7.org.uk/CodeSystem/UKCore-AddressKeyType","code":"PAF"}},{"url":"value","valueString":"12345678"}]},{"url":"https://fhir.hl7.org.uk/StructureDefinition/Extension-UKCore-AddressKey","extension":[{"url":"type","valueCoding":{"system":"https://fhir.hl7.org.uk/CodeSystem/UKCore-AddressKeyType","code":"UPRN"}},{"url":"value","valueString":"123456789012"}]}]}]}
2023/09/15 17:37:04.652262 tttmplts.go:100: Caching 24 Templates
2023/09/15 17:37:04.664389 tttmplts.go:87: Processing Template allpatientSrvs_tmplt
2023/09/15 17:37:04.670933 ttproxy.go:149: Response Status Code 200
2023/09/15 18:14:32.149335 ttserver.go:52: ICB Workflow Service stopped
