2023/09/15 20:52:21.560297 ttutil.go:133: -----------------------------------------------------------------------------------
2023/09/15 20:52:21.560788 ttdb.go:51: Opening DB Connection to mysql instance
User: root
Host: tuk.coil1nnpqdlr.eu-west-1.rds.amazonaws.com
Port: :3306
Name: tuk
Connect Timeout 2s
Read Timeout 5s
2023/09/15 20:52:21.560917 ttdb.go:54: Opened Database
2023/09/15 20:52:21.804174 ttdb.go:379: Persisting Template dsubcancel_tmplt
2023/09/15 20:52:21.876912 ttdb.go:385: Persisted Template dsubcancel_tmplt
2023/09/15 20:52:21.876988 ttdb.go:366: Persisted Template dsubcancel_tmplt.xml
2023/09/15 20:52:21.942171 ttdb.go:379: Persisting Template cgl_tmplt
2023/09/15 20:52:22.043083 ttdb.go:385: Persisted Template cgl_tmplt
2023/09/15 20:52:22.043236 ttdb.go:366: Persisted Template cgl_tmplt.html
2023/09/15 20:52:22.107876 ttdb.go:379: Persisting Template pdssearch_tmplt
2023/09/15 20:52:22.178883 ttdb.go:385: Persisted Template pdssearch_tmplt
2023/09/15 20:52:22.178974 ttdb.go:366: Persisted Template pdssearch_tmplt.html
2023/09/15 20:52:22.244624 ttdb.go:379: Persisting Template dsubsubscribe_tmplt
2023/09/15 20:52:22.308286 ttdb.go:385: Persisted Template dsubsubscribe_tmplt
2023/09/15 20:52:22.308332 ttdb.go:366: Persisted Template dsubsubscribe_tmplt.xml
2023/09/15 20:52:22.373001 ttdb.go:379: Persisting Template notification_tmplt
2023/09/15 20:52:22.435787 ttdb.go:385: Persisted Template notification_tmplt
2023/09/15 20:52:22.435824 ttdb.go:366: Persisted Template notification_tmplt.txt
2023/09/15 20:52:22.498804 ttdb.go:379: Persisting Template wfstate2t_tmplt
2023/09/15 20:52:22.613153 ttdb.go:385: Persisted Template wfstate2t_tmplt
2023/09/15 20:52:22.613227 ttdb.go:366: Persisted Template wfstate2t_tmplt.html
2023/09/15 20:52:22.678201 ttdb.go:379: Persisting Template publishfile2t_tmplt
2023/09/15 20:52:22.749591 ttdb.go:385: Persisted Template publishfile2t_tmplt
2023/09/15 20:52:22.749656 ttdb.go:366: Persisted Template publishfile2t_tmplt.html
2023/09/15 20:52:22.814401 ttdb.go:379: Persisting Template react_tmplt
2023/09/15 20:52:22.876512 ttdb.go:385: Persisted Template react_tmplt
2023/09/15 20:52:22.876602 ttdb.go:366: Persisted Template react_tmplt.html
2023/09/15 20:52:22.939757 ttdb.go:379: Persisting Template pdsretrieve_tmplt
2023/09/15 20:52:23.018394 ttdb.go:385: Persisted Template pdsretrieve_tmplt
2023/09/15 20:52:23.018511 ttdb.go:366: Persisted Template pdsretrieve_tmplt.html
2023/09/15 20:52:23.082454 ttdb.go:379: Persisting Template allpatientSrvs_tmplt
2023/09/15 20:52:23.149197 ttdb.go:385: Persisted Template allpatientSrvs_tmplt
2023/09/15 20:52:23.149393 ttdb.go:366: Persisted Template allpatientSrvs_tmplt.html
2023/09/15 20:52:23.212852 ttdb.go:379: Persisting Template spa2t_tmplt
2023/09/15 20:52:23.290068 ttdb.go:385: Persisted Template spa2t_tmplt
2023/09/15 20:52:23.290241 ttdb.go:366: Persisted Template spa2t_tmplt.html
2023/09/15 20:52:23.358078 ttdb.go:379: Persisting Template xdw2t_tmplt
2023/09/15 20:52:23.437598 ttdb.go:385: Persisted Template xdw2t_tmplt
2023/09/15 20:52:23.437830 ttdb.go:366: Persisted Template xdw2t_tmplt.html
2023/09/15 20:52:23.503858 ttdb.go:379: Persisting Template spaheader2t_tmplt
2023/09/15 20:52:23.573190 ttdb.go:385: Persisted Template spaheader2t_tmplt
2023/09/15 20:52:23.573449 ttdb.go:366: Persisted Template spaheader2t_tmplt.html
2023/09/15 20:52:23.638218 ttdb.go:379: Persisting Template pds_tmplt
2023/09/15 20:52:23.704160 ttdb.go:385: Persisted Template pds_tmplt
2023/09/15 20:52:23.704342 ttdb.go:366: Persisted Template pds_tmplt.html
2023/09/15 20:52:23.767190 ttdb.go:379: Persisting Template error_tmplt
2023/09/15 20:52:23.830024 ttdb.go:385: Persisted Template error_tmplt
2023/09/15 20:52:23.830055 ttdb.go:366: Persisted Template error_tmplt.html
2023/09/15 20:52:23.894181 ttdb.go:379: Persisting Template dsuback_tmplt
2023/09/15 20:52:23.956835 ttdb.go:385: Persisted Template dsuback_tmplt
2023/09/15 20:52:23.956989 ttdb.go:366: Persisted Template dsuback_tmplt.xml
2023/09/15 20:52:24.023999 ttdb.go:379: Persisting Template pixm_tmplt
2023/09/15 20:52:24.091168 ttdb.go:385: Persisted Template pixm_tmplt
2023/09/15 20:52:24.091196 ttdb.go:366: Persisted Template pixm_tmplt.html
2023/09/15 20:52:24.155236 ttdb.go:379: Persisting Template subscriptions2t_tmplt
2023/09/15 20:52:24.218957 ttdb.go:385: Persisted Template subscriptions2t_tmplt
2023/09/15 20:52:24.219064 ttdb.go:366: Persisted Template subscriptions2t_tmplt.html
2023/09/15 20:52:24.285205 ttdb.go:379: Persisting Template codemaps2t_tmplt
2023/09/15 20:52:24.351518 ttdb.go:385: Persisted Template codemaps2t_tmplt
2023/09/15 20:52:24.351680 ttdb.go:366: Persisted Template codemaps2t_tmplt.html
2023/09/15 20:52:24.415793 ttdb.go:379: Persisting Template mhdpublish_tmplt
2023/09/15 20:52:24.486265 ttdb.go:385: Persisted Template mhdpublish_tmplt
2023/09/15 20:52:24.486405 ttdb.go:366: Persisted Template mhdpublish_tmplt.json
2023/09/15 20:52:24.549555 ttdb.go:379: Persisting Template events_tmplt
2023/09/15 20:52:24.619060 ttdb.go:385: Persisted Template events_tmplt
2023/09/15 20:52:24.619131 ttdb.go:366: Persisted Template events_tmplt.html
2023/09/15 20:52:24.682521 ttdb.go:379: Persisting Template uploadfile2t_tmplt
2023/09/15 20:52:24.745868 ttdb.go:385: Persisted Template uploadfile2t_tmplt
2023/09/15 20:52:24.746007 ttdb.go:366: Persisted Template uploadfile2t_tmplt.html
2023/09/15 20:52:24.746312 ttserver.go:40: Starting ICB Workflow Service. Service Endpoint http://MacBook-Pro-3.lan:8080/
2023/09/15 20:52:32.410433 ttgethandler.go:10: Processing new GET Request
2023/09/15 20:52:32.410651 ttproxy.go:138: 	Request Query Params
2023/09/15 20:52:32.411219 ttutil.go:140: 	{
  "User": "ian.thomas",
  "Org": "2tsolutions",
  "Role": "clinical",
  "Nhs": "9000000009"
}
2023/09/15 20:52:32.411280 ttgethandler.go:15: Path = /beta/spa/consumer/patient
2023/09/15 20:52:32.411349 tttmplts.go:37: CGL Worker starting
2023/09/15 20:52:32.411348 tttmplts.go:30: PIXm Worker starting
2023/09/15 20:52:32.412414 tthttp.go:15: Creating PIXm PDQ - Server URL http://lac-demo-01.tianispirit.co.uk:8081/SpiritPIXFhir/r4/Patient?identifier=2.16.840.1.113883.2.1.4.1%7C9000000009
2023/09/15 20:52:32.415039 tthttp.go:160: Request Headers 
map[Content-Type:[application/json]]
2023/09/15 20:52:32.415086 tthttp.go:160: Request Headers 
map[Accept:[application/json] X-Api-Key:[FNhb#OhxWiEiMdf+@6085k5Zmt] X-Api-Secret:[9710ea0fb4ffb5d56c2e62c71c30bdfhjsyr56a79d]]
2023/09/15 20:52:33.227420 tthttp.go:174: Server Response - Status Code 404 
{"errors":[{"message":"No clients matching nhs number 9000000009","path":"\/"}],"status":404}
2023/09/15 20:52:33.229878 ttutil.go:140: 	{
  "data": {
    "client": {
      "basicDetails": {
        "address": {},
        "name": {}
      },
      "bbvInformation": {},
      "drugTestResults": {
        "results": {}
      },
      "riskInformation": {
        "mentalHealthDomain": {},
        "riskOfHarmToSelfDomain": {},
        "socialDomain": {},
        "substanceMisuseDomain": {}
      },
      "safeguardingInformation": {}
    },
    "keyWorker": {
      "name": {}
    }
  }
}
2023/09/15 20:52:33.229919 tttmplts.go:39: CGL Worker done
2023/09/15 20:52:33.229930 tttmplts.go:40: CGL Worker Status Code 404
2023/09/15 20:52:37.412982 tthttp.go:174: Server Response - Status Code 0 
2023/09/15 20:52:37.413295 tttmplts.go:32: PIXm Worker done
2023/09/15 20:52:37.413335 tttmplts.go:33: PIXm Worker Status Code 408
2023/09/15 20:52:37.413544 tthttp.go:56: Creating PDS Search Request - Server URL https://sandbox.api.service.nhs.uk/personal-demographics/FHIR/R4/Patient/9000000009
2023/09/15 20:52:37.413686 tthttp.go:160: Request Headers 
map[Accept:[*/*] Content-Type:[application/json] X-Request-Id:[410e0b13-93f1-4b89-8733-c68ce29b04b1]]
2023/09/15 20:52:38.017298 tthttp.go:174: Server Response - Status Code 200 
{"resourceType":"Patient","id":"9000000009","identifier":[{"system":"https://fhir.nhs.uk/Id/nhs-number","value":"9000000009","extension":[{"url":"https://fhir.hl7.org.uk/StructureDefinition/Extension-UKCore-NHSNumberVerificationStatus","valueCodeableConcept":{"coding":[{"system":"https://fhir.hl7.org.uk/CodeSystem/UKCore-NHSNumberVerificationStatus","version":"1.0.0","code":"01","display":"Number present and verified"}]}}]}],"meta":{"versionId":"2","security":[{"system":"http://terminology.hl7.org/CodeSystem/v3-Confidentiality","code":"U","display":"unrestricted"}]},"name":[{"id":"123","use":"usual","period":{"start":"2020-01-01","end":"2021-12-31"},"given":["Jane"],"family":"Smith","prefix":["Mrs"],"suffix":["MBE"]}],"gender":"female","birthDate":"2010-10-22","multipleBirthInteger":1,"deceasedDateTime":"2010-10-22T00:00:00+00:00","generalPractitioner":[{"id":"254406A3","type":"Organization","identifier":{"system":"https://fhir.nhs.uk/Id/ods-organization-code","value":"Y12345","period":{"start":"2020-01-01","end":"2021-12-31"}}}],"managingOrganization":{"type":"Organization","identifier":{"system":"https://fhir.nhs.uk/Id/ods-organization-code","value":"Y12345","period":{"start":"2020-01-01","end":"2021-12-31"}}},"extension":[{"url":"https://fhir.hl7.org.uk/StructureDefinition/Extension-UKCore-NominatedPharmacy","valueReference":{"identifier":{"system":"https://fhir.nhs.uk/Id/ods-organization-code","value":"Y12345"}}},{"url":"https://fhir.hl7.org.uk/StructureDefinition/Extension-UKCore-PreferredDispenserOrganization","valueReference":{"identifier":{"system":"https://fhir.nhs.uk/Id/ods-organization-code","value":"Y23456"}}},{"url":"https://fhir.hl7.org.uk/StructureDefinition/Extension-UKCore-MedicalApplianceSupplier","valueReference":{"identifier":{"system":"https://fhir.nhs.uk/Id/ods-organization-code","value":"Y34567"}}},{"url":"https://fhir.hl7.org.uk/StructureDefinition/Extension-UKCore-DeathNotificationStatus","extension":[{"url":"deathNotificationStatus","valueCodeableConcept":{"coding":[{"system":"https://fhir.hl7.org.uk/CodeSystem/UKCore-DeathNotificationStatus","version":"1.0.0","code":"2","display":"Formal - death notice received from Registrar of Deaths"}]}},{"url":"systemEffectiveDate","valueDateTime":"2010-10-22T00:00:00+00:00"}]},{"url":"https://fhir.hl7.org.uk/StructureDefinition/Extension-UKCore-NHSCommunication","extension":[{"url":"language","valueCodeableConcept":{"coding":[{"system":"https://fhir.hl7.org.uk/CodeSystem/UKCore-HumanLanguage","version":"1.0.0","code":"fr","display":"French"}]}},{"url":"interpreterRequired","valueBoolean":true}]},{"url":"https://fhir.hl7.org.uk/StructureDefinition/Extension-UKCore-ContactPreference","extension":[{"url":"PreferredWrittenCommunicationFormat","valueCodeableConcept":{"coding":[{"system":"https://fhir.hl7.org.uk/CodeSystem/UKCore-PreferredWrittenCommunicationFormat","code":"12","display":"Braille"}]}},{"url":"PreferredContactMethod","valueCodeableConcept":{"coding":[{"system":"https://fhir.hl7.org.uk/CodeSystem/UKCore-PreferredContactMethod","code":"1","display":"Letter"}]}},{"url":"PreferredContactTimes","valueString":"Not after 7pm"}]},{"url":"http://hl7.org/fhir/StructureDefinition/patient-birthPlace","valueAddress":{"city":"Manchester","district":"Greater Manchester","country":"GBR"}},{"url":"https://fhir.nhs.uk/StructureDefinition/Extension-PDS-RemovalFromRegistration","extension":[{"url":"removalFromRegistrationCode","valueCodeableConcept":{"coding":[{"system":"https://fhir.nhs.uk/CodeSystem/PDS-RemovalReasonExitCode","code":"SCT","display":"Transferred to Scotland"}]}},{"url":"effectiveTime","valuePeriod":{"start":"2020-01-01T00:00:00+00:00","end":"2021-12-31T00:00:00+00:00"}}]}],"telecom":[{"id":"789","period":{"start":"2020-01-01","end":"2021-12-31"},"system":"phone","value":"01632960587","use":"home"},{"id":"790","period":{"start":"2019-01-01","end":"2022-12-31"},"system":"email","value":"jane.smith@example.com","use":"home"},{"id":"OC789","period":{"start":"2020-01-01","end":"2021-12-31"},"system":"other","value":"01632960587","use":"home","extension":[{"url":"https://fhir.hl7.org.uk/StructureDefinition/Extension-UKCore-OtherContactSystem","valueCoding":{"system":"https://fhir.hl7.org.uk/CodeSystem/UKCore-OtherContactSystem","code":"textphone","display":"Minicom (Textphone)"}}]}],"contact":[{"id":"C123","period":{"start":"2020-01-01","end":"2021-12-31"},"relationship":[{"coding":[{"system":"http://terminology.hl7.org/CodeSystem/v2-0131","code":"C","display":"Emergency Contact"}]}],"telecom":[{"system":"phone","value":"01632960587"}]}],"address":[{"id":"456","period":{"start":"2020-01-01","end":"2021-12-31"},"use":"home","line":["1 Trevelyan Square","Boar Lane","City Centre","Leeds","West Yorkshire"],"postalCode":"LS1 6AE","extension":[{"url":"https://fhir.hl7.org.uk/StructureDefinition/Extension-UKCore-AddressKey","extension":[{"url":"type","valueCoding":{"system":"https://fhir.hl7.org.uk/CodeSystem/UKCore-AddressKeyType","code":"PAF"}},{"url":"value","valueString":"12345678"}]},{"url":"https://fhir.hl7.org.uk/StructureDefinition/Extension-UKCore-AddressKey","extension":[{"url":"type","valueCoding":{"system":"https://fhir.hl7.org.uk/CodeSystem/UKCore-AddressKeyType","code":"UPRN"}},{"url":"value","valueString":"123456789012"}]}]},{"id":"T456","period":{"start":"2020-01-01","end":"2021-12-31"},"use":"temp","text":"Student Accommodation","line":["1 Trevelyan Square","Boar Lane","City Centre","Leeds","West Yorkshire"],"postalCode":"LS1 6AE","extension":[{"url":"https://fhir.hl7.org.uk/StructureDefinition/Extension-UKCore-AddressKey","extension":[{"url":"type","valueCoding":{"system":"https://fhir.hl7.org.uk/CodeSystem/UKCore-AddressKeyType","code":"PAF"}},{"url":"value","valueString":"12345678"}]},{"url":"https://fhir.hl7.org.uk/StructureDefinition/Extension-UKCore-AddressKey","extension":[{"url":"type","valueCoding":{"system":"https://fhir.hl7.org.uk/CodeSystem/UKCore-AddressKeyType","code":"UPRN"}},{"url":"value","valueString":"123456789012"}]}]}]}
2023/09/15 20:52:38.208204 tttmplts.go:100: Caching 24 Templates
2023/09/15 20:52:38.212587 tttmplts.go:104: Template pdsretrieve_tmplt caused Error template: pdsretrieve_tmplt:190: undefined variable "$exp"
2023/09/15 20:52:38.213354 server.go:3217: http: panic serving [::1]:60415: runtime error: invalid memory address or nil pointer dereference
goroutine 36 [running]:
net/http.(*conn).serve.func1()
	/Users/IanThomas/sdk/go1.20.5/src/net/http/server.go:1854 +0xbf
panic({0x1434ca0, 0x17e4e70})
	/Users/IanThomas/sdk/go1.20.5/src/runtime/panic.go:890 +0x263
html/template.(*Template).New(0x14c1682?, {0xc0000bad50?, 0xc0005b3fc0?})
	/Users/IanThomas/sdk/go1.20.5/src/html/template/template.go:305 +0x37
main.(*Trans).cacheTemplates(0xc0002e2000)
	/Users/IanThomas/go/src/ttxdwuser/main/tttmplts.go:103 +0x1d2
main.(*Trans).setResponseFromTemplate(0xc0002e2000)
	/Users/IanThomas/go/src/ttxdwuser/main/tttmplts.go:85 +0x45
main.(*Trans).setPatientTemplate(0xc0002e2000)
	/Users/IanThomas/go/src/ttxdwuser/main/tttmplts.go:53 +0x1b1
main.(*Trans).newGetHandler(0xc0002e2000)
	/Users/IanThomas/go/src/ttxdwuser/main/ttgethandler.go:28 +0xd94
main.(*Trans).newProxyTrans(0xc0002e2000)
	/Users/IanThomas/go/src/ttxdwuser/main/ttproxy.go:73 +0x4d1
main.Handle_HTTP_Request({0x15657d0, 0xc0002aa460}, 0xc0002ca000)
	/Users/IanThomas/go/src/ttxdwuser/main/ttproxy.go:15 +0xeb
net/http.HandlerFunc.ServeHTTP(0xc0002cc01f?, {0x15657d0?, 0xc0002aa460?}, 0x1064cee?)
	/Users/IanThomas/sdk/go1.20.5/src/net/http/server.go:2122 +0x2f
net/http.serverHandler.ServeHTTP({0xc000292270?}, {0x15657d0, 0xc0002aa460}, 0xc0002ca000)
	/Users/IanThomas/sdk/go1.20.5/src/net/http/server.go:2936 +0x316
net/http.(*conn).serve(0xc000227830, {0x15659c8, 0xc000219c80})
	/Users/IanThomas/sdk/go1.20.5/src/net/http/server.go:1995 +0x612
created by net/http.(*Server).Serve
	/Users/IanThomas/sdk/go1.20.5/src/net/http/server.go:3089 +0x5ed
2023/09/15 20:53:45.290498 ttserver.go:52: ICB Workflow Service stopped
2023/09/15 20:53:47.072004 ttutil.go:133: -----------------------------------------------------------------------------------
2023/09/15 20:53:47.072464 ttdb.go:51: Opening DB Connection to mysql instance
User: root
Host: tuk.coil1nnpqdlr.eu-west-1.rds.amazonaws.com
Port: :3306
Name: tuk
Connect Timeout 2s
Read Timeout 5s
2023/09/15 20:53:47.072582 ttdb.go:54: Opened Database
2023/09/15 20:53:47.254952 ttdb.go:379: Persisting Template dsubcancel_tmplt
2023/09/15 20:53:47.318180 ttdb.go:385: Persisted Template dsubcancel_tmplt
2023/09/15 20:53:47.318234 ttdb.go:366: Persisted Template dsubcancel_tmplt.xml
2023/09/15 20:53:47.381954 ttdb.go:379: Persisting Template cgl_tmplt
2023/09/15 20:53:47.480496 ttdb.go:385: Persisted Template cgl_tmplt
2023/09/15 20:53:47.480538 ttdb.go:366: Persisted Template cgl_tmplt.html
2023/09/15 20:53:47.544923 ttdb.go:379: Persisting Template pdssearch_tmplt
2023/09/15 20:53:47.611385 ttdb.go:385: Persisted Template pdssearch_tmplt
2023/09/15 20:53:47.611523 ttdb.go:366: Persisted Template pdssearch_tmplt.html
2023/09/15 20:53:47.675791 ttdb.go:379: Persisting Template dsubsubscribe_tmplt
2023/09/15 20:53:47.743767 ttdb.go:385: Persisted Template dsubsubscribe_tmplt
2023/09/15 20:53:47.743842 ttdb.go:366: Persisted Template dsubsubscribe_tmplt.xml
2023/09/15 20:53:47.807420 ttdb.go:379: Persisting Template notification_tmplt
2023/09/15 20:53:47.870620 ttdb.go:385: Persisted Template notification_tmplt
2023/09/15 20:53:47.870667 ttdb.go:366: Persisted Template notification_tmplt.txt
2023/09/15 20:53:47.934337 ttdb.go:379: Persisting Template wfstate2t_tmplt
2023/09/15 20:53:48.050003 ttdb.go:385: Persisted Template wfstate2t_tmplt
2023/09/15 20:53:48.050041 ttdb.go:366: Persisted Template wfstate2t_tmplt.html
2023/09/15 20:53:48.111900 ttdb.go:379: Persisting Template publishfile2t_tmplt
2023/09/15 20:53:48.176197 ttdb.go:385: Persisted Template publishfile2t_tmplt
2023/09/15 20:53:48.176227 ttdb.go:366: Persisted Template publishfile2t_tmplt.html
2023/09/15 20:53:48.240491 ttdb.go:379: Persisting Template react_tmplt
2023/09/15 20:53:48.303917 ttdb.go:385: Persisted Template react_tmplt
2023/09/15 20:53:48.303972 ttdb.go:366: Persisted Template react_tmplt.html
2023/09/15 20:53:48.368266 ttdb.go:379: Persisting Template pdsretrieve_tmplt
2023/09/15 20:53:48.436087 ttdb.go:385: Persisted Template pdsretrieve_tmplt
2023/09/15 20:53:48.436145 ttdb.go:366: Persisted Template pdsretrieve_tmplt.html
2023/09/15 20:53:48.500339 ttdb.go:379: Persisting Template allpatientSrvs_tmplt
2023/09/15 20:53:48.565303 ttdb.go:385: Persisted Template allpatientSrvs_tmplt
2023/09/15 20:53:48.565472 ttdb.go:366: Persisted Template allpatientSrvs_tmplt.html
2023/09/15 20:53:48.638146 ttdb.go:379: Persisting Template spa2t_tmplt
2023/09/15 20:53:48.713877 ttdb.go:385: Persisted Template spa2t_tmplt
2023/09/15 20:53:48.713921 ttdb.go:366: Persisted Template spa2t_tmplt.html
2023/09/15 20:53:48.778791 ttdb.go:379: Persisting Template xdw2t_tmplt
2023/09/15 20:53:48.859899 ttdb.go:385: Persisted Template xdw2t_tmplt
2023/09/15 20:53:48.860021 ttdb.go:366: Persisted Template xdw2t_tmplt.html
2023/09/15 20:53:48.924961 ttdb.go:379: Persisting Template spaheader2t_tmplt
2023/09/15 20:53:48.995456 ttdb.go:385: Persisted Template spaheader2t_tmplt
2023/09/15 20:53:48.995605 ttdb.go:366: Persisted Template spaheader2t_tmplt.html
2023/09/15 20:53:49.062696 ttdb.go:379: Persisting Template pds_tmplt
2023/09/15 20:53:49.128167 ttdb.go:385: Persisted Template pds_tmplt
2023/09/15 20:53:49.128303 ttdb.go:366: Persisted Template pds_tmplt.html
2023/09/15 20:53:49.198447 ttdb.go:379: Persisting Template error_tmplt
2023/09/15 20:53:49.264300 ttdb.go:385: Persisted Template error_tmplt
2023/09/15 20:53:49.264431 ttdb.go:366: Persisted Template error_tmplt.html
2023/09/15 20:53:49.330358 ttdb.go:379: Persisting Template dsuback_tmplt
2023/09/15 20:53:49.396839 ttdb.go:385: Persisted Template dsuback_tmplt
2023/09/15 20:53:49.396983 ttdb.go:366: Persisted Template dsuback_tmplt.xml
2023/09/15 20:53:49.461890 ttdb.go:379: Persisting Template pixm_tmplt
2023/09/15 20:53:49.531278 ttdb.go:385: Persisted Template pixm_tmplt
2023/09/15 20:53:49.531372 ttdb.go:366: Persisted Template pixm_tmplt.html
2023/09/15 20:53:49.596373 ttdb.go:379: Persisting Template subscriptions2t_tmplt
2023/09/15 20:53:49.665254 ttdb.go:385: Persisted Template subscriptions2t_tmplt
2023/09/15 20:53:49.665342 ttdb.go:366: Persisted Template subscriptions2t_tmplt.html
2023/09/15 20:53:49.730237 ttdb.go:379: Persisting Template codemaps2t_tmplt
2023/09/15 20:53:49.798780 ttdb.go:385: Persisted Template codemaps2t_tmplt
2023/09/15 20:53:49.798823 ttdb.go:366: Persisted Template codemaps2t_tmplt.html
2023/09/15 20:53:49.863915 ttdb.go:379: Persisting Template mhdpublish_tmplt
2023/09/15 20:53:49.935188 ttdb.go:385: Persisted Template mhdpublish_tmplt
2023/09/15 20:53:49.935316 ttdb.go:366: Persisted Template mhdpublish_tmplt.json
2023/09/15 20:53:50.001486 ttdb.go:379: Persisting Template events_tmplt
2023/09/15 20:53:50.070177 ttdb.go:385: Persisted Template events_tmplt
2023/09/15 20:53:50.070319 ttdb.go:366: Persisted Template events_tmplt.html
2023/09/15 20:53:50.136375 ttdb.go:379: Persisting Template uploadfile2t_tmplt
2023/09/15 20:53:50.203356 ttdb.go:385: Persisted Template uploadfile2t_tmplt
2023/09/15 20:53:50.203485 ttdb.go:366: Persisted Template uploadfile2t_tmplt.html
2023/09/15 20:53:50.203732 ttserver.go:40: Starting ICB Workflow Service. Service Endpoint http://MacBook-Pro-3.lan:8080/
2023/09/15 20:53:55.438585 ttgethandler.go:10: Processing new GET Request
2023/09/15 20:53:55.438751 ttproxy.go:138: 	Request Query Params
2023/09/15 20:53:55.439231 ttutil.go:140: 	{
  "User": "ian.thomas",
  "Org": "2tsolutions",
  "Role": "clinical",
  "Nhs": "9000000009"
}
2023/09/15 20:53:55.439288 ttgethandler.go:15: Path = /beta/spa/consumer/patient
2023/09/15 20:53:55.439357 tttmplts.go:37: CGL Worker starting
2023/09/15 20:53:55.439374 tttmplts.go:30: PIXm Worker starting
2023/09/15 20:53:55.440283 tthttp.go:15: Creating PIXm PDQ - Server URL http://lac-demo-01.tianispirit.co.uk:8081/SpiritPIXFhir/r4/Patient?identifier=2.16.840.1.113883.2.1.4.1%7C9000000009
2023/09/15 20:53:55.443405 tthttp.go:160: Request Headers 
map[Content-Type:[application/json]]
2023/09/15 20:53:55.443527 tthttp.go:160: Request Headers 
map[Accept:[application/json] X-Api-Key:[FNhb#OhxWiEiMdf+@6085k5Zmt] X-Api-Secret:[9710ea0fb4ffb5d56c2e62c71c30bdfhjsyr56a79d]]
2023/09/15 20:53:55.656025 tthttp.go:174: Server Response - Status Code 404 
{"errors":[{"message":"No clients matching nhs number 9000000009","path":"\/"}],"status":404}
2023/09/15 20:53:55.660148 ttutil.go:140: 	{
  "data": {
    "client": {
      "basicDetails": {
        "address": {},
        "name": {}
      },
      "bbvInformation": {},
      "drugTestResults": {
        "results": {}
      },
      "riskInformation": {
        "mentalHealthDomain": {},
        "riskOfHarmToSelfDomain": {},
        "socialDomain": {},
        "substanceMisuseDomain": {}
      },
      "safeguardingInformation": {}
    },
    "keyWorker": {
      "name": {}
    }
  }
}
2023/09/15 20:53:55.660259 tttmplts.go:39: CGL Worker done
2023/09/15 20:53:55.660316 tttmplts.go:40: CGL Worker Status Code 404
2023/09/15 20:54:00.440749 tthttp.go:174: Server Response - Status Code 0 
2023/09/15 20:54:00.441412 tttmplts.go:32: PIXm Worker done
2023/09/15 20:54:00.441484 tttmplts.go:33: PIXm Worker Status Code 408
2023/09/15 20:54:00.441658 tthttp.go:56: Creating PDS Search Request - Server URL https://sandbox.api.service.nhs.uk/personal-demographics/FHIR/R4/Patient/9000000009
2023/09/15 20:54:00.441853 tthttp.go:160: Request Headers 
map[Accept:[*/*] Content-Type:[application/json] X-Request-Id:[84347188-c2a3-4c41-a34c-5721686cf180]]
2023/09/15 20:54:00.683091 tthttp.go:174: Server Response - Status Code 200 
{"resourceType":"Patient","id":"9000000009","identifier":[{"system":"https://fhir.nhs.uk/Id/nhs-number","value":"9000000009","extension":[{"url":"https://fhir.hl7.org.uk/StructureDefinition/Extension-UKCore-NHSNumberVerificationStatus","valueCodeableConcept":{"coding":[{"system":"https://fhir.hl7.org.uk/CodeSystem/UKCore-NHSNumberVerificationStatus","version":"1.0.0","code":"01","display":"Number present and verified"}]}}]}],"meta":{"versionId":"2","security":[{"system":"http://terminology.hl7.org/CodeSystem/v3-Confidentiality","code":"U","display":"unrestricted"}]},"name":[{"id":"123","use":"usual","period":{"start":"2020-01-01","end":"2021-12-31"},"given":["Jane"],"family":"Smith","prefix":["Mrs"],"suffix":["MBE"]}],"gender":"female","birthDate":"2010-10-22","multipleBirthInteger":1,"deceasedDateTime":"2010-10-22T00:00:00+00:00","generalPractitioner":[{"id":"254406A3","type":"Organization","identifier":{"system":"https://fhir.nhs.uk/Id/ods-organization-code","value":"Y12345","period":{"start":"2020-01-01","end":"2021-12-31"}}}],"managingOrganization":{"type":"Organization","identifier":{"system":"https://fhir.nhs.uk/Id/ods-organization-code","value":"Y12345","period":{"start":"2020-01-01","end":"2021-12-31"}}},"extension":[{"url":"https://fhir.hl7.org.uk/StructureDefinition/Extension-UKCore-NominatedPharmacy","valueReference":{"identifier":{"system":"https://fhir.nhs.uk/Id/ods-organization-code","value":"Y12345"}}},{"url":"https://fhir.hl7.org.uk/StructureDefinition/Extension-UKCore-PreferredDispenserOrganization","valueReference":{"identifier":{"system":"https://fhir.nhs.uk/Id/ods-organization-code","value":"Y23456"}}},{"url":"https://fhir.hl7.org.uk/StructureDefinition/Extension-UKCore-MedicalApplianceSupplier","valueReference":{"identifier":{"system":"https://fhir.nhs.uk/Id/ods-organization-code","value":"Y34567"}}},{"url":"https://fhir.hl7.org.uk/StructureDefinition/Extension-UKCore-DeathNotificationStatus","extension":[{"url":"deathNotificationStatus","valueCodeableConcept":{"coding":[{"system":"https://fhir.hl7.org.uk/CodeSystem/UKCore-DeathNotificationStatus","version":"1.0.0","code":"2","display":"Formal - death notice received from Registrar of Deaths"}]}},{"url":"systemEffectiveDate","valueDateTime":"2010-10-22T00:00:00+00:00"}]},{"url":"https://fhir.hl7.org.uk/StructureDefinition/Extension-UKCore-NHSCommunication","extension":[{"url":"language","valueCodeableConcept":{"coding":[{"system":"https://fhir.hl7.org.uk/CodeSystem/UKCore-HumanLanguage","version":"1.0.0","code":"fr","display":"French"}]}},{"url":"interpreterRequired","valueBoolean":true}]},{"url":"https://fhir.hl7.org.uk/StructureDefinition/Extension-UKCore-ContactPreference","extension":[{"url":"PreferredWrittenCommunicationFormat","valueCodeableConcept":{"coding":[{"system":"https://fhir.hl7.org.uk/CodeSystem/UKCore-PreferredWrittenCommunicationFormat","code":"12","display":"Braille"}]}},{"url":"PreferredContactMethod","valueCodeableConcept":{"coding":[{"system":"https://fhir.hl7.org.uk/CodeSystem/UKCore-PreferredContactMethod","code":"1","display":"Letter"}]}},{"url":"PreferredContactTimes","valueString":"Not after 7pm"}]},{"url":"http://hl7.org/fhir/StructureDefinition/patient-birthPlace","valueAddress":{"city":"Manchester","district":"Greater Manchester","country":"GBR"}},{"url":"https://fhir.nhs.uk/StructureDefinition/Extension-PDS-RemovalFromRegistration","extension":[{"url":"removalFromRegistrationCode","valueCodeableConcept":{"coding":[{"system":"https://fhir.nhs.uk/CodeSystem/PDS-RemovalReasonExitCode","code":"SCT","display":"Transferred to Scotland"}]}},{"url":"effectiveTime","valuePeriod":{"start":"2020-01-01T00:00:00+00:00","end":"2021-12-31T00:00:00+00:00"}}]}],"telecom":[{"id":"789","period":{"start":"2020-01-01","end":"2021-12-31"},"system":"phone","value":"01632960587","use":"home"},{"id":"790","period":{"start":"2019-01-01","end":"2022-12-31"},"system":"email","value":"jane.smith@example.com","use":"home"},{"id":"OC789","period":{"start":"2020-01-01","end":"2021-12-31"},"system":"other","value":"01632960587","use":"home","extension":[{"url":"https://fhir.hl7.org.uk/StructureDefinition/Extension-UKCore-OtherContactSystem","valueCoding":{"system":"https://fhir.hl7.org.uk/CodeSystem/UKCore-OtherContactSystem","code":"textphone","display":"Minicom (Textphone)"}}]}],"contact":[{"id":"C123","period":{"start":"2020-01-01","end":"2021-12-31"},"relationship":[{"coding":[{"system":"http://terminology.hl7.org/CodeSystem/v2-0131","code":"C","display":"Emergency Contact"}]}],"telecom":[{"system":"phone","value":"01632960587"}]}],"address":[{"id":"456","period":{"start":"2020-01-01","end":"2021-12-31"},"use":"home","line":["1 Trevelyan Square","Boar Lane","City Centre","Leeds","West Yorkshire"],"postalCode":"LS1 6AE","extension":[{"url":"https://fhir.hl7.org.uk/StructureDefinition/Extension-UKCore-AddressKey","extension":[{"url":"type","valueCoding":{"system":"https://fhir.hl7.org.uk/CodeSystem/UKCore-AddressKeyType","code":"PAF"}},{"url":"value","valueString":"12345678"}]},{"url":"https://fhir.hl7.org.uk/StructureDefinition/Extension-UKCore-AddressKey","extension":[{"url":"type","valueCoding":{"system":"https://fhir.hl7.org.uk/CodeSystem/UKCore-AddressKeyType","code":"UPRN"}},{"url":"value","valueString":"123456789012"}]}]},{"id":"T456","period":{"start":"2020-01-01","end":"2021-12-31"},"use":"temp","text":"Student Accommodation","line":["1 Trevelyan Square","Boar Lane","City Centre","Leeds","West Yorkshire"],"postalCode":"LS1 6AE","extension":[{"url":"https://fhir.hl7.org.uk/StructureDefinition/Extension-UKCore-AddressKey","extension":[{"url":"type","valueCoding":{"system":"https://fhir.hl7.org.uk/CodeSystem/UKCore-AddressKeyType","code":"PAF"}},{"url":"value","valueString":"12345678"}]},{"url":"https://fhir.hl7.org.uk/StructureDefinition/Extension-UKCore-AddressKey","extension":[{"url":"type","valueCoding":{"system":"https://fhir.hl7.org.uk/CodeSystem/UKCore-AddressKeyType","code":"UPRN"}},{"url":"value","valueString":"123456789012"}]}]}]}
2023/09/15 20:54:00.880832 tttmplts.go:100: Caching 24 Templates
2023/09/15 20:54:00.888517 tttmplts.go:87: Processing Template allpatientSrvs_tmplt
2023/09/15 20:54:00.960843 ttproxy.go:149: Response Status Code 200
2023/09/15 21:00:56.300618 ttserver.go:52: ICB Workflow Service stopped
