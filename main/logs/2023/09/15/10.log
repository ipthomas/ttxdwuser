2023/09/15 10:25:01.519568 ttutil.go:133: -----------------------------------------------------------------------------------
2023/09/15 10:25:01.520058 ttdb.go:51: Opening DB Connection to mysql instance
User: root
Host: tuk.coil1nnpqdlr.eu-west-1.rds.amazonaws.com
Port: :3306
Name: tuk
Connect Timeout 2s
Read Timeout 5s
2023/09/15 10:25:01.520194 ttdb.go:54: Opened Database
2023/09/15 10:25:01.924386 ttdb.go:379: Persisting Template dsubcancel_tmplt
2023/09/15 10:25:02.045425 ttdb.go:385: Persisted Template dsubcancel_tmplt
2023/09/15 10:25:02.045690 ttdb.go:366: Persisted Template dsubcancel_tmplt.xml
2023/09/15 10:25:02.123549 ttdb.go:379: Persisting Template cgl_tmplt
2023/09/15 10:25:02.221229 ttdb.go:385: Persisted Template cgl_tmplt
2023/09/15 10:25:02.221294 ttdb.go:366: Persisted Template cgl_tmplt.html
2023/09/15 10:25:02.287895 ttdb.go:379: Persisting Template pdssearch_tmplt
2023/09/15 10:25:02.354475 ttdb.go:385: Persisted Template pdssearch_tmplt
2023/09/15 10:25:02.354515 ttdb.go:366: Persisted Template pdssearch_tmplt.html
2023/09/15 10:25:02.416961 ttdb.go:379: Persisting Template dsubsubscribe_tmplt
2023/09/15 10:25:02.477448 ttdb.go:385: Persisted Template dsubsubscribe_tmplt
2023/09/15 10:25:02.477599 ttdb.go:366: Persisted Template dsubsubscribe_tmplt.xml
2023/09/15 10:25:02.539119 ttdb.go:379: Persisting Template notification_tmplt
2023/09/15 10:25:02.600796 ttdb.go:385: Persisted Template notification_tmplt
2023/09/15 10:25:02.600879 ttdb.go:366: Persisted Template notification_tmplt.txt
2023/09/15 10:25:02.662930 ttdb.go:379: Persisting Template wfstate2t_tmplt
2023/09/15 10:25:02.777657 ttdb.go:385: Persisted Template wfstate2t_tmplt
2023/09/15 10:25:02.777727 ttdb.go:366: Persisted Template wfstate2t_tmplt.html
2023/09/15 10:25:02.840402 ttdb.go:379: Persisting Template publishfile2t_tmplt
2023/09/15 10:25:02.905631 ttdb.go:385: Persisted Template publishfile2t_tmplt
2023/09/15 10:25:02.905723 ttdb.go:366: Persisted Template publishfile2t_tmplt.html
2023/09/15 10:25:02.972366 ttdb.go:379: Persisting Template react_tmplt
2023/09/15 10:25:03.035161 ttdb.go:385: Persisted Template react_tmplt
2023/09/15 10:25:03.035251 ttdb.go:366: Persisted Template react_tmplt.html
2023/09/15 10:25:03.099145 ttdb.go:379: Persisting Template pdsretrieve_tmplt
2023/09/15 10:25:03.163418 ttdb.go:385: Persisted Template pdsretrieve_tmplt
2023/09/15 10:25:03.163518 ttdb.go:366: Persisted Template pdsretrieve_tmplt.html
2023/09/15 10:25:03.227875 ttdb.go:379: Persisting Template allpatientSrvs_tmplt
2023/09/15 10:25:03.296449 ttdb.go:385: Persisted Template allpatientSrvs_tmplt
2023/09/15 10:25:03.296596 ttdb.go:366: Persisted Template allpatientSrvs_tmplt.html
2023/09/15 10:25:03.378379 ttdb.go:379: Persisting Template spa2t_tmplt
2023/09/15 10:25:03.453192 ttdb.go:385: Persisted Template spa2t_tmplt
2023/09/15 10:25:03.453360 ttdb.go:366: Persisted Template spa2t_tmplt.html
2023/09/15 10:25:03.516969 ttdb.go:379: Persisting Template xdw2t_tmplt
2023/09/15 10:25:03.594121 ttdb.go:385: Persisted Template xdw2t_tmplt
2023/09/15 10:25:03.594307 ttdb.go:366: Persisted Template xdw2t_tmplt.html
2023/09/15 10:25:03.659943 ttdb.go:379: Persisting Template spaheader2t_tmplt
2023/09/15 10:25:03.728153 ttdb.go:385: Persisted Template spaheader2t_tmplt
2023/09/15 10:25:03.728277 ttdb.go:366: Persisted Template spaheader2t_tmplt.html
2023/09/15 10:25:03.791317 ttdb.go:379: Persisting Template pds_tmplt
2023/09/15 10:25:03.851998 ttdb.go:385: Persisted Template pds_tmplt
2023/09/15 10:25:03.852022 ttdb.go:366: Persisted Template pds_tmplt.html
2023/09/15 10:25:03.912590 ttdb.go:379: Persisting Template error_tmplt
2023/09/15 10:25:03.973634 ttdb.go:385: Persisted Template error_tmplt
2023/09/15 10:25:03.973739 ttdb.go:366: Persisted Template error_tmplt.html
2023/09/15 10:25:04.036817 ttdb.go:379: Persisting Template dsuback_tmplt
2023/09/15 10:25:04.098257 ttdb.go:385: Persisted Template dsuback_tmplt
2023/09/15 10:25:04.098422 ttdb.go:366: Persisted Template dsuback_tmplt.xml
2023/09/15 10:25:04.162103 ttdb.go:379: Persisting Template pixm_tmplt
2023/09/15 10:25:04.234261 ttdb.go:385: Persisted Template pixm_tmplt
2023/09/15 10:25:04.234384 ttdb.go:366: Persisted Template pixm_tmplt.html
2023/09/15 10:25:04.298599 ttdb.go:379: Persisting Template subscriptions2t_tmplt
2023/09/15 10:25:04.363435 ttdb.go:385: Persisted Template subscriptions2t_tmplt
2023/09/15 10:25:04.363558 ttdb.go:366: Persisted Template subscriptions2t_tmplt.html
2023/09/15 10:25:04.426772 ttdb.go:379: Persisting Template codemaps2t_tmplt
2023/09/15 10:25:04.492102 ttdb.go:385: Persisted Template codemaps2t_tmplt
2023/09/15 10:25:04.492204 ttdb.go:366: Persisted Template codemaps2t_tmplt.html
2023/09/15 10:25:04.554661 ttdb.go:379: Persisting Template mhdpublish_tmplt
2023/09/15 10:25:04.623669 ttdb.go:385: Persisted Template mhdpublish_tmplt
2023/09/15 10:25:04.623813 ttdb.go:366: Persisted Template mhdpublish_tmplt.json
2023/09/15 10:25:04.687677 ttdb.go:379: Persisting Template events_tmplt
2023/09/15 10:25:04.758540 ttdb.go:385: Persisted Template events_tmplt
2023/09/15 10:25:04.758678 ttdb.go:366: Persisted Template events_tmplt.html
2023/09/15 10:25:04.880618 ttdb.go:379: Persisting Template uploadfile2t_tmplt
2023/09/15 10:25:05.005534 ttdb.go:385: Persisted Template uploadfile2t_tmplt
2023/09/15 10:25:05.005592 ttdb.go:366: Persisted Template uploadfile2t_tmplt.html
2023/09/15 10:25:05.005685 ttserver.go:40: Starting ICB Workflow Service. Service Endpoint http://MacBook-Pro-3.lan:8080/
2023/09/15 10:25:19.079121 ttgethandler.go:10: Processing new GET Request
2023/09/15 10:25:19.079315 ttproxy.go:138: 	Request Query Params
2023/09/15 10:25:19.079690 ttutil.go:140: 	{
  "User": "ian.thomas",
  "Org": "2tsolutions",
  "Role": "clinical",
  "Nhs": "9000000009"
}
2023/09/15 10:25:19.079727 ttgethandler.go:15: Path = /beta/spa/consumer/patient
2023/09/15 10:25:19.079770 tttmplts.go:37: CGL Worker starting
2023/09/15 10:25:19.079773 tttmplts.go:30: PIXm Worker starting
2023/09/15 10:25:19.079948 tthttp.go:15: Creating PIXm PDQ - Server URL http://lac-demo-01.tianispirit.co.uk:8081/SpiritPIXFhir/r4/Patient?identifier=2.16.840.1.113883.2.1.4.1%7C9000000009
2023/09/15 10:25:19.081476 tthttp.go:160: Request Headers 
map[Accept:[application/json] X-Api-Key:[FNhb#OhxWiEiMdf+@6085k5Zmt] X-Api-Secret:[9710ea0fb4ffb5d56c2e62c71c30bdfhjsyr56a79d]]
2023/09/15 10:25:19.081496 tthttp.go:160: Request Headers 
map[Content-Type:[application/json]]
2023/09/15 10:25:19.549800 tthttp.go:174: Server Response - Status Code 404 
{"errors":[{"message":"No clients matching nhs number 9000000009","path":"\/"}],"status":404}
2023/09/15 10:25:19.555795 ttutil.go:140: 	{
  "data": {
    "client": {
      "basicDetails": {
        "address": {},
        "name": {}
      },
      "bbvInformation": {},
      "drugTestResults": {
        "results": {}
      },
      "riskInformation": {
        "mentalHealthDomain": {},
        "riskOfHarmToSelfDomain": {},
        "socialDomain": {},
        "substanceMisuseDomain": {}
      },
      "safeguardingInformation": {}
    },
    "keyWorker": {
      "name": {}
    }
  }
}
2023/09/15 10:25:19.555927 tttmplts.go:39: CGL Worker done
2023/09/15 10:25:19.555957 tttmplts.go:40: CGL Worker Status Code 404
2023/09/15 10:25:24.081467 tthttp.go:174: Server Response - Status Code 0 
2023/09/15 10:25:24.083165 tttmplts.go:32: PIXm Worker done
2023/09/15 10:25:24.083239 tttmplts.go:33: PIXm Worker Status Code 408
2023/09/15 10:25:24.083463 tthttp.go:56: Creating PDS Search Request - Server URL https://sandbox.api.service.nhs.uk/personal-demographics/FHIR/R4/Patient/9000000009
2023/09/15 10:25:24.083613 tthttp.go:160: Request Headers 
map[Accept:[*/*] Content-Type:[application/json] X-Request-Id:[943d86a3-1b90-492f-91c5-7d7463ec80b6]]
2023/09/15 10:25:25.411156 tthttp.go:174: Server Response - Status Code 200 
{"resourceType":"Patient","id":"9000000009","identifier":[{"system":"https://fhir.nhs.uk/Id/nhs-number","value":"9000000009","extension":[{"url":"https://fhir.hl7.org.uk/StructureDefinition/Extension-UKCore-NHSNumberVerificationStatus","valueCodeableConcept":{"coding":[{"system":"https://fhir.hl7.org.uk/CodeSystem/UKCore-NHSNumberVerificationStatus","version":"1.0.0","code":"01","display":"Number present and verified"}]}}]}],"meta":{"versionId":"2","security":[{"system":"http://terminology.hl7.org/CodeSystem/v3-Confidentiality","code":"U","display":"unrestricted"}]},"name":[{"id":"123","use":"usual","period":{"start":"2020-01-01","end":"2021-12-31"},"given":["Jane"],"family":"Smith","prefix":["Mrs"],"suffix":["MBE"]}],"gender":"female","birthDate":"2010-10-22","multipleBirthInteger":1,"deceasedDateTime":"2010-10-22T00:00:00+00:00","generalPractitioner":[{"id":"254406A3","type":"Organization","identifier":{"system":"https://fhir.nhs.uk/Id/ods-organization-code","value":"Y12345","period":{"start":"2020-01-01","end":"2021-12-31"}}}],"managingOrganization":{"type":"Organization","identifier":{"system":"https://fhir.nhs.uk/Id/ods-organization-code","value":"Y12345","period":{"start":"2020-01-01","end":"2021-12-31"}}},"extension":[{"url":"https://fhir.hl7.org.uk/StructureDefinition/Extension-UKCore-NominatedPharmacy","valueReference":{"identifier":{"system":"https://fhir.nhs.uk/Id/ods-organization-code","value":"Y12345"}}},{"url":"https://fhir.hl7.org.uk/StructureDefinition/Extension-UKCore-PreferredDispenserOrganization","valueReference":{"identifier":{"system":"https://fhir.nhs.uk/Id/ods-organization-code","value":"Y23456"}}},{"url":"https://fhir.hl7.org.uk/StructureDefinition/Extension-UKCore-MedicalApplianceSupplier","valueReference":{"identifier":{"system":"https://fhir.nhs.uk/Id/ods-organization-code","value":"Y34567"}}},{"url":"https://fhir.hl7.org.uk/StructureDefinition/Extension-UKCore-DeathNotificationStatus","extension":[{"url":"deathNotificationStatus","valueCodeableConcept":{"coding":[{"system":"https://fhir.hl7.org.uk/CodeSystem/UKCore-DeathNotificationStatus","version":"1.0.0","code":"2","display":"Formal - death notice received from Registrar of Deaths"}]}},{"url":"systemEffectiveDate","valueDateTime":"2010-10-22T00:00:00+00:00"}]},{"url":"https://fhir.hl7.org.uk/StructureDefinition/Extension-UKCore-NHSCommunication","extension":[{"url":"language","valueCodeableConcept":{"coding":[{"system":"https://fhir.hl7.org.uk/CodeSystem/UKCore-HumanLanguage","version":"1.0.0","code":"fr","display":"French"}]}},{"url":"interpreterRequired","valueBoolean":true}]},{"url":"https://fhir.hl7.org.uk/StructureDefinition/Extension-UKCore-ContactPreference","extension":[{"url":"PreferredWrittenCommunicationFormat","valueCodeableConcept":{"coding":[{"system":"https://fhir.hl7.org.uk/CodeSystem/UKCore-PreferredWrittenCommunicationFormat","code":"12","display":"Braille"}]}},{"url":"PreferredContactMethod","valueCodeableConcept":{"coding":[{"system":"https://fhir.hl7.org.uk/CodeSystem/UKCore-PreferredContactMethod","code":"1","display":"Letter"}]}},{"url":"PreferredContactTimes","valueString":"Not after 7pm"}]},{"url":"http://hl7.org/fhir/StructureDefinition/patient-birthPlace","valueAddress":{"city":"Manchester","district":"Greater Manchester","country":"GBR"}},{"url":"https://fhir.nhs.uk/StructureDefinition/Extension-PDS-RemovalFromRegistration","extension":[{"url":"removalFromRegistrationCode","valueCodeableConcept":{"coding":[{"system":"https://fhir.nhs.uk/CodeSystem/PDS-RemovalReasonExitCode","code":"SCT","display":"Transferred to Scotland"}]}},{"url":"effectiveTime","valuePeriod":{"start":"2020-01-01T00:00:00+00:00","end":"2021-12-31T00:00:00+00:00"}}]}],"telecom":[{"id":"789","period":{"start":"2020-01-01","end":"2021-12-31"},"system":"phone","value":"01632960587","use":"home"},{"id":"790","period":{"start":"2019-01-01","end":"2022-12-31"},"system":"email","value":"jane.smith@example.com","use":"home"},{"id":"OC789","period":{"start":"2020-01-01","end":"2021-12-31"},"system":"other","value":"01632960587","use":"home","extension":[{"url":"https://fhir.hl7.org.uk/StructureDefinition/Extension-UKCore-OtherContactSystem","valueCoding":{"system":"https://fhir.hl7.org.uk/CodeSystem/UKCore-OtherContactSystem","code":"textphone","display":"Minicom (Textphone)"}}]}],"contact":[{"id":"C123","period":{"start":"2020-01-01","end":"2021-12-31"},"relationship":[{"coding":[{"system":"http://terminology.hl7.org/CodeSystem/v2-0131","code":"C","display":"Emergency Contact"}]}],"telecom":[{"system":"phone","value":"01632960587"}]}],"address":[{"id":"456","period":{"start":"2020-01-01","end":"2021-12-31"},"use":"home","line":["1 Trevelyan Square","Boar Lane","City Centre","Leeds","West Yorkshire"],"postalCode":"LS1 6AE","extension":[{"url":"https://fhir.hl7.org.uk/StructureDefinition/Extension-UKCore-AddressKey","extension":[{"url":"type","valueCoding":{"system":"https://fhir.hl7.org.uk/CodeSystem/UKCore-AddressKeyType","code":"PAF"}},{"url":"value","valueString":"12345678"}]},{"url":"https://fhir.hl7.org.uk/StructureDefinition/Extension-UKCore-AddressKey","extension":[{"url":"type","valueCoding":{"system":"https://fhir.hl7.org.uk/CodeSystem/UKCore-AddressKeyType","code":"UPRN"}},{"url":"value","valueString":"123456789012"}]}]},{"id":"T456","period":{"start":"2020-01-01","end":"2021-12-31"},"use":"temp","text":"Student Accommodation","line":["1 Trevelyan Square","Boar Lane","City Centre","Leeds","West Yorkshire"],"postalCode":"LS1 6AE","extension":[{"url":"https://fhir.hl7.org.uk/StructureDefinition/Extension-UKCore-AddressKey","extension":[{"url":"type","valueCoding":{"system":"https://fhir.hl7.org.uk/CodeSystem/UKCore-AddressKeyType","code":"PAF"}},{"url":"value","valueString":"12345678"}]},{"url":"https://fhir.hl7.org.uk/StructureDefinition/Extension-UKCore-AddressKey","extension":[{"url":"type","valueCoding":{"system":"https://fhir.hl7.org.uk/CodeSystem/UKCore-AddressKeyType","code":"UPRN"}},{"url":"value","valueString":"123456789012"}]}]}]}
2023/09/15 10:25:25.619912 tttmplts.go:100: Caching 24 Templates
2023/09/15 10:25:25.627447 tttmplts.go:104: Template pdsretrieve_tmplt caused Error template: pdsretrieve_tmplt:113: unexpected EOF
2023/09/15 10:25:25.628195 server.go:3217: http: panic serving [::1]:64517: runtime error: invalid memory address or nil pointer dereference
goroutine 36 [running]:
net/http.(*conn).serve.func1()
	/Users/IanThomas/sdk/go1.20.5/src/net/http/server.go:1854 +0xbf
panic({0x1434ca0, 0x17e4e70})
	/Users/IanThomas/sdk/go1.20.5/src/runtime/panic.go:890 +0x263
html/template.(*Template).New(0x14c1682?, {0xc000028348?, 0xc000839fc0?})
	/Users/IanThomas/sdk/go1.20.5/src/html/template/template.go:305 +0x37
main.(*Trans).cacheTemplates(0xc0003cc000)
	/Users/IanThomas/go/src/ttxdwuser/main/tttmplts.go:103 +0x1d2
main.(*Trans).setResponseFromTemplate(0xc0003cc000)
	/Users/IanThomas/go/src/ttxdwuser/main/tttmplts.go:85 +0x45
main.(*Trans).setPatientTemplate(0xc0003cc000)
	/Users/IanThomas/go/src/ttxdwuser/main/tttmplts.go:53 +0x1b1
main.(*Trans).newGetHandler(0xc0003cc000)
	/Users/IanThomas/go/src/ttxdwuser/main/ttgethandler.go:28 +0xd94
main.(*Trans).newProxyTrans(0xc0003cc000)
	/Users/IanThomas/go/src/ttxdwuser/main/ttproxy.go:73 +0x4d1
main.Handle_HTTP_Request({0x15657d0, 0xc0002d9880}, 0xc0003b4000)
	/Users/IanThomas/go/src/ttxdwuser/main/ttproxy.go:15 +0xeb
net/http.HandlerFunc.ServeHTTP(0xc0003b601f?, {0x15657d0?, 0xc0002d9880?}, 0x1064cee?)
	/Users/IanThomas/sdk/go1.20.5/src/net/http/server.go:2122 +0x2f
net/http.serverHandler.ServeHTTP({0xc000292c90?}, {0x15657d0, 0xc0002d9880}, 0xc0003b4000)
	/Users/IanThomas/sdk/go1.20.5/src/net/http/server.go:2936 +0x316
net/http.(*conn).serve(0xc0000a8cf0, {0x15659c8, 0xc00009afc0})
	/Users/IanThomas/sdk/go1.20.5/src/net/http/server.go:1995 +0x612
created by net/http.(*Server).Serve
	/Users/IanThomas/sdk/go1.20.5/src/net/http/server.go:3089 +0x5ed
2023/09/15 10:27:38.787855 ttserver.go:52: ICB Workflow Service stopped
2023/09/15 10:27:40.518850 ttutil.go:133: -----------------------------------------------------------------------------------
2023/09/15 10:27:40.519388 ttdb.go:51: Opening DB Connection to mysql instance
User: root
Host: tuk.coil1nnpqdlr.eu-west-1.rds.amazonaws.com
Port: :3306
Name: tuk
Connect Timeout 2s
Read Timeout 5s
2023/09/15 10:27:40.519531 ttdb.go:54: Opened Database
2023/09/15 10:27:40.712424 ttdb.go:379: Persisting Template dsubcancel_tmplt
2023/09/15 10:27:40.778575 ttdb.go:385: Persisted Template dsubcancel_tmplt
2023/09/15 10:27:40.778629 ttdb.go:366: Persisted Template dsubcancel_tmplt.xml
2023/09/15 10:27:40.846615 ttdb.go:379: Persisting Template cgl_tmplt
2023/09/15 10:27:40.948964 ttdb.go:385: Persisted Template cgl_tmplt
2023/09/15 10:27:40.949025 ttdb.go:366: Persisted Template cgl_tmplt.html
2023/09/15 10:27:41.016926 ttdb.go:379: Persisting Template pdssearch_tmplt
2023/09/15 10:27:41.086130 ttdb.go:385: Persisted Template pdssearch_tmplt
2023/09/15 10:27:41.086169 ttdb.go:366: Persisted Template pdssearch_tmplt.html
2023/09/15 10:27:41.154172 ttdb.go:379: Persisting Template dsubsubscribe_tmplt
2023/09/15 10:27:41.222860 ttdb.go:385: Persisted Template dsubsubscribe_tmplt
2023/09/15 10:27:41.222916 ttdb.go:366: Persisted Template dsubsubscribe_tmplt.xml
2023/09/15 10:27:41.290226 ttdb.go:379: Persisting Template notification_tmplt
2023/09/15 10:27:41.356857 ttdb.go:385: Persisted Template notification_tmplt
2023/09/15 10:27:41.356897 ttdb.go:366: Persisted Template notification_tmplt.txt
2023/09/15 10:27:41.425180 ttdb.go:379: Persisting Template wfstate2t_tmplt
2023/09/15 10:27:41.548367 ttdb.go:385: Persisted Template wfstate2t_tmplt
2023/09/15 10:27:41.548424 ttdb.go:366: Persisted Template wfstate2t_tmplt.html
2023/09/15 10:27:41.618082 ttdb.go:379: Persisting Template publishfile2t_tmplt
2023/09/15 10:27:41.686285 ttdb.go:385: Persisted Template publishfile2t_tmplt
2023/09/15 10:27:41.686388 ttdb.go:366: Persisted Template publishfile2t_tmplt.html
2023/09/15 10:27:41.752973 ttdb.go:379: Persisting Template react_tmplt
2023/09/15 10:27:41.819174 ttdb.go:385: Persisted Template react_tmplt
2023/09/15 10:27:41.819225 ttdb.go:366: Persisted Template react_tmplt.html
2023/09/15 10:27:41.887494 ttdb.go:379: Persisting Template pdsretrieve_tmplt
2023/09/15 10:27:41.957895 ttdb.go:385: Persisted Template pdsretrieve_tmplt
2023/09/15 10:27:41.957937 ttdb.go:366: Persisted Template pdsretrieve_tmplt.html
2023/09/15 10:27:42.024965 ttdb.go:379: Persisting Template allpatientSrvs_tmplt
2023/09/15 10:27:42.091108 ttdb.go:385: Persisted Template allpatientSrvs_tmplt
2023/09/15 10:27:42.091134 ttdb.go:366: Persisted Template allpatientSrvs_tmplt.html
2023/09/15 10:27:42.159794 ttdb.go:379: Persisting Template spa2t_tmplt
2023/09/15 10:27:42.239989 ttdb.go:385: Persisted Template spa2t_tmplt
2023/09/15 10:27:42.240023 ttdb.go:366: Persisted Template spa2t_tmplt.html
2023/09/15 10:27:42.307583 ttdb.go:379: Persisting Template xdw2t_tmplt
2023/09/15 10:27:42.390020 ttdb.go:385: Persisted Template xdw2t_tmplt
2023/09/15 10:27:42.390071 ttdb.go:366: Persisted Template xdw2t_tmplt.html
2023/09/15 10:27:42.456757 ttdb.go:379: Persisting Template spaheader2t_tmplt
2023/09/15 10:27:42.528827 ttdb.go:385: Persisted Template spaheader2t_tmplt
2023/09/15 10:27:42.528853 ttdb.go:366: Persisted Template spaheader2t_tmplt.html
2023/09/15 10:27:42.596529 ttdb.go:379: Persisting Template pds_tmplt
2023/09/15 10:27:42.663521 ttdb.go:385: Persisted Template pds_tmplt
2023/09/15 10:27:42.663548 ttdb.go:366: Persisted Template pds_tmplt.html
2023/09/15 10:27:42.732140 ttdb.go:379: Persisting Template error_tmplt
2023/09/15 10:27:42.799205 ttdb.go:385: Persisted Template error_tmplt
2023/09/15 10:27:42.799340 ttdb.go:366: Persisted Template error_tmplt.html
2023/09/15 10:27:42.867658 ttdb.go:379: Persisting Template dsuback_tmplt
2023/09/15 10:27:42.934656 ttdb.go:385: Persisted Template dsuback_tmplt
2023/09/15 10:27:42.934772 ttdb.go:366: Persisted Template dsuback_tmplt.xml
2023/09/15 10:27:43.001374 ttdb.go:379: Persisting Template pixm_tmplt
2023/09/15 10:27:43.070737 ttdb.go:385: Persisted Template pixm_tmplt
2023/09/15 10:27:43.070788 ttdb.go:366: Persisted Template pixm_tmplt.html
2023/09/15 10:27:43.138320 ttdb.go:379: Persisting Template subscriptions2t_tmplt
2023/09/15 10:27:43.207121 ttdb.go:385: Persisted Template subscriptions2t_tmplt
2023/09/15 10:27:43.207152 ttdb.go:366: Persisted Template subscriptions2t_tmplt.html
2023/09/15 10:27:43.275406 ttdb.go:379: Persisting Template codemaps2t_tmplt
2023/09/15 10:27:43.349208 ttdb.go:385: Persisted Template codemaps2t_tmplt
2023/09/15 10:27:43.349393 ttdb.go:366: Persisted Template codemaps2t_tmplt.html
2023/09/15 10:27:43.418481 ttdb.go:379: Persisting Template mhdpublish_tmplt
2023/09/15 10:27:43.493614 ttdb.go:385: Persisted Template mhdpublish_tmplt
2023/09/15 10:27:43.493745 ttdb.go:366: Persisted Template mhdpublish_tmplt.json
2023/09/15 10:27:43.562475 ttdb.go:379: Persisting Template events_tmplt
2023/09/15 10:27:43.633412 ttdb.go:385: Persisted Template events_tmplt
2023/09/15 10:27:43.633544 ttdb.go:366: Persisted Template events_tmplt.html
2023/09/15 10:27:43.702182 ttdb.go:379: Persisting Template uploadfile2t_tmplt
2023/09/15 10:27:43.769108 ttdb.go:385: Persisted Template uploadfile2t_tmplt
2023/09/15 10:27:43.769240 ttdb.go:366: Persisted Template uploadfile2t_tmplt.html
2023/09/15 10:27:43.769565 ttserver.go:40: Starting ICB Workflow Service. Service Endpoint http://MacBook-Pro-3.lan:8080/
2023/09/15 10:27:50.644590 ttgethandler.go:10: Processing new GET Request
2023/09/15 10:27:50.644793 ttproxy.go:138: 	Request Query Params
2023/09/15 10:27:50.645417 ttutil.go:140: 	{
  "User": "ian.thomas",
  "Org": "2tsolutions",
  "Role": "clinical",
  "Nhs": "9000000009"
}
2023/09/15 10:27:50.645456 ttgethandler.go:15: Path = /beta/spa/consumer/patient
2023/09/15 10:27:50.645548 tttmplts.go:37: CGL Worker starting
2023/09/15 10:27:50.645547 tttmplts.go:30: PIXm Worker starting
2023/09/15 10:27:50.645924 tthttp.go:15: Creating PIXm PDQ - Server URL http://lac-demo-01.tianispirit.co.uk:8081/SpiritPIXFhir/r4/Patient?identifier=2.16.840.1.113883.2.1.4.1%7C9000000009
2023/09/15 10:27:50.648948 tthttp.go:160: Request Headers 
map[Content-Type:[application/json]]
2023/09/15 10:27:50.649105 tthttp.go:160: Request Headers 
map[Accept:[application/json] X-Api-Key:[FNhb#OhxWiEiMdf+@6085k5Zmt] X-Api-Secret:[9710ea0fb4ffb5d56c2e62c71c30bdfhjsyr56a79d]]
2023/09/15 10:27:51.031014 tthttp.go:174: Server Response - Status Code 404 
{"errors":[{"message":"No clients matching nhs number 9000000009","path":"\/"}],"status":404}
2023/09/15 10:27:51.036421 ttutil.go:140: 	{
  "data": {
    "client": {
      "basicDetails": {
        "address": {},
        "name": {}
      },
      "bbvInformation": {},
      "drugTestResults": {
        "results": {}
      },
      "riskInformation": {
        "mentalHealthDomain": {},
        "riskOfHarmToSelfDomain": {},
        "socialDomain": {},
        "substanceMisuseDomain": {}
      },
      "safeguardingInformation": {}
    },
    "keyWorker": {
      "name": {}
    }
  }
}
2023/09/15 10:27:51.036550 tttmplts.go:39: CGL Worker done
2023/09/15 10:27:51.036584 tttmplts.go:40: CGL Worker Status Code 404
2023/09/15 10:27:55.647880 tthttp.go:174: Server Response - Status Code 0 
2023/09/15 10:27:55.648113 tttmplts.go:32: PIXm Worker done
2023/09/15 10:27:55.648148 tttmplts.go:33: PIXm Worker Status Code 408
2023/09/15 10:27:55.648278 tthttp.go:56: Creating PDS Search Request - Server URL https://sandbox.api.service.nhs.uk/personal-demographics/FHIR/R4/Patient/9000000009
2023/09/15 10:27:55.648373 tthttp.go:160: Request Headers 
map[Accept:[*/*] Content-Type:[application/json] X-Request-Id:[f8d854bf-e5a9-4491-a49c-c13f8bf07871]]
2023/09/15 10:27:55.798583 tthttp.go:174: Server Response - Status Code 200 
{"resourceType":"Patient","id":"9000000009","identifier":[{"system":"https://fhir.nhs.uk/Id/nhs-number","value":"9000000009","extension":[{"url":"https://fhir.hl7.org.uk/StructureDefinition/Extension-UKCore-NHSNumberVerificationStatus","valueCodeableConcept":{"coding":[{"system":"https://fhir.hl7.org.uk/CodeSystem/UKCore-NHSNumberVerificationStatus","version":"1.0.0","code":"01","display":"Number present and verified"}]}}]}],"meta":{"versionId":"2","security":[{"system":"http://terminology.hl7.org/CodeSystem/v3-Confidentiality","code":"U","display":"unrestricted"}]},"name":[{"id":"123","use":"usual","period":{"start":"2020-01-01","end":"2021-12-31"},"given":["Jane"],"family":"Smith","prefix":["Mrs"],"suffix":["MBE"]}],"gender":"female","birthDate":"2010-10-22","multipleBirthInteger":1,"deceasedDateTime":"2010-10-22T00:00:00+00:00","generalPractitioner":[{"id":"254406A3","type":"Organization","identifier":{"system":"https://fhir.nhs.uk/Id/ods-organization-code","value":"Y12345","period":{"start":"2020-01-01","end":"2021-12-31"}}}],"managingOrganization":{"type":"Organization","identifier":{"system":"https://fhir.nhs.uk/Id/ods-organization-code","value":"Y12345","period":{"start":"2020-01-01","end":"2021-12-31"}}},"extension":[{"url":"https://fhir.hl7.org.uk/StructureDefinition/Extension-UKCore-NominatedPharmacy","valueReference":{"identifier":{"system":"https://fhir.nhs.uk/Id/ods-organization-code","value":"Y12345"}}},{"url":"https://fhir.hl7.org.uk/StructureDefinition/Extension-UKCore-PreferredDispenserOrganization","valueReference":{"identifier":{"system":"https://fhir.nhs.uk/Id/ods-organization-code","value":"Y23456"}}},{"url":"https://fhir.hl7.org.uk/StructureDefinition/Extension-UKCore-MedicalApplianceSupplier","valueReference":{"identifier":{"system":"https://fhir.nhs.uk/Id/ods-organization-code","value":"Y34567"}}},{"url":"https://fhir.hl7.org.uk/StructureDefinition/Extension-UKCore-DeathNotificationStatus","extension":[{"url":"deathNotificationStatus","valueCodeableConcept":{"coding":[{"system":"https://fhir.hl7.org.uk/CodeSystem/UKCore-DeathNotificationStatus","version":"1.0.0","code":"2","display":"Formal - death notice received from Registrar of Deaths"}]}},{"url":"systemEffectiveDate","valueDateTime":"2010-10-22T00:00:00+00:00"}]},{"url":"https://fhir.hl7.org.uk/StructureDefinition/Extension-UKCore-NHSCommunication","extension":[{"url":"language","valueCodeableConcept":{"coding":[{"system":"https://fhir.hl7.org.uk/CodeSystem/UKCore-HumanLanguage","version":"1.0.0","code":"fr","display":"French"}]}},{"url":"interpreterRequired","valueBoolean":true}]},{"url":"https://fhir.hl7.org.uk/StructureDefinition/Extension-UKCore-ContactPreference","extension":[{"url":"PreferredWrittenCommunicationFormat","valueCodeableConcept":{"coding":[{"system":"https://fhir.hl7.org.uk/CodeSystem/UKCore-PreferredWrittenCommunicationFormat","code":"12","display":"Braille"}]}},{"url":"PreferredContactMethod","valueCodeableConcept":{"coding":[{"system":"https://fhir.hl7.org.uk/CodeSystem/UKCore-PreferredContactMethod","code":"1","display":"Letter"}]}},{"url":"PreferredContactTimes","valueString":"Not after 7pm"}]},{"url":"http://hl7.org/fhir/StructureDefinition/patient-birthPlace","valueAddress":{"city":"Manchester","district":"Greater Manchester","country":"GBR"}},{"url":"https://fhir.nhs.uk/StructureDefinition/Extension-PDS-RemovalFromRegistration","extension":[{"url":"removalFromRegistrationCode","valueCodeableConcept":{"coding":[{"system":"https://fhir.nhs.uk/CodeSystem/PDS-RemovalReasonExitCode","code":"SCT","display":"Transferred to Scotland"}]}},{"url":"effectiveTime","valuePeriod":{"start":"2020-01-01T00:00:00+00:00","end":"2021-12-31T00:00:00+00:00"}}]}],"telecom":[{"id":"789","period":{"start":"2020-01-01","end":"2021-12-31"},"system":"phone","value":"01632960587","use":"home"},{"id":"790","period":{"start":"2019-01-01","end":"2022-12-31"},"system":"email","value":"jane.smith@example.com","use":"home"},{"id":"OC789","period":{"start":"2020-01-01","end":"2021-12-31"},"system":"other","value":"01632960587","use":"home","extension":[{"url":"https://fhir.hl7.org.uk/StructureDefinition/Extension-UKCore-OtherContactSystem","valueCoding":{"system":"https://fhir.hl7.org.uk/CodeSystem/UKCore-OtherContactSystem","code":"textphone","display":"Minicom (Textphone)"}}]}],"contact":[{"id":"C123","period":{"start":"2020-01-01","end":"2021-12-31"},"relationship":[{"coding":[{"system":"http://terminology.hl7.org/CodeSystem/v2-0131","code":"C","display":"Emergency Contact"}]}],"telecom":[{"system":"phone","value":"01632960587"}]}],"address":[{"id":"456","period":{"start":"2020-01-01","end":"2021-12-31"},"use":"home","line":["1 Trevelyan Square","Boar Lane","City Centre","Leeds","West Yorkshire"],"postalCode":"LS1 6AE","extension":[{"url":"https://fhir.hl7.org.uk/StructureDefinition/Extension-UKCore-AddressKey","extension":[{"url":"type","valueCoding":{"system":"https://fhir.hl7.org.uk/CodeSystem/UKCore-AddressKeyType","code":"PAF"}},{"url":"value","valueString":"12345678"}]},{"url":"https://fhir.hl7.org.uk/StructureDefinition/Extension-UKCore-AddressKey","extension":[{"url":"type","valueCoding":{"system":"https://fhir.hl7.org.uk/CodeSystem/UKCore-AddressKeyType","code":"UPRN"}},{"url":"value","valueString":"123456789012"}]}]},{"id":"T456","period":{"start":"2020-01-01","end":"2021-12-31"},"use":"temp","text":"Student Accommodation","line":["1 Trevelyan Square","Boar Lane","City Centre","Leeds","West Yorkshire"],"postalCode":"LS1 6AE","extension":[{"url":"https://fhir.hl7.org.uk/StructureDefinition/Extension-UKCore-AddressKey","extension":[{"url":"type","valueCoding":{"system":"https://fhir.hl7.org.uk/CodeSystem/UKCore-AddressKeyType","code":"PAF"}},{"url":"value","valueString":"12345678"}]},{"url":"https://fhir.hl7.org.uk/StructureDefinition/Extension-UKCore-AddressKey","extension":[{"url":"type","valueCoding":{"system":"https://fhir.hl7.org.uk/CodeSystem/UKCore-AddressKeyType","code":"UPRN"}},{"url":"value","valueString":"123456789012"}]}]}]}
2023/09/15 10:27:55.994889 tttmplts.go:100: Caching 24 Templates
2023/09/15 10:27:56.001304 tttmplts.go:87: Processing Template allpatientSrvs_tmplt
2023/09/15 10:27:56.003829 tttmplts.go:93: template: pdsretrieve_tmplt:82:53: executing "pdsretrieve_tmplt" at <.Code>: can't evaluate field Code in type struct { URL string "json:\"url,omitempty\""; ValueCoding struct { System string "json:\"system,omitempty\""; Code string "json:\"code,omitempty\"" } "json:\"valueCoding,omitempty\""; ValueString string "json:\"valueString,omitempty\"" }
2023/09/15 10:27:56.004002 ttproxy.go:105: template: pdsretrieve_tmplt:82:53: executing "pdsretrieve_tmplt" at <.Code>: can't evaluate field Code in type struct { URL string "json:\"url,omitempty\""; ValueCoding struct { System string "json:\"system,omitempty\""; Code string "json:\"code,omitempty\"" } "json:\"valueCoding,omitempty\""; ValueString string "json:\"valueString,omitempty\"" }
2023/09/15 10:27:56.004051 ttproxy.go:149: Response Status Code 500
2023/09/15 10:27:56.004063 ttproxy.go:151: 
2023/09/15 10:27:56.004071 ttproxy.go:152: Response Headers
2023/09/15 10:27:56.004183 ttutil.go:140: 	{
  "Access-Control-Allow-Origin": "*",
  "Content-Type": "",
  "Server": "Workflow Service"
}
2023/09/15 10:27:56.004205 ttproxy.go:154: ----------------
2023/09/15 10:27:56.004213 ttproxy.go:155: Response
2023/09/15 10:27:56.004219 ttproxy.go:156: ----------------
2023/09/15 10:27:56.004624 ttutil.go:140: 	{
  "Host": "MacBook-Pro-3.lan",
  "Path": "/beta/spa/consumer/patient",
  "Method": "GET",
  "SourceIP": "[::1]:64559",
  "ReqContentType": "",
  "RspContentType": "",
  "ResponseBody": "{\"resourceType\":\"Patient\",\"id\":\"9000000009\",\"identifier\":[{\"system\":\"https://fhir.nhs.uk/Id/nhs-number\",\"value\":\"9000000009\",\"extension\":[{\"url\":\"https://fhir.hl7.org.uk/StructureDefinition/Extension-UKCore-NHSNumberVerificationStatus\",\"valueCodeableConcept\":{\"coding\":[{\"system\":\"https://fhir.hl7.org.uk/CodeSystem/UKCore-NHSNumberVerificationStatus\",\"version\":\"1.0.0\",\"code\":\"01\",\"display\":\"Number present and verified\"}]}}]}],\"meta\":{\"versionId\":\"2\",\"security\":[{\"system\":\"http://terminology.hl7.org/CodeSystem/v3-Confidentiality\",\"code\":\"U\",\"display\":\"unrestricted\"}]},\"name\":[{\"id\":\"123\",\"use\":\"usual\",\"period\":{\"start\":\"2020-01-01\",\"end\":\"2021-12-31\"},\"given\":[\"Jane\"],\"family\":\"Smith\",\"prefix\":[\"Mrs\"],\"suffix\":[\"MBE\"]}],\"gender\":\"female\",\"birthDate\":\"2010-10-22\",\"multipleBirthInteger\":1,\"deceasedDateTime\":\"2010-10-22T00:00:00+00:00\",\"generalPractitioner\":[{\"id\":\"254406A3\",\"type\":\"Organization\",\"identifier\":{\"system\":\"https://fhir.nhs.uk/Id/ods-organization-code\",\"value\":\"Y12345\",\"period\":{\"start\":\"2020-01-01\",\"end\":\"2021-12-31\"}}}],\"managingOrganization\":{\"type\":\"Organization\",\"identifier\":{\"system\":\"https://fhir.nhs.uk/Id/ods-organization-code\",\"value\":\"Y12345\",\"period\":{\"start\":\"2020-01-01\",\"end\":\"2021-12-31\"}}},\"extension\":[{\"url\":\"https://fhir.hl7.org.uk/StructureDefinition/Extension-UKCore-NominatedPharmacy\",\"valueReference\":{\"identifier\":{\"system\":\"https://fhir.nhs.uk/Id/ods-organization-code\",\"value\":\"Y12345\"}}},{\"url\":\"https://fhir.hl7.org.uk/StructureDefinition/Extension-UKCore-PreferredDispenserOrganization\",\"valueReference\":{\"identifier\":{\"system\":\"https://fhir.nhs.uk/Id/ods-organization-code\",\"value\":\"Y23456\"}}},{\"url\":\"https://fhir.hl7.org.uk/StructureDefinition/Extension-UKCore-MedicalApplianceSupplier\",\"valueReference\":{\"identifier\":{\"system\":\"https://fhir.nhs.uk/Id/ods-organization-code\",\"value\":\"Y34567\"}}},{\"url\":\"https://fhir.hl7.org.uk/StructureDefinition/Extension-UKCore-DeathNotificationStatus\",\"extension\":[{\"url\":\"deathNotificationStatus\",\"valueCodeableConcept\":{\"coding\":[{\"system\":\"https://fhir.hl7.org.uk/CodeSystem/UKCore-DeathNotificationStatus\",\"version\":\"1.0.0\",\"code\":\"2\",\"display\":\"Formal - death notice received from Registrar of Deaths\"}]}},{\"url\":\"systemEffectiveDate\",\"valueDateTime\":\"2010-10-22T00:00:00+00:00\"}]},{\"url\":\"https://fhir.hl7.org.uk/StructureDefinition/Extension-UKCore-NHSCommunication\",\"extension\":[{\"url\":\"language\",\"valueCodeableConcept\":{\"coding\":[{\"system\":\"https://fhir.hl7.org.uk/CodeSystem/UKCore-HumanLanguage\",\"version\":\"1.0.0\",\"code\":\"fr\",\"display\":\"French\"}]}},{\"url\":\"interpreterRequired\",\"valueBoolean\":true}]},{\"url\":\"https://fhir.hl7.org.uk/StructureDefinition/Extension-UKCore-ContactPreference\",\"extension\":[{\"url\":\"PreferredWrittenCommunicationFormat\",\"valueCodeableConcept\":{\"coding\":[{\"system\":\"https://fhir.hl7.org.uk/CodeSystem/UKCore-PreferredWrittenCommunicationFormat\",\"code\":\"12\",\"display\":\"Braille\"}]}},{\"url\":\"PreferredContactMethod\",\"valueCodeableConcept\":{\"coding\":[{\"system\":\"https://fhir.hl7.org.uk/CodeSystem/UKCore-PreferredContactMethod\",\"code\":\"1\",\"display\":\"Letter\"}]}},{\"url\":\"PreferredContactTimes\",\"valueString\":\"Not after 7pm\"}]},{\"url\":\"http://hl7.org/fhir/StructureDefinition/patient-birthPlace\",\"valueAddress\":{\"city\":\"Manchester\",\"district\":\"Greater Manchester\",\"country\":\"GBR\"}},{\"url\":\"https://fhir.nhs.uk/StructureDefinition/Extension-PDS-RemovalFromRegistration\",\"extension\":[{\"url\":\"removalFromRegistrationCode\",\"valueCodeableConcept\":{\"coding\":[{\"system\":\"https://fhir.nhs.uk/CodeSystem/PDS-RemovalReasonExitCode\",\"code\":\"SCT\",\"display\":\"Transferred to Scotland\"}]}},{\"url\":\"effectiveTime\",\"valuePeriod\":{\"start\":\"2020-01-01T00:00:00+00:00\",\"end\":\"2021-12-31T00:00:00+00:00\"}}]}],\"telecom\":[{\"id\":\"789\",\"period\":{\"start\":\"2020-01-01\",\"end\":\"2021-12-31\"},\"system\":\"phone\",\"value\":\"01632960587\",\"use\":\"home\"},{\"id\":\"790\",\"period\":{\"start\":\"2019-01-01\",\"end\":\"2022-12-31\"},\"system\":\"email\",\"value\":\"jane.smith@example.com\",\"use\":\"home\"},{\"id\":\"OC789\",\"period\":{\"start\":\"2020-01-01\",\"end\":\"2021-12-31\"},\"system\":\"other\",\"value\":\"01632960587\",\"use\":\"home\",\"extension\":[{\"url\":\"https://fhir.hl7.org.uk/StructureDefinition/Extension-UKCore-OtherContactSystem\",\"valueCoding\":{\"system\":\"https://fhir.hl7.org.uk/CodeSystem/UKCore-OtherContactSystem\",\"code\":\"textphone\",\"display\":\"Minicom (Textphone)\"}}]}],\"contact\":[{\"id\":\"C123\",\"period\":{\"start\":\"2020-01-01\",\"end\":\"2021-12-31\"},\"relationship\":[{\"coding\":[{\"system\":\"http://terminology.hl7.org/CodeSystem/v2-0131\",\"code\":\"C\",\"display\":\"Emergency Contact\"}]}],\"telecom\":[{\"system\":\"phone\",\"value\":\"01632960587\"}]}],\"address\":[{\"id\":\"456\",\"period\":{\"start\":\"2020-01-01\",\"end\":\"2021-12-31\"},\"use\":\"home\",\"line\":[\"1 Trevelyan Square\",\"Boar Lane\",\"City Centre\",\"Leeds\",\"West Yorkshire\"],\"postalCode\":\"LS1 6AE\",\"extension\":[{\"url\":\"https://fhir.hl7.org.uk/StructureDefinition/Extension-UKCore-AddressKey\",\"extension\":[{\"url\":\"type\",\"valueCoding\":{\"system\":\"https://fhir.hl7.org.uk/CodeSystem/UKCore-AddressKeyType\",\"code\":\"PAF\"}},{\"url\":\"value\",\"valueString\":\"12345678\"}]},{\"url\":\"https://fhir.hl7.org.uk/StructureDefinition/Extension-UKCore-AddressKey\",\"extension\":[{\"url\":\"type\",\"valueCoding\":{\"system\":\"https://fhir.hl7.org.uk/CodeSystem/UKCore-AddressKeyType\",\"code\":\"UPRN\"}},{\"url\":\"value\",\"valueString\":\"123456789012\"}]}]},{\"id\":\"T456\",\"period\":{\"start\":\"2020-01-01\",\"end\":\"2021-12-31\"},\"use\":\"temp\",\"text\":\"Student Accommodation\",\"line\":[\"1 Trevelyan Square\",\"Boar Lane\",\"City Centre\",\"Leeds\",\"West Yorkshire\"],\"postalCode\":\"LS1 6AE\",\"extension\":[{\"url\":\"https://fhir.hl7.org.uk/StructureDefinition/Extension-UKCore-AddressKey\",\"extension\":[{\"url\":\"type\",\"valueCoding\":{\"system\":\"https://fhir.hl7.org.uk/CodeSystem/UKCore-AddressKeyType\",\"code\":\"PAF\"}},{\"url\":\"value\",\"valueString\":\"12345678\"}]},{\"url\":\"https://fhir.hl7.org.uk/StructureDefinition/Extension-UKCore-AddressKey\",\"extension\":[{\"url\":\"type\",\"valueCoding\":{\"system\":\"https://fhir.hl7.org.uk/CodeSystem/UKCore-AddressKeyType\",\"code\":\"UPRN\"}},{\"url\":\"value\",\"valueString\":\"123456789012\"}]}]}]}",
  "StatusCode": 500,
  "IsBase64": false,
  "Timeout": 0
}
2023/09/15 10:27:56.004707 ttproxy.go:158: -------------
2023/09/15 10:27:56.004724 ttproxy.go:160: Error template: pdsretrieve_tmplt:82:53: executing "pdsretrieve_tmplt" at <.Code>: can't evaluate field Code in type struct { URL string "json:\"url,omitempty\""; ValueCoding struct { System string "json:\"system,omitempty\""; Code string "json:\"code,omitempty\"" } "json:\"valueCoding,omitempty\""; ValueString string "json:\"valueString,omitempty\"" }
2023/09/15 10:27:56.004731 ttproxy.go:161: -------------
2023/09/15 10:29:38.409487 ttserver.go:52: ICB Workflow Service stopped
2023/09/15 10:29:40.204221 ttutil.go:133: -----------------------------------------------------------------------------------
2023/09/15 10:29:40.204729 ttdb.go:51: Opening DB Connection to mysql instance
User: root
Host: tuk.coil1nnpqdlr.eu-west-1.rds.amazonaws.com
Port: :3306
Name: tuk
Connect Timeout 2s
Read Timeout 5s
2023/09/15 10:29:40.204858 ttdb.go:54: Opened Database
2023/09/15 10:29:40.381752 ttdb.go:379: Persisting Template dsubcancel_tmplt
2023/09/15 10:29:40.444901 ttdb.go:385: Persisted Template dsubcancel_tmplt
2023/09/15 10:29:40.444961 ttdb.go:366: Persisted Template dsubcancel_tmplt.xml
2023/09/15 10:29:40.508143 ttdb.go:379: Persisting Template cgl_tmplt
2023/09/15 10:29:40.605446 ttdb.go:385: Persisted Template cgl_tmplt
2023/09/15 10:29:40.605477 ttdb.go:366: Persisted Template cgl_tmplt.html
2023/09/15 10:29:40.669036 ttdb.go:379: Persisting Template pdssearch_tmplt
2023/09/15 10:29:40.736560 ttdb.go:385: Persisted Template pdssearch_tmplt
2023/09/15 10:29:40.736739 ttdb.go:366: Persisted Template pdssearch_tmplt.html
2023/09/15 10:29:40.800232 ttdb.go:379: Persisting Template dsubsubscribe_tmplt
2023/09/15 10:29:40.863724 ttdb.go:385: Persisted Template dsubsubscribe_tmplt
2023/09/15 10:29:40.863845 ttdb.go:366: Persisted Template dsubsubscribe_tmplt.xml
2023/09/15 10:29:40.926883 ttdb.go:379: Persisting Template notification_tmplt
2023/09/15 10:29:40.989544 ttdb.go:385: Persisted Template notification_tmplt
2023/09/15 10:29:40.989621 ttdb.go:366: Persisted Template notification_tmplt.txt
2023/09/15 10:29:41.054327 ttdb.go:379: Persisting Template wfstate2t_tmplt
2023/09/15 10:29:41.173142 ttdb.go:385: Persisted Template wfstate2t_tmplt
2023/09/15 10:29:41.173300 ttdb.go:366: Persisted Template wfstate2t_tmplt.html
2023/09/15 10:29:41.236411 ttdb.go:379: Persisting Template publishfile2t_tmplt
2023/09/15 10:29:41.301013 ttdb.go:385: Persisted Template publishfile2t_tmplt
2023/09/15 10:29:41.301159 ttdb.go:366: Persisted Template publishfile2t_tmplt.html
2023/09/15 10:29:41.364296 ttdb.go:379: Persisting Template react_tmplt
2023/09/15 10:29:41.428160 ttdb.go:385: Persisted Template react_tmplt
2023/09/15 10:29:41.428291 ttdb.go:366: Persisted Template react_tmplt.html
2023/09/15 10:29:41.493362 ttdb.go:379: Persisting Template pdsretrieve_tmplt
2023/09/15 10:29:41.558578 ttdb.go:385: Persisted Template pdsretrieve_tmplt
2023/09/15 10:29:41.558609 ttdb.go:366: Persisted Template pdsretrieve_tmplt.html
2023/09/15 10:29:41.620965 ttdb.go:379: Persisting Template allpatientSrvs_tmplt
2023/09/15 10:29:41.686569 ttdb.go:385: Persisted Template allpatientSrvs_tmplt
2023/09/15 10:29:41.686599 ttdb.go:366: Persisted Template allpatientSrvs_tmplt.html
2023/09/15 10:29:41.750131 ttdb.go:379: Persisting Template spa2t_tmplt
2023/09/15 10:29:41.826091 ttdb.go:385: Persisted Template spa2t_tmplt
2023/09/15 10:29:41.826133 ttdb.go:366: Persisted Template spa2t_tmplt.html
2023/09/15 10:29:41.888971 ttdb.go:379: Persisting Template xdw2t_tmplt
2023/09/15 10:29:41.968572 ttdb.go:385: Persisted Template xdw2t_tmplt
2023/09/15 10:29:41.968615 ttdb.go:366: Persisted Template xdw2t_tmplt.html
2023/09/15 10:29:42.035803 ttdb.go:379: Persisting Template spaheader2t_tmplt
2023/09/15 10:29:42.104277 ttdb.go:385: Persisted Template spaheader2t_tmplt
2023/09/15 10:29:42.104386 ttdb.go:366: Persisted Template spaheader2t_tmplt.html
2023/09/15 10:29:42.168926 ttdb.go:379: Persisting Template pds_tmplt
2023/09/15 10:29:42.235163 ttdb.go:385: Persisted Template pds_tmplt
2023/09/15 10:29:42.235304 ttdb.go:366: Persisted Template pds_tmplt.html
2023/09/15 10:29:42.301062 ttdb.go:379: Persisting Template error_tmplt
2023/09/15 10:29:42.365365 ttdb.go:385: Persisted Template error_tmplt
2023/09/15 10:29:42.365503 ttdb.go:366: Persisted Template error_tmplt.html
2023/09/15 10:29:42.594968 ttdb.go:379: Persisting Template dsuback_tmplt
2023/09/15 10:29:42.658908 ttdb.go:385: Persisted Template dsuback_tmplt
2023/09/15 10:29:42.659040 ttdb.go:366: Persisted Template dsuback_tmplt.xml
2023/09/15 10:29:42.722746 ttdb.go:379: Persisting Template pixm_tmplt
2023/09/15 10:29:42.789470 ttdb.go:385: Persisted Template pixm_tmplt
2023/09/15 10:29:42.789690 ttdb.go:366: Persisted Template pixm_tmplt.html
2023/09/15 10:29:42.853262 ttdb.go:379: Persisting Template subscriptions2t_tmplt
2023/09/15 10:29:42.922715 ttdb.go:385: Persisted Template subscriptions2t_tmplt
2023/09/15 10:29:42.922810 ttdb.go:366: Persisted Template subscriptions2t_tmplt.html
2023/09/15 10:29:42.986791 ttdb.go:379: Persisting Template codemaps2t_tmplt
2023/09/15 10:29:43.053913 ttdb.go:385: Persisted Template codemaps2t_tmplt
2023/09/15 10:29:43.054069 ttdb.go:366: Persisted Template codemaps2t_tmplt.html
2023/09/15 10:29:43.122431 ttdb.go:379: Persisting Template mhdpublish_tmplt
2023/09/15 10:29:43.194888 ttdb.go:385: Persisted Template mhdpublish_tmplt
2023/09/15 10:29:43.194981 ttdb.go:366: Persisted Template mhdpublish_tmplt.json
2023/09/15 10:29:43.266868 ttdb.go:379: Persisting Template events_tmplt
2023/09/15 10:29:43.337390 ttdb.go:385: Persisted Template events_tmplt
2023/09/15 10:29:43.337521 ttdb.go:366: Persisted Template events_tmplt.html
2023/09/15 10:29:43.402259 ttdb.go:379: Persisting Template uploadfile2t_tmplt
2023/09/15 10:29:43.469653 ttdb.go:385: Persisted Template uploadfile2t_tmplt
2023/09/15 10:29:43.469800 ttdb.go:366: Persisted Template uploadfile2t_tmplt.html
2023/09/15 10:29:43.470168 ttserver.go:40: Starting ICB Workflow Service. Service Endpoint http://MacBook-Pro-3.lan:8080/
2023/09/15 10:29:46.776999 ttgethandler.go:10: Processing new GET Request
2023/09/15 10:29:46.777175 ttproxy.go:138: 	Request Query Params
2023/09/15 10:29:46.777512 ttutil.go:140: 	{
  "User": "ian.thomas",
  "Org": "2tsolutions",
  "Role": "clinical",
  "Nhs": "9000000009"
}
2023/09/15 10:29:46.777545 ttgethandler.go:15: Path = /beta/spa/consumer/patient
2023/09/15 10:29:46.777575 tttmplts.go:37: CGL Worker starting
2023/09/15 10:29:46.777579 tttmplts.go:30: PIXm Worker starting
2023/09/15 10:29:46.778042 tthttp.go:15: Creating PIXm PDQ - Server URL http://lac-demo-01.tianispirit.co.uk:8081/SpiritPIXFhir/r4/Patient?identifier=2.16.840.1.113883.2.1.4.1%7C9000000009
2023/09/15 10:29:46.779117 tthttp.go:160: Request Headers 
map[Content-Type:[application/json]]
2023/09/15 10:29:46.779190 tthttp.go:160: Request Headers 
map[Accept:[application/json] X-Api-Key:[FNhb#OhxWiEiMdf+@6085k5Zmt] X-Api-Secret:[9710ea0fb4ffb5d56c2e62c71c30bdfhjsyr56a79d]]
2023/09/15 10:29:46.964278 tthttp.go:174: Server Response - Status Code 404 
{"errors":[{"message":"No clients matching nhs number 9000000009","path":"\/"}],"status":404}
2023/09/15 10:29:46.967279 ttutil.go:140: 	{
  "data": {
    "client": {
      "basicDetails": {
        "address": {},
        "name": {}
      },
      "bbvInformation": {},
      "drugTestResults": {
        "results": {}
      },
      "riskInformation": {
        "mentalHealthDomain": {},
        "riskOfHarmToSelfDomain": {},
        "socialDomain": {},
        "substanceMisuseDomain": {}
      },
      "safeguardingInformation": {}
    },
    "keyWorker": {
      "name": {}
    }
  }
}
2023/09/15 10:29:46.967360 tttmplts.go:39: CGL Worker done
2023/09/15 10:29:46.967381 tttmplts.go:40: CGL Worker Status Code 404
2023/09/15 10:29:51.779752 tthttp.go:174: Server Response - Status Code 0 
2023/09/15 10:29:51.780037 tttmplts.go:32: PIXm Worker done
2023/09/15 10:29:51.780081 tttmplts.go:33: PIXm Worker Status Code 408
2023/09/15 10:29:51.780247 tthttp.go:56: Creating PDS Search Request - Server URL https://sandbox.api.service.nhs.uk/personal-demographics/FHIR/R4/Patient/9000000009
2023/09/15 10:29:51.780382 tthttp.go:160: Request Headers 
map[Accept:[*/*] Content-Type:[application/json] X-Request-Id:[6d2f71d3-8573-413c-b40f-7c9cec16f099]]
2023/09/15 10:29:51.935382 tthttp.go:174: Server Response - Status Code 200 
{"resourceType":"Patient","id":"9000000009","identifier":[{"system":"https://fhir.nhs.uk/Id/nhs-number","value":"9000000009","extension":[{"url":"https://fhir.hl7.org.uk/StructureDefinition/Extension-UKCore-NHSNumberVerificationStatus","valueCodeableConcept":{"coding":[{"system":"https://fhir.hl7.org.uk/CodeSystem/UKCore-NHSNumberVerificationStatus","version":"1.0.0","code":"01","display":"Number present and verified"}]}}]}],"meta":{"versionId":"2","security":[{"system":"http://terminology.hl7.org/CodeSystem/v3-Confidentiality","code":"U","display":"unrestricted"}]},"name":[{"id":"123","use":"usual","period":{"start":"2020-01-01","end":"2021-12-31"},"given":["Jane"],"family":"Smith","prefix":["Mrs"],"suffix":["MBE"]}],"gender":"female","birthDate":"2010-10-22","multipleBirthInteger":1,"deceasedDateTime":"2010-10-22T00:00:00+00:00","generalPractitioner":[{"id":"254406A3","type":"Organization","identifier":{"system":"https://fhir.nhs.uk/Id/ods-organization-code","value":"Y12345","period":{"start":"2020-01-01","end":"2021-12-31"}}}],"managingOrganization":{"type":"Organization","identifier":{"system":"https://fhir.nhs.uk/Id/ods-organization-code","value":"Y12345","period":{"start":"2020-01-01","end":"2021-12-31"}}},"extension":[{"url":"https://fhir.hl7.org.uk/StructureDefinition/Extension-UKCore-NominatedPharmacy","valueReference":{"identifier":{"system":"https://fhir.nhs.uk/Id/ods-organization-code","value":"Y12345"}}},{"url":"https://fhir.hl7.org.uk/StructureDefinition/Extension-UKCore-PreferredDispenserOrganization","valueReference":{"identifier":{"system":"https://fhir.nhs.uk/Id/ods-organization-code","value":"Y23456"}}},{"url":"https://fhir.hl7.org.uk/StructureDefinition/Extension-UKCore-MedicalApplianceSupplier","valueReference":{"identifier":{"system":"https://fhir.nhs.uk/Id/ods-organization-code","value":"Y34567"}}},{"url":"https://fhir.hl7.org.uk/StructureDefinition/Extension-UKCore-DeathNotificationStatus","extension":[{"url":"deathNotificationStatus","valueCodeableConcept":{"coding":[{"system":"https://fhir.hl7.org.uk/CodeSystem/UKCore-DeathNotificationStatus","version":"1.0.0","code":"2","display":"Formal - death notice received from Registrar of Deaths"}]}},{"url":"systemEffectiveDate","valueDateTime":"2010-10-22T00:00:00+00:00"}]},{"url":"https://fhir.hl7.org.uk/StructureDefinition/Extension-UKCore-NHSCommunication","extension":[{"url":"language","valueCodeableConcept":{"coding":[{"system":"https://fhir.hl7.org.uk/CodeSystem/UKCore-HumanLanguage","version":"1.0.0","code":"fr","display":"French"}]}},{"url":"interpreterRequired","valueBoolean":true}]},{"url":"https://fhir.hl7.org.uk/StructureDefinition/Extension-UKCore-ContactPreference","extension":[{"url":"PreferredWrittenCommunicationFormat","valueCodeableConcept":{"coding":[{"system":"https://fhir.hl7.org.uk/CodeSystem/UKCore-PreferredWrittenCommunicationFormat","code":"12","display":"Braille"}]}},{"url":"PreferredContactMethod","valueCodeableConcept":{"coding":[{"system":"https://fhir.hl7.org.uk/CodeSystem/UKCore-PreferredContactMethod","code":"1","display":"Letter"}]}},{"url":"PreferredContactTimes","valueString":"Not after 7pm"}]},{"url":"http://hl7.org/fhir/StructureDefinition/patient-birthPlace","valueAddress":{"city":"Manchester","district":"Greater Manchester","country":"GBR"}},{"url":"https://fhir.nhs.uk/StructureDefinition/Extension-PDS-RemovalFromRegistration","extension":[{"url":"removalFromRegistrationCode","valueCodeableConcept":{"coding":[{"system":"https://fhir.nhs.uk/CodeSystem/PDS-RemovalReasonExitCode","code":"SCT","display":"Transferred to Scotland"}]}},{"url":"effectiveTime","valuePeriod":{"start":"2020-01-01T00:00:00+00:00","end":"2021-12-31T00:00:00+00:00"}}]}],"telecom":[{"id":"789","period":{"start":"2020-01-01","end":"2021-12-31"},"system":"phone","value":"01632960587","use":"home"},{"id":"790","period":{"start":"2019-01-01","end":"2022-12-31"},"system":"email","value":"jane.smith@example.com","use":"home"},{"id":"OC789","period":{"start":"2020-01-01","end":"2021-12-31"},"system":"other","value":"01632960587","use":"home","extension":[{"url":"https://fhir.hl7.org.uk/StructureDefinition/Extension-UKCore-OtherContactSystem","valueCoding":{"system":"https://fhir.hl7.org.uk/CodeSystem/UKCore-OtherContactSystem","code":"textphone","display":"Minicom (Textphone)"}}]}],"contact":[{"id":"C123","period":{"start":"2020-01-01","end":"2021-12-31"},"relationship":[{"coding":[{"system":"http://terminology.hl7.org/CodeSystem/v2-0131","code":"C","display":"Emergency Contact"}]}],"telecom":[{"system":"phone","value":"01632960587"}]}],"address":[{"id":"456","period":{"start":"2020-01-01","end":"2021-12-31"},"use":"home","line":["1 Trevelyan Square","Boar Lane","City Centre","Leeds","West Yorkshire"],"postalCode":"LS1 6AE","extension":[{"url":"https://fhir.hl7.org.uk/StructureDefinition/Extension-UKCore-AddressKey","extension":[{"url":"type","valueCoding":{"system":"https://fhir.hl7.org.uk/CodeSystem/UKCore-AddressKeyType","code":"PAF"}},{"url":"value","valueString":"12345678"}]},{"url":"https://fhir.hl7.org.uk/StructureDefinition/Extension-UKCore-AddressKey","extension":[{"url":"type","valueCoding":{"system":"https://fhir.hl7.org.uk/CodeSystem/UKCore-AddressKeyType","code":"UPRN"}},{"url":"value","valueString":"123456789012"}]}]},{"id":"T456","period":{"start":"2020-01-01","end":"2021-12-31"},"use":"temp","text":"Student Accommodation","line":["1 Trevelyan Square","Boar Lane","City Centre","Leeds","West Yorkshire"],"postalCode":"LS1 6AE","extension":[{"url":"https://fhir.hl7.org.uk/StructureDefinition/Extension-UKCore-AddressKey","extension":[{"url":"type","valueCoding":{"system":"https://fhir.hl7.org.uk/CodeSystem/UKCore-AddressKeyType","code":"PAF"}},{"url":"value","valueString":"12345678"}]},{"url":"https://fhir.hl7.org.uk/StructureDefinition/Extension-UKCore-AddressKey","extension":[{"url":"type","valueCoding":{"system":"https://fhir.hl7.org.uk/CodeSystem/UKCore-AddressKeyType","code":"UPRN"}},{"url":"value","valueString":"123456789012"}]}]}]}
2023/09/15 10:29:52.123032 tttmplts.go:100: Caching 24 Templates
2023/09/15 10:29:52.134910 tttmplts.go:87: Processing Template allpatientSrvs_tmplt
2023/09/15 10:29:52.139599 ttproxy.go:149: Response Status Code 200
2023/09/15 10:34:52.714314 ttserver.go:52: ICB Workflow Service stopped
2023/09/15 10:34:55.314526 ttutil.go:133: -----------------------------------------------------------------------------------
2023/09/15 10:34:55.315034 ttdb.go:51: Opening DB Connection to mysql instance
User: root
Host: tuk.coil1nnpqdlr.eu-west-1.rds.amazonaws.com
Port: :3306
Name: tuk
Connect Timeout 2s
Read Timeout 5s
2023/09/15 10:34:55.315161 ttdb.go:54: Opened Database
2023/09/15 10:34:55.510122 ttdb.go:379: Persisting Template dsubcancel_tmplt
2023/09/15 10:34:55.579341 ttdb.go:385: Persisted Template dsubcancel_tmplt
2023/09/15 10:34:55.579388 ttdb.go:366: Persisted Template dsubcancel_tmplt.xml
2023/09/15 10:34:55.647631 ttdb.go:379: Persisting Template cgl_tmplt
2023/09/15 10:34:55.753593 ttdb.go:385: Persisted Template cgl_tmplt
2023/09/15 10:34:55.753728 ttdb.go:366: Persisted Template cgl_tmplt.html
2023/09/15 10:34:55.822092 ttdb.go:379: Persisting Template pdssearch_tmplt
2023/09/15 10:34:55.892352 ttdb.go:385: Persisted Template pdssearch_tmplt
2023/09/15 10:34:55.892490 ttdb.go:366: Persisted Template pdssearch_tmplt.html
2023/09/15 10:34:55.961309 ttdb.go:379: Persisting Template dsubsubscribe_tmplt
2023/09/15 10:34:56.032355 ttdb.go:385: Persisted Template dsubsubscribe_tmplt
2023/09/15 10:34:56.032481 ttdb.go:366: Persisted Template dsubsubscribe_tmplt.xml
2023/09/15 10:34:56.100751 ttdb.go:379: Persisting Template notification_tmplt
2023/09/15 10:34:56.186199 ttdb.go:385: Persisted Template notification_tmplt
2023/09/15 10:34:56.186269 ttdb.go:366: Persisted Template notification_tmplt.txt
2023/09/15 10:34:56.255600 ttdb.go:379: Persisting Template wfstate2t_tmplt
2023/09/15 10:34:56.385531 ttdb.go:385: Persisted Template wfstate2t_tmplt
2023/09/15 10:34:56.385629 ttdb.go:366: Persisted Template wfstate2t_tmplt.html
2023/09/15 10:34:56.454740 ttdb.go:379: Persisting Template publishfile2t_tmplt
2023/09/15 10:34:56.524226 ttdb.go:385: Persisted Template publishfile2t_tmplt
2023/09/15 10:34:56.524324 ttdb.go:366: Persisted Template publishfile2t_tmplt.html
2023/09/15 10:34:56.593743 ttdb.go:379: Persisting Template react_tmplt
2023/09/15 10:34:56.663333 ttdb.go:385: Persisted Template react_tmplt
2023/09/15 10:34:56.663510 ttdb.go:366: Persisted Template react_tmplt.html
2023/09/15 10:34:56.734469 ttdb.go:379: Persisting Template pdsretrieve_tmplt
2023/09/15 10:34:56.806190 ttdb.go:385: Persisted Template pdsretrieve_tmplt
2023/09/15 10:34:56.806340 ttdb.go:366: Persisted Template pdsretrieve_tmplt.html
2023/09/15 10:34:56.876066 ttdb.go:379: Persisting Template allpatientSrvs_tmplt
2023/09/15 10:34:56.944761 ttdb.go:385: Persisted Template allpatientSrvs_tmplt
2023/09/15 10:34:56.944902 ttdb.go:366: Persisted Template allpatientSrvs_tmplt.html
2023/09/15 10:34:57.014458 ttdb.go:379: Persisting Template spa2t_tmplt
2023/09/15 10:34:57.098466 ttdb.go:385: Persisted Template spa2t_tmplt
2023/09/15 10:34:57.098611 ttdb.go:366: Persisted Template spa2t_tmplt.html
2023/09/15 10:34:57.167323 ttdb.go:379: Persisting Template xdw2t_tmplt
2023/09/15 10:34:57.254996 ttdb.go:385: Persisted Template xdw2t_tmplt
2023/09/15 10:34:57.255185 ttdb.go:366: Persisted Template xdw2t_tmplt.html
2023/09/15 10:34:57.329700 ttdb.go:379: Persisting Template spaheader2t_tmplt
2023/09/15 10:34:57.404914 ttdb.go:385: Persisted Template spaheader2t_tmplt
2023/09/15 10:34:57.404959 ttdb.go:366: Persisted Template spaheader2t_tmplt.html
2023/09/15 10:34:57.473788 ttdb.go:379: Persisting Template pds_tmplt
2023/09/15 10:34:57.543125 ttdb.go:385: Persisted Template pds_tmplt
2023/09/15 10:34:57.543267 ttdb.go:366: Persisted Template pds_tmplt.html
2023/09/15 10:34:57.612702 ttdb.go:379: Persisting Template error_tmplt
2023/09/15 10:34:57.681199 ttdb.go:385: Persisted Template error_tmplt
2023/09/15 10:34:57.681391 ttdb.go:366: Persisted Template error_tmplt.html
2023/09/15 10:34:57.749821 ttdb.go:379: Persisting Template dsuback_tmplt
2023/09/15 10:34:57.820376 ttdb.go:385: Persisted Template dsuback_tmplt
2023/09/15 10:34:57.820490 ttdb.go:366: Persisted Template dsuback_tmplt.xml
2023/09/15 10:34:57.891816 ttdb.go:379: Persisting Template pixm_tmplt
2023/09/15 10:34:57.964042 ttdb.go:385: Persisted Template pixm_tmplt
2023/09/15 10:34:57.964230 ttdb.go:366: Persisted Template pixm_tmplt.html
2023/09/15 10:34:58.032395 ttdb.go:379: Persisting Template subscriptions2t_tmplt
2023/09/15 10:34:58.103771 ttdb.go:385: Persisted Template subscriptions2t_tmplt
2023/09/15 10:34:58.103910 ttdb.go:366: Persisted Template subscriptions2t_tmplt.html
2023/09/15 10:34:58.173002 ttdb.go:379: Persisting Template codemaps2t_tmplt
2023/09/15 10:34:58.248843 ttdb.go:385: Persisted Template codemaps2t_tmplt
2023/09/15 10:34:58.248995 ttdb.go:366: Persisted Template codemaps2t_tmplt.html
2023/09/15 10:34:58.320489 ttdb.go:379: Persisting Template mhdpublish_tmplt
2023/09/15 10:34:58.397816 ttdb.go:385: Persisted Template mhdpublish_tmplt
2023/09/15 10:34:58.397928 ttdb.go:366: Persisted Template mhdpublish_tmplt.json
2023/09/15 10:34:58.466148 ttdb.go:379: Persisting Template events_tmplt
2023/09/15 10:34:58.539560 ttdb.go:385: Persisted Template events_tmplt
2023/09/15 10:34:58.539704 ttdb.go:366: Persisted Template events_tmplt.html
2023/09/15 10:34:58.608288 ttdb.go:379: Persisting Template uploadfile2t_tmplt
2023/09/15 10:34:58.678318 ttdb.go:385: Persisted Template uploadfile2t_tmplt
2023/09/15 10:34:58.678462 ttdb.go:366: Persisted Template uploadfile2t_tmplt.html
2023/09/15 10:34:58.678768 ttserver.go:40: Starting ICB Workflow Service. Service Endpoint http://MacBook-Pro-3.lan:8080/
2023/09/15 10:35:07.410590 ttgethandler.go:10: Processing new GET Request
2023/09/15 10:35:07.410924 ttproxy.go:138: 	Request Query Params
2023/09/15 10:35:07.411741 ttutil.go:140: 	{
  "User": "ian.thomas",
  "Org": "2tsolutions",
  "Role": "clinical",
  "Nhs": "9000000009"
}
2023/09/15 10:35:07.411787 ttgethandler.go:15: Path = /beta/spa/consumer/patient
2023/09/15 10:35:07.411863 tttmplts.go:37: CGL Worker starting
2023/09/15 10:35:07.411875 tttmplts.go:30: PIXm Worker starting
2023/09/15 10:35:07.412238 tthttp.go:15: Creating PIXm PDQ - Server URL http://lac-demo-01.tianispirit.co.uk:8081/SpiritPIXFhir/r4/Patient?identifier=2.16.840.1.113883.2.1.4.1%7C9000000009
2023/09/15 10:35:07.415661 tthttp.go:160: Request Headers 
map[Accept:[application/json] X-Api-Key:[FNhb#OhxWiEiMdf+@6085k5Zmt] X-Api-Secret:[9710ea0fb4ffb5d56c2e62c71c30bdfhjsyr56a79d]]
2023/09/15 10:35:07.416134 tthttp.go:160: Request Headers 
map[Content-Type:[application/json]]
2023/09/15 10:35:07.614116 tthttp.go:174: Server Response - Status Code 404 
{"errors":[{"message":"No clients matching nhs number 9000000009","path":"\/"}],"status":404}
2023/09/15 10:35:07.619581 ttutil.go:140: 	{
  "data": {
    "client": {
      "basicDetails": {
        "address": {},
        "name": {}
      },
      "bbvInformation": {},
      "drugTestResults": {
        "results": {}
      },
      "riskInformation": {
        "mentalHealthDomain": {},
        "riskOfHarmToSelfDomain": {},
        "socialDomain": {},
        "substanceMisuseDomain": {}
      },
      "safeguardingInformation": {}
    },
    "keyWorker": {
      "name": {}
    }
  }
}
2023/09/15 10:35:07.619695 tttmplts.go:39: CGL Worker done
2023/09/15 10:35:07.619719 tttmplts.go:40: CGL Worker Status Code 404
2023/09/15 10:35:12.413454 tthttp.go:174: Server Response - Status Code 0 
2023/09/15 10:35:12.413794 tttmplts.go:32: PIXm Worker done
2023/09/15 10:35:12.413842 tttmplts.go:33: PIXm Worker Status Code 408
2023/09/15 10:35:12.414164 tthttp.go:56: Creating PDS Search Request - Server URL https://sandbox.api.service.nhs.uk/personal-demographics/FHIR/R4/Patient/9000000009
2023/09/15 10:35:12.414321 tthttp.go:160: Request Headers 
map[Accept:[*/*] Content-Type:[application/json] X-Request-Id:[f6c293bc-d1cb-47d3-85d1-3970748e4ce1]]
2023/09/15 10:35:12.584865 tthttp.go:174: Server Response - Status Code 200 
{"resourceType":"Patient","id":"9000000009","identifier":[{"system":"https://fhir.nhs.uk/Id/nhs-number","value":"9000000009","extension":[{"url":"https://fhir.hl7.org.uk/StructureDefinition/Extension-UKCore-NHSNumberVerificationStatus","valueCodeableConcept":{"coding":[{"system":"https://fhir.hl7.org.uk/CodeSystem/UKCore-NHSNumberVerificationStatus","version":"1.0.0","code":"01","display":"Number present and verified"}]}}]}],"meta":{"versionId":"2","security":[{"system":"http://terminology.hl7.org/CodeSystem/v3-Confidentiality","code":"U","display":"unrestricted"}]},"name":[{"id":"123","use":"usual","period":{"start":"2020-01-01","end":"2021-12-31"},"given":["Jane"],"family":"Smith","prefix":["Mrs"],"suffix":["MBE"]}],"gender":"female","birthDate":"2010-10-22","multipleBirthInteger":1,"deceasedDateTime":"2010-10-22T00:00:00+00:00","generalPractitioner":[{"id":"254406A3","type":"Organization","identifier":{"system":"https://fhir.nhs.uk/Id/ods-organization-code","value":"Y12345","period":{"start":"2020-01-01","end":"2021-12-31"}}}],"managingOrganization":{"type":"Organization","identifier":{"system":"https://fhir.nhs.uk/Id/ods-organization-code","value":"Y12345","period":{"start":"2020-01-01","end":"2021-12-31"}}},"extension":[{"url":"https://fhir.hl7.org.uk/StructureDefinition/Extension-UKCore-NominatedPharmacy","valueReference":{"identifier":{"system":"https://fhir.nhs.uk/Id/ods-organization-code","value":"Y12345"}}},{"url":"https://fhir.hl7.org.uk/StructureDefinition/Extension-UKCore-PreferredDispenserOrganization","valueReference":{"identifier":{"system":"https://fhir.nhs.uk/Id/ods-organization-code","value":"Y23456"}}},{"url":"https://fhir.hl7.org.uk/StructureDefinition/Extension-UKCore-MedicalApplianceSupplier","valueReference":{"identifier":{"system":"https://fhir.nhs.uk/Id/ods-organization-code","value":"Y34567"}}},{"url":"https://fhir.hl7.org.uk/StructureDefinition/Extension-UKCore-DeathNotificationStatus","extension":[{"url":"deathNotificationStatus","valueCodeableConcept":{"coding":[{"system":"https://fhir.hl7.org.uk/CodeSystem/UKCore-DeathNotificationStatus","version":"1.0.0","code":"2","display":"Formal - death notice received from Registrar of Deaths"}]}},{"url":"systemEffectiveDate","valueDateTime":"2010-10-22T00:00:00+00:00"}]},{"url":"https://fhir.hl7.org.uk/StructureDefinition/Extension-UKCore-NHSCommunication","extension":[{"url":"language","valueCodeableConcept":{"coding":[{"system":"https://fhir.hl7.org.uk/CodeSystem/UKCore-HumanLanguage","version":"1.0.0","code":"fr","display":"French"}]}},{"url":"interpreterRequired","valueBoolean":true}]},{"url":"https://fhir.hl7.org.uk/StructureDefinition/Extension-UKCore-ContactPreference","extension":[{"url":"PreferredWrittenCommunicationFormat","valueCodeableConcept":{"coding":[{"system":"https://fhir.hl7.org.uk/CodeSystem/UKCore-PreferredWrittenCommunicationFormat","code":"12","display":"Braille"}]}},{"url":"PreferredContactMethod","valueCodeableConcept":{"coding":[{"system":"https://fhir.hl7.org.uk/CodeSystem/UKCore-PreferredContactMethod","code":"1","display":"Letter"}]}},{"url":"PreferredContactTimes","valueString":"Not after 7pm"}]},{"url":"http://hl7.org/fhir/StructureDefinition/patient-birthPlace","valueAddress":{"city":"Manchester","district":"Greater Manchester","country":"GBR"}},{"url":"https://fhir.nhs.uk/StructureDefinition/Extension-PDS-RemovalFromRegistration","extension":[{"url":"removalFromRegistrationCode","valueCodeableConcept":{"coding":[{"system":"https://fhir.nhs.uk/CodeSystem/PDS-RemovalReasonExitCode","code":"SCT","display":"Transferred to Scotland"}]}},{"url":"effectiveTime","valuePeriod":{"start":"2020-01-01T00:00:00+00:00","end":"2021-12-31T00:00:00+00:00"}}]}],"telecom":[{"id":"789","period":{"start":"2020-01-01","end":"2021-12-31"},"system":"phone","value":"01632960587","use":"home"},{"id":"790","period":{"start":"2019-01-01","end":"2022-12-31"},"system":"email","value":"jane.smith@example.com","use":"home"},{"id":"OC789","period":{"start":"2020-01-01","end":"2021-12-31"},"system":"other","value":"01632960587","use":"home","extension":[{"url":"https://fhir.hl7.org.uk/StructureDefinition/Extension-UKCore-OtherContactSystem","valueCoding":{"system":"https://fhir.hl7.org.uk/CodeSystem/UKCore-OtherContactSystem","code":"textphone","display":"Minicom (Textphone)"}}]}],"contact":[{"id":"C123","period":{"start":"2020-01-01","end":"2021-12-31"},"relationship":[{"coding":[{"system":"http://terminology.hl7.org/CodeSystem/v2-0131","code":"C","display":"Emergency Contact"}]}],"telecom":[{"system":"phone","value":"01632960587"}]}],"address":[{"id":"456","period":{"start":"2020-01-01","end":"2021-12-31"},"use":"home","line":["1 Trevelyan Square","Boar Lane","City Centre","Leeds","West Yorkshire"],"postalCode":"LS1 6AE","extension":[{"url":"https://fhir.hl7.org.uk/StructureDefinition/Extension-UKCore-AddressKey","extension":[{"url":"type","valueCoding":{"system":"https://fhir.hl7.org.uk/CodeSystem/UKCore-AddressKeyType","code":"PAF"}},{"url":"value","valueString":"12345678"}]},{"url":"https://fhir.hl7.org.uk/StructureDefinition/Extension-UKCore-AddressKey","extension":[{"url":"type","valueCoding":{"system":"https://fhir.hl7.org.uk/CodeSystem/UKCore-AddressKeyType","code":"UPRN"}},{"url":"value","valueString":"123456789012"}]}]},{"id":"T456","period":{"start":"2020-01-01","end":"2021-12-31"},"use":"temp","text":"Student Accommodation","line":["1 Trevelyan Square","Boar Lane","City Centre","Leeds","West Yorkshire"],"postalCode":"LS1 6AE","extension":[{"url":"https://fhir.hl7.org.uk/StructureDefinition/Extension-UKCore-AddressKey","extension":[{"url":"type","valueCoding":{"system":"https://fhir.hl7.org.uk/CodeSystem/UKCore-AddressKeyType","code":"PAF"}},{"url":"value","valueString":"12345678"}]},{"url":"https://fhir.hl7.org.uk/StructureDefinition/Extension-UKCore-AddressKey","extension":[{"url":"type","valueCoding":{"system":"https://fhir.hl7.org.uk/CodeSystem/UKCore-AddressKeyType","code":"UPRN"}},{"url":"value","valueString":"123456789012"}]}]}]}
2023/09/15 10:35:12.796183 tttmplts.go:100: Caching 24 Templates
2023/09/15 10:35:12.802412 tttmplts.go:87: Processing Template allpatientSrvs_tmplt
2023/09/15 10:35:12.804938 ttproxy.go:149: Response Status Code 200
2023/09/15 10:38:32.539832 ttserver.go:52: ICB Workflow Service stopped
2023/09/15 10:38:34.401061 ttutil.go:133: -----------------------------------------------------------------------------------
2023/09/15 10:38:34.401547 ttdb.go:51: Opening DB Connection to mysql instance
User: root
Host: tuk.coil1nnpqdlr.eu-west-1.rds.amazonaws.com
Port: :3306
Name: tuk
Connect Timeout 2s
Read Timeout 5s
2023/09/15 10:38:34.401679 ttdb.go:54: Opened Database
2023/09/15 10:38:34.872138 ttdb.go:379: Persisting Template dsubcancel_tmplt
2023/09/15 10:38:35.059299 ttdb.go:385: Persisted Template dsubcancel_tmplt
2023/09/15 10:38:35.059401 ttdb.go:366: Persisted Template dsubcancel_tmplt.xml
2023/09/15 10:38:35.199765 ttdb.go:379: Persisting Template cgl_tmplt
2023/09/15 10:38:35.370365 ttdb.go:385: Persisted Template cgl_tmplt
2023/09/15 10:38:35.370547 ttdb.go:366: Persisted Template cgl_tmplt.html
2023/09/15 10:38:35.446053 ttdb.go:379: Persisting Template pdssearch_tmplt
2023/09/15 10:38:35.521691 ttdb.go:385: Persisted Template pdssearch_tmplt
2023/09/15 10:38:35.521729 ttdb.go:366: Persisted Template pdssearch_tmplt.html
2023/09/15 10:38:35.586001 ttdb.go:379: Persisting Template dsubsubscribe_tmplt
2023/09/15 10:38:35.650420 ttdb.go:385: Persisted Template dsubsubscribe_tmplt
2023/09/15 10:38:35.650451 ttdb.go:366: Persisted Template dsubsubscribe_tmplt.xml
2023/09/15 10:38:35.713610 ttdb.go:379: Persisting Template notification_tmplt
2023/09/15 10:38:35.777035 ttdb.go:385: Persisted Template notification_tmplt
2023/09/15 10:38:35.777063 ttdb.go:366: Persisted Template notification_tmplt.txt
2023/09/15 10:38:35.841480 ttdb.go:379: Persisting Template wfstate2t_tmplt
2023/09/15 10:38:35.958779 ttdb.go:385: Persisted Template wfstate2t_tmplt
2023/09/15 10:38:35.958867 ttdb.go:366: Persisted Template wfstate2t_tmplt.html
2023/09/15 10:38:36.022942 ttdb.go:379: Persisting Template publishfile2t_tmplt
2023/09/15 10:38:36.091332 ttdb.go:385: Persisted Template publishfile2t_tmplt
2023/09/15 10:38:36.091479 ttdb.go:366: Persisted Template publishfile2t_tmplt.html
2023/09/15 10:38:36.155620 ttdb.go:379: Persisting Template react_tmplt
2023/09/15 10:38:36.221102 ttdb.go:385: Persisted Template react_tmplt
2023/09/15 10:38:36.221318 ttdb.go:366: Persisted Template react_tmplt.html
2023/09/15 10:38:36.286498 ttdb.go:379: Persisting Template pdsretrieve_tmplt
2023/09/15 10:38:36.352750 ttdb.go:385: Persisted Template pdsretrieve_tmplt
2023/09/15 10:38:36.352804 ttdb.go:366: Persisted Template pdsretrieve_tmplt.html
2023/09/15 10:38:36.417465 ttdb.go:379: Persisting Template allpatientSrvs_tmplt
2023/09/15 10:38:36.483189 ttdb.go:385: Persisted Template allpatientSrvs_tmplt
2023/09/15 10:38:36.483333 ttdb.go:366: Persisted Template allpatientSrvs_tmplt.html
2023/09/15 10:38:36.548250 ttdb.go:379: Persisting Template spa2t_tmplt
2023/09/15 10:38:36.626486 ttdb.go:385: Persisted Template spa2t_tmplt
2023/09/15 10:38:36.626626 ttdb.go:366: Persisted Template spa2t_tmplt.html
2023/09/15 10:38:36.691094 ttdb.go:379: Persisting Template xdw2t_tmplt
2023/09/15 10:38:36.771729 ttdb.go:385: Persisted Template xdw2t_tmplt
2023/09/15 10:38:36.771873 ttdb.go:366: Persisted Template xdw2t_tmplt.html
2023/09/15 10:38:36.837532 ttdb.go:379: Persisting Template spaheader2t_tmplt
2023/09/15 10:38:36.913919 ttdb.go:385: Persisted Template spaheader2t_tmplt
2023/09/15 10:38:36.914050 ttdb.go:366: Persisted Template spaheader2t_tmplt.html
2023/09/15 10:38:36.978440 ttdb.go:379: Persisting Template pds_tmplt
2023/09/15 10:38:37.043217 ttdb.go:385: Persisted Template pds_tmplt
2023/09/15 10:38:37.043251 ttdb.go:366: Persisted Template pds_tmplt.html
2023/09/15 10:38:37.107388 ttdb.go:379: Persisting Template error_tmplt
2023/09/15 10:38:37.172406 ttdb.go:385: Persisted Template error_tmplt
2023/09/15 10:38:37.172461 ttdb.go:366: Persisted Template error_tmplt.html
2023/09/15 10:38:37.240609 ttdb.go:379: Persisting Template dsuback_tmplt
2023/09/15 10:38:37.305454 ttdb.go:385: Persisted Template dsuback_tmplt
2023/09/15 10:38:37.305559 ttdb.go:366: Persisted Template dsuback_tmplt.xml
2023/09/15 10:38:37.370009 ttdb.go:379: Persisting Template pixm_tmplt
2023/09/15 10:38:37.437818 ttdb.go:385: Persisted Template pixm_tmplt
2023/09/15 10:38:37.438100 ttdb.go:366: Persisted Template pixm_tmplt.html
2023/09/15 10:38:37.503472 ttdb.go:379: Persisting Template subscriptions2t_tmplt
2023/09/15 10:38:37.570907 ttdb.go:385: Persisted Template subscriptions2t_tmplt
2023/09/15 10:38:37.571058 ttdb.go:366: Persisted Template subscriptions2t_tmplt.html
2023/09/15 10:38:37.636210 ttdb.go:379: Persisting Template codemaps2t_tmplt
2023/09/15 10:38:37.704873 ttdb.go:385: Persisted Template codemaps2t_tmplt
2023/09/15 10:38:37.705008 ttdb.go:366: Persisted Template codemaps2t_tmplt.html
2023/09/15 10:38:37.768894 ttdb.go:379: Persisting Template mhdpublish_tmplt
2023/09/15 10:38:37.838442 ttdb.go:385: Persisted Template mhdpublish_tmplt
2023/09/15 10:38:37.838573 ttdb.go:366: Persisted Template mhdpublish_tmplt.json
2023/09/15 10:38:37.905012 ttdb.go:379: Persisting Template events_tmplt
2023/09/15 10:38:37.975727 ttdb.go:385: Persisted Template events_tmplt
2023/09/15 10:38:37.975892 ttdb.go:366: Persisted Template events_tmplt.html
2023/09/15 10:38:38.041216 ttdb.go:379: Persisting Template uploadfile2t_tmplt
2023/09/15 10:38:38.110838 ttdb.go:385: Persisted Template uploadfile2t_tmplt
2023/09/15 10:38:38.110961 ttdb.go:366: Persisted Template uploadfile2t_tmplt.html
2023/09/15 10:38:38.111222 ttserver.go:40: Starting ICB Workflow Service. Service Endpoint http://MacBook-Pro-3.lan:8080/
2023/09/15 10:38:42.506732 ttgethandler.go:10: Processing new GET Request
2023/09/15 10:38:42.506907 ttproxy.go:138: 	Request Query Params
2023/09/15 10:38:42.507257 ttutil.go:140: 	{
  "User": "ian.thomas",
  "Org": "2tsolutions",
  "Role": "clinical",
  "Nhs": "9000000009"
}
2023/09/15 10:38:42.507292 ttgethandler.go:15: Path = /beta/spa/consumer/patient
2023/09/15 10:38:42.507336 tttmplts.go:37: CGL Worker starting
2023/09/15 10:38:42.507326 tttmplts.go:30: PIXm Worker starting
2023/09/15 10:38:42.507847 tthttp.go:15: Creating PIXm PDQ - Server URL http://lac-demo-01.tianispirit.co.uk:8081/SpiritPIXFhir/r4/Patient?identifier=2.16.840.1.113883.2.1.4.1%7C9000000009
2023/09/15 10:38:42.509081 tthttp.go:160: Request Headers 
map[Content-Type:[application/json]]
2023/09/15 10:38:42.509099 tthttp.go:160: Request Headers 
map[Accept:[application/json] X-Api-Key:[FNhb#OhxWiEiMdf+@6085k5Zmt] X-Api-Secret:[9710ea0fb4ffb5d56c2e62c71c30bdfhjsyr56a79d]]
2023/09/15 10:38:42.682470 tthttp.go:174: Server Response - Status Code 404 
{"errors":[{"message":"No clients matching nhs number 9000000009","path":"\/"}],"status":404}
2023/09/15 10:38:42.685996 ttutil.go:140: 	{
  "data": {
    "client": {
      "basicDetails": {
        "address": {},
        "name": {}
      },
      "bbvInformation": {},
      "drugTestResults": {
        "results": {}
      },
      "riskInformation": {
        "mentalHealthDomain": {},
        "riskOfHarmToSelfDomain": {},
        "socialDomain": {},
        "substanceMisuseDomain": {}
      },
      "safeguardingInformation": {}
    },
    "keyWorker": {
      "name": {}
    }
  }
}
2023/09/15 10:38:42.686078 tttmplts.go:39: CGL Worker done
2023/09/15 10:38:42.686095 tttmplts.go:40: CGL Worker Status Code 404
2023/09/15 10:38:47.509095 tthttp.go:174: Server Response - Status Code 0 
2023/09/15 10:38:47.509456 tttmplts.go:32: PIXm Worker done
2023/09/15 10:38:47.509527 tttmplts.go:33: PIXm Worker Status Code 408
2023/09/15 10:38:47.509827 tthttp.go:56: Creating PDS Search Request - Server URL https://sandbox.api.service.nhs.uk/personal-demographics/FHIR/R4/Patient/9000000009
2023/09/15 10:38:47.510028 tthttp.go:160: Request Headers 
map[Accept:[*/*] Content-Type:[application/json] X-Request-Id:[835c8246-209f-436e-8496-d60d0115b601]]
2023/09/15 10:38:47.734185 tthttp.go:174: Server Response - Status Code 200 
{"resourceType":"Patient","id":"9000000009","identifier":[{"system":"https://fhir.nhs.uk/Id/nhs-number","value":"9000000009","extension":[{"url":"https://fhir.hl7.org.uk/StructureDefinition/Extension-UKCore-NHSNumberVerificationStatus","valueCodeableConcept":{"coding":[{"system":"https://fhir.hl7.org.uk/CodeSystem/UKCore-NHSNumberVerificationStatus","version":"1.0.0","code":"01","display":"Number present and verified"}]}}]}],"meta":{"versionId":"2","security":[{"system":"http://terminology.hl7.org/CodeSystem/v3-Confidentiality","code":"U","display":"unrestricted"}]},"name":[{"id":"123","use":"usual","period":{"start":"2020-01-01","end":"2021-12-31"},"given":["Jane"],"family":"Smith","prefix":["Mrs"],"suffix":["MBE"]}],"gender":"female","birthDate":"2010-10-22","multipleBirthInteger":1,"deceasedDateTime":"2010-10-22T00:00:00+00:00","generalPractitioner":[{"id":"254406A3","type":"Organization","identifier":{"system":"https://fhir.nhs.uk/Id/ods-organization-code","value":"Y12345","period":{"start":"2020-01-01","end":"2021-12-31"}}}],"managingOrganization":{"type":"Organization","identifier":{"system":"https://fhir.nhs.uk/Id/ods-organization-code","value":"Y12345","period":{"start":"2020-01-01","end":"2021-12-31"}}},"extension":[{"url":"https://fhir.hl7.org.uk/StructureDefinition/Extension-UKCore-NominatedPharmacy","valueReference":{"identifier":{"system":"https://fhir.nhs.uk/Id/ods-organization-code","value":"Y12345"}}},{"url":"https://fhir.hl7.org.uk/StructureDefinition/Extension-UKCore-PreferredDispenserOrganization","valueReference":{"identifier":{"system":"https://fhir.nhs.uk/Id/ods-organization-code","value":"Y23456"}}},{"url":"https://fhir.hl7.org.uk/StructureDefinition/Extension-UKCore-MedicalApplianceSupplier","valueReference":{"identifier":{"system":"https://fhir.nhs.uk/Id/ods-organization-code","value":"Y34567"}}},{"url":"https://fhir.hl7.org.uk/StructureDefinition/Extension-UKCore-DeathNotificationStatus","extension":[{"url":"deathNotificationStatus","valueCodeableConcept":{"coding":[{"system":"https://fhir.hl7.org.uk/CodeSystem/UKCore-DeathNotificationStatus","version":"1.0.0","code":"2","display":"Formal - death notice received from Registrar of Deaths"}]}},{"url":"systemEffectiveDate","valueDateTime":"2010-10-22T00:00:00+00:00"}]},{"url":"https://fhir.hl7.org.uk/StructureDefinition/Extension-UKCore-NHSCommunication","extension":[{"url":"language","valueCodeableConcept":{"coding":[{"system":"https://fhir.hl7.org.uk/CodeSystem/UKCore-HumanLanguage","version":"1.0.0","code":"fr","display":"French"}]}},{"url":"interpreterRequired","valueBoolean":true}]},{"url":"https://fhir.hl7.org.uk/StructureDefinition/Extension-UKCore-ContactPreference","extension":[{"url":"PreferredWrittenCommunicationFormat","valueCodeableConcept":{"coding":[{"system":"https://fhir.hl7.org.uk/CodeSystem/UKCore-PreferredWrittenCommunicationFormat","code":"12","display":"Braille"}]}},{"url":"PreferredContactMethod","valueCodeableConcept":{"coding":[{"system":"https://fhir.hl7.org.uk/CodeSystem/UKCore-PreferredContactMethod","code":"1","display":"Letter"}]}},{"url":"PreferredContactTimes","valueString":"Not after 7pm"}]},{"url":"http://hl7.org/fhir/StructureDefinition/patient-birthPlace","valueAddress":{"city":"Manchester","district":"Greater Manchester","country":"GBR"}},{"url":"https://fhir.nhs.uk/StructureDefinition/Extension-PDS-RemovalFromRegistration","extension":[{"url":"removalFromRegistrationCode","valueCodeableConcept":{"coding":[{"system":"https://fhir.nhs.uk/CodeSystem/PDS-RemovalReasonExitCode","code":"SCT","display":"Transferred to Scotland"}]}},{"url":"effectiveTime","valuePeriod":{"start":"2020-01-01T00:00:00+00:00","end":"2021-12-31T00:00:00+00:00"}}]}],"telecom":[{"id":"789","period":{"start":"2020-01-01","end":"2021-12-31"},"system":"phone","value":"01632960587","use":"home"},{"id":"790","period":{"start":"2019-01-01","end":"2022-12-31"},"system":"email","value":"jane.smith@example.com","use":"home"},{"id":"OC789","period":{"start":"2020-01-01","end":"2021-12-31"},"system":"other","value":"01632960587","use":"home","extension":[{"url":"https://fhir.hl7.org.uk/StructureDefinition/Extension-UKCore-OtherContactSystem","valueCoding":{"system":"https://fhir.hl7.org.uk/CodeSystem/UKCore-OtherContactSystem","code":"textphone","display":"Minicom (Textphone)"}}]}],"contact":[{"id":"C123","period":{"start":"2020-01-01","end":"2021-12-31"},"relationship":[{"coding":[{"system":"http://terminology.hl7.org/CodeSystem/v2-0131","code":"C","display":"Emergency Contact"}]}],"telecom":[{"system":"phone","value":"01632960587"}]}],"address":[{"id":"456","period":{"start":"2020-01-01","end":"2021-12-31"},"use":"home","line":["1 Trevelyan Square","Boar Lane","City Centre","Leeds","West Yorkshire"],"postalCode":"LS1 6AE","extension":[{"url":"https://fhir.hl7.org.uk/StructureDefinition/Extension-UKCore-AddressKey","extension":[{"url":"type","valueCoding":{"system":"https://fhir.hl7.org.uk/CodeSystem/UKCore-AddressKeyType","code":"PAF"}},{"url":"value","valueString":"12345678"}]},{"url":"https://fhir.hl7.org.uk/StructureDefinition/Extension-UKCore-AddressKey","extension":[{"url":"type","valueCoding":{"system":"https://fhir.hl7.org.uk/CodeSystem/UKCore-AddressKeyType","code":"UPRN"}},{"url":"value","valueString":"123456789012"}]}]},{"id":"T456","period":{"start":"2020-01-01","end":"2021-12-31"},"use":"temp","text":"Student Accommodation","line":["1 Trevelyan Square","Boar Lane","City Centre","Leeds","West Yorkshire"],"postalCode":"LS1 6AE","extension":[{"url":"https://fhir.hl7.org.uk/StructureDefinition/Extension-UKCore-AddressKey","extension":[{"url":"type","valueCoding":{"system":"https://fhir.hl7.org.uk/CodeSystem/UKCore-AddressKeyType","code":"PAF"}},{"url":"value","valueString":"12345678"}]},{"url":"https://fhir.hl7.org.uk/StructureDefinition/Extension-UKCore-AddressKey","extension":[{"url":"type","valueCoding":{"system":"https://fhir.hl7.org.uk/CodeSystem/UKCore-AddressKeyType","code":"UPRN"}},{"url":"value","valueString":"123456789012"}]}]}]}
2023/09/15 10:38:47.930168 tttmplts.go:100: Caching 24 Templates
2023/09/15 10:38:47.941689 tttmplts.go:87: Processing Template allpatientSrvs_tmplt
2023/09/15 10:38:47.946716 ttproxy.go:149: Response Status Code 200
2023/09/15 10:40:49.145139 ttserver.go:52: ICB Workflow Service stopped
2023/09/15 10:40:50.973761 ttutil.go:133: -----------------------------------------------------------------------------------
2023/09/15 10:40:50.974252 ttdb.go:51: Opening DB Connection to mysql instance
User: root
Host: tuk.coil1nnpqdlr.eu-west-1.rds.amazonaws.com
Port: :3306
Name: tuk
Connect Timeout 2s
Read Timeout 5s
2023/09/15 10:40:50.974381 ttdb.go:54: Opened Database
2023/09/15 10:40:51.364698 ttdb.go:379: Persisting Template dsubcancel_tmplt
2023/09/15 10:40:51.474162 ttdb.go:385: Persisted Template dsubcancel_tmplt
2023/09/15 10:40:51.474448 ttdb.go:366: Persisted Template dsubcancel_tmplt.xml
2023/09/15 10:40:51.603479 ttdb.go:379: Persisting Template cgl_tmplt
2023/09/15 10:40:51.811881 ttdb.go:385: Persisted Template cgl_tmplt
2023/09/15 10:40:51.811997 ttdb.go:366: Persisted Template cgl_tmplt.html
2023/09/15 10:40:51.881664 ttdb.go:379: Persisting Template pdssearch_tmplt
2023/09/15 10:40:52.018765 ttdb.go:385: Persisted Template pdssearch_tmplt
2023/09/15 10:40:52.018868 ttdb.go:366: Persisted Template pdssearch_tmplt.html
2023/09/15 10:40:52.150840 ttdb.go:379: Persisting Template dsubsubscribe_tmplt
2023/09/15 10:40:52.273901 ttdb.go:385: Persisted Template dsubsubscribe_tmplt
2023/09/15 10:40:52.274027 ttdb.go:366: Persisted Template dsubsubscribe_tmplt.xml
2023/09/15 10:40:52.375368 ttdb.go:379: Persisting Template notification_tmplt
2023/09/15 10:40:52.450646 ttdb.go:385: Persisted Template notification_tmplt
2023/09/15 10:40:52.450845 ttdb.go:366: Persisted Template notification_tmplt.txt
2023/09/15 10:40:52.513260 ttdb.go:379: Persisting Template wfstate2t_tmplt
2023/09/15 10:40:52.629592 ttdb.go:385: Persisted Template wfstate2t_tmplt
2023/09/15 10:40:52.629887 ttdb.go:366: Persisted Template wfstate2t_tmplt.html
2023/09/15 10:40:52.692500 ttdb.go:379: Persisting Template publishfile2t_tmplt
2023/09/15 10:40:52.756384 ttdb.go:385: Persisted Template publishfile2t_tmplt
2023/09/15 10:40:52.756585 ttdb.go:366: Persisted Template publishfile2t_tmplt.html
2023/09/15 10:40:52.818463 ttdb.go:379: Persisting Template react_tmplt
2023/09/15 10:40:52.881714 ttdb.go:385: Persisted Template react_tmplt
2023/09/15 10:40:52.881858 ttdb.go:366: Persisted Template react_tmplt.html
2023/09/15 10:40:52.943701 ttdb.go:379: Persisting Template pdsretrieve_tmplt
2023/09/15 10:40:53.006050 ttdb.go:385: Persisted Template pdsretrieve_tmplt
2023/09/15 10:40:53.006080 ttdb.go:366: Persisted Template pdsretrieve_tmplt.html
2023/09/15 10:40:53.067250 ttdb.go:379: Persisting Template allpatientSrvs_tmplt
2023/09/15 10:40:53.128688 ttdb.go:385: Persisted Template allpatientSrvs_tmplt
2023/09/15 10:40:53.128875 ttdb.go:366: Persisted Template allpatientSrvs_tmplt.html
2023/09/15 10:40:53.192456 ttdb.go:379: Persisting Template spa2t_tmplt
2023/09/15 10:40:53.269127 ttdb.go:385: Persisted Template spa2t_tmplt
2023/09/15 10:40:53.269262 ttdb.go:366: Persisted Template spa2t_tmplt.html
2023/09/15 10:40:53.330961 ttdb.go:379: Persisting Template xdw2t_tmplt
2023/09/15 10:40:53.411244 ttdb.go:385: Persisted Template xdw2t_tmplt
2023/09/15 10:40:53.411353 ttdb.go:366: Persisted Template xdw2t_tmplt.html
2023/09/15 10:40:53.474047 ttdb.go:379: Persisting Template spaheader2t_tmplt
2023/09/15 10:40:53.543156 ttdb.go:385: Persisted Template spaheader2t_tmplt
2023/09/15 10:40:53.543269 ttdb.go:366: Persisted Template spaheader2t_tmplt.html
2023/09/15 10:40:53.604332 ttdb.go:379: Persisting Template pds_tmplt
2023/09/15 10:40:53.669822 ttdb.go:385: Persisted Template pds_tmplt
2023/09/15 10:40:53.669981 ttdb.go:366: Persisted Template pds_tmplt.html
2023/09/15 10:40:53.732861 ttdb.go:379: Persisting Template error_tmplt
2023/09/15 10:40:53.794782 ttdb.go:385: Persisted Template error_tmplt
2023/09/15 10:40:53.794913 ttdb.go:366: Persisted Template error_tmplt.html
2023/09/15 10:40:53.858677 ttdb.go:379: Persisting Template dsuback_tmplt
2023/09/15 10:40:53.921703 ttdb.go:385: Persisted Template dsuback_tmplt
2023/09/15 10:40:53.921858 ttdb.go:366: Persisted Template dsuback_tmplt.xml
2023/09/15 10:40:53.983319 ttdb.go:379: Persisting Template pixm_tmplt
2023/09/15 10:40:54.050825 ttdb.go:385: Persisted Template pixm_tmplt
2023/09/15 10:40:54.050984 ttdb.go:366: Persisted Template pixm_tmplt.html
2023/09/15 10:40:54.113357 ttdb.go:379: Persisting Template subscriptions2t_tmplt
2023/09/15 10:40:54.178776 ttdb.go:385: Persisted Template subscriptions2t_tmplt
2023/09/15 10:40:54.178920 ttdb.go:366: Persisted Template subscriptions2t_tmplt.html
2023/09/15 10:40:54.241991 ttdb.go:379: Persisting Template codemaps2t_tmplt
2023/09/15 10:40:54.311002 ttdb.go:385: Persisted Template codemaps2t_tmplt
2023/09/15 10:40:54.311155 ttdb.go:366: Persisted Template codemaps2t_tmplt.html
2023/09/15 10:40:54.373587 ttdb.go:379: Persisting Template mhdpublish_tmplt
2023/09/15 10:40:54.442832 ttdb.go:385: Persisted Template mhdpublish_tmplt
2023/09/15 10:40:54.442993 ttdb.go:366: Persisted Template mhdpublish_tmplt.json
2023/09/15 10:40:54.506740 ttdb.go:379: Persisting Template events_tmplt
2023/09/15 10:40:54.572849 ttdb.go:385: Persisted Template events_tmplt
2023/09/15 10:40:54.572998 ttdb.go:366: Persisted Template events_tmplt.html
2023/09/15 10:40:54.636211 ttdb.go:379: Persisting Template uploadfile2t_tmplt
2023/09/15 10:40:54.702552 ttdb.go:385: Persisted Template uploadfile2t_tmplt
2023/09/15 10:40:54.702682 ttdb.go:366: Persisted Template uploadfile2t_tmplt.html
2023/09/15 10:40:54.702907 ttserver.go:40: Starting ICB Workflow Service. Service Endpoint http://MacBook-Pro-3.lan:8080/
2023/09/15 10:40:57.653140 ttgethandler.go:10: Processing new GET Request
2023/09/15 10:40:57.653328 ttproxy.go:138: 	Request Query Params
2023/09/15 10:40:57.653898 ttutil.go:140: 	{
  "User": "ian.thomas",
  "Org": "2tsolutions",
  "Role": "clinical",
  "Nhs": "9000000009"
}
2023/09/15 10:40:57.653957 ttgethandler.go:15: Path = /beta/spa/consumer/patient
2023/09/15 10:40:57.654021 tttmplts.go:37: CGL Worker starting
2023/09/15 10:40:57.654033 tttmplts.go:30: PIXm Worker starting
2023/09/15 10:40:57.654927 tthttp.go:15: Creating PIXm PDQ - Server URL http://lac-demo-01.tianispirit.co.uk:8081/SpiritPIXFhir/r4/Patient?identifier=2.16.840.1.113883.2.1.4.1%7C9000000009
2023/09/15 10:40:57.657823 tthttp.go:160: Request Headers 
map[Content-Type:[application/json]]
2023/09/15 10:40:57.657973 tthttp.go:160: Request Headers 
map[Accept:[application/json] X-Api-Key:[FNhb#OhxWiEiMdf+@6085k5Zmt] X-Api-Secret:[9710ea0fb4ffb5d56c2e62c71c30bdfhjsyr56a79d]]
2023/09/15 10:40:57.843576 tthttp.go:174: Server Response - Status Code 404 
{"errors":[{"message":"No clients matching nhs number 9000000009","path":"\/"}],"status":404}
2023/09/15 10:40:57.849483 ttutil.go:140: 	{
  "data": {
    "client": {
      "basicDetails": {
        "address": {},
        "name": {}
      },
      "bbvInformation": {},
      "drugTestResults": {
        "results": {}
      },
      "riskInformation": {
        "mentalHealthDomain": {},
        "riskOfHarmToSelfDomain": {},
        "socialDomain": {},
        "substanceMisuseDomain": {}
      },
      "safeguardingInformation": {}
    },
    "keyWorker": {
      "name": {}
    }
  }
}
2023/09/15 10:40:57.849621 tttmplts.go:39: CGL Worker done
2023/09/15 10:40:57.849656 tttmplts.go:40: CGL Worker Status Code 404
2023/09/15 10:41:02.656533 tthttp.go:174: Server Response - Status Code 0 
2023/09/15 10:41:02.656703 tttmplts.go:32: PIXm Worker done
2023/09/15 10:41:02.656730 tttmplts.go:33: PIXm Worker Status Code 408
2023/09/15 10:41:02.656888 tthttp.go:56: Creating PDS Search Request - Server URL https://sandbox.api.service.nhs.uk/personal-demographics/FHIR/R4/Patient/9000000009
2023/09/15 10:41:02.656982 tthttp.go:160: Request Headers 
map[Accept:[*/*] Content-Type:[application/json] X-Request-Id:[dbaae406-a7d3-48bd-a90a-4d15d5e4895c]]
2023/09/15 10:41:02.860966 tthttp.go:174: Server Response - Status Code 200 
{"resourceType":"Patient","id":"9000000009","identifier":[{"system":"https://fhir.nhs.uk/Id/nhs-number","value":"9000000009","extension":[{"url":"https://fhir.hl7.org.uk/StructureDefinition/Extension-UKCore-NHSNumberVerificationStatus","valueCodeableConcept":{"coding":[{"system":"https://fhir.hl7.org.uk/CodeSystem/UKCore-NHSNumberVerificationStatus","version":"1.0.0","code":"01","display":"Number present and verified"}]}}]}],"meta":{"versionId":"2","security":[{"system":"http://terminology.hl7.org/CodeSystem/v3-Confidentiality","code":"U","display":"unrestricted"}]},"name":[{"id":"123","use":"usual","period":{"start":"2020-01-01","end":"2021-12-31"},"given":["Jane"],"family":"Smith","prefix":["Mrs"],"suffix":["MBE"]}],"gender":"female","birthDate":"2010-10-22","multipleBirthInteger":1,"deceasedDateTime":"2010-10-22T00:00:00+00:00","generalPractitioner":[{"id":"254406A3","type":"Organization","identifier":{"system":"https://fhir.nhs.uk/Id/ods-organization-code","value":"Y12345","period":{"start":"2020-01-01","end":"2021-12-31"}}}],"managingOrganization":{"type":"Organization","identifier":{"system":"https://fhir.nhs.uk/Id/ods-organization-code","value":"Y12345","period":{"start":"2020-01-01","end":"2021-12-31"}}},"extension":[{"url":"https://fhir.hl7.org.uk/StructureDefinition/Extension-UKCore-NominatedPharmacy","valueReference":{"identifier":{"system":"https://fhir.nhs.uk/Id/ods-organization-code","value":"Y12345"}}},{"url":"https://fhir.hl7.org.uk/StructureDefinition/Extension-UKCore-PreferredDispenserOrganization","valueReference":{"identifier":{"system":"https://fhir.nhs.uk/Id/ods-organization-code","value":"Y23456"}}},{"url":"https://fhir.hl7.org.uk/StructureDefinition/Extension-UKCore-MedicalApplianceSupplier","valueReference":{"identifier":{"system":"https://fhir.nhs.uk/Id/ods-organization-code","value":"Y34567"}}},{"url":"https://fhir.hl7.org.uk/StructureDefinition/Extension-UKCore-DeathNotificationStatus","extension":[{"url":"deathNotificationStatus","valueCodeableConcept":{"coding":[{"system":"https://fhir.hl7.org.uk/CodeSystem/UKCore-DeathNotificationStatus","version":"1.0.0","code":"2","display":"Formal - death notice received from Registrar of Deaths"}]}},{"url":"systemEffectiveDate","valueDateTime":"2010-10-22T00:00:00+00:00"}]},{"url":"https://fhir.hl7.org.uk/StructureDefinition/Extension-UKCore-NHSCommunication","extension":[{"url":"language","valueCodeableConcept":{"coding":[{"system":"https://fhir.hl7.org.uk/CodeSystem/UKCore-HumanLanguage","version":"1.0.0","code":"fr","display":"French"}]}},{"url":"interpreterRequired","valueBoolean":true}]},{"url":"https://fhir.hl7.org.uk/StructureDefinition/Extension-UKCore-ContactPreference","extension":[{"url":"PreferredWrittenCommunicationFormat","valueCodeableConcept":{"coding":[{"system":"https://fhir.hl7.org.uk/CodeSystem/UKCore-PreferredWrittenCommunicationFormat","code":"12","display":"Braille"}]}},{"url":"PreferredContactMethod","valueCodeableConcept":{"coding":[{"system":"https://fhir.hl7.org.uk/CodeSystem/UKCore-PreferredContactMethod","code":"1","display":"Letter"}]}},{"url":"PreferredContactTimes","valueString":"Not after 7pm"}]},{"url":"http://hl7.org/fhir/StructureDefinition/patient-birthPlace","valueAddress":{"city":"Manchester","district":"Greater Manchester","country":"GBR"}},{"url":"https://fhir.nhs.uk/StructureDefinition/Extension-PDS-RemovalFromRegistration","extension":[{"url":"removalFromRegistrationCode","valueCodeableConcept":{"coding":[{"system":"https://fhir.nhs.uk/CodeSystem/PDS-RemovalReasonExitCode","code":"SCT","display":"Transferred to Scotland"}]}},{"url":"effectiveTime","valuePeriod":{"start":"2020-01-01T00:00:00+00:00","end":"2021-12-31T00:00:00+00:00"}}]}],"telecom":[{"id":"789","period":{"start":"2020-01-01","end":"2021-12-31"},"system":"phone","value":"01632960587","use":"home"},{"id":"790","period":{"start":"2019-01-01","end":"2022-12-31"},"system":"email","value":"jane.smith@example.com","use":"home"},{"id":"OC789","period":{"start":"2020-01-01","end":"2021-12-31"},"system":"other","value":"01632960587","use":"home","extension":[{"url":"https://fhir.hl7.org.uk/StructureDefinition/Extension-UKCore-OtherContactSystem","valueCoding":{"system":"https://fhir.hl7.org.uk/CodeSystem/UKCore-OtherContactSystem","code":"textphone","display":"Minicom (Textphone)"}}]}],"contact":[{"id":"C123","period":{"start":"2020-01-01","end":"2021-12-31"},"relationship":[{"coding":[{"system":"http://terminology.hl7.org/CodeSystem/v2-0131","code":"C","display":"Emergency Contact"}]}],"telecom":[{"system":"phone","value":"01632960587"}]}],"address":[{"id":"456","period":{"start":"2020-01-01","end":"2021-12-31"},"use":"home","line":["1 Trevelyan Square","Boar Lane","City Centre","Leeds","West Yorkshire"],"postalCode":"LS1 6AE","extension":[{"url":"https://fhir.hl7.org.uk/StructureDefinition/Extension-UKCore-AddressKey","extension":[{"url":"type","valueCoding":{"system":"https://fhir.hl7.org.uk/CodeSystem/UKCore-AddressKeyType","code":"PAF"}},{"url":"value","valueString":"12345678"}]},{"url":"https://fhir.hl7.org.uk/StructureDefinition/Extension-UKCore-AddressKey","extension":[{"url":"type","valueCoding":{"system":"https://fhir.hl7.org.uk/CodeSystem/UKCore-AddressKeyType","code":"UPRN"}},{"url":"value","valueString":"123456789012"}]}]},{"id":"T456","period":{"start":"2020-01-01","end":"2021-12-31"},"use":"temp","text":"Student Accommodation","line":["1 Trevelyan Square","Boar Lane","City Centre","Leeds","West Yorkshire"],"postalCode":"LS1 6AE","extension":[{"url":"https://fhir.hl7.org.uk/StructureDefinition/Extension-UKCore-AddressKey","extension":[{"url":"type","valueCoding":{"system":"https://fhir.hl7.org.uk/CodeSystem/UKCore-AddressKeyType","code":"PAF"}},{"url":"value","valueString":"12345678"}]},{"url":"https://fhir.hl7.org.uk/StructureDefinition/Extension-UKCore-AddressKey","extension":[{"url":"type","valueCoding":{"system":"https://fhir.hl7.org.uk/CodeSystem/UKCore-AddressKeyType","code":"UPRN"}},{"url":"value","valueString":"123456789012"}]}]}]}
2023/09/15 10:41:03.053912 tttmplts.go:100: Caching 24 Templates
2023/09/15 10:41:03.054634 tttmplts.go:104: Template cgl_tmplt caused Error template: cgl_tmplt:5: unexpected {{else}} in define clause
2023/09/15 10:41:03.055089 server.go:3217: http: panic serving [::1]:64881: runtime error: invalid memory address or nil pointer dereference
goroutine 37 [running]:
net/http.(*conn).serve.func1()
	/Users/IanThomas/sdk/go1.20.5/src/net/http/server.go:1854 +0xbf
panic({0x1434ca0, 0x17e4e70})
	/Users/IanThomas/sdk/go1.20.5/src/runtime/panic.go:890 +0x263
html/template.(*Template).New(0x14c1682?, {0xc0005b5bb0?, 0xc000337fc0?})
	/Users/IanThomas/sdk/go1.20.5/src/html/template/template.go:305 +0x37
main.(*Trans).cacheTemplates(0xc0003c6000)
	/Users/IanThomas/go/src/ttxdwuser/main/tttmplts.go:103 +0x1d2
main.(*Trans).setResponseFromTemplate(0xc0003c6000)
	/Users/IanThomas/go/src/ttxdwuser/main/tttmplts.go:85 +0x45
main.(*Trans).setPatientTemplate(0xc0003c6000)
	/Users/IanThomas/go/src/ttxdwuser/main/tttmplts.go:53 +0x1b1
main.(*Trans).newGetHandler(0xc0003c6000)
	/Users/IanThomas/go/src/ttxdwuser/main/ttgethandler.go:28 +0xd94
main.(*Trans).newProxyTrans(0xc0003c6000)
	/Users/IanThomas/go/src/ttxdwuser/main/ttproxy.go:73 +0x4d1
main.Handle_HTTP_Request({0x15657d0, 0xc0002fe9a0}, 0xc0003b0000)
	/Users/IanThomas/go/src/ttxdwuser/main/ttproxy.go:15 +0xeb
net/http.HandlerFunc.ServeHTTP(0xc0003b201f?, {0x15657d0?, 0xc0002fe9a0?}, 0x1064cee?)
	/Users/IanThomas/sdk/go1.20.5/src/net/http/server.go:2122 +0x2f
net/http.serverHandler.ServeHTTP({0xc0001994a0?}, {0x15657d0, 0xc0002fe9a0}, 0xc0003b0000)
	/Users/IanThomas/sdk/go1.20.5/src/net/http/server.go:2936 +0x316
net/http.(*conn).serve(0xc0000d41b0, {0x15659c8, 0xc0000ae4b0})
	/Users/IanThomas/sdk/go1.20.5/src/net/http/server.go:1995 +0x612
created by net/http.(*Server).Serve
	/Users/IanThomas/sdk/go1.20.5/src/net/http/server.go:3089 +0x5ed
2023/09/15 10:42:06.328575 ttserver.go:52: ICB Workflow Service stopped
2023/09/15 10:42:08.206014 ttutil.go:133: -----------------------------------------------------------------------------------
2023/09/15 10:42:08.206464 ttdb.go:51: Opening DB Connection to mysql instance
User: root
Host: tuk.coil1nnpqdlr.eu-west-1.rds.amazonaws.com
Port: :3306
Name: tuk
Connect Timeout 2s
Read Timeout 5s
2023/09/15 10:42:08.206581 ttdb.go:54: Opened Database
2023/09/15 10:42:08.398014 ttdb.go:379: Persisting Template dsubcancel_tmplt
2023/09/15 10:42:08.469883 ttdb.go:385: Persisted Template dsubcancel_tmplt
2023/09/15 10:42:08.469950 ttdb.go:366: Persisted Template dsubcancel_tmplt.xml
2023/09/15 10:42:08.539470 ttdb.go:379: Persisting Template cgl_tmplt
2023/09/15 10:42:08.644355 ttdb.go:385: Persisted Template cgl_tmplt
2023/09/15 10:42:08.644417 ttdb.go:366: Persisted Template cgl_tmplt.html
2023/09/15 10:42:08.714083 ttdb.go:379: Persisting Template pdssearch_tmplt
2023/09/15 10:42:08.786360 ttdb.go:385: Persisted Template pdssearch_tmplt
2023/09/15 10:42:08.786396 ttdb.go:366: Persisted Template pdssearch_tmplt.html
2023/09/15 10:42:08.855152 ttdb.go:379: Persisting Template dsubsubscribe_tmplt
2023/09/15 10:42:08.924169 ttdb.go:385: Persisted Template dsubsubscribe_tmplt
2023/09/15 10:42:08.924321 ttdb.go:366: Persisted Template dsubsubscribe_tmplt.xml
2023/09/15 10:42:08.995276 ttdb.go:379: Persisting Template notification_tmplt
2023/09/15 10:42:09.064407 ttdb.go:385: Persisted Template notification_tmplt
2023/09/15 10:42:09.064564 ttdb.go:366: Persisted Template notification_tmplt.txt
2023/09/15 10:42:09.135218 ttdb.go:379: Persisting Template wfstate2t_tmplt
2023/09/15 10:42:09.263359 ttdb.go:385: Persisted Template wfstate2t_tmplt
2023/09/15 10:42:09.263493 ttdb.go:366: Persisted Template wfstate2t_tmplt.html
2023/09/15 10:42:09.333165 ttdb.go:379: Persisting Template publishfile2t_tmplt
2023/09/15 10:42:09.405639 ttdb.go:385: Persisted Template publishfile2t_tmplt
2023/09/15 10:42:09.405804 ttdb.go:366: Persisted Template publishfile2t_tmplt.html
2023/09/15 10:42:09.476081 ttdb.go:379: Persisting Template react_tmplt
2023/09/15 10:42:09.545045 ttdb.go:385: Persisted Template react_tmplt
2023/09/15 10:42:09.545141 ttdb.go:366: Persisted Template react_tmplt.html
2023/09/15 10:42:09.614862 ttdb.go:379: Persisting Template pdsretrieve_tmplt
2023/09/15 10:42:09.686375 ttdb.go:385: Persisted Template pdsretrieve_tmplt
2023/09/15 10:42:09.686459 ttdb.go:366: Persisted Template pdsretrieve_tmplt.html
2023/09/15 10:42:09.757163 ttdb.go:379: Persisting Template allpatientSrvs_tmplt
2023/09/15 10:42:09.830078 ttdb.go:385: Persisted Template allpatientSrvs_tmplt
2023/09/15 10:42:09.830115 ttdb.go:366: Persisted Template allpatientSrvs_tmplt.html
2023/09/15 10:42:09.900797 ttdb.go:379: Persisting Template spa2t_tmplt
2023/09/15 10:42:09.982286 ttdb.go:385: Persisted Template spa2t_tmplt
2023/09/15 10:42:09.982347 ttdb.go:366: Persisted Template spa2t_tmplt.html
2023/09/15 10:42:10.051998 ttdb.go:379: Persisting Template xdw2t_tmplt
2023/09/15 10:42:10.138560 ttdb.go:385: Persisted Template xdw2t_tmplt
2023/09/15 10:42:10.138728 ttdb.go:366: Persisted Template xdw2t_tmplt.html
2023/09/15 10:42:10.210659 ttdb.go:379: Persisting Template spaheader2t_tmplt
2023/09/15 10:42:10.286293 ttdb.go:385: Persisted Template spaheader2t_tmplt
2023/09/15 10:42:10.286466 ttdb.go:366: Persisted Template spaheader2t_tmplt.html
2023/09/15 10:42:10.357651 ttdb.go:379: Persisting Template pds_tmplt
2023/09/15 10:42:10.427517 ttdb.go:385: Persisted Template pds_tmplt
2023/09/15 10:42:10.427694 ttdb.go:366: Persisted Template pds_tmplt.html
2023/09/15 10:42:10.503715 ttdb.go:379: Persisting Template error_tmplt
2023/09/15 10:42:10.572559 ttdb.go:385: Persisted Template error_tmplt
2023/09/15 10:42:10.572590 ttdb.go:366: Persisted Template error_tmplt.html
2023/09/15 10:42:10.641327 ttdb.go:379: Persisting Template dsuback_tmplt
2023/09/15 10:42:10.710262 ttdb.go:385: Persisted Template dsuback_tmplt
2023/09/15 10:42:10.710320 ttdb.go:366: Persisted Template dsuback_tmplt.xml
2023/09/15 10:42:10.780981 ttdb.go:379: Persisting Template pixm_tmplt
2023/09/15 10:42:10.855935 ttdb.go:385: Persisted Template pixm_tmplt
2023/09/15 10:42:10.856094 ttdb.go:366: Persisted Template pixm_tmplt.html
2023/09/15 10:42:10.923961 ttdb.go:379: Persisting Template subscriptions2t_tmplt
2023/09/15 10:42:10.999973 ttdb.go:385: Persisted Template subscriptions2t_tmplt
2023/09/15 10:42:11.000117 ttdb.go:366: Persisted Template subscriptions2t_tmplt.html
2023/09/15 10:42:11.069932 ttdb.go:379: Persisting Template codemaps2t_tmplt
2023/09/15 10:42:11.143971 ttdb.go:385: Persisted Template codemaps2t_tmplt
2023/09/15 10:42:11.144075 ttdb.go:366: Persisted Template codemaps2t_tmplt.html
2023/09/15 10:42:11.213547 ttdb.go:379: Persisting Template mhdpublish_tmplt
2023/09/15 10:42:11.288424 ttdb.go:385: Persisted Template mhdpublish_tmplt
2023/09/15 10:42:11.288635 ttdb.go:366: Persisted Template mhdpublish_tmplt.json
2023/09/15 10:42:11.359480 ttdb.go:379: Persisting Template events_tmplt
2023/09/15 10:42:11.432648 ttdb.go:385: Persisted Template events_tmplt
2023/09/15 10:42:11.432786 ttdb.go:366: Persisted Template events_tmplt.html
2023/09/15 10:42:11.504584 ttdb.go:379: Persisting Template uploadfile2t_tmplt
2023/09/15 10:42:11.574803 ttdb.go:385: Persisted Template uploadfile2t_tmplt
2023/09/15 10:42:11.574933 ttdb.go:366: Persisted Template uploadfile2t_tmplt.html
2023/09/15 10:42:11.575225 ttserver.go:40: Starting ICB Workflow Service. Service Endpoint http://MacBook-Pro-3.lan:8080/
2023/09/15 10:42:15.372537 ttgethandler.go:10: Processing new GET Request
2023/09/15 10:42:15.372736 ttproxy.go:138: 	Request Query Params
2023/09/15 10:42:15.373157 ttutil.go:140: 	{
  "User": "ian.thomas",
  "Org": "2tsolutions",
  "Role": "clinical",
  "Nhs": "9000000009"
}
2023/09/15 10:42:15.373203 ttgethandler.go:15: Path = /beta/spa/consumer/patient
2023/09/15 10:42:15.373244 tttmplts.go:37: CGL Worker starting
2023/09/15 10:42:15.373250 tttmplts.go:30: PIXm Worker starting
2023/09/15 10:42:15.373759 tthttp.go:15: Creating PIXm PDQ - Server URL http://lac-demo-01.tianispirit.co.uk:8081/SpiritPIXFhir/r4/Patient?identifier=2.16.840.1.113883.2.1.4.1%7C9000000009
2023/09/15 10:42:15.375103 tthttp.go:160: Request Headers 
map[Content-Type:[application/json]]
2023/09/15 10:42:15.375121 tthttp.go:160: Request Headers 
map[Accept:[application/json] X-Api-Key:[FNhb#OhxWiEiMdf+@6085k5Zmt] X-Api-Secret:[9710ea0fb4ffb5d56c2e62c71c30bdfhjsyr56a79d]]
2023/09/15 10:42:15.570494 tthttp.go:174: Server Response - Status Code 404 
{"errors":[{"message":"No clients matching nhs number 9000000009","path":"\/"}],"status":404}
2023/09/15 10:42:15.577172 ttutil.go:140: 	{
  "data": {
    "client": {
      "basicDetails": {
        "address": {},
        "name": {}
      },
      "bbvInformation": {},
      "drugTestResults": {
        "results": {}
      },
      "riskInformation": {
        "mentalHealthDomain": {},
        "riskOfHarmToSelfDomain": {},
        "socialDomain": {},
        "substanceMisuseDomain": {}
      },
      "safeguardingInformation": {}
    },
    "keyWorker": {
      "name": {}
    }
  }
}
2023/09/15 10:42:15.577284 tttmplts.go:39: CGL Worker done
2023/09/15 10:42:15.577317 tttmplts.go:40: CGL Worker Status Code 404
2023/09/15 10:42:20.375282 tthttp.go:174: Server Response - Status Code 0 
2023/09/15 10:42:20.375803 tttmplts.go:32: PIXm Worker done
2023/09/15 10:42:20.375907 tttmplts.go:33: PIXm Worker Status Code 408
2023/09/15 10:42:20.376296 tthttp.go:56: Creating PDS Search Request - Server URL https://sandbox.api.service.nhs.uk/personal-demographics/FHIR/R4/Patient/9000000009
2023/09/15 10:42:20.376513 tthttp.go:160: Request Headers 
map[Accept:[*/*] Content-Type:[application/json] X-Request-Id:[04387bc9-995b-4508-9e98-f266925ca08b]]
2023/09/15 10:42:20.639013 tthttp.go:174: Server Response - Status Code 200 
{"resourceType":"Patient","id":"9000000009","identifier":[{"system":"https://fhir.nhs.uk/Id/nhs-number","value":"9000000009","extension":[{"url":"https://fhir.hl7.org.uk/StructureDefinition/Extension-UKCore-NHSNumberVerificationStatus","valueCodeableConcept":{"coding":[{"system":"https://fhir.hl7.org.uk/CodeSystem/UKCore-NHSNumberVerificationStatus","version":"1.0.0","code":"01","display":"Number present and verified"}]}}]}],"meta":{"versionId":"2","security":[{"system":"http://terminology.hl7.org/CodeSystem/v3-Confidentiality","code":"U","display":"unrestricted"}]},"name":[{"id":"123","use":"usual","period":{"start":"2020-01-01","end":"2021-12-31"},"given":["Jane"],"family":"Smith","prefix":["Mrs"],"suffix":["MBE"]}],"gender":"female","birthDate":"2010-10-22","multipleBirthInteger":1,"deceasedDateTime":"2010-10-22T00:00:00+00:00","generalPractitioner":[{"id":"254406A3","type":"Organization","identifier":{"system":"https://fhir.nhs.uk/Id/ods-organization-code","value":"Y12345","period":{"start":"2020-01-01","end":"2021-12-31"}}}],"managingOrganization":{"type":"Organization","identifier":{"system":"https://fhir.nhs.uk/Id/ods-organization-code","value":"Y12345","period":{"start":"2020-01-01","end":"2021-12-31"}}},"extension":[{"url":"https://fhir.hl7.org.uk/StructureDefinition/Extension-UKCore-NominatedPharmacy","valueReference":{"identifier":{"system":"https://fhir.nhs.uk/Id/ods-organization-code","value":"Y12345"}}},{"url":"https://fhir.hl7.org.uk/StructureDefinition/Extension-UKCore-PreferredDispenserOrganization","valueReference":{"identifier":{"system":"https://fhir.nhs.uk/Id/ods-organization-code","value":"Y23456"}}},{"url":"https://fhir.hl7.org.uk/StructureDefinition/Extension-UKCore-MedicalApplianceSupplier","valueReference":{"identifier":{"system":"https://fhir.nhs.uk/Id/ods-organization-code","value":"Y34567"}}},{"url":"https://fhir.hl7.org.uk/StructureDefinition/Extension-UKCore-DeathNotificationStatus","extension":[{"url":"deathNotificationStatus","valueCodeableConcept":{"coding":[{"system":"https://fhir.hl7.org.uk/CodeSystem/UKCore-DeathNotificationStatus","version":"1.0.0","code":"2","display":"Formal - death notice received from Registrar of Deaths"}]}},{"url":"systemEffectiveDate","valueDateTime":"2010-10-22T00:00:00+00:00"}]},{"url":"https://fhir.hl7.org.uk/StructureDefinition/Extension-UKCore-NHSCommunication","extension":[{"url":"language","valueCodeableConcept":{"coding":[{"system":"https://fhir.hl7.org.uk/CodeSystem/UKCore-HumanLanguage","version":"1.0.0","code":"fr","display":"French"}]}},{"url":"interpreterRequired","valueBoolean":true}]},{"url":"https://fhir.hl7.org.uk/StructureDefinition/Extension-UKCore-ContactPreference","extension":[{"url":"PreferredWrittenCommunicationFormat","valueCodeableConcept":{"coding":[{"system":"https://fhir.hl7.org.uk/CodeSystem/UKCore-PreferredWrittenCommunicationFormat","code":"12","display":"Braille"}]}},{"url":"PreferredContactMethod","valueCodeableConcept":{"coding":[{"system":"https://fhir.hl7.org.uk/CodeSystem/UKCore-PreferredContactMethod","code":"1","display":"Letter"}]}},{"url":"PreferredContactTimes","valueString":"Not after 7pm"}]},{"url":"http://hl7.org/fhir/StructureDefinition/patient-birthPlace","valueAddress":{"city":"Manchester","district":"Greater Manchester","country":"GBR"}},{"url":"https://fhir.nhs.uk/StructureDefinition/Extension-PDS-RemovalFromRegistration","extension":[{"url":"removalFromRegistrationCode","valueCodeableConcept":{"coding":[{"system":"https://fhir.nhs.uk/CodeSystem/PDS-RemovalReasonExitCode","code":"SCT","display":"Transferred to Scotland"}]}},{"url":"effectiveTime","valuePeriod":{"start":"2020-01-01T00:00:00+00:00","end":"2021-12-31T00:00:00+00:00"}}]}],"telecom":[{"id":"789","period":{"start":"2020-01-01","end":"2021-12-31"},"system":"phone","value":"01632960587","use":"home"},{"id":"790","period":{"start":"2019-01-01","end":"2022-12-31"},"system":"email","value":"jane.smith@example.com","use":"home"},{"id":"OC789","period":{"start":"2020-01-01","end":"2021-12-31"},"system":"other","value":"01632960587","use":"home","extension":[{"url":"https://fhir.hl7.org.uk/StructureDefinition/Extension-UKCore-OtherContactSystem","valueCoding":{"system":"https://fhir.hl7.org.uk/CodeSystem/UKCore-OtherContactSystem","code":"textphone","display":"Minicom (Textphone)"}}]}],"contact":[{"id":"C123","period":{"start":"2020-01-01","end":"2021-12-31"},"relationship":[{"coding":[{"system":"http://terminology.hl7.org/CodeSystem/v2-0131","code":"C","display":"Emergency Contact"}]}],"telecom":[{"system":"phone","value":"01632960587"}]}],"address":[{"id":"456","period":{"start":"2020-01-01","end":"2021-12-31"},"use":"home","line":["1 Trevelyan Square","Boar Lane","City Centre","Leeds","West Yorkshire"],"postalCode":"LS1 6AE","extension":[{"url":"https://fhir.hl7.org.uk/StructureDefinition/Extension-UKCore-AddressKey","extension":[{"url":"type","valueCoding":{"system":"https://fhir.hl7.org.uk/CodeSystem/UKCore-AddressKeyType","code":"PAF"}},{"url":"value","valueString":"12345678"}]},{"url":"https://fhir.hl7.org.uk/StructureDefinition/Extension-UKCore-AddressKey","extension":[{"url":"type","valueCoding":{"system":"https://fhir.hl7.org.uk/CodeSystem/UKCore-AddressKeyType","code":"UPRN"}},{"url":"value","valueString":"123456789012"}]}]},{"id":"T456","period":{"start":"2020-01-01","end":"2021-12-31"},"use":"temp","text":"Student Accommodation","line":["1 Trevelyan Square","Boar Lane","City Centre","Leeds","West Yorkshire"],"postalCode":"LS1 6AE","extension":[{"url":"https://fhir.hl7.org.uk/StructureDefinition/Extension-UKCore-AddressKey","extension":[{"url":"type","valueCoding":{"system":"https://fhir.hl7.org.uk/CodeSystem/UKCore-AddressKeyType","code":"PAF"}},{"url":"value","valueString":"12345678"}]},{"url":"https://fhir.hl7.org.uk/StructureDefinition/Extension-UKCore-AddressKey","extension":[{"url":"type","valueCoding":{"system":"https://fhir.hl7.org.uk/CodeSystem/UKCore-AddressKeyType","code":"UPRN"}},{"url":"value","valueString":"123456789012"}]}]}]}
2023/09/15 10:42:20.851785 tttmplts.go:100: Caching 24 Templates
2023/09/15 10:42:20.862940 tttmplts.go:87: Processing Template allpatientSrvs_tmplt
2023/09/15 10:42:20.868031 ttproxy.go:149: Response Status Code 200
2023/09/15 10:54:59.253644 ttserver.go:52: ICB Workflow Service stopped
2023/09/15 10:55:01.916375 ttutil.go:133: -----------------------------------------------------------------------------------
2023/09/15 10:55:01.916865 ttdb.go:51: Opening DB Connection to mysql instance
User: root
Host: tuk.coil1nnpqdlr.eu-west-1.rds.amazonaws.com
Port: :3306
Name: tuk
Connect Timeout 2s
Read Timeout 5s
2023/09/15 10:55:01.916991 ttdb.go:54: Opened Database
2023/09/15 10:55:02.169998 ttdb.go:379: Persisting Template dsubcancel_tmplt
2023/09/15 10:55:02.274697 ttdb.go:385: Persisted Template dsubcancel_tmplt
2023/09/15 10:55:02.275587 ttdb.go:366: Persisted Template dsubcancel_tmplt.xml
2023/09/15 10:55:02.398402 ttdb.go:379: Persisting Template cgl_tmplt
2023/09/15 10:55:02.612032 ttdb.go:385: Persisted Template cgl_tmplt
2023/09/15 10:55:02.612148 ttdb.go:366: Persisted Template cgl_tmplt.html
2023/09/15 10:55:02.733072 ttdb.go:379: Persisting Template pdssearch_tmplt
2023/09/15 10:55:02.852561 ttdb.go:385: Persisted Template pdssearch_tmplt
2023/09/15 10:55:02.852668 ttdb.go:366: Persisted Template pdssearch_tmplt.html
2023/09/15 10:55:02.979183 ttdb.go:379: Persisting Template dsubsubscribe_tmplt
2023/09/15 10:55:03.102475 ttdb.go:385: Persisted Template dsubsubscribe_tmplt
2023/09/15 10:55:03.102561 ttdb.go:366: Persisted Template dsubsubscribe_tmplt.xml
2023/09/15 10:55:03.221555 ttdb.go:379: Persisting Template notification_tmplt
2023/09/15 10:55:03.366672 ttdb.go:385: Persisted Template notification_tmplt
2023/09/15 10:55:03.366775 ttdb.go:366: Persisted Template notification_tmplt.txt
2023/09/15 10:55:03.533816 ttdb.go:379: Persisting Template wfstate2t_tmplt
2023/09/15 10:55:03.758667 ttdb.go:385: Persisted Template wfstate2t_tmplt
2023/09/15 10:55:03.758743 ttdb.go:366: Persisted Template wfstate2t_tmplt.html
2023/09/15 10:55:03.922886 ttdb.go:379: Persisting Template publishfile2t_tmplt
2023/09/15 10:55:04.052974 ttdb.go:385: Persisted Template publishfile2t_tmplt
2023/09/15 10:55:04.053125 ttdb.go:366: Persisted Template publishfile2t_tmplt.html
2023/09/15 10:55:04.225323 ttdb.go:379: Persisting Template react_tmplt
2023/09/15 10:55:04.343950 ttdb.go:385: Persisted Template react_tmplt
2023/09/15 10:55:04.344144 ttdb.go:366: Persisted Template react_tmplt.html
2023/09/15 10:55:04.466583 ttdb.go:379: Persisting Template pdsretrieve_tmplt
2023/09/15 10:55:04.647835 ttdb.go:385: Persisted Template pdsretrieve_tmplt
2023/09/15 10:55:04.647994 ttdb.go:366: Persisted Template pdsretrieve_tmplt.html
2023/09/15 10:55:04.717149 ttdb.go:379: Persisting Template allpatientSrvs_tmplt
2023/09/15 10:55:04.786434 ttdb.go:385: Persisted Template allpatientSrvs_tmplt
2023/09/15 10:55:04.786603 ttdb.go:366: Persisted Template allpatientSrvs_tmplt.html
2023/09/15 10:55:04.861124 ttdb.go:379: Persisting Template spa2t_tmplt
2023/09/15 10:55:04.941478 ttdb.go:385: Persisted Template spa2t_tmplt
2023/09/15 10:55:04.941704 ttdb.go:366: Persisted Template spa2t_tmplt.html
2023/09/15 10:55:05.008547 ttdb.go:379: Persisting Template xdw2t_tmplt
2023/09/15 10:55:05.091792 ttdb.go:385: Persisted Template xdw2t_tmplt
2023/09/15 10:55:05.091960 ttdb.go:366: Persisted Template xdw2t_tmplt.html
2023/09/15 10:55:05.157448 ttdb.go:379: Persisting Template spaheader2t_tmplt
2023/09/15 10:55:05.229268 ttdb.go:385: Persisted Template spaheader2t_tmplt
2023/09/15 10:55:05.229287 ttdb.go:366: Persisted Template spaheader2t_tmplt.html
2023/09/15 10:55:05.296878 ttdb.go:379: Persisting Template pds_tmplt
2023/09/15 10:55:05.361417 ttdb.go:385: Persisted Template pds_tmplt
2023/09/15 10:55:05.361446 ttdb.go:366: Persisted Template pds_tmplt.html
2023/09/15 10:55:05.429550 ttdb.go:379: Persisting Template error_tmplt
2023/09/15 10:55:05.494447 ttdb.go:385: Persisted Template error_tmplt
2023/09/15 10:55:05.494503 ttdb.go:366: Persisted Template error_tmplt.html
2023/09/15 10:55:05.559877 ttdb.go:379: Persisting Template dsuback_tmplt
2023/09/15 10:55:05.625488 ttdb.go:385: Persisted Template dsuback_tmplt
2023/09/15 10:55:05.625558 ttdb.go:366: Persisted Template dsuback_tmplt.xml
2023/09/15 10:55:05.691509 ttdb.go:379: Persisting Template pixm_tmplt
2023/09/15 10:55:05.762038 ttdb.go:385: Persisted Template pixm_tmplt
2023/09/15 10:55:05.762136 ttdb.go:366: Persisted Template pixm_tmplt.html
2023/09/15 10:55:05.826919 ttdb.go:379: Persisting Template subscriptions2t_tmplt
2023/09/15 10:55:05.893573 ttdb.go:385: Persisted Template subscriptions2t_tmplt
2023/09/15 10:55:05.893727 ttdb.go:366: Persisted Template subscriptions2t_tmplt.html
2023/09/15 10:55:05.959027 ttdb.go:379: Persisting Template codemaps2t_tmplt
2023/09/15 10:55:06.030395 ttdb.go:385: Persisted Template codemaps2t_tmplt
2023/09/15 10:55:06.030543 ttdb.go:366: Persisted Template codemaps2t_tmplt.html
2023/09/15 10:55:06.096483 ttdb.go:379: Persisting Template mhdpublish_tmplt
2023/09/15 10:55:06.168594 ttdb.go:385: Persisted Template mhdpublish_tmplt
2023/09/15 10:55:06.168752 ttdb.go:366: Persisted Template mhdpublish_tmplt.json
2023/09/15 10:55:06.238219 ttdb.go:379: Persisting Template events_tmplt
2023/09/15 10:55:06.307927 ttdb.go:385: Persisted Template events_tmplt
2023/09/15 10:55:06.308067 ttdb.go:366: Persisted Template events_tmplt.html
2023/09/15 10:55:06.375375 ttdb.go:379: Persisting Template uploadfile2t_tmplt
2023/09/15 10:55:06.441752 ttdb.go:385: Persisted Template uploadfile2t_tmplt
2023/09/15 10:55:06.441899 ttdb.go:366: Persisted Template uploadfile2t_tmplt.html
2023/09/15 10:55:06.442173 ttserver.go:40: Starting ICB Workflow Service. Service Endpoint http://MacBook-Pro-3.lan:8080/
2023/09/15 10:55:10.178715 ttgethandler.go:10: Processing new GET Request
2023/09/15 10:55:10.178908 ttproxy.go:138: 	Request Query Params
2023/09/15 10:55:10.179437 ttutil.go:140: 	{
  "User": "ian.thomas",
  "Org": "2tsolutions",
  "Role": "clinical",
  "Nhs": "9000000009"
}
2023/09/15 10:55:10.179498 ttgethandler.go:15: Path = /beta/spa/consumer/patient
2023/09/15 10:55:10.179578 tttmplts.go:37: CGL Worker starting
2023/09/15 10:55:10.179587 tttmplts.go:30: PIXm Worker starting
2023/09/15 10:55:10.180720 tthttp.go:15: Creating PIXm PDQ - Server URL http://lac-demo-01.tianispirit.co.uk:8081/SpiritPIXFhir/r4/Patient?identifier=2.16.840.1.113883.2.1.4.1%7C9000000009
2023/09/15 10:55:10.183864 tthttp.go:160: Request Headers 
map[Content-Type:[application/json]]
2023/09/15 10:55:10.183893 tthttp.go:160: Request Headers 
map[Accept:[application/json] X-Api-Key:[FNhb#OhxWiEiMdf+@6085k5Zmt] X-Api-Secret:[9710ea0fb4ffb5d56c2e62c71c30bdfhjsyr56a79d]]
2023/09/15 10:55:10.377545 tthttp.go:174: Server Response - Status Code 404 
{"errors":[{"message":"No clients matching nhs number 9000000009","path":"\/"}],"status":404}
2023/09/15 10:55:10.381042 ttutil.go:140: 	{
  "data": {
    "client": {
      "basicDetails": {
        "address": {},
        "name": {}
      },
      "bbvInformation": {},
      "drugTestResults": {
        "results": {}
      },
      "riskInformation": {
        "mentalHealthDomain": {},
        "riskOfHarmToSelfDomain": {},
        "socialDomain": {},
        "substanceMisuseDomain": {}
      },
      "safeguardingInformation": {}
    },
    "keyWorker": {
      "name": {}
    }
  }
}
2023/09/15 10:55:10.381198 tttmplts.go:39: CGL Worker done
2023/09/15 10:55:10.381229 tttmplts.go:40: CGL Worker Status Code 404
2023/09/15 10:55:15.181572 tthttp.go:174: Server Response - Status Code 0 
2023/09/15 10:55:15.182367 tttmplts.go:32: PIXm Worker done
2023/09/15 10:55:15.182479 tttmplts.go:33: PIXm Worker Status Code 408
2023/09/15 10:55:15.182853 tthttp.go:56: Creating PDS Search Request - Server URL https://sandbox.api.service.nhs.uk/personal-demographics/FHIR/R4/Patient/9000000009
2023/09/15 10:55:15.183044 tthttp.go:160: Request Headers 
map[Accept:[*/*] Content-Type:[application/json] X-Request-Id:[15f756d9-1e80-4749-8200-0e7b439b1bd9]]
2023/09/15 10:55:15.540442 tthttp.go:174: Server Response - Status Code 200 
{"resourceType":"Patient","id":"9000000009","identifier":[{"system":"https://fhir.nhs.uk/Id/nhs-number","value":"9000000009","extension":[{"url":"https://fhir.hl7.org.uk/StructureDefinition/Extension-UKCore-NHSNumberVerificationStatus","valueCodeableConcept":{"coding":[{"system":"https://fhir.hl7.org.uk/CodeSystem/UKCore-NHSNumberVerificationStatus","version":"1.0.0","code":"01","display":"Number present and verified"}]}}]}],"meta":{"versionId":"2","security":[{"system":"http://terminology.hl7.org/CodeSystem/v3-Confidentiality","code":"U","display":"unrestricted"}]},"name":[{"id":"123","use":"usual","period":{"start":"2020-01-01","end":"2021-12-31"},"given":["Jane"],"family":"Smith","prefix":["Mrs"],"suffix":["MBE"]}],"gender":"female","birthDate":"2010-10-22","multipleBirthInteger":1,"deceasedDateTime":"2010-10-22T00:00:00+00:00","generalPractitioner":[{"id":"254406A3","type":"Organization","identifier":{"system":"https://fhir.nhs.uk/Id/ods-organization-code","value":"Y12345","period":{"start":"2020-01-01","end":"2021-12-31"}}}],"managingOrganization":{"type":"Organization","identifier":{"system":"https://fhir.nhs.uk/Id/ods-organization-code","value":"Y12345","period":{"start":"2020-01-01","end":"2021-12-31"}}},"extension":[{"url":"https://fhir.hl7.org.uk/StructureDefinition/Extension-UKCore-NominatedPharmacy","valueReference":{"identifier":{"system":"https://fhir.nhs.uk/Id/ods-organization-code","value":"Y12345"}}},{"url":"https://fhir.hl7.org.uk/StructureDefinition/Extension-UKCore-PreferredDispenserOrganization","valueReference":{"identifier":{"system":"https://fhir.nhs.uk/Id/ods-organization-code","value":"Y23456"}}},{"url":"https://fhir.hl7.org.uk/StructureDefinition/Extension-UKCore-MedicalApplianceSupplier","valueReference":{"identifier":{"system":"https://fhir.nhs.uk/Id/ods-organization-code","value":"Y34567"}}},{"url":"https://fhir.hl7.org.uk/StructureDefinition/Extension-UKCore-DeathNotificationStatus","extension":[{"url":"deathNotificationStatus","valueCodeableConcept":{"coding":[{"system":"https://fhir.hl7.org.uk/CodeSystem/UKCore-DeathNotificationStatus","version":"1.0.0","code":"2","display":"Formal - death notice received from Registrar of Deaths"}]}},{"url":"systemEffectiveDate","valueDateTime":"2010-10-22T00:00:00+00:00"}]},{"url":"https://fhir.hl7.org.uk/StructureDefinition/Extension-UKCore-NHSCommunication","extension":[{"url":"language","valueCodeableConcept":{"coding":[{"system":"https://fhir.hl7.org.uk/CodeSystem/UKCore-HumanLanguage","version":"1.0.0","code":"fr","display":"French"}]}},{"url":"interpreterRequired","valueBoolean":true}]},{"url":"https://fhir.hl7.org.uk/StructureDefinition/Extension-UKCore-ContactPreference","extension":[{"url":"PreferredWrittenCommunicationFormat","valueCodeableConcept":{"coding":[{"system":"https://fhir.hl7.org.uk/CodeSystem/UKCore-PreferredWrittenCommunicationFormat","code":"12","display":"Braille"}]}},{"url":"PreferredContactMethod","valueCodeableConcept":{"coding":[{"system":"https://fhir.hl7.org.uk/CodeSystem/UKCore-PreferredContactMethod","code":"1","display":"Letter"}]}},{"url":"PreferredContactTimes","valueString":"Not after 7pm"}]},{"url":"http://hl7.org/fhir/StructureDefinition/patient-birthPlace","valueAddress":{"city":"Manchester","district":"Greater Manchester","country":"GBR"}},{"url":"https://fhir.nhs.uk/StructureDefinition/Extension-PDS-RemovalFromRegistration","extension":[{"url":"removalFromRegistrationCode","valueCodeableConcept":{"coding":[{"system":"https://fhir.nhs.uk/CodeSystem/PDS-RemovalReasonExitCode","code":"SCT","display":"Transferred to Scotland"}]}},{"url":"effectiveTime","valuePeriod":{"start":"2020-01-01T00:00:00+00:00","end":"2021-12-31T00:00:00+00:00"}}]}],"telecom":[{"id":"789","period":{"start":"2020-01-01","end":"2021-12-31"},"system":"phone","value":"01632960587","use":"home"},{"id":"790","period":{"start":"2019-01-01","end":"2022-12-31"},"system":"email","value":"jane.smith@example.com","use":"home"},{"id":"OC789","period":{"start":"2020-01-01","end":"2021-12-31"},"system":"other","value":"01632960587","use":"home","extension":[{"url":"https://fhir.hl7.org.uk/StructureDefinition/Extension-UKCore-OtherContactSystem","valueCoding":{"system":"https://fhir.hl7.org.uk/CodeSystem/UKCore-OtherContactSystem","code":"textphone","display":"Minicom (Textphone)"}}]}],"contact":[{"id":"C123","period":{"start":"2020-01-01","end":"2021-12-31"},"relationship":[{"coding":[{"system":"http://terminology.hl7.org/CodeSystem/v2-0131","code":"C","display":"Emergency Contact"}]}],"telecom":[{"system":"phone","value":"01632960587"}]}],"address":[{"id":"456","period":{"start":"2020-01-01","end":"2021-12-31"},"use":"home","line":["1 Trevelyan Square","Boar Lane","City Centre","Leeds","West Yorkshire"],"postalCode":"LS1 6AE","extension":[{"url":"https://fhir.hl7.org.uk/StructureDefinition/Extension-UKCore-AddressKey","extension":[{"url":"type","valueCoding":{"system":"https://fhir.hl7.org.uk/CodeSystem/UKCore-AddressKeyType","code":"PAF"}},{"url":"value","valueString":"12345678"}]},{"url":"https://fhir.hl7.org.uk/StructureDefinition/Extension-UKCore-AddressKey","extension":[{"url":"type","valueCoding":{"system":"https://fhir.hl7.org.uk/CodeSystem/UKCore-AddressKeyType","code":"UPRN"}},{"url":"value","valueString":"123456789012"}]}]},{"id":"T456","period":{"start":"2020-01-01","end":"2021-12-31"},"use":"temp","text":"Student Accommodation","line":["1 Trevelyan Square","Boar Lane","City Centre","Leeds","West Yorkshire"],"postalCode":"LS1 6AE","extension":[{"url":"https://fhir.hl7.org.uk/StructureDefinition/Extension-UKCore-AddressKey","extension":[{"url":"type","valueCoding":{"system":"https://fhir.hl7.org.uk/CodeSystem/UKCore-AddressKeyType","code":"PAF"}},{"url":"value","valueString":"12345678"}]},{"url":"https://fhir.hl7.org.uk/StructureDefinition/Extension-UKCore-AddressKey","extension":[{"url":"type","valueCoding":{"system":"https://fhir.hl7.org.uk/CodeSystem/UKCore-AddressKeyType","code":"UPRN"}},{"url":"value","valueString":"123456789012"}]}]}]}
2023/09/15 10:55:16.257850 tttmplts.go:100: Caching 24 Templates
2023/09/15 10:55:16.265849 tttmplts.go:87: Processing Template allpatientSrvs_tmplt
2023/09/15 10:55:16.269021 ttproxy.go:149: Response Status Code 200
2023/09/15 10:58:39.810674 ttserver.go:52: ICB Workflow Service stopped
2023/09/15 10:58:41.805191 ttutil.go:133: -----------------------------------------------------------------------------------
2023/09/15 10:58:41.805700 ttdb.go:51: Opening DB Connection to mysql instance
User: root
Host: tuk.coil1nnpqdlr.eu-west-1.rds.amazonaws.com
Port: :3306
Name: tuk
Connect Timeout 2s
Read Timeout 5s
2023/09/15 10:58:41.805834 ttdb.go:54: Opened Database
2023/09/15 10:58:41.995233 ttdb.go:379: Persisting Template dsubcancel_tmplt
2023/09/15 10:58:42.060781 ttdb.go:385: Persisted Template dsubcancel_tmplt
2023/09/15 10:58:42.060899 ttdb.go:366: Persisted Template dsubcancel_tmplt.xml
2023/09/15 10:58:42.126292 ttdb.go:379: Persisting Template cgl_tmplt
2023/09/15 10:58:42.227408 ttdb.go:385: Persisted Template cgl_tmplt
2023/09/15 10:58:42.227443 ttdb.go:366: Persisted Template cgl_tmplt.html
2023/09/15 10:58:42.292912 ttdb.go:379: Persisting Template pdssearch_tmplt
2023/09/15 10:58:42.363547 ttdb.go:385: Persisted Template pdssearch_tmplt
2023/09/15 10:58:42.363714 ttdb.go:366: Persisted Template pdssearch_tmplt.html
2023/09/15 10:58:42.430236 ttdb.go:379: Persisting Template dsubsubscribe_tmplt
2023/09/15 10:58:42.498202 ttdb.go:385: Persisted Template dsubsubscribe_tmplt
2023/09/15 10:58:42.498261 ttdb.go:366: Persisted Template dsubsubscribe_tmplt.xml
2023/09/15 10:58:42.564596 ttdb.go:379: Persisting Template notification_tmplt
2023/09/15 10:58:42.631901 ttdb.go:385: Persisted Template notification_tmplt
2023/09/15 10:58:42.632090 ttdb.go:366: Persisted Template notification_tmplt.txt
2023/09/15 10:58:42.703670 ttdb.go:379: Persisting Template wfstate2t_tmplt
2023/09/15 10:58:42.825066 ttdb.go:385: Persisted Template wfstate2t_tmplt
2023/09/15 10:58:42.825225 ttdb.go:366: Persisted Template wfstate2t_tmplt.html
2023/09/15 10:58:42.891998 ttdb.go:379: Persisting Template publishfile2t_tmplt
2023/09/15 10:58:42.959277 ttdb.go:385: Persisted Template publishfile2t_tmplt
2023/09/15 10:58:42.959369 ttdb.go:366: Persisted Template publishfile2t_tmplt.html
2023/09/15 10:58:43.026856 ttdb.go:379: Persisting Template react_tmplt
2023/09/15 10:58:43.094408 ttdb.go:385: Persisted Template react_tmplt
2023/09/15 10:58:43.094558 ttdb.go:366: Persisted Template react_tmplt.html
2023/09/15 10:58:43.159618 ttdb.go:379: Persisting Template pdsretrieve_tmplt
2023/09/15 10:58:43.227064 ttdb.go:385: Persisted Template pdsretrieve_tmplt
2023/09/15 10:58:43.227093 ttdb.go:366: Persisted Template pdsretrieve_tmplt.html
2023/09/15 10:58:43.292597 ttdb.go:379: Persisting Template allpatientSrvs_tmplt
2023/09/15 10:58:43.358616 ttdb.go:385: Persisted Template allpatientSrvs_tmplt
2023/09/15 10:58:43.358637 ttdb.go:366: Persisted Template allpatientSrvs_tmplt.html
2023/09/15 10:58:43.426096 ttdb.go:379: Persisting Template spa2t_tmplt
2023/09/15 10:58:43.504747 ttdb.go:385: Persisted Template spa2t_tmplt
2023/09/15 10:58:43.504797 ttdb.go:366: Persisted Template spa2t_tmplt.html
2023/09/15 10:58:43.572629 ttdb.go:379: Persisting Template xdw2t_tmplt
2023/09/15 10:58:43.652909 ttdb.go:385: Persisted Template xdw2t_tmplt
2023/09/15 10:58:43.652937 ttdb.go:366: Persisted Template xdw2t_tmplt.html
2023/09/15 10:58:43.718503 ttdb.go:379: Persisting Template spaheader2t_tmplt
2023/09/15 10:58:43.787673 ttdb.go:385: Persisted Template spaheader2t_tmplt
2023/09/15 10:58:43.787838 ttdb.go:366: Persisted Template spaheader2t_tmplt.html
2023/09/15 10:58:43.853147 ttdb.go:379: Persisting Template pds_tmplt
2023/09/15 10:58:43.920255 ttdb.go:385: Persisted Template pds_tmplt
2023/09/15 10:58:43.920412 ttdb.go:366: Persisted Template pds_tmplt.html
2023/09/15 10:58:43.986335 ttdb.go:379: Persisting Template error_tmplt
2023/09/15 10:58:44.053050 ttdb.go:385: Persisted Template error_tmplt
2023/09/15 10:58:44.053213 ttdb.go:366: Persisted Template error_tmplt.html
2023/09/15 10:58:44.120684 ttdb.go:379: Persisting Template dsuback_tmplt
2023/09/15 10:58:44.185906 ttdb.go:385: Persisted Template dsuback_tmplt
2023/09/15 10:58:44.186044 ttdb.go:366: Persisted Template dsuback_tmplt.xml
2023/09/15 10:58:44.251824 ttdb.go:379: Persisting Template pixm_tmplt
2023/09/15 10:58:44.332047 ttdb.go:385: Persisted Template pixm_tmplt
2023/09/15 10:58:44.332213 ttdb.go:366: Persisted Template pixm_tmplt.html
2023/09/15 10:58:44.398392 ttdb.go:379: Persisting Template subscriptions2t_tmplt
2023/09/15 10:58:44.466669 ttdb.go:385: Persisted Template subscriptions2t_tmplt
2023/09/15 10:58:44.466795 ttdb.go:366: Persisted Template subscriptions2t_tmplt.html
2023/09/15 10:58:44.534290 ttdb.go:379: Persisting Template codemaps2t_tmplt
2023/09/15 10:58:44.603379 ttdb.go:385: Persisted Template codemaps2t_tmplt
2023/09/15 10:58:44.603525 ttdb.go:366: Persisted Template codemaps2t_tmplt.html
2023/09/15 10:58:44.670746 ttdb.go:379: Persisting Template mhdpublish_tmplt
2023/09/15 10:58:44.742946 ttdb.go:385: Persisted Template mhdpublish_tmplt
2023/09/15 10:58:44.743108 ttdb.go:366: Persisted Template mhdpublish_tmplt.json
2023/09/15 10:58:44.809224 ttdb.go:379: Persisting Template events_tmplt
2023/09/15 10:58:44.880849 ttdb.go:385: Persisted Template events_tmplt
2023/09/15 10:58:44.881040 ttdb.go:366: Persisted Template events_tmplt.html
2023/09/15 10:58:44.948883 ttdb.go:379: Persisting Template uploadfile2t_tmplt
2023/09/15 10:58:45.016047 ttdb.go:385: Persisted Template uploadfile2t_tmplt
2023/09/15 10:58:45.016195 ttdb.go:366: Persisted Template uploadfile2t_tmplt.html
2023/09/15 10:58:45.016492 ttserver.go:40: Starting ICB Workflow Service. Service Endpoint http://MacBook-Pro-3.lan:8080/
2023/09/15 10:58:48.751869 ttgethandler.go:10: Processing new GET Request
2023/09/15 10:58:48.752050 ttproxy.go:138: 	Request Query Params
2023/09/15 10:58:48.752403 ttutil.go:140: 	{
  "User": "ian.thomas",
  "Org": "2tsolutions",
  "Role": "clinical",
  "Nhs": "9000000009"
}
2023/09/15 10:58:48.752452 ttgethandler.go:15: Path = /beta/spa/consumer/patient
2023/09/15 10:58:48.752499 tttmplts.go:37: CGL Worker starting
2023/09/15 10:58:48.752497 tttmplts.go:30: PIXm Worker starting
2023/09/15 10:58:48.752850 tthttp.go:15: Creating PIXm PDQ - Server URL http://lac-demo-01.tianispirit.co.uk:8081/SpiritPIXFhir/r4/Patient?identifier=2.16.840.1.113883.2.1.4.1%7C9000000009
2023/09/15 10:58:48.754405 tthttp.go:160: Request Headers 
map[Content-Type:[application/json]]
2023/09/15 10:58:48.754423 tthttp.go:160: Request Headers 
map[Accept:[application/json] X-Api-Key:[FNhb#OhxWiEiMdf+@6085k5Zmt] X-Api-Secret:[9710ea0fb4ffb5d56c2e62c71c30bdfhjsyr56a79d]]
2023/09/15 10:58:49.181039 tthttp.go:174: Server Response - Status Code 404 
{"errors":[{"message":"No clients matching nhs number 9000000009","path":"\/"}],"status":404}
2023/09/15 10:58:49.186300 ttutil.go:140: 	{
  "data": {
    "client": {
      "basicDetails": {
        "address": {},
        "name": {}
      },
      "bbvInformation": {},
      "drugTestResults": {
        "results": {}
      },
      "riskInformation": {
        "mentalHealthDomain": {},
        "riskOfHarmToSelfDomain": {},
        "socialDomain": {},
        "substanceMisuseDomain": {}
      },
      "safeguardingInformation": {}
    },
    "keyWorker": {
      "name": {}
    }
  }
}
2023/09/15 10:58:49.186446 tttmplts.go:39: CGL Worker done
2023/09/15 10:58:49.186492 tttmplts.go:40: CGL Worker Status Code 404
2023/09/15 10:58:53.755458 tthttp.go:174: Server Response - Status Code 0 
2023/09/15 10:58:53.755954 tttmplts.go:32: PIXm Worker done
2023/09/15 10:58:53.756034 tttmplts.go:33: PIXm Worker Status Code 408
2023/09/15 10:58:53.756382 tthttp.go:56: Creating PDS Search Request - Server URL https://sandbox.api.service.nhs.uk/personal-demographics/FHIR/R4/Patient/9000000009
2023/09/15 10:58:53.756648 tthttp.go:160: Request Headers 
map[Accept:[*/*] Content-Type:[application/json] X-Request-Id:[3b8739cc-270a-4a13-bd24-2558c4c2aafa]]
2023/09/15 10:58:53.911796 tthttp.go:174: Server Response - Status Code 200 
{"resourceType":"Patient","id":"9000000009","identifier":[{"system":"https://fhir.nhs.uk/Id/nhs-number","value":"9000000009","extension":[{"url":"https://fhir.hl7.org.uk/StructureDefinition/Extension-UKCore-NHSNumberVerificationStatus","valueCodeableConcept":{"coding":[{"system":"https://fhir.hl7.org.uk/CodeSystem/UKCore-NHSNumberVerificationStatus","version":"1.0.0","code":"01","display":"Number present and verified"}]}}]}],"meta":{"versionId":"2","security":[{"system":"http://terminology.hl7.org/CodeSystem/v3-Confidentiality","code":"U","display":"unrestricted"}]},"name":[{"id":"123","use":"usual","period":{"start":"2020-01-01","end":"2021-12-31"},"given":["Jane"],"family":"Smith","prefix":["Mrs"],"suffix":["MBE"]}],"gender":"female","birthDate":"2010-10-22","multipleBirthInteger":1,"deceasedDateTime":"2010-10-22T00:00:00+00:00","generalPractitioner":[{"id":"254406A3","type":"Organization","identifier":{"system":"https://fhir.nhs.uk/Id/ods-organization-code","value":"Y12345","period":{"start":"2020-01-01","end":"2021-12-31"}}}],"managingOrganization":{"type":"Organization","identifier":{"system":"https://fhir.nhs.uk/Id/ods-organization-code","value":"Y12345","period":{"start":"2020-01-01","end":"2021-12-31"}}},"extension":[{"url":"https://fhir.hl7.org.uk/StructureDefinition/Extension-UKCore-NominatedPharmacy","valueReference":{"identifier":{"system":"https://fhir.nhs.uk/Id/ods-organization-code","value":"Y12345"}}},{"url":"https://fhir.hl7.org.uk/StructureDefinition/Extension-UKCore-PreferredDispenserOrganization","valueReference":{"identifier":{"system":"https://fhir.nhs.uk/Id/ods-organization-code","value":"Y23456"}}},{"url":"https://fhir.hl7.org.uk/StructureDefinition/Extension-UKCore-MedicalApplianceSupplier","valueReference":{"identifier":{"system":"https://fhir.nhs.uk/Id/ods-organization-code","value":"Y34567"}}},{"url":"https://fhir.hl7.org.uk/StructureDefinition/Extension-UKCore-DeathNotificationStatus","extension":[{"url":"deathNotificationStatus","valueCodeableConcept":{"coding":[{"system":"https://fhir.hl7.org.uk/CodeSystem/UKCore-DeathNotificationStatus","version":"1.0.0","code":"2","display":"Formal - death notice received from Registrar of Deaths"}]}},{"url":"systemEffectiveDate","valueDateTime":"2010-10-22T00:00:00+00:00"}]},{"url":"https://fhir.hl7.org.uk/StructureDefinition/Extension-UKCore-NHSCommunication","extension":[{"url":"language","valueCodeableConcept":{"coding":[{"system":"https://fhir.hl7.org.uk/CodeSystem/UKCore-HumanLanguage","version":"1.0.0","code":"fr","display":"French"}]}},{"url":"interpreterRequired","valueBoolean":true}]},{"url":"https://fhir.hl7.org.uk/StructureDefinition/Extension-UKCore-ContactPreference","extension":[{"url":"PreferredWrittenCommunicationFormat","valueCodeableConcept":{"coding":[{"system":"https://fhir.hl7.org.uk/CodeSystem/UKCore-PreferredWrittenCommunicationFormat","code":"12","display":"Braille"}]}},{"url":"PreferredContactMethod","valueCodeableConcept":{"coding":[{"system":"https://fhir.hl7.org.uk/CodeSystem/UKCore-PreferredContactMethod","code":"1","display":"Letter"}]}},{"url":"PreferredContactTimes","valueString":"Not after 7pm"}]},{"url":"http://hl7.org/fhir/StructureDefinition/patient-birthPlace","valueAddress":{"city":"Manchester","district":"Greater Manchester","country":"GBR"}},{"url":"https://fhir.nhs.uk/StructureDefinition/Extension-PDS-RemovalFromRegistration","extension":[{"url":"removalFromRegistrationCode","valueCodeableConcept":{"coding":[{"system":"https://fhir.nhs.uk/CodeSystem/PDS-RemovalReasonExitCode","code":"SCT","display":"Transferred to Scotland"}]}},{"url":"effectiveTime","valuePeriod":{"start":"2020-01-01T00:00:00+00:00","end":"2021-12-31T00:00:00+00:00"}}]}],"telecom":[{"id":"789","period":{"start":"2020-01-01","end":"2021-12-31"},"system":"phone","value":"01632960587","use":"home"},{"id":"790","period":{"start":"2019-01-01","end":"2022-12-31"},"system":"email","value":"jane.smith@example.com","use":"home"},{"id":"OC789","period":{"start":"2020-01-01","end":"2021-12-31"},"system":"other","value":"01632960587","use":"home","extension":[{"url":"https://fhir.hl7.org.uk/StructureDefinition/Extension-UKCore-OtherContactSystem","valueCoding":{"system":"https://fhir.hl7.org.uk/CodeSystem/UKCore-OtherContactSystem","code":"textphone","display":"Minicom (Textphone)"}}]}],"contact":[{"id":"C123","period":{"start":"2020-01-01","end":"2021-12-31"},"relationship":[{"coding":[{"system":"http://terminology.hl7.org/CodeSystem/v2-0131","code":"C","display":"Emergency Contact"}]}],"telecom":[{"system":"phone","value":"01632960587"}]}],"address":[{"id":"456","period":{"start":"2020-01-01","end":"2021-12-31"},"use":"home","line":["1 Trevelyan Square","Boar Lane","City Centre","Leeds","West Yorkshire"],"postalCode":"LS1 6AE","extension":[{"url":"https://fhir.hl7.org.uk/StructureDefinition/Extension-UKCore-AddressKey","extension":[{"url":"type","valueCoding":{"system":"https://fhir.hl7.org.uk/CodeSystem/UKCore-AddressKeyType","code":"PAF"}},{"url":"value","valueString":"12345678"}]},{"url":"https://fhir.hl7.org.uk/StructureDefinition/Extension-UKCore-AddressKey","extension":[{"url":"type","valueCoding":{"system":"https://fhir.hl7.org.uk/CodeSystem/UKCore-AddressKeyType","code":"UPRN"}},{"url":"value","valueString":"123456789012"}]}]},{"id":"T456","period":{"start":"2020-01-01","end":"2021-12-31"},"use":"temp","text":"Student Accommodation","line":["1 Trevelyan Square","Boar Lane","City Centre","Leeds","West Yorkshire"],"postalCode":"LS1 6AE","extension":[{"url":"https://fhir.hl7.org.uk/StructureDefinition/Extension-UKCore-AddressKey","extension":[{"url":"type","valueCoding":{"system":"https://fhir.hl7.org.uk/CodeSystem/UKCore-AddressKeyType","code":"PAF"}},{"url":"value","valueString":"12345678"}]},{"url":"https://fhir.hl7.org.uk/StructureDefinition/Extension-UKCore-AddressKey","extension":[{"url":"type","valueCoding":{"system":"https://fhir.hl7.org.uk/CodeSystem/UKCore-AddressKeyType","code":"UPRN"}},{"url":"value","valueString":"123456789012"}]}]}]}
2023/09/15 10:58:54.110116 tttmplts.go:100: Caching 24 Templates
2023/09/15 10:58:54.115303 tttmplts.go:87: Processing Template allpatientSrvs_tmplt
2023/09/15 10:58:54.118248 ttproxy.go:149: Response Status Code 200
2023/09/15 11:02:14.662875 ttserver.go:52: ICB Workflow Service stopped
