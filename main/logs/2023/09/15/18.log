2023/09/15 18:14:34.177849 ttutil.go:133: -----------------------------------------------------------------------------------
2023/09/15 18:14:34.178327 ttdb.go:51: Opening DB Connection to mysql instance
User: root
Host: tuk.coil1nnpqdlr.eu-west-1.rds.amazonaws.com
Port: :3306
Name: tuk
Connect Timeout 2s
Read Timeout 5s
2023/09/15 18:14:34.178454 ttdb.go:54: Opened Database
2023/09/15 18:14:34.361703 ttdb.go:379: Persisting Template dsubcancel_tmplt
2023/09/15 18:14:34.424160 ttdb.go:385: Persisted Template dsubcancel_tmplt
2023/09/15 18:14:34.424216 ttdb.go:366: Persisted Template dsubcancel_tmplt.xml
2023/09/15 18:14:34.486909 ttdb.go:379: Persisting Template cgl_tmplt
2023/09/15 18:14:34.581445 ttdb.go:385: Persisted Template cgl_tmplt
2023/09/15 18:14:34.581546 ttdb.go:366: Persisted Template cgl_tmplt.html
2023/09/15 18:14:34.644136 ttdb.go:379: Persisting Template pdssearch_tmplt
2023/09/15 18:14:34.712793 ttdb.go:385: Persisted Template pdssearch_tmplt
2023/09/15 18:14:34.712936 ttdb.go:366: Persisted Template pdssearch_tmplt.html
2023/09/15 18:14:34.841358 ttdb.go:379: Persisting Template dsubsubscribe_tmplt
2023/09/15 18:14:34.992809 ttdb.go:385: Persisted Template dsubsubscribe_tmplt
2023/09/15 18:14:34.992864 ttdb.go:366: Persisted Template dsubsubscribe_tmplt.xml
2023/09/15 18:14:35.082434 ttdb.go:379: Persisting Template notification_tmplt
2023/09/15 18:14:35.148362 ttdb.go:385: Persisted Template notification_tmplt
2023/09/15 18:14:35.148427 ttdb.go:366: Persisted Template notification_tmplt.txt
2023/09/15 18:14:35.211877 ttdb.go:379: Persisting Template wfstate2t_tmplt
2023/09/15 18:14:35.328944 ttdb.go:385: Persisted Template wfstate2t_tmplt
2023/09/15 18:14:35.329025 ttdb.go:366: Persisted Template wfstate2t_tmplt.html
2023/09/15 18:14:35.392166 ttdb.go:379: Persisting Template publishfile2t_tmplt
2023/09/15 18:14:35.455815 ttdb.go:385: Persisted Template publishfile2t_tmplt
2023/09/15 18:14:35.455882 ttdb.go:366: Persisted Template publishfile2t_tmplt.html
2023/09/15 18:14:35.519937 ttdb.go:379: Persisting Template react_tmplt
2023/09/15 18:14:35.582144 ttdb.go:385: Persisted Template react_tmplt
2023/09/15 18:14:35.582272 ttdb.go:366: Persisted Template react_tmplt.html
2023/09/15 18:14:35.644889 ttdb.go:379: Persisting Template pdsretrieve_tmplt
2023/09/15 18:14:35.715761 ttdb.go:385: Persisted Template pdsretrieve_tmplt
2023/09/15 18:14:35.715888 ttdb.go:366: Persisted Template pdsretrieve_tmplt.html
2023/09/15 18:14:35.779880 ttdb.go:379: Persisting Template allpatientSrvs_tmplt
2023/09/15 18:14:35.844142 ttdb.go:385: Persisted Template allpatientSrvs_tmplt
2023/09/15 18:14:35.844307 ttdb.go:366: Persisted Template allpatientSrvs_tmplt.html
2023/09/15 18:14:35.907599 ttdb.go:379: Persisting Template spa2t_tmplt
2023/09/15 18:14:35.982863 ttdb.go:385: Persisted Template spa2t_tmplt
2023/09/15 18:14:35.982900 ttdb.go:366: Persisted Template spa2t_tmplt.html
2023/09/15 18:14:36.046239 ttdb.go:379: Persisting Template xdw2t_tmplt
2023/09/15 18:14:36.122291 ttdb.go:385: Persisted Template xdw2t_tmplt
2023/09/15 18:14:36.122341 ttdb.go:366: Persisted Template xdw2t_tmplt.html
2023/09/15 18:14:36.183818 ttdb.go:379: Persisting Template spaheader2t_tmplt
2023/09/15 18:14:36.258147 ttdb.go:385: Persisted Template spaheader2t_tmplt
2023/09/15 18:14:36.258268 ttdb.go:366: Persisted Template spaheader2t_tmplt.html
2023/09/15 18:14:36.321589 ttdb.go:379: Persisting Template pds_tmplt
2023/09/15 18:14:36.387119 ttdb.go:385: Persisted Template pds_tmplt
2023/09/15 18:14:36.387219 ttdb.go:366: Persisted Template pds_tmplt.html
2023/09/15 18:14:36.451225 ttdb.go:379: Persisting Template error_tmplt
2023/09/15 18:14:36.513487 ttdb.go:385: Persisted Template error_tmplt
2023/09/15 18:14:36.513701 ttdb.go:366: Persisted Template error_tmplt.html
2023/09/15 18:14:36.577711 ttdb.go:379: Persisting Template dsuback_tmplt
2023/09/15 18:14:36.640168 ttdb.go:385: Persisted Template dsuback_tmplt
2023/09/15 18:14:36.640326 ttdb.go:366: Persisted Template dsuback_tmplt.xml
2023/09/15 18:14:36.702438 ttdb.go:379: Persisting Template pixm_tmplt
2023/09/15 18:14:36.770645 ttdb.go:385: Persisted Template pixm_tmplt
2023/09/15 18:14:36.771082 ttdb.go:366: Persisted Template pixm_tmplt.html
2023/09/15 18:14:36.833527 ttdb.go:379: Persisting Template subscriptions2t_tmplt
2023/09/15 18:14:36.898721 ttdb.go:385: Persisted Template subscriptions2t_tmplt
2023/09/15 18:14:36.898867 ttdb.go:366: Persisted Template subscriptions2t_tmplt.html
2023/09/15 18:14:36.961734 ttdb.go:379: Persisting Template codemaps2t_tmplt
2023/09/15 18:14:37.038902 ttdb.go:385: Persisted Template codemaps2t_tmplt
2023/09/15 18:14:37.039034 ttdb.go:366: Persisted Template codemaps2t_tmplt.html
2023/09/15 18:14:37.100890 ttdb.go:379: Persisting Template mhdpublish_tmplt
2023/09/15 18:14:37.168469 ttdb.go:385: Persisted Template mhdpublish_tmplt
2023/09/15 18:14:37.168636 ttdb.go:366: Persisted Template mhdpublish_tmplt.json
2023/09/15 18:14:37.231896 ttdb.go:379: Persisting Template events_tmplt
2023/09/15 18:14:37.298645 ttdb.go:385: Persisted Template events_tmplt
2023/09/15 18:14:37.298854 ttdb.go:366: Persisted Template events_tmplt.html
2023/09/15 18:14:37.365923 ttdb.go:379: Persisting Template uploadfile2t_tmplt
2023/09/15 18:14:37.436177 ttdb.go:385: Persisted Template uploadfile2t_tmplt
2023/09/15 18:14:37.436248 ttdb.go:366: Persisted Template uploadfile2t_tmplt.html
2023/09/15 18:14:37.436406 ttserver.go:40: Starting ICB Workflow Service. Service Endpoint http://MacBook-Pro-3.lan:8080/
2023/09/15 18:14:40.330559 ttgethandler.go:10: Processing new GET Request
2023/09/15 18:14:40.330740 ttproxy.go:138: 	Request Query Params
2023/09/15 18:14:40.331115 ttutil.go:140: 	{
  "User": "ian.thomas",
  "Org": "2tsolutions",
  "Role": "clinical",
  "Nhs": "9000000009"
}
2023/09/15 18:14:40.331151 ttgethandler.go:15: Path = /beta/spa/consumer/patient
2023/09/15 18:14:40.331189 tttmplts.go:37: CGL Worker starting
2023/09/15 18:14:40.331197 tttmplts.go:30: PIXm Worker starting
2023/09/15 18:14:40.331356 tthttp.go:15: Creating PIXm PDQ - Server URL http://lac-demo-01.tianispirit.co.uk:8081/SpiritPIXFhir/r4/Patient?identifier=2.16.840.1.113883.2.1.4.1%7C9000000009
2023/09/15 18:14:40.333203 tthttp.go:160: Request Headers 
map[Accept:[application/json] X-Api-Key:[FNhb#OhxWiEiMdf+@6085k5Zmt] X-Api-Secret:[9710ea0fb4ffb5d56c2e62c71c30bdfhjsyr56a79d]]
2023/09/15 18:14:40.333231 tthttp.go:160: Request Headers 
map[Content-Type:[application/json]]
2023/09/15 18:14:40.545601 tthttp.go:174: Server Response - Status Code 404 
{"errors":[{"message":"No clients matching nhs number 9000000009","path":"\/"}],"status":404}
2023/09/15 18:14:40.550199 ttutil.go:140: 	{
  "data": {
    "client": {
      "basicDetails": {
        "address": {},
        "name": {}
      },
      "bbvInformation": {},
      "drugTestResults": {
        "results": {}
      },
      "riskInformation": {
        "mentalHealthDomain": {},
        "riskOfHarmToSelfDomain": {},
        "socialDomain": {},
        "substanceMisuseDomain": {}
      },
      "safeguardingInformation": {}
    },
    "keyWorker": {
      "name": {}
    }
  }
}
2023/09/15 18:14:40.550320 tttmplts.go:39: CGL Worker done
2023/09/15 18:14:40.550355 tttmplts.go:40: CGL Worker Status Code 404
2023/09/15 18:14:45.332879 tthttp.go:174: Server Response - Status Code 0 
2023/09/15 18:14:45.333454 tttmplts.go:32: PIXm Worker done
2023/09/15 18:14:45.333504 tttmplts.go:33: PIXm Worker Status Code 408
2023/09/15 18:14:45.333652 tthttp.go:56: Creating PDS Search Request - Server URL https://sandbox.api.service.nhs.uk/personal-demographics/FHIR/R4/Patient/9000000009
2023/09/15 18:14:45.333769 tthttp.go:160: Request Headers 
map[Accept:[*/*] Content-Type:[application/json] X-Request-Id:[ade0096c-4513-4578-9893-afcd2a33fd3e]]
2023/09/15 18:14:45.496743 tthttp.go:174: Server Response - Status Code 200 
{"resourceType":"Patient","id":"9000000009","identifier":[{"system":"https://fhir.nhs.uk/Id/nhs-number","value":"9000000009","extension":[{"url":"https://fhir.hl7.org.uk/StructureDefinition/Extension-UKCore-NHSNumberVerificationStatus","valueCodeableConcept":{"coding":[{"system":"https://fhir.hl7.org.uk/CodeSystem/UKCore-NHSNumberVerificationStatus","version":"1.0.0","code":"01","display":"Number present and verified"}]}}]}],"meta":{"versionId":"2","security":[{"system":"http://terminology.hl7.org/CodeSystem/v3-Confidentiality","code":"U","display":"unrestricted"}]},"name":[{"id":"123","use":"usual","period":{"start":"2020-01-01","end":"2021-12-31"},"given":["Jane"],"family":"Smith","prefix":["Mrs"],"suffix":["MBE"]}],"gender":"female","birthDate":"2010-10-22","multipleBirthInteger":1,"deceasedDateTime":"2010-10-22T00:00:00+00:00","generalPractitioner":[{"id":"254406A3","type":"Organization","identifier":{"system":"https://fhir.nhs.uk/Id/ods-organization-code","value":"Y12345","period":{"start":"2020-01-01","end":"2021-12-31"}}}],"managingOrganization":{"type":"Organization","identifier":{"system":"https://fhir.nhs.uk/Id/ods-organization-code","value":"Y12345","period":{"start":"2020-01-01","end":"2021-12-31"}}},"extension":[{"url":"https://fhir.hl7.org.uk/StructureDefinition/Extension-UKCore-NominatedPharmacy","valueReference":{"identifier":{"system":"https://fhir.nhs.uk/Id/ods-organization-code","value":"Y12345"}}},{"url":"https://fhir.hl7.org.uk/StructureDefinition/Extension-UKCore-PreferredDispenserOrganization","valueReference":{"identifier":{"system":"https://fhir.nhs.uk/Id/ods-organization-code","value":"Y23456"}}},{"url":"https://fhir.hl7.org.uk/StructureDefinition/Extension-UKCore-MedicalApplianceSupplier","valueReference":{"identifier":{"system":"https://fhir.nhs.uk/Id/ods-organization-code","value":"Y34567"}}},{"url":"https://fhir.hl7.org.uk/StructureDefinition/Extension-UKCore-DeathNotificationStatus","extension":[{"url":"deathNotificationStatus","valueCodeableConcept":{"coding":[{"system":"https://fhir.hl7.org.uk/CodeSystem/UKCore-DeathNotificationStatus","version":"1.0.0","code":"2","display":"Formal - death notice received from Registrar of Deaths"}]}},{"url":"systemEffectiveDate","valueDateTime":"2010-10-22T00:00:00+00:00"}]},{"url":"https://fhir.hl7.org.uk/StructureDefinition/Extension-UKCore-NHSCommunication","extension":[{"url":"language","valueCodeableConcept":{"coding":[{"system":"https://fhir.hl7.org.uk/CodeSystem/UKCore-HumanLanguage","version":"1.0.0","code":"fr","display":"French"}]}},{"url":"interpreterRequired","valueBoolean":true}]},{"url":"https://fhir.hl7.org.uk/StructureDefinition/Extension-UKCore-ContactPreference","extension":[{"url":"PreferredWrittenCommunicationFormat","valueCodeableConcept":{"coding":[{"system":"https://fhir.hl7.org.uk/CodeSystem/UKCore-PreferredWrittenCommunicationFormat","code":"12","display":"Braille"}]}},{"url":"PreferredContactMethod","valueCodeableConcept":{"coding":[{"system":"https://fhir.hl7.org.uk/CodeSystem/UKCore-PreferredContactMethod","code":"1","display":"Letter"}]}},{"url":"PreferredContactTimes","valueString":"Not after 7pm"}]},{"url":"http://hl7.org/fhir/StructureDefinition/patient-birthPlace","valueAddress":{"city":"Manchester","district":"Greater Manchester","country":"GBR"}},{"url":"https://fhir.nhs.uk/StructureDefinition/Extension-PDS-RemovalFromRegistration","extension":[{"url":"removalFromRegistrationCode","valueCodeableConcept":{"coding":[{"system":"https://fhir.nhs.uk/CodeSystem/PDS-RemovalReasonExitCode","code":"SCT","display":"Transferred to Scotland"}]}},{"url":"effectiveTime","valuePeriod":{"start":"2020-01-01T00:00:00+00:00","end":"2021-12-31T00:00:00+00:00"}}]}],"telecom":[{"id":"789","period":{"start":"2020-01-01","end":"2021-12-31"},"system":"phone","value":"01632960587","use":"home"},{"id":"790","period":{"start":"2019-01-01","end":"2022-12-31"},"system":"email","value":"jane.smith@example.com","use":"home"},{"id":"OC789","period":{"start":"2020-01-01","end":"2021-12-31"},"system":"other","value":"01632960587","use":"home","extension":[{"url":"https://fhir.hl7.org.uk/StructureDefinition/Extension-UKCore-OtherContactSystem","valueCoding":{"system":"https://fhir.hl7.org.uk/CodeSystem/UKCore-OtherContactSystem","code":"textphone","display":"Minicom (Textphone)"}}]}],"contact":[{"id":"C123","period":{"start":"2020-01-01","end":"2021-12-31"},"relationship":[{"coding":[{"system":"http://terminology.hl7.org/CodeSystem/v2-0131","code":"C","display":"Emergency Contact"}]}],"telecom":[{"system":"phone","value":"01632960587"}]}],"address":[{"id":"456","period":{"start":"2020-01-01","end":"2021-12-31"},"use":"home","line":["1 Trevelyan Square","Boar Lane","City Centre","Leeds","West Yorkshire"],"postalCode":"LS1 6AE","extension":[{"url":"https://fhir.hl7.org.uk/StructureDefinition/Extension-UKCore-AddressKey","extension":[{"url":"type","valueCoding":{"system":"https://fhir.hl7.org.uk/CodeSystem/UKCore-AddressKeyType","code":"PAF"}},{"url":"value","valueString":"12345678"}]},{"url":"https://fhir.hl7.org.uk/StructureDefinition/Extension-UKCore-AddressKey","extension":[{"url":"type","valueCoding":{"system":"https://fhir.hl7.org.uk/CodeSystem/UKCore-AddressKeyType","code":"UPRN"}},{"url":"value","valueString":"123456789012"}]}]},{"id":"T456","period":{"start":"2020-01-01","end":"2021-12-31"},"use":"temp","text":"Student Accommodation","line":["1 Trevelyan Square","Boar Lane","City Centre","Leeds","West Yorkshire"],"postalCode":"LS1 6AE","extension":[{"url":"https://fhir.hl7.org.uk/StructureDefinition/Extension-UKCore-AddressKey","extension":[{"url":"type","valueCoding":{"system":"https://fhir.hl7.org.uk/CodeSystem/UKCore-AddressKeyType","code":"PAF"}},{"url":"value","valueString":"12345678"}]},{"url":"https://fhir.hl7.org.uk/StructureDefinition/Extension-UKCore-AddressKey","extension":[{"url":"type","valueCoding":{"system":"https://fhir.hl7.org.uk/CodeSystem/UKCore-AddressKeyType","code":"UPRN"}},{"url":"value","valueString":"123456789012"}]}]}]}
2023/09/15 18:14:45.691593 tttmplts.go:100: Caching 24 Templates
2023/09/15 18:14:45.697048 tttmplts.go:87: Processing Template allpatientSrvs_tmplt
2023/09/15 18:14:45.764826 tttmplts.go:93: template: pdsretrieve_tmplt:196:47: executing "pdsretrieve_tmplt" at <.ValueBoolean>: can't evaluate field ValueBoolean in type struct { URL string "json:\"url,omitempty\""; ValueCodeableConcept struct { Coding []struct { System string "json:\"system,omitempty\""; Version string "json:\"version,omitempty\""; Code string "json:\"code,omitempty\""; Display string "json:\"display,omitempty\"" } "json:\"coding,omitempty\"" } "json:\"valueCodeableConcept,omitempty\""; ValueDateTime time.Time "json:\"valueDateTime,omitempty\"" }
2023/09/15 18:14:45.765016 ttproxy.go:105: template: pdsretrieve_tmplt:196:47: executing "pdsretrieve_tmplt" at <.ValueBoolean>: can't evaluate field ValueBoolean in type struct { URL string "json:\"url,omitempty\""; ValueCodeableConcept struct { Coding []struct { System string "json:\"system,omitempty\""; Version string "json:\"version,omitempty\""; Code string "json:\"code,omitempty\""; Display string "json:\"display,omitempty\"" } "json:\"coding,omitempty\"" } "json:\"valueCodeableConcept,omitempty\""; ValueDateTime time.Time "json:\"valueDateTime,omitempty\"" }
2023/09/15 18:14:45.765058 ttproxy.go:149: Response Status Code 500
2023/09/15 18:14:45.765081 ttproxy.go:151: 
2023/09/15 18:14:45.765094 ttproxy.go:152: Response Headers
2023/09/15 18:14:45.765184 ttutil.go:140: 	{
  "Access-Control-Allow-Origin": "*",
  "Content-Type": "",
  "Server": "Workflow Service"
}
2023/09/15 18:14:45.765220 ttproxy.go:154: ----------------
2023/09/15 18:14:45.765230 ttproxy.go:155: Response
2023/09/15 18:14:45.765238 ttproxy.go:156: ----------------
2023/09/15 18:14:45.765556 ttutil.go:140: 	{
  "Host": "MacBook-Pro-3.lan",
  "Path": "/beta/spa/consumer/patient",
  "Method": "GET",
  "SourceIP": "[::1]:57413",
  "ReqContentType": "",
  "RspContentType": "",
  "ResponseBody": "{\"resourceType\":\"Patient\",\"id\":\"9000000009\",\"identifier\":[{\"system\":\"https://fhir.nhs.uk/Id/nhs-number\",\"value\":\"9000000009\",\"extension\":[{\"url\":\"https://fhir.hl7.org.uk/StructureDefinition/Extension-UKCore-NHSNumberVerificationStatus\",\"valueCodeableConcept\":{\"coding\":[{\"system\":\"https://fhir.hl7.org.uk/CodeSystem/UKCore-NHSNumberVerificationStatus\",\"version\":\"1.0.0\",\"code\":\"01\",\"display\":\"Number present and verified\"}]}}]}],\"meta\":{\"versionId\":\"2\",\"security\":[{\"system\":\"http://terminology.hl7.org/CodeSystem/v3-Confidentiality\",\"code\":\"U\",\"display\":\"unrestricted\"}]},\"name\":[{\"id\":\"123\",\"use\":\"usual\",\"period\":{\"start\":\"2020-01-01\",\"end\":\"2021-12-31\"},\"given\":[\"Jane\"],\"family\":\"Smith\",\"prefix\":[\"Mrs\"],\"suffix\":[\"MBE\"]}],\"gender\":\"female\",\"birthDate\":\"2010-10-22\",\"multipleBirthInteger\":1,\"deceasedDateTime\":\"2010-10-22T00:00:00+00:00\",\"generalPractitioner\":[{\"id\":\"254406A3\",\"type\":\"Organization\",\"identifier\":{\"system\":\"https://fhir.nhs.uk/Id/ods-organization-code\",\"value\":\"Y12345\",\"period\":{\"start\":\"2020-01-01\",\"end\":\"2021-12-31\"}}}],\"managingOrganization\":{\"type\":\"Organization\",\"identifier\":{\"system\":\"https://fhir.nhs.uk/Id/ods-organization-code\",\"value\":\"Y12345\",\"period\":{\"start\":\"2020-01-01\",\"end\":\"2021-12-31\"}}},\"extension\":[{\"url\":\"https://fhir.hl7.org.uk/StructureDefinition/Extension-UKCore-NominatedPharmacy\",\"valueReference\":{\"identifier\":{\"system\":\"https://fhir.nhs.uk/Id/ods-organization-code\",\"value\":\"Y12345\"}}},{\"url\":\"https://fhir.hl7.org.uk/StructureDefinition/Extension-UKCore-PreferredDispenserOrganization\",\"valueReference\":{\"identifier\":{\"system\":\"https://fhir.nhs.uk/Id/ods-organization-code\",\"value\":\"Y23456\"}}},{\"url\":\"https://fhir.hl7.org.uk/StructureDefinition/Extension-UKCore-MedicalApplianceSupplier\",\"valueReference\":{\"identifier\":{\"system\":\"https://fhir.nhs.uk/Id/ods-organization-code\",\"value\":\"Y34567\"}}},{\"url\":\"https://fhir.hl7.org.uk/StructureDefinition/Extension-UKCore-DeathNotificationStatus\",\"extension\":[{\"url\":\"deathNotificationStatus\",\"valueCodeableConcept\":{\"coding\":[{\"system\":\"https://fhir.hl7.org.uk/CodeSystem/UKCore-DeathNotificationStatus\",\"version\":\"1.0.0\",\"code\":\"2\",\"display\":\"Formal - death notice received from Registrar of Deaths\"}]}},{\"url\":\"systemEffectiveDate\",\"valueDateTime\":\"2010-10-22T00:00:00+00:00\"}]},{\"url\":\"https://fhir.hl7.org.uk/StructureDefinition/Extension-UKCore-NHSCommunication\",\"extension\":[{\"url\":\"language\",\"valueCodeableConcept\":{\"coding\":[{\"system\":\"https://fhir.hl7.org.uk/CodeSystem/UKCore-HumanLanguage\",\"version\":\"1.0.0\",\"code\":\"fr\",\"display\":\"French\"}]}},{\"url\":\"interpreterRequired\",\"valueBoolean\":true}]},{\"url\":\"https://fhir.hl7.org.uk/StructureDefinition/Extension-UKCore-ContactPreference\",\"extension\":[{\"url\":\"PreferredWrittenCommunicationFormat\",\"valueCodeableConcept\":{\"coding\":[{\"system\":\"https://fhir.hl7.org.uk/CodeSystem/UKCore-PreferredWrittenCommunicationFormat\",\"code\":\"12\",\"display\":\"Braille\"}]}},{\"url\":\"PreferredContactMethod\",\"valueCodeableConcept\":{\"coding\":[{\"system\":\"https://fhir.hl7.org.uk/CodeSystem/UKCore-PreferredContactMethod\",\"code\":\"1\",\"display\":\"Letter\"}]}},{\"url\":\"PreferredContactTimes\",\"valueString\":\"Not after 7pm\"}]},{\"url\":\"http://hl7.org/fhir/StructureDefinition/patient-birthPlace\",\"valueAddress\":{\"city\":\"Manchester\",\"district\":\"Greater Manchester\",\"country\":\"GBR\"}},{\"url\":\"https://fhir.nhs.uk/StructureDefinition/Extension-PDS-RemovalFromRegistration\",\"extension\":[{\"url\":\"removalFromRegistrationCode\",\"valueCodeableConcept\":{\"coding\":[{\"system\":\"https://fhir.nhs.uk/CodeSystem/PDS-RemovalReasonExitCode\",\"code\":\"SCT\",\"display\":\"Transferred to Scotland\"}]}},{\"url\":\"effectiveTime\",\"valuePeriod\":{\"start\":\"2020-01-01T00:00:00+00:00\",\"end\":\"2021-12-31T00:00:00+00:00\"}}]}],\"telecom\":[{\"id\":\"789\",\"period\":{\"start\":\"2020-01-01\",\"end\":\"2021-12-31\"},\"system\":\"phone\",\"value\":\"01632960587\",\"use\":\"home\"},{\"id\":\"790\",\"period\":{\"start\":\"2019-01-01\",\"end\":\"2022-12-31\"},\"system\":\"email\",\"value\":\"jane.smith@example.com\",\"use\":\"home\"},{\"id\":\"OC789\",\"period\":{\"start\":\"2020-01-01\",\"end\":\"2021-12-31\"},\"system\":\"other\",\"value\":\"01632960587\",\"use\":\"home\",\"extension\":[{\"url\":\"https://fhir.hl7.org.uk/StructureDefinition/Extension-UKCore-OtherContactSystem\",\"valueCoding\":{\"system\":\"https://fhir.hl7.org.uk/CodeSystem/UKCore-OtherContactSystem\",\"code\":\"textphone\",\"display\":\"Minicom (Textphone)\"}}]}],\"contact\":[{\"id\":\"C123\",\"period\":{\"start\":\"2020-01-01\",\"end\":\"2021-12-31\"},\"relationship\":[{\"coding\":[{\"system\":\"http://terminology.hl7.org/CodeSystem/v2-0131\",\"code\":\"C\",\"display\":\"Emergency Contact\"}]}],\"telecom\":[{\"system\":\"phone\",\"value\":\"01632960587\"}]}],\"address\":[{\"id\":\"456\",\"period\":{\"start\":\"2020-01-01\",\"end\":\"2021-12-31\"},\"use\":\"home\",\"line\":[\"1 Trevelyan Square\",\"Boar Lane\",\"City Centre\",\"Leeds\",\"West Yorkshire\"],\"postalCode\":\"LS1 6AE\",\"extension\":[{\"url\":\"https://fhir.hl7.org.uk/StructureDefinition/Extension-UKCore-AddressKey\",\"extension\":[{\"url\":\"type\",\"valueCoding\":{\"system\":\"https://fhir.hl7.org.uk/CodeSystem/UKCore-AddressKeyType\",\"code\":\"PAF\"}},{\"url\":\"value\",\"valueString\":\"12345678\"}]},{\"url\":\"https://fhir.hl7.org.uk/StructureDefinition/Extension-UKCore-AddressKey\",\"extension\":[{\"url\":\"type\",\"valueCoding\":{\"system\":\"https://fhir.hl7.org.uk/CodeSystem/UKCore-AddressKeyType\",\"code\":\"UPRN\"}},{\"url\":\"value\",\"valueString\":\"123456789012\"}]}]},{\"id\":\"T456\",\"period\":{\"start\":\"2020-01-01\",\"end\":\"2021-12-31\"},\"use\":\"temp\",\"text\":\"Student Accommodation\",\"line\":[\"1 Trevelyan Square\",\"Boar Lane\",\"City Centre\",\"Leeds\",\"West Yorkshire\"],\"postalCode\":\"LS1 6AE\",\"extension\":[{\"url\":\"https://fhir.hl7.org.uk/StructureDefinition/Extension-UKCore-AddressKey\",\"extension\":[{\"url\":\"type\",\"valueCoding\":{\"system\":\"https://fhir.hl7.org.uk/CodeSystem/UKCore-AddressKeyType\",\"code\":\"PAF\"}},{\"url\":\"value\",\"valueString\":\"12345678\"}]},{\"url\":\"https://fhir.hl7.org.uk/StructureDefinition/Extension-UKCore-AddressKey\",\"extension\":[{\"url\":\"type\",\"valueCoding\":{\"system\":\"https://fhir.hl7.org.uk/CodeSystem/UKCore-AddressKeyType\",\"code\":\"UPRN\"}},{\"url\":\"value\",\"valueString\":\"123456789012\"}]}]}]}",
  "StatusCode": 500,
  "IsBase64": false,
  "Timeout": 0
}
2023/09/15 18:14:45.765626 ttproxy.go:158: -------------
2023/09/15 18:14:45.765638 ttproxy.go:160: Error template: pdsretrieve_tmplt:196:47: executing "pdsretrieve_tmplt" at <.ValueBoolean>: can't evaluate field ValueBoolean in type struct { URL string "json:\"url,omitempty\""; ValueCodeableConcept struct { Coding []struct { System string "json:\"system,omitempty\""; Version string "json:\"version,omitempty\""; Code string "json:\"code,omitempty\""; Display string "json:\"display,omitempty\"" } "json:\"coding,omitempty\"" } "json:\"valueCodeableConcept,omitempty\""; ValueDateTime time.Time "json:\"valueDateTime,omitempty\"" }
2023/09/15 18:14:45.765646 ttproxy.go:161: -------------
2023/09/15 18:18:37.989607 ttserver.go:52: ICB Workflow Service stopped
2023/09/15 18:18:39.693725 ttutil.go:133: -----------------------------------------------------------------------------------
2023/09/15 18:18:39.694288 ttdb.go:51: Opening DB Connection to mysql instance
User: root
Host: tuk.coil1nnpqdlr.eu-west-1.rds.amazonaws.com
Port: :3306
Name: tuk
Connect Timeout 2s
Read Timeout 5s
2023/09/15 18:18:39.694430 ttdb.go:54: Opened Database
2023/09/15 18:18:39.875946 ttdb.go:379: Persisting Template dsubcancel_tmplt
2023/09/15 18:18:39.939685 ttdb.go:385: Persisted Template dsubcancel_tmplt
2023/09/15 18:18:39.939768 ttdb.go:366: Persisted Template dsubcancel_tmplt.xml
2023/09/15 18:18:40.010267 ttdb.go:379: Persisting Template cgl_tmplt
2023/09/15 18:18:40.107868 ttdb.go:385: Persisted Template cgl_tmplt
2023/09/15 18:18:40.107899 ttdb.go:366: Persisted Template cgl_tmplt.html
2023/09/15 18:18:40.179171 ttdb.go:379: Persisting Template pdssearch_tmplt
2023/09/15 18:18:40.245537 ttdb.go:385: Persisted Template pdssearch_tmplt
2023/09/15 18:18:40.245606 ttdb.go:366: Persisted Template pdssearch_tmplt.html
2023/09/15 18:18:40.310371 ttdb.go:379: Persisting Template dsubsubscribe_tmplt
2023/09/15 18:18:40.374622 ttdb.go:385: Persisted Template dsubsubscribe_tmplt
2023/09/15 18:18:40.374667 ttdb.go:366: Persisted Template dsubsubscribe_tmplt.xml
2023/09/15 18:18:40.438262 ttdb.go:379: Persisting Template notification_tmplt
2023/09/15 18:18:40.503903 ttdb.go:385: Persisted Template notification_tmplt
2023/09/15 18:18:40.504058 ttdb.go:366: Persisted Template notification_tmplt.txt
2023/09/15 18:18:40.569192 ttdb.go:379: Persisting Template wfstate2t_tmplt
2023/09/15 18:18:40.685557 ttdb.go:385: Persisted Template wfstate2t_tmplt
2023/09/15 18:18:40.685593 ttdb.go:366: Persisted Template wfstate2t_tmplt.html
2023/09/15 18:18:40.748666 ttdb.go:379: Persisting Template publishfile2t_tmplt
2023/09/15 18:18:40.812895 ttdb.go:385: Persisted Template publishfile2t_tmplt
2023/09/15 18:18:40.812919 ttdb.go:366: Persisted Template publishfile2t_tmplt.html
2023/09/15 18:18:40.877366 ttdb.go:379: Persisting Template react_tmplt
2023/09/15 18:18:40.939734 ttdb.go:385: Persisted Template react_tmplt
2023/09/15 18:18:40.939769 ttdb.go:366: Persisted Template react_tmplt.html
2023/09/15 18:18:41.002848 ttdb.go:379: Persisting Template pdsretrieve_tmplt
2023/09/15 18:18:41.067843 ttdb.go:385: Persisted Template pdsretrieve_tmplt
2023/09/15 18:18:41.067983 ttdb.go:366: Persisted Template pdsretrieve_tmplt.html
2023/09/15 18:18:41.131194 ttdb.go:379: Persisting Template allpatientSrvs_tmplt
2023/09/15 18:18:41.194483 ttdb.go:385: Persisted Template allpatientSrvs_tmplt
2023/09/15 18:18:41.194539 ttdb.go:366: Persisted Template allpatientSrvs_tmplt.html
2023/09/15 18:18:41.258901 ttdb.go:379: Persisting Template spa2t_tmplt
2023/09/15 18:18:41.334914 ttdb.go:385: Persisted Template spa2t_tmplt
2023/09/15 18:18:41.334977 ttdb.go:366: Persisted Template spa2t_tmplt.html
2023/09/15 18:18:41.398138 ttdb.go:379: Persisting Template xdw2t_tmplt
2023/09/15 18:18:41.478862 ttdb.go:385: Persisted Template xdw2t_tmplt
2023/09/15 18:18:41.478940 ttdb.go:366: Persisted Template xdw2t_tmplt.html
2023/09/15 18:18:41.542226 ttdb.go:379: Persisting Template spaheader2t_tmplt
2023/09/15 18:18:41.609844 ttdb.go:385: Persisted Template spaheader2t_tmplt
2023/09/15 18:18:41.609935 ttdb.go:366: Persisted Template spaheader2t_tmplt.html
2023/09/15 18:18:41.672224 ttdb.go:379: Persisting Template pds_tmplt
2023/09/15 18:18:41.742627 ttdb.go:385: Persisted Template pds_tmplt
2023/09/15 18:18:41.742766 ttdb.go:366: Persisted Template pds_tmplt.html
2023/09/15 18:18:41.806641 ttdb.go:379: Persisting Template error_tmplt
2023/09/15 18:18:41.870182 ttdb.go:385: Persisted Template error_tmplt
2023/09/15 18:18:41.870313 ttdb.go:366: Persisted Template error_tmplt.html
2023/09/15 18:18:41.934393 ttdb.go:379: Persisting Template dsuback_tmplt
2023/09/15 18:18:42.002100 ttdb.go:385: Persisted Template dsuback_tmplt
2023/09/15 18:18:42.002216 ttdb.go:366: Persisted Template dsuback_tmplt.xml
2023/09/15 18:18:42.065155 ttdb.go:379: Persisting Template pixm_tmplt
2023/09/15 18:18:42.133733 ttdb.go:385: Persisted Template pixm_tmplt
2023/09/15 18:18:42.133777 ttdb.go:366: Persisted Template pixm_tmplt.html
2023/09/15 18:18:42.197551 ttdb.go:379: Persisting Template subscriptions2t_tmplt
2023/09/15 18:18:42.261356 ttdb.go:385: Persisted Template subscriptions2t_tmplt
2023/09/15 18:18:42.261398 ttdb.go:366: Persisted Template subscriptions2t_tmplt.html
2023/09/15 18:18:42.325857 ttdb.go:379: Persisting Template codemaps2t_tmplt
2023/09/15 18:18:42.395604 ttdb.go:385: Persisted Template codemaps2t_tmplt
2023/09/15 18:18:42.395752 ttdb.go:366: Persisted Template codemaps2t_tmplt.html
2023/09/15 18:18:42.463636 ttdb.go:379: Persisting Template mhdpublish_tmplt
2023/09/15 18:18:42.535321 ttdb.go:385: Persisted Template mhdpublish_tmplt
2023/09/15 18:18:42.535471 ttdb.go:366: Persisted Template mhdpublish_tmplt.json
2023/09/15 18:18:42.599835 ttdb.go:379: Persisting Template events_tmplt
2023/09/15 18:18:42.666851 ttdb.go:385: Persisted Template events_tmplt
2023/09/15 18:18:42.667100 ttdb.go:366: Persisted Template events_tmplt.html
2023/09/15 18:18:42.731915 ttdb.go:379: Persisting Template uploadfile2t_tmplt
2023/09/15 18:18:42.795220 ttdb.go:385: Persisted Template uploadfile2t_tmplt
2023/09/15 18:18:42.795342 ttdb.go:366: Persisted Template uploadfile2t_tmplt.html
2023/09/15 18:18:42.795645 ttserver.go:40: Starting ICB Workflow Service. Service Endpoint http://MacBook-Pro-3.lan:8080/
2023/09/15 18:18:47.585478 ttgethandler.go:10: Processing new GET Request
2023/09/15 18:18:47.585660 ttproxy.go:138: 	Request Query Params
2023/09/15 18:18:47.586052 ttutil.go:140: 	{
  "User": "ian.thomas",
  "Org": "2tsolutions",
  "Role": "clinical",
  "Nhs": "9000000009"
}
2023/09/15 18:18:47.586096 ttgethandler.go:15: Path = /beta/spa/consumer/patient
2023/09/15 18:18:47.586139 tttmplts.go:37: CGL Worker starting
2023/09/15 18:18:47.586145 tttmplts.go:30: PIXm Worker starting
2023/09/15 18:18:47.586331 tthttp.go:15: Creating PIXm PDQ - Server URL http://lac-demo-01.tianispirit.co.uk:8081/SpiritPIXFhir/r4/Patient?identifier=2.16.840.1.113883.2.1.4.1%7C9000000009
2023/09/15 18:18:47.587963 tthttp.go:160: Request Headers 
map[Content-Type:[application/json]]
2023/09/15 18:18:47.588045 tthttp.go:160: Request Headers 
map[Accept:[application/json] X-Api-Key:[FNhb#OhxWiEiMdf+@6085k5Zmt] X-Api-Secret:[9710ea0fb4ffb5d56c2e62c71c30bdfhjsyr56a79d]]
2023/09/15 18:18:47.784305 tthttp.go:174: Server Response - Status Code 404 
{"errors":[{"message":"No clients matching nhs number 9000000009","path":"\/"}],"status":404}
2023/09/15 18:18:47.791605 ttutil.go:140: 	{
  "data": {
    "client": {
      "basicDetails": {
        "address": {},
        "name": {}
      },
      "bbvInformation": {},
      "drugTestResults": {
        "results": {}
      },
      "riskInformation": {
        "mentalHealthDomain": {},
        "riskOfHarmToSelfDomain": {},
        "socialDomain": {},
        "substanceMisuseDomain": {}
      },
      "safeguardingInformation": {}
    },
    "keyWorker": {
      "name": {}
    }
  }
}
2023/09/15 18:18:47.791779 tttmplts.go:39: CGL Worker done
2023/09/15 18:18:47.791819 tttmplts.go:40: CGL Worker Status Code 404
2023/09/15 18:18:52.587672 tthttp.go:174: Server Response - Status Code 0 
2023/09/15 18:18:52.588309 tttmplts.go:32: PIXm Worker done
2023/09/15 18:18:52.588374 tttmplts.go:33: PIXm Worker Status Code 408
2023/09/15 18:18:52.588565 tthttp.go:56: Creating PDS Search Request - Server URL https://sandbox.api.service.nhs.uk/personal-demographics/FHIR/R4/Patient/9000000009
2023/09/15 18:18:52.588762 tthttp.go:160: Request Headers 
map[Accept:[*/*] Content-Type:[application/json] X-Request-Id:[0a7f7ae1-388d-4ff1-9186-9c08a8445686]]
2023/09/15 18:18:52.740611 tthttp.go:174: Server Response - Status Code 200 
{"resourceType":"Patient","id":"9000000009","identifier":[{"system":"https://fhir.nhs.uk/Id/nhs-number","value":"9000000009","extension":[{"url":"https://fhir.hl7.org.uk/StructureDefinition/Extension-UKCore-NHSNumberVerificationStatus","valueCodeableConcept":{"coding":[{"system":"https://fhir.hl7.org.uk/CodeSystem/UKCore-NHSNumberVerificationStatus","version":"1.0.0","code":"01","display":"Number present and verified"}]}}]}],"meta":{"versionId":"2","security":[{"system":"http://terminology.hl7.org/CodeSystem/v3-Confidentiality","code":"U","display":"unrestricted"}]},"name":[{"id":"123","use":"usual","period":{"start":"2020-01-01","end":"2021-12-31"},"given":["Jane"],"family":"Smith","prefix":["Mrs"],"suffix":["MBE"]}],"gender":"female","birthDate":"2010-10-22","multipleBirthInteger":1,"deceasedDateTime":"2010-10-22T00:00:00+00:00","generalPractitioner":[{"id":"254406A3","type":"Organization","identifier":{"system":"https://fhir.nhs.uk/Id/ods-organization-code","value":"Y12345","period":{"start":"2020-01-01","end":"2021-12-31"}}}],"managingOrganization":{"type":"Organization","identifier":{"system":"https://fhir.nhs.uk/Id/ods-organization-code","value":"Y12345","period":{"start":"2020-01-01","end":"2021-12-31"}}},"extension":[{"url":"https://fhir.hl7.org.uk/StructureDefinition/Extension-UKCore-NominatedPharmacy","valueReference":{"identifier":{"system":"https://fhir.nhs.uk/Id/ods-organization-code","value":"Y12345"}}},{"url":"https://fhir.hl7.org.uk/StructureDefinition/Extension-UKCore-PreferredDispenserOrganization","valueReference":{"identifier":{"system":"https://fhir.nhs.uk/Id/ods-organization-code","value":"Y23456"}}},{"url":"https://fhir.hl7.org.uk/StructureDefinition/Extension-UKCore-MedicalApplianceSupplier","valueReference":{"identifier":{"system":"https://fhir.nhs.uk/Id/ods-organization-code","value":"Y34567"}}},{"url":"https://fhir.hl7.org.uk/StructureDefinition/Extension-UKCore-DeathNotificationStatus","extension":[{"url":"deathNotificationStatus","valueCodeableConcept":{"coding":[{"system":"https://fhir.hl7.org.uk/CodeSystem/UKCore-DeathNotificationStatus","version":"1.0.0","code":"2","display":"Formal - death notice received from Registrar of Deaths"}]}},{"url":"systemEffectiveDate","valueDateTime":"2010-10-22T00:00:00+00:00"}]},{"url":"https://fhir.hl7.org.uk/StructureDefinition/Extension-UKCore-NHSCommunication","extension":[{"url":"language","valueCodeableConcept":{"coding":[{"system":"https://fhir.hl7.org.uk/CodeSystem/UKCore-HumanLanguage","version":"1.0.0","code":"fr","display":"French"}]}},{"url":"interpreterRequired","valueBoolean":true}]},{"url":"https://fhir.hl7.org.uk/StructureDefinition/Extension-UKCore-ContactPreference","extension":[{"url":"PreferredWrittenCommunicationFormat","valueCodeableConcept":{"coding":[{"system":"https://fhir.hl7.org.uk/CodeSystem/UKCore-PreferredWrittenCommunicationFormat","code":"12","display":"Braille"}]}},{"url":"PreferredContactMethod","valueCodeableConcept":{"coding":[{"system":"https://fhir.hl7.org.uk/CodeSystem/UKCore-PreferredContactMethod","code":"1","display":"Letter"}]}},{"url":"PreferredContactTimes","valueString":"Not after 7pm"}]},{"url":"http://hl7.org/fhir/StructureDefinition/patient-birthPlace","valueAddress":{"city":"Manchester","district":"Greater Manchester","country":"GBR"}},{"url":"https://fhir.nhs.uk/StructureDefinition/Extension-PDS-RemovalFromRegistration","extension":[{"url":"removalFromRegistrationCode","valueCodeableConcept":{"coding":[{"system":"https://fhir.nhs.uk/CodeSystem/PDS-RemovalReasonExitCode","code":"SCT","display":"Transferred to Scotland"}]}},{"url":"effectiveTime","valuePeriod":{"start":"2020-01-01T00:00:00+00:00","end":"2021-12-31T00:00:00+00:00"}}]}],"telecom":[{"id":"789","period":{"start":"2020-01-01","end":"2021-12-31"},"system":"phone","value":"01632960587","use":"home"},{"id":"790","period":{"start":"2019-01-01","end":"2022-12-31"},"system":"email","value":"jane.smith@example.com","use":"home"},{"id":"OC789","period":{"start":"2020-01-01","end":"2021-12-31"},"system":"other","value":"01632960587","use":"home","extension":[{"url":"https://fhir.hl7.org.uk/StructureDefinition/Extension-UKCore-OtherContactSystem","valueCoding":{"system":"https://fhir.hl7.org.uk/CodeSystem/UKCore-OtherContactSystem","code":"textphone","display":"Minicom (Textphone)"}}]}],"contact":[{"id":"C123","period":{"start":"2020-01-01","end":"2021-12-31"},"relationship":[{"coding":[{"system":"http://terminology.hl7.org/CodeSystem/v2-0131","code":"C","display":"Emergency Contact"}]}],"telecom":[{"system":"phone","value":"01632960587"}]}],"address":[{"id":"456","period":{"start":"2020-01-01","end":"2021-12-31"},"use":"home","line":["1 Trevelyan Square","Boar Lane","City Centre","Leeds","West Yorkshire"],"postalCode":"LS1 6AE","extension":[{"url":"https://fhir.hl7.org.uk/StructureDefinition/Extension-UKCore-AddressKey","extension":[{"url":"type","valueCoding":{"system":"https://fhir.hl7.org.uk/CodeSystem/UKCore-AddressKeyType","code":"PAF"}},{"url":"value","valueString":"12345678"}]},{"url":"https://fhir.hl7.org.uk/StructureDefinition/Extension-UKCore-AddressKey","extension":[{"url":"type","valueCoding":{"system":"https://fhir.hl7.org.uk/CodeSystem/UKCore-AddressKeyType","code":"UPRN"}},{"url":"value","valueString":"123456789012"}]}]},{"id":"T456","period":{"start":"2020-01-01","end":"2021-12-31"},"use":"temp","text":"Student Accommodation","line":["1 Trevelyan Square","Boar Lane","City Centre","Leeds","West Yorkshire"],"postalCode":"LS1 6AE","extension":[{"url":"https://fhir.hl7.org.uk/StructureDefinition/Extension-UKCore-AddressKey","extension":[{"url":"type","valueCoding":{"system":"https://fhir.hl7.org.uk/CodeSystem/UKCore-AddressKeyType","code":"PAF"}},{"url":"value","valueString":"12345678"}]},{"url":"https://fhir.hl7.org.uk/StructureDefinition/Extension-UKCore-AddressKey","extension":[{"url":"type","valueCoding":{"system":"https://fhir.hl7.org.uk/CodeSystem/UKCore-AddressKeyType","code":"UPRN"}},{"url":"value","valueString":"123456789012"}]}]}]}
2023/09/15 18:18:52.940353 tttmplts.go:100: Caching 24 Templates
2023/09/15 18:18:52.951505 tttmplts.go:87: Processing Template allpatientSrvs_tmplt
2023/09/15 18:18:53.021392 tttmplts.go:93: template: pdsretrieve_tmplt:193:47: executing "pdsretrieve_tmplt" at <.ValueString>: can't evaluate field ValueString in type struct { URL string "json:\"url,omitempty\""; ValueCodeableConcept struct { Coding []struct { System string "json:\"system,omitempty\""; Version string "json:\"version,omitempty\""; Code string "json:\"code,omitempty\""; Display string "json:\"display,omitempty\"" } "json:\"coding,omitempty\"" } "json:\"valueCodeableConcept,omitempty\""; ValueDateTime time.Time "json:\"valueDateTime,omitempty\"" }
2023/09/15 18:18:53.021822 ttproxy.go:105: template: pdsretrieve_tmplt:193:47: executing "pdsretrieve_tmplt" at <.ValueString>: can't evaluate field ValueString in type struct { URL string "json:\"url,omitempty\""; ValueCodeableConcept struct { Coding []struct { System string "json:\"system,omitempty\""; Version string "json:\"version,omitempty\""; Code string "json:\"code,omitempty\""; Display string "json:\"display,omitempty\"" } "json:\"coding,omitempty\"" } "json:\"valueCodeableConcept,omitempty\""; ValueDateTime time.Time "json:\"valueDateTime,omitempty\"" }
2023/09/15 18:18:53.021923 ttproxy.go:149: Response Status Code 500
2023/09/15 18:18:53.021951 ttproxy.go:151: 
2023/09/15 18:18:53.021971 ttproxy.go:152: Response Headers
2023/09/15 18:18:53.022207 ttutil.go:140: 	{
  "Access-Control-Allow-Origin": "*",
  "Content-Type": "",
  "Server": "Workflow Service"
}
2023/09/15 18:18:53.022240 ttproxy.go:154: ----------------
2023/09/15 18:18:53.022259 ttproxy.go:155: Response
2023/09/15 18:18:53.022276 ttproxy.go:156: ----------------
2023/09/15 18:18:53.023044 ttutil.go:140: 	{
  "Host": "MacBook-Pro-3.lan",
  "Path": "/beta/spa/consumer/patient",
  "Method": "GET",
  "SourceIP": "[::1]:57510",
  "ReqContentType": "",
  "RspContentType": "",
  "ResponseBody": "{\"resourceType\":\"Patient\",\"id\":\"9000000009\",\"identifier\":[{\"system\":\"https://fhir.nhs.uk/Id/nhs-number\",\"value\":\"9000000009\",\"extension\":[{\"url\":\"https://fhir.hl7.org.uk/StructureDefinition/Extension-UKCore-NHSNumberVerificationStatus\",\"valueCodeableConcept\":{\"coding\":[{\"system\":\"https://fhir.hl7.org.uk/CodeSystem/UKCore-NHSNumberVerificationStatus\",\"version\":\"1.0.0\",\"code\":\"01\",\"display\":\"Number present and verified\"}]}}]}],\"meta\":{\"versionId\":\"2\",\"security\":[{\"system\":\"http://terminology.hl7.org/CodeSystem/v3-Confidentiality\",\"code\":\"U\",\"display\":\"unrestricted\"}]},\"name\":[{\"id\":\"123\",\"use\":\"usual\",\"period\":{\"start\":\"2020-01-01\",\"end\":\"2021-12-31\"},\"given\":[\"Jane\"],\"family\":\"Smith\",\"prefix\":[\"Mrs\"],\"suffix\":[\"MBE\"]}],\"gender\":\"female\",\"birthDate\":\"2010-10-22\",\"multipleBirthInteger\":1,\"deceasedDateTime\":\"2010-10-22T00:00:00+00:00\",\"generalPractitioner\":[{\"id\":\"254406A3\",\"type\":\"Organization\",\"identifier\":{\"system\":\"https://fhir.nhs.uk/Id/ods-organization-code\",\"value\":\"Y12345\",\"period\":{\"start\":\"2020-01-01\",\"end\":\"2021-12-31\"}}}],\"managingOrganization\":{\"type\":\"Organization\",\"identifier\":{\"system\":\"https://fhir.nhs.uk/Id/ods-organization-code\",\"value\":\"Y12345\",\"period\":{\"start\":\"2020-01-01\",\"end\":\"2021-12-31\"}}},\"extension\":[{\"url\":\"https://fhir.hl7.org.uk/StructureDefinition/Extension-UKCore-NominatedPharmacy\",\"valueReference\":{\"identifier\":{\"system\":\"https://fhir.nhs.uk/Id/ods-organization-code\",\"value\":\"Y12345\"}}},{\"url\":\"https://fhir.hl7.org.uk/StructureDefinition/Extension-UKCore-PreferredDispenserOrganization\",\"valueReference\":{\"identifier\":{\"system\":\"https://fhir.nhs.uk/Id/ods-organization-code\",\"value\":\"Y23456\"}}},{\"url\":\"https://fhir.hl7.org.uk/StructureDefinition/Extension-UKCore-MedicalApplianceSupplier\",\"valueReference\":{\"identifier\":{\"system\":\"https://fhir.nhs.uk/Id/ods-organization-code\",\"value\":\"Y34567\"}}},{\"url\":\"https://fhir.hl7.org.uk/StructureDefinition/Extension-UKCore-DeathNotificationStatus\",\"extension\":[{\"url\":\"deathNotificationStatus\",\"valueCodeableConcept\":{\"coding\":[{\"system\":\"https://fhir.hl7.org.uk/CodeSystem/UKCore-DeathNotificationStatus\",\"version\":\"1.0.0\",\"code\":\"2\",\"display\":\"Formal - death notice received from Registrar of Deaths\"}]}},{\"url\":\"systemEffectiveDate\",\"valueDateTime\":\"2010-10-22T00:00:00+00:00\"}]},{\"url\":\"https://fhir.hl7.org.uk/StructureDefinition/Extension-UKCore-NHSCommunication\",\"extension\":[{\"url\":\"language\",\"valueCodeableConcept\":{\"coding\":[{\"system\":\"https://fhir.hl7.org.uk/CodeSystem/UKCore-HumanLanguage\",\"version\":\"1.0.0\",\"code\":\"fr\",\"display\":\"French\"}]}},{\"url\":\"interpreterRequired\",\"valueBoolean\":true}]},{\"url\":\"https://fhir.hl7.org.uk/StructureDefinition/Extension-UKCore-ContactPreference\",\"extension\":[{\"url\":\"PreferredWrittenCommunicationFormat\",\"valueCodeableConcept\":{\"coding\":[{\"system\":\"https://fhir.hl7.org.uk/CodeSystem/UKCore-PreferredWrittenCommunicationFormat\",\"code\":\"12\",\"display\":\"Braille\"}]}},{\"url\":\"PreferredContactMethod\",\"valueCodeableConcept\":{\"coding\":[{\"system\":\"https://fhir.hl7.org.uk/CodeSystem/UKCore-PreferredContactMethod\",\"code\":\"1\",\"display\":\"Letter\"}]}},{\"url\":\"PreferredContactTimes\",\"valueString\":\"Not after 7pm\"}]},{\"url\":\"http://hl7.org/fhir/StructureDefinition/patient-birthPlace\",\"valueAddress\":{\"city\":\"Manchester\",\"district\":\"Greater Manchester\",\"country\":\"GBR\"}},{\"url\":\"https://fhir.nhs.uk/StructureDefinition/Extension-PDS-RemovalFromRegistration\",\"extension\":[{\"url\":\"removalFromRegistrationCode\",\"valueCodeableConcept\":{\"coding\":[{\"system\":\"https://fhir.nhs.uk/CodeSystem/PDS-RemovalReasonExitCode\",\"code\":\"SCT\",\"display\":\"Transferred to Scotland\"}]}},{\"url\":\"effectiveTime\",\"valuePeriod\":{\"start\":\"2020-01-01T00:00:00+00:00\",\"end\":\"2021-12-31T00:00:00+00:00\"}}]}],\"telecom\":[{\"id\":\"789\",\"period\":{\"start\":\"2020-01-01\",\"end\":\"2021-12-31\"},\"system\":\"phone\",\"value\":\"01632960587\",\"use\":\"home\"},{\"id\":\"790\",\"period\":{\"start\":\"2019-01-01\",\"end\":\"2022-12-31\"},\"system\":\"email\",\"value\":\"jane.smith@example.com\",\"use\":\"home\"},{\"id\":\"OC789\",\"period\":{\"start\":\"2020-01-01\",\"end\":\"2021-12-31\"},\"system\":\"other\",\"value\":\"01632960587\",\"use\":\"home\",\"extension\":[{\"url\":\"https://fhir.hl7.org.uk/StructureDefinition/Extension-UKCore-OtherContactSystem\",\"valueCoding\":{\"system\":\"https://fhir.hl7.org.uk/CodeSystem/UKCore-OtherContactSystem\",\"code\":\"textphone\",\"display\":\"Minicom (Textphone)\"}}]}],\"contact\":[{\"id\":\"C123\",\"period\":{\"start\":\"2020-01-01\",\"end\":\"2021-12-31\"},\"relationship\":[{\"coding\":[{\"system\":\"http://terminology.hl7.org/CodeSystem/v2-0131\",\"code\":\"C\",\"display\":\"Emergency Contact\"}]}],\"telecom\":[{\"system\":\"phone\",\"value\":\"01632960587\"}]}],\"address\":[{\"id\":\"456\",\"period\":{\"start\":\"2020-01-01\",\"end\":\"2021-12-31\"},\"use\":\"home\",\"line\":[\"1 Trevelyan Square\",\"Boar Lane\",\"City Centre\",\"Leeds\",\"West Yorkshire\"],\"postalCode\":\"LS1 6AE\",\"extension\":[{\"url\":\"https://fhir.hl7.org.uk/StructureDefinition/Extension-UKCore-AddressKey\",\"extension\":[{\"url\":\"type\",\"valueCoding\":{\"system\":\"https://fhir.hl7.org.uk/CodeSystem/UKCore-AddressKeyType\",\"code\":\"PAF\"}},{\"url\":\"value\",\"valueString\":\"12345678\"}]},{\"url\":\"https://fhir.hl7.org.uk/StructureDefinition/Extension-UKCore-AddressKey\",\"extension\":[{\"url\":\"type\",\"valueCoding\":{\"system\":\"https://fhir.hl7.org.uk/CodeSystem/UKCore-AddressKeyType\",\"code\":\"UPRN\"}},{\"url\":\"value\",\"valueString\":\"123456789012\"}]}]},{\"id\":\"T456\",\"period\":{\"start\":\"2020-01-01\",\"end\":\"2021-12-31\"},\"use\":\"temp\",\"text\":\"Student Accommodation\",\"line\":[\"1 Trevelyan Square\",\"Boar Lane\",\"City Centre\",\"Leeds\",\"West Yorkshire\"],\"postalCode\":\"LS1 6AE\",\"extension\":[{\"url\":\"https://fhir.hl7.org.uk/StructureDefinition/Extension-UKCore-AddressKey\",\"extension\":[{\"url\":\"type\",\"valueCoding\":{\"system\":\"https://fhir.hl7.org.uk/CodeSystem/UKCore-AddressKeyType\",\"code\":\"PAF\"}},{\"url\":\"value\",\"valueString\":\"12345678\"}]},{\"url\":\"https://fhir.hl7.org.uk/StructureDefinition/Extension-UKCore-AddressKey\",\"extension\":[{\"url\":\"type\",\"valueCoding\":{\"system\":\"https://fhir.hl7.org.uk/CodeSystem/UKCore-AddressKeyType\",\"code\":\"UPRN\"}},{\"url\":\"value\",\"valueString\":\"123456789012\"}]}]}]}",
  "StatusCode": 500,
  "IsBase64": false,
  "Timeout": 0
}
2023/09/15 18:18:53.023160 ttproxy.go:158: -------------
2023/09/15 18:18:53.023181 ttproxy.go:160: Error template: pdsretrieve_tmplt:193:47: executing "pdsretrieve_tmplt" at <.ValueString>: can't evaluate field ValueString in type struct { URL string "json:\"url,omitempty\""; ValueCodeableConcept struct { Coding []struct { System string "json:\"system,omitempty\""; Version string "json:\"version,omitempty\""; Code string "json:\"code,omitempty\""; Display string "json:\"display,omitempty\"" } "json:\"coding,omitempty\"" } "json:\"valueCodeableConcept,omitempty\""; ValueDateTime time.Time "json:\"valueDateTime,omitempty\"" }
2023/09/15 18:18:53.023207 ttproxy.go:161: -------------
2023/09/15 18:19:57.618589 ttserver.go:52: ICB Workflow Service stopped
2023/09/15 18:19:59.477311 ttutil.go:133: -----------------------------------------------------------------------------------
2023/09/15 18:19:59.477678 ttdb.go:51: Opening DB Connection to mysql instance
User: root
Host: tuk.coil1nnpqdlr.eu-west-1.rds.amazonaws.com
Port: :3306
Name: tuk
Connect Timeout 2s
Read Timeout 5s
2023/09/15 18:19:59.477802 ttdb.go:54: Opened Database
2023/09/15 18:19:59.656698 ttdb.go:379: Persisting Template dsubcancel_tmplt
2023/09/15 18:19:59.719857 ttdb.go:385: Persisted Template dsubcancel_tmplt
2023/09/15 18:19:59.719930 ttdb.go:366: Persisted Template dsubcancel_tmplt.xml
2023/09/15 18:19:59.782119 ttdb.go:379: Persisting Template cgl_tmplt
2023/09/15 18:19:59.876394 ttdb.go:385: Persisted Template cgl_tmplt
2023/09/15 18:19:59.876458 ttdb.go:366: Persisted Template cgl_tmplt.html
2023/09/15 18:19:59.941424 ttdb.go:379: Persisting Template pdssearch_tmplt
2023/09/15 18:20:00.191567 ttdb.go:385: Persisted Template pdssearch_tmplt
2023/09/15 18:20:00.191780 ttdb.go:366: Persisted Template pdssearch_tmplt.html
2023/09/15 18:20:00.267968 ttdb.go:379: Persisting Template dsubsubscribe_tmplt
2023/09/15 18:20:00.347408 ttdb.go:385: Persisted Template dsubsubscribe_tmplt
2023/09/15 18:20:00.347448 ttdb.go:366: Persisted Template dsubsubscribe_tmplt.xml
2023/09/15 18:20:00.418516 ttdb.go:379: Persisting Template notification_tmplt
2023/09/15 18:20:00.508705 ttdb.go:385: Persisted Template notification_tmplt
2023/09/15 18:20:00.508748 ttdb.go:366: Persisted Template notification_tmplt.txt
2023/09/15 18:20:00.572260 ttdb.go:379: Persisting Template wfstate2t_tmplt
2023/09/15 18:20:00.689411 ttdb.go:385: Persisted Template wfstate2t_tmplt
2023/09/15 18:20:00.689450 ttdb.go:366: Persisted Template wfstate2t_tmplt.html
2023/09/15 18:20:00.752900 ttdb.go:379: Persisting Template publishfile2t_tmplt
2023/09/15 18:20:00.815481 ttdb.go:385: Persisted Template publishfile2t_tmplt
2023/09/15 18:20:00.815563 ttdb.go:366: Persisted Template publishfile2t_tmplt.html
2023/09/15 18:20:00.881026 ttdb.go:379: Persisting Template react_tmplt
2023/09/15 18:20:00.945738 ttdb.go:385: Persisted Template react_tmplt
2023/09/15 18:20:00.945852 ttdb.go:366: Persisted Template react_tmplt.html
2023/09/15 18:20:01.013305 ttdb.go:379: Persisting Template pdsretrieve_tmplt
2023/09/15 18:20:01.081163 ttdb.go:385: Persisted Template pdsretrieve_tmplt
2023/09/15 18:20:01.081296 ttdb.go:366: Persisted Template pdsretrieve_tmplt.html
2023/09/15 18:20:01.144407 ttdb.go:379: Persisting Template allpatientSrvs_tmplt
2023/09/15 18:20:01.214349 ttdb.go:385: Persisted Template allpatientSrvs_tmplt
2023/09/15 18:20:01.214483 ttdb.go:366: Persisted Template allpatientSrvs_tmplt.html
2023/09/15 18:20:01.276504 ttdb.go:379: Persisting Template spa2t_tmplt
2023/09/15 18:20:01.355433 ttdb.go:385: Persisted Template spa2t_tmplt
2023/09/15 18:20:01.355569 ttdb.go:366: Persisted Template spa2t_tmplt.html
2023/09/15 18:20:01.420535 ttdb.go:379: Persisting Template xdw2t_tmplt
2023/09/15 18:20:01.501377 ttdb.go:385: Persisted Template xdw2t_tmplt
2023/09/15 18:20:01.501520 ttdb.go:366: Persisted Template xdw2t_tmplt.html
2023/09/15 18:20:01.566325 ttdb.go:379: Persisting Template spaheader2t_tmplt
2023/09/15 18:20:01.634868 ttdb.go:385: Persisted Template spaheader2t_tmplt
2023/09/15 18:20:01.635012 ttdb.go:366: Persisted Template spaheader2t_tmplt.html
2023/09/15 18:20:01.698478 ttdb.go:379: Persisting Template pds_tmplt
2023/09/15 18:20:01.761889 ttdb.go:385: Persisted Template pds_tmplt
2023/09/15 18:20:01.761916 ttdb.go:366: Persisted Template pds_tmplt.html
2023/09/15 18:20:01.824549 ttdb.go:379: Persisting Template error_tmplt
2023/09/15 18:20:01.888003 ttdb.go:385: Persisted Template error_tmplt
2023/09/15 18:20:01.888065 ttdb.go:366: Persisted Template error_tmplt.html
2023/09/15 18:20:01.952046 ttdb.go:379: Persisting Template dsuback_tmplt
2023/09/15 18:20:02.015940 ttdb.go:385: Persisted Template dsuback_tmplt
2023/09/15 18:20:02.016032 ttdb.go:366: Persisted Template dsuback_tmplt.xml
2023/09/15 18:20:02.079099 ttdb.go:379: Persisting Template pixm_tmplt
2023/09/15 18:20:02.151893 ttdb.go:385: Persisted Template pixm_tmplt
2023/09/15 18:20:02.152004 ttdb.go:366: Persisted Template pixm_tmplt.html
2023/09/15 18:20:02.215020 ttdb.go:379: Persisting Template subscriptions2t_tmplt
2023/09/15 18:20:02.280837 ttdb.go:385: Persisted Template subscriptions2t_tmplt
2023/09/15 18:20:02.280981 ttdb.go:366: Persisted Template subscriptions2t_tmplt.html
2023/09/15 18:20:02.347216 ttdb.go:379: Persisting Template codemaps2t_tmplt
2023/09/15 18:20:02.414251 ttdb.go:385: Persisted Template codemaps2t_tmplt
2023/09/15 18:20:02.414495 ttdb.go:366: Persisted Template codemaps2t_tmplt.html
2023/09/15 18:20:02.477457 ttdb.go:379: Persisting Template mhdpublish_tmplt
2023/09/15 18:20:02.545611 ttdb.go:385: Persisted Template mhdpublish_tmplt
2023/09/15 18:20:02.545725 ttdb.go:366: Persisted Template mhdpublish_tmplt.json
2023/09/15 18:20:02.608665 ttdb.go:379: Persisting Template events_tmplt
2023/09/15 18:20:02.677200 ttdb.go:385: Persisted Template events_tmplt
2023/09/15 18:20:02.677336 ttdb.go:366: Persisted Template events_tmplt.html
2023/09/15 18:20:02.738822 ttdb.go:379: Persisting Template uploadfile2t_tmplt
2023/09/15 18:20:02.802993 ttdb.go:385: Persisted Template uploadfile2t_tmplt
2023/09/15 18:20:02.803121 ttdb.go:366: Persisted Template uploadfile2t_tmplt.html
2023/09/15 18:20:02.803439 ttserver.go:40: Starting ICB Workflow Service. Service Endpoint http://MacBook-Pro-3.lan:8080/
2023/09/15 18:20:05.844090 ttgethandler.go:10: Processing new GET Request
2023/09/15 18:20:05.844321 ttproxy.go:138: 	Request Query Params
2023/09/15 18:20:05.844931 ttutil.go:140: 	{
  "User": "ian.thomas",
  "Org": "2tsolutions",
  "Role": "clinical",
  "Nhs": "9000000009"
}
2023/09/15 18:20:05.844988 ttgethandler.go:15: Path = /beta/spa/consumer/patient
2023/09/15 18:20:05.845077 tttmplts.go:37: CGL Worker starting
2023/09/15 18:20:05.845093 tttmplts.go:30: PIXm Worker starting
2023/09/15 18:20:05.845405 tthttp.go:15: Creating PIXm PDQ - Server URL http://lac-demo-01.tianispirit.co.uk:8081/SpiritPIXFhir/r4/Patient?identifier=2.16.840.1.113883.2.1.4.1%7C9000000009
2023/09/15 18:20:05.848459 tthttp.go:160: Request Headers 
map[Content-Type:[application/json]]
2023/09/15 18:20:05.848529 tthttp.go:160: Request Headers 
map[Accept:[application/json] X-Api-Key:[FNhb#OhxWiEiMdf+@6085k5Zmt] X-Api-Secret:[9710ea0fb4ffb5d56c2e62c71c30bdfhjsyr56a79d]]
2023/09/15 18:20:06.034930 tthttp.go:174: Server Response - Status Code 404 
{"errors":[{"message":"No clients matching nhs number 9000000009","path":"\/"}],"status":404}
2023/09/15 18:20:06.038178 ttutil.go:140: 	{
  "data": {
    "client": {
      "basicDetails": {
        "address": {},
        "name": {}
      },
      "bbvInformation": {},
      "drugTestResults": {
        "results": {}
      },
      "riskInformation": {
        "mentalHealthDomain": {},
        "riskOfHarmToSelfDomain": {},
        "socialDomain": {},
        "substanceMisuseDomain": {}
      },
      "safeguardingInformation": {}
    },
    "keyWorker": {
      "name": {}
    }
  }
}
2023/09/15 18:20:06.038268 tttmplts.go:39: CGL Worker done
2023/09/15 18:20:06.038290 tttmplts.go:40: CGL Worker Status Code 404
2023/09/15 18:20:10.847415 tthttp.go:174: Server Response - Status Code 0 
2023/09/15 18:20:10.847645 tttmplts.go:32: PIXm Worker done
2023/09/15 18:20:10.847677 tttmplts.go:33: PIXm Worker Status Code 408
2023/09/15 18:20:10.847955 tthttp.go:56: Creating PDS Search Request - Server URL https://sandbox.api.service.nhs.uk/personal-demographics/FHIR/R4/Patient/9000000009
2023/09/15 18:20:10.848091 tthttp.go:160: Request Headers 
map[Accept:[*/*] Content-Type:[application/json] X-Request-Id:[312d61f3-5e00-48c2-8a9e-a96588090006]]
2023/09/15 18:20:11.021553 tthttp.go:174: Server Response - Status Code 200 
{"resourceType":"Patient","id":"9000000009","identifier":[{"system":"https://fhir.nhs.uk/Id/nhs-number","value":"9000000009","extension":[{"url":"https://fhir.hl7.org.uk/StructureDefinition/Extension-UKCore-NHSNumberVerificationStatus","valueCodeableConcept":{"coding":[{"system":"https://fhir.hl7.org.uk/CodeSystem/UKCore-NHSNumberVerificationStatus","version":"1.0.0","code":"01","display":"Number present and verified"}]}}]}],"meta":{"versionId":"2","security":[{"system":"http://terminology.hl7.org/CodeSystem/v3-Confidentiality","code":"U","display":"unrestricted"}]},"name":[{"id":"123","use":"usual","period":{"start":"2020-01-01","end":"2021-12-31"},"given":["Jane"],"family":"Smith","prefix":["Mrs"],"suffix":["MBE"]}],"gender":"female","birthDate":"2010-10-22","multipleBirthInteger":1,"deceasedDateTime":"2010-10-22T00:00:00+00:00","generalPractitioner":[{"id":"254406A3","type":"Organization","identifier":{"system":"https://fhir.nhs.uk/Id/ods-organization-code","value":"Y12345","period":{"start":"2020-01-01","end":"2021-12-31"}}}],"managingOrganization":{"type":"Organization","identifier":{"system":"https://fhir.nhs.uk/Id/ods-organization-code","value":"Y12345","period":{"start":"2020-01-01","end":"2021-12-31"}}},"extension":[{"url":"https://fhir.hl7.org.uk/StructureDefinition/Extension-UKCore-NominatedPharmacy","valueReference":{"identifier":{"system":"https://fhir.nhs.uk/Id/ods-organization-code","value":"Y12345"}}},{"url":"https://fhir.hl7.org.uk/StructureDefinition/Extension-UKCore-PreferredDispenserOrganization","valueReference":{"identifier":{"system":"https://fhir.nhs.uk/Id/ods-organization-code","value":"Y23456"}}},{"url":"https://fhir.hl7.org.uk/StructureDefinition/Extension-UKCore-MedicalApplianceSupplier","valueReference":{"identifier":{"system":"https://fhir.nhs.uk/Id/ods-organization-code","value":"Y34567"}}},{"url":"https://fhir.hl7.org.uk/StructureDefinition/Extension-UKCore-DeathNotificationStatus","extension":[{"url":"deathNotificationStatus","valueCodeableConcept":{"coding":[{"system":"https://fhir.hl7.org.uk/CodeSystem/UKCore-DeathNotificationStatus","version":"1.0.0","code":"2","display":"Formal - death notice received from Registrar of Deaths"}]}},{"url":"systemEffectiveDate","valueDateTime":"2010-10-22T00:00:00+00:00"}]},{"url":"https://fhir.hl7.org.uk/StructureDefinition/Extension-UKCore-NHSCommunication","extension":[{"url":"language","valueCodeableConcept":{"coding":[{"system":"https://fhir.hl7.org.uk/CodeSystem/UKCore-HumanLanguage","version":"1.0.0","code":"fr","display":"French"}]}},{"url":"interpreterRequired","valueBoolean":true}]},{"url":"https://fhir.hl7.org.uk/StructureDefinition/Extension-UKCore-ContactPreference","extension":[{"url":"PreferredWrittenCommunicationFormat","valueCodeableConcept":{"coding":[{"system":"https://fhir.hl7.org.uk/CodeSystem/UKCore-PreferredWrittenCommunicationFormat","code":"12","display":"Braille"}]}},{"url":"PreferredContactMethod","valueCodeableConcept":{"coding":[{"system":"https://fhir.hl7.org.uk/CodeSystem/UKCore-PreferredContactMethod","code":"1","display":"Letter"}]}},{"url":"PreferredContactTimes","valueString":"Not after 7pm"}]},{"url":"http://hl7.org/fhir/StructureDefinition/patient-birthPlace","valueAddress":{"city":"Manchester","district":"Greater Manchester","country":"GBR"}},{"url":"https://fhir.nhs.uk/StructureDefinition/Extension-PDS-RemovalFromRegistration","extension":[{"url":"removalFromRegistrationCode","valueCodeableConcept":{"coding":[{"system":"https://fhir.nhs.uk/CodeSystem/PDS-RemovalReasonExitCode","code":"SCT","display":"Transferred to Scotland"}]}},{"url":"effectiveTime","valuePeriod":{"start":"2020-01-01T00:00:00+00:00","end":"2021-12-31T00:00:00+00:00"}}]}],"telecom":[{"id":"789","period":{"start":"2020-01-01","end":"2021-12-31"},"system":"phone","value":"01632960587","use":"home"},{"id":"790","period":{"start":"2019-01-01","end":"2022-12-31"},"system":"email","value":"jane.smith@example.com","use":"home"},{"id":"OC789","period":{"start":"2020-01-01","end":"2021-12-31"},"system":"other","value":"01632960587","use":"home","extension":[{"url":"https://fhir.hl7.org.uk/StructureDefinition/Extension-UKCore-OtherContactSystem","valueCoding":{"system":"https://fhir.hl7.org.uk/CodeSystem/UKCore-OtherContactSystem","code":"textphone","display":"Minicom (Textphone)"}}]}],"contact":[{"id":"C123","period":{"start":"2020-01-01","end":"2021-12-31"},"relationship":[{"coding":[{"system":"http://terminology.hl7.org/CodeSystem/v2-0131","code":"C","display":"Emergency Contact"}]}],"telecom":[{"system":"phone","value":"01632960587"}]}],"address":[{"id":"456","period":{"start":"2020-01-01","end":"2021-12-31"},"use":"home","line":["1 Trevelyan Square","Boar Lane","City Centre","Leeds","West Yorkshire"],"postalCode":"LS1 6AE","extension":[{"url":"https://fhir.hl7.org.uk/StructureDefinition/Extension-UKCore-AddressKey","extension":[{"url":"type","valueCoding":{"system":"https://fhir.hl7.org.uk/CodeSystem/UKCore-AddressKeyType","code":"PAF"}},{"url":"value","valueString":"12345678"}]},{"url":"https://fhir.hl7.org.uk/StructureDefinition/Extension-UKCore-AddressKey","extension":[{"url":"type","valueCoding":{"system":"https://fhir.hl7.org.uk/CodeSystem/UKCore-AddressKeyType","code":"UPRN"}},{"url":"value","valueString":"123456789012"}]}]},{"id":"T456","period":{"start":"2020-01-01","end":"2021-12-31"},"use":"temp","text":"Student Accommodation","line":["1 Trevelyan Square","Boar Lane","City Centre","Leeds","West Yorkshire"],"postalCode":"LS1 6AE","extension":[{"url":"https://fhir.hl7.org.uk/StructureDefinition/Extension-UKCore-AddressKey","extension":[{"url":"type","valueCoding":{"system":"https://fhir.hl7.org.uk/CodeSystem/UKCore-AddressKeyType","code":"PAF"}},{"url":"value","valueString":"12345678"}]},{"url":"https://fhir.hl7.org.uk/StructureDefinition/Extension-UKCore-AddressKey","extension":[{"url":"type","valueCoding":{"system":"https://fhir.hl7.org.uk/CodeSystem/UKCore-AddressKeyType","code":"UPRN"}},{"url":"value","valueString":"123456789012"}]}]}]}
2023/09/15 18:20:11.210143 tttmplts.go:100: Caching 24 Templates
2023/09/15 18:20:11.216078 tttmplts.go:87: Processing Template allpatientSrvs_tmplt
2023/09/15 18:20:11.284227 ttproxy.go:149: Response Status Code 200
2023/09/15 18:24:03.464528 ttserver.go:52: ICB Workflow Service stopped
2023/09/15 18:24:05.501127 ttutil.go:133: -----------------------------------------------------------------------------------
2023/09/15 18:24:05.501608 ttdb.go:51: Opening DB Connection to mysql instance
User: root
Host: tuk.coil1nnpqdlr.eu-west-1.rds.amazonaws.com
Port: :3306
Name: tuk
Connect Timeout 2s
Read Timeout 5s
2023/09/15 18:24:05.501720 ttdb.go:54: Opened Database
2023/09/15 18:24:05.677435 ttdb.go:379: Persisting Template dsubcancel_tmplt
2023/09/15 18:24:05.739722 ttdb.go:385: Persisted Template dsubcancel_tmplt
2023/09/15 18:24:05.739764 ttdb.go:366: Persisted Template dsubcancel_tmplt.xml
2023/09/15 18:24:05.803488 ttdb.go:379: Persisting Template cgl_tmplt
2023/09/15 18:24:05.898277 ttdb.go:385: Persisted Template cgl_tmplt
2023/09/15 18:24:05.898319 ttdb.go:366: Persisted Template cgl_tmplt.html
2023/09/15 18:24:05.960504 ttdb.go:379: Persisting Template pdssearch_tmplt
2023/09/15 18:24:06.025978 ttdb.go:385: Persisted Template pdssearch_tmplt
2023/09/15 18:24:06.026044 ttdb.go:366: Persisted Template pdssearch_tmplt.html
2023/09/15 18:24:06.088761 ttdb.go:379: Persisting Template dsubsubscribe_tmplt
2023/09/15 18:24:06.151375 ttdb.go:385: Persisted Template dsubsubscribe_tmplt
2023/09/15 18:24:06.151425 ttdb.go:366: Persisted Template dsubsubscribe_tmplt.xml
2023/09/15 18:24:06.213914 ttdb.go:379: Persisting Template notification_tmplt
2023/09/15 18:24:06.277203 ttdb.go:385: Persisted Template notification_tmplt
2023/09/15 18:24:06.277253 ttdb.go:366: Persisted Template notification_tmplt.txt
2023/09/15 18:24:06.340769 ttdb.go:379: Persisting Template wfstate2t_tmplt
2023/09/15 18:24:06.459064 ttdb.go:385: Persisted Template wfstate2t_tmplt
2023/09/15 18:24:06.459155 ttdb.go:366: Persisted Template wfstate2t_tmplt.html
2023/09/15 18:24:06.523005 ttdb.go:379: Persisting Template publishfile2t_tmplt
2023/09/15 18:24:06.589076 ttdb.go:385: Persisted Template publishfile2t_tmplt
2023/09/15 18:24:06.589251 ttdb.go:366: Persisted Template publishfile2t_tmplt.html
2023/09/15 18:24:06.654410 ttdb.go:379: Persisting Template react_tmplt
2023/09/15 18:24:06.719858 ttdb.go:385: Persisted Template react_tmplt
2023/09/15 18:24:06.720036 ttdb.go:366: Persisted Template react_tmplt.html
2023/09/15 18:24:06.783682 ttdb.go:379: Persisting Template pdsretrieve_tmplt
2023/09/15 18:24:06.851682 ttdb.go:385: Persisted Template pdsretrieve_tmplt
2023/09/15 18:24:06.851831 ttdb.go:366: Persisted Template pdsretrieve_tmplt.html
2023/09/15 18:24:06.916054 ttdb.go:379: Persisting Template allpatientSrvs_tmplt
2023/09/15 18:24:06.979805 ttdb.go:385: Persisted Template allpatientSrvs_tmplt
2023/09/15 18:24:06.979947 ttdb.go:366: Persisted Template allpatientSrvs_tmplt.html
2023/09/15 18:24:07.043855 ttdb.go:379: Persisting Template spa2t_tmplt
2023/09/15 18:24:07.121032 ttdb.go:385: Persisted Template spa2t_tmplt
2023/09/15 18:24:07.121167 ttdb.go:366: Persisted Template spa2t_tmplt.html
2023/09/15 18:24:07.184157 ttdb.go:379: Persisting Template xdw2t_tmplt
2023/09/15 18:24:07.262919 ttdb.go:385: Persisted Template xdw2t_tmplt
2023/09/15 18:24:07.263056 ttdb.go:366: Persisted Template xdw2t_tmplt.html
2023/09/15 18:24:07.328565 ttdb.go:379: Persisting Template spaheader2t_tmplt
2023/09/15 18:24:07.395180 ttdb.go:385: Persisted Template spaheader2t_tmplt
2023/09/15 18:24:07.395203 ttdb.go:366: Persisted Template spaheader2t_tmplt.html
2023/09/15 18:24:07.461561 ttdb.go:379: Persisting Template pds_tmplt
2023/09/15 18:24:07.526690 ttdb.go:385: Persisted Template pds_tmplt
2023/09/15 18:24:07.526771 ttdb.go:366: Persisted Template pds_tmplt.html
2023/09/15 18:24:07.589190 ttdb.go:379: Persisting Template error_tmplt
2023/09/15 18:24:07.651831 ttdb.go:385: Persisted Template error_tmplt
2023/09/15 18:24:07.651936 ttdb.go:366: Persisted Template error_tmplt.html
2023/09/15 18:24:07.720549 ttdb.go:379: Persisting Template dsuback_tmplt
2023/09/15 18:24:07.792779 ttdb.go:385: Persisted Template dsuback_tmplt
2023/09/15 18:24:07.792894 ttdb.go:366: Persisted Template dsuback_tmplt.xml
2023/09/15 18:24:07.855051 ttdb.go:379: Persisting Template pixm_tmplt
2023/09/15 18:24:07.923640 ttdb.go:385: Persisted Template pixm_tmplt
2023/09/15 18:24:07.923840 ttdb.go:366: Persisted Template pixm_tmplt.html
2023/09/15 18:24:07.987946 ttdb.go:379: Persisting Template subscriptions2t_tmplt
2023/09/15 18:24:08.056305 ttdb.go:385: Persisted Template subscriptions2t_tmplt
2023/09/15 18:24:08.056549 ttdb.go:366: Persisted Template subscriptions2t_tmplt.html
2023/09/15 18:24:08.119251 ttdb.go:379: Persisting Template codemaps2t_tmplt
2023/09/15 18:24:08.189087 ttdb.go:385: Persisted Template codemaps2t_tmplt
2023/09/15 18:24:08.189226 ttdb.go:366: Persisted Template codemaps2t_tmplt.html
2023/09/15 18:24:08.252977 ttdb.go:379: Persisting Template mhdpublish_tmplt
2023/09/15 18:24:08.321423 ttdb.go:385: Persisted Template mhdpublish_tmplt
2023/09/15 18:24:08.321570 ttdb.go:366: Persisted Template mhdpublish_tmplt.json
2023/09/15 18:24:08.384809 ttdb.go:379: Persisting Template events_tmplt
2023/09/15 18:24:08.452397 ttdb.go:385: Persisted Template events_tmplt
2023/09/15 18:24:08.452528 ttdb.go:366: Persisted Template events_tmplt.html
2023/09/15 18:24:08.518952 ttdb.go:379: Persisting Template uploadfile2t_tmplt
2023/09/15 18:24:08.583354 ttdb.go:385: Persisted Template uploadfile2t_tmplt
2023/09/15 18:24:08.583461 ttdb.go:366: Persisted Template uploadfile2t_tmplt.html
2023/09/15 18:24:08.583753 ttserver.go:40: Starting ICB Workflow Service. Service Endpoint http://MacBook-Pro-3.lan:8080/
2023/09/15 18:24:12.019077 ttgethandler.go:10: Processing new GET Request
2023/09/15 18:24:12.019123 ttproxy.go:138: 	Request Query Params
2023/09/15 18:24:12.019289 ttutil.go:140: 	{
  "User": "ian.thomas",
  "Org": "2tsolutions",
  "Role": "clinical",
  "Nhs": "9000000009"
}
2023/09/15 18:24:12.019299 ttgethandler.go:15: Path = /beta/spa/consumer/patient
2023/09/15 18:24:12.019317 tttmplts.go:37: CGL Worker starting
2023/09/15 18:24:12.019329 tttmplts.go:30: PIXm Worker starting
2023/09/15 18:24:12.019442 tthttp.go:15: Creating PIXm PDQ - Server URL http://lac-demo-01.tianispirit.co.uk:8081/SpiritPIXFhir/r4/Patient?identifier=2.16.840.1.113883.2.1.4.1%7C9000000009
2023/09/15 18:24:12.020471 tthttp.go:160: Request Headers 
map[Content-Type:[application/json]]
2023/09/15 18:24:12.020524 tthttp.go:160: Request Headers 
map[Accept:[application/json] X-Api-Key:[FNhb#OhxWiEiMdf+@6085k5Zmt] X-Api-Secret:[9710ea0fb4ffb5d56c2e62c71c30bdfhjsyr56a79d]]
2023/09/15 18:24:12.072657 tthttp.go:174: Server Response - Status Code 0 
2023/09/15 18:24:12.072776 tttmplts.go:32: PIXm Worker done
2023/09/15 18:24:12.072791 tttmplts.go:33: PIXm Worker Status Code 408
2023/09/15 18:24:12.199432 tthttp.go:174: Server Response - Status Code 404 
{"errors":[{"message":"No clients matching nhs number 9000000009","path":"\/"}],"status":404}
2023/09/15 18:24:12.205385 ttutil.go:140: 	{
  "data": {
    "client": {
      "basicDetails": {
        "address": {},
        "name": {}
      },
      "bbvInformation": {},
      "drugTestResults": {
        "results": {}
      },
      "riskInformation": {
        "mentalHealthDomain": {},
        "riskOfHarmToSelfDomain": {},
        "socialDomain": {},
        "substanceMisuseDomain": {}
      },
      "safeguardingInformation": {}
    },
    "keyWorker": {
      "name": {}
    }
  }
}
2023/09/15 18:24:12.205494 tttmplts.go:39: CGL Worker done
2023/09/15 18:24:12.205525 tttmplts.go:40: CGL Worker Status Code 404
2023/09/15 18:24:12.205779 tthttp.go:56: Creating PDS Search Request - Server URL https://sandbox.api.service.nhs.uk/personal-demographics/FHIR/R4/Patient/9000000009
2023/09/15 18:24:12.205944 tthttp.go:160: Request Headers 
map[Accept:[*/*] Content-Type:[application/json] X-Request-Id:[38c0d0fe-bade-47fc-b4a0-abc0c77832b7]]
2023/09/15 18:24:12.406736 tthttp.go:174: Server Response - Status Code 200 
{"resourceType":"Patient","id":"9000000009","identifier":[{"system":"https://fhir.nhs.uk/Id/nhs-number","value":"9000000009","extension":[{"url":"https://fhir.hl7.org.uk/StructureDefinition/Extension-UKCore-NHSNumberVerificationStatus","valueCodeableConcept":{"coding":[{"system":"https://fhir.hl7.org.uk/CodeSystem/UKCore-NHSNumberVerificationStatus","version":"1.0.0","code":"01","display":"Number present and verified"}]}}]}],"meta":{"versionId":"2","security":[{"system":"http://terminology.hl7.org/CodeSystem/v3-Confidentiality","code":"U","display":"unrestricted"}]},"name":[{"id":"123","use":"usual","period":{"start":"2020-01-01","end":"2021-12-31"},"given":["Jane"],"family":"Smith","prefix":["Mrs"],"suffix":["MBE"]}],"gender":"female","birthDate":"2010-10-22","multipleBirthInteger":1,"deceasedDateTime":"2010-10-22T00:00:00+00:00","generalPractitioner":[{"id":"254406A3","type":"Organization","identifier":{"system":"https://fhir.nhs.uk/Id/ods-organization-code","value":"Y12345","period":{"start":"2020-01-01","end":"2021-12-31"}}}],"managingOrganization":{"type":"Organization","identifier":{"system":"https://fhir.nhs.uk/Id/ods-organization-code","value":"Y12345","period":{"start":"2020-01-01","end":"2021-12-31"}}},"extension":[{"url":"https://fhir.hl7.org.uk/StructureDefinition/Extension-UKCore-NominatedPharmacy","valueReference":{"identifier":{"system":"https://fhir.nhs.uk/Id/ods-organization-code","value":"Y12345"}}},{"url":"https://fhir.hl7.org.uk/StructureDefinition/Extension-UKCore-PreferredDispenserOrganization","valueReference":{"identifier":{"system":"https://fhir.nhs.uk/Id/ods-organization-code","value":"Y23456"}}},{"url":"https://fhir.hl7.org.uk/StructureDefinition/Extension-UKCore-MedicalApplianceSupplier","valueReference":{"identifier":{"system":"https://fhir.nhs.uk/Id/ods-organization-code","value":"Y34567"}}},{"url":"https://fhir.hl7.org.uk/StructureDefinition/Extension-UKCore-DeathNotificationStatus","extension":[{"url":"deathNotificationStatus","valueCodeableConcept":{"coding":[{"system":"https://fhir.hl7.org.uk/CodeSystem/UKCore-DeathNotificationStatus","version":"1.0.0","code":"2","display":"Formal - death notice received from Registrar of Deaths"}]}},{"url":"systemEffectiveDate","valueDateTime":"2010-10-22T00:00:00+00:00"}]},{"url":"https://fhir.hl7.org.uk/StructureDefinition/Extension-UKCore-NHSCommunication","extension":[{"url":"language","valueCodeableConcept":{"coding":[{"system":"https://fhir.hl7.org.uk/CodeSystem/UKCore-HumanLanguage","version":"1.0.0","code":"fr","display":"French"}]}},{"url":"interpreterRequired","valueBoolean":true}]},{"url":"https://fhir.hl7.org.uk/StructureDefinition/Extension-UKCore-ContactPreference","extension":[{"url":"PreferredWrittenCommunicationFormat","valueCodeableConcept":{"coding":[{"system":"https://fhir.hl7.org.uk/CodeSystem/UKCore-PreferredWrittenCommunicationFormat","code":"12","display":"Braille"}]}},{"url":"PreferredContactMethod","valueCodeableConcept":{"coding":[{"system":"https://fhir.hl7.org.uk/CodeSystem/UKCore-PreferredContactMethod","code":"1","display":"Letter"}]}},{"url":"PreferredContactTimes","valueString":"Not after 7pm"}]},{"url":"http://hl7.org/fhir/StructureDefinition/patient-birthPlace","valueAddress":{"city":"Manchester","district":"Greater Manchester","country":"GBR"}},{"url":"https://fhir.nhs.uk/StructureDefinition/Extension-PDS-RemovalFromRegistration","extension":[{"url":"removalFromRegistrationCode","valueCodeableConcept":{"coding":[{"system":"https://fhir.nhs.uk/CodeSystem/PDS-RemovalReasonExitCode","code":"SCT","display":"Transferred to Scotland"}]}},{"url":"effectiveTime","valuePeriod":{"start":"2020-01-01T00:00:00+00:00","end":"2021-12-31T00:00:00+00:00"}}]}],"telecom":[{"id":"789","period":{"start":"2020-01-01","end":"2021-12-31"},"system":"phone","value":"01632960587","use":"home"},{"id":"790","period":{"start":"2019-01-01","end":"2022-12-31"},"system":"email","value":"jane.smith@example.com","use":"home"},{"id":"OC789","period":{"start":"2020-01-01","end":"2021-12-31"},"system":"other","value":"01632960587","use":"home","extension":[{"url":"https://fhir.hl7.org.uk/StructureDefinition/Extension-UKCore-OtherContactSystem","valueCoding":{"system":"https://fhir.hl7.org.uk/CodeSystem/UKCore-OtherContactSystem","code":"textphone","display":"Minicom (Textphone)"}}]}],"contact":[{"id":"C123","period":{"start":"2020-01-01","end":"2021-12-31"},"relationship":[{"coding":[{"system":"http://terminology.hl7.org/CodeSystem/v2-0131","code":"C","display":"Emergency Contact"}]}],"telecom":[{"system":"phone","value":"01632960587"}]}],"address":[{"id":"456","period":{"start":"2020-01-01","end":"2021-12-31"},"use":"home","line":["1 Trevelyan Square","Boar Lane","City Centre","Leeds","West Yorkshire"],"postalCode":"LS1 6AE","extension":[{"url":"https://fhir.hl7.org.uk/StructureDefinition/Extension-UKCore-AddressKey","extension":[{"url":"type","valueCoding":{"system":"https://fhir.hl7.org.uk/CodeSystem/UKCore-AddressKeyType","code":"PAF"}},{"url":"value","valueString":"12345678"}]},{"url":"https://fhir.hl7.org.uk/StructureDefinition/Extension-UKCore-AddressKey","extension":[{"url":"type","valueCoding":{"system":"https://fhir.hl7.org.uk/CodeSystem/UKCore-AddressKeyType","code":"UPRN"}},{"url":"value","valueString":"123456789012"}]}]},{"id":"T456","period":{"start":"2020-01-01","end":"2021-12-31"},"use":"temp","text":"Student Accommodation","line":["1 Trevelyan Square","Boar Lane","City Centre","Leeds","West Yorkshire"],"postalCode":"LS1 6AE","extension":[{"url":"https://fhir.hl7.org.uk/StructureDefinition/Extension-UKCore-AddressKey","extension":[{"url":"type","valueCoding":{"system":"https://fhir.hl7.org.uk/CodeSystem/UKCore-AddressKeyType","code":"PAF"}},{"url":"value","valueString":"12345678"}]},{"url":"https://fhir.hl7.org.uk/StructureDefinition/Extension-UKCore-AddressKey","extension":[{"url":"type","valueCoding":{"system":"https://fhir.hl7.org.uk/CodeSystem/UKCore-AddressKeyType","code":"UPRN"}},{"url":"value","valueString":"123456789012"}]}]}]}
2023/09/15 18:24:12.603843 tttmplts.go:100: Caching 24 Templates
2023/09/15 18:24:12.616465 tttmplts.go:87: Processing Template allpatientSrvs_tmplt
2023/09/15 18:24:12.688999 ttproxy.go:149: Response Status Code 200
2023/09/15 18:24:35.185248 ttgethandler.go:10: Processing new GET Request
2023/09/15 18:24:35.185430 ttproxy.go:138: 	Request Query Params
2023/09/15 18:24:35.185528 ttutil.go:140: 	{
  "User": "ian.thomas",
  "Org": "2tsolutions",
  "Role": "clinical",
  "Nhs": "9000000009"
}
2023/09/15 18:24:35.185565 ttgethandler.go:15: Path = /beta/spa/consumer/patient
2023/09/15 18:24:35.185621 tttmplts.go:37: CGL Worker starting
2023/09/15 18:24:35.185627 tttmplts.go:30: PIXm Worker starting
2023/09/15 18:24:35.185770 tthttp.go:15: Creating PIXm PDQ - Server URL http://lac-demo-01.tianispirit.co.uk:8081/SpiritPIXFhir/r4/Patient?identifier=2.16.840.1.113883.2.1.4.1%7C9000000009
2023/09/15 18:24:35.185950 tthttp.go:160: Request Headers 
map[Content-Type:[application/json]]
2023/09/15 18:24:35.186068 tthttp.go:160: Request Headers 
map[Accept:[application/json] X-Api-Key:[FNhb#OhxWiEiMdf+@6085k5Zmt] X-Api-Secret:[9710ea0fb4ffb5d56c2e62c71c30bdfhjsyr56a79d]]
2023/09/15 18:24:35.216683 tthttp.go:174: Server Response - Status Code 0 
2023/09/15 18:24:35.216861 tttmplts.go:32: PIXm Worker done
2023/09/15 18:24:35.216904 tttmplts.go:33: PIXm Worker Status Code 408
2023/09/15 18:24:35.243754 tthttp.go:174: Server Response - Status Code 404 
{"errors":[{"message":"No clients matching nhs number 9000000009","path":"\/"}],"status":404}
2023/09/15 18:24:35.244029 ttutil.go:140: 	{
  "data": {
    "client": {
      "basicDetails": {
        "address": {},
        "name": {}
      },
      "bbvInformation": {},
      "drugTestResults": {
        "results": {}
      },
      "riskInformation": {
        "mentalHealthDomain": {},
        "riskOfHarmToSelfDomain": {},
        "socialDomain": {},
        "substanceMisuseDomain": {}
      },
      "safeguardingInformation": {}
    },
    "keyWorker": {
      "name": {}
    }
  }
}
2023/09/15 18:24:35.244082 tttmplts.go:39: CGL Worker done
2023/09/15 18:24:35.244106 tttmplts.go:40: CGL Worker Status Code 404
2023/09/15 18:24:35.244142 tthttp.go:56: Creating PDS Search Request - Server URL https://sandbox.api.service.nhs.uk/personal-demographics/FHIR/R4/Patient/9000000009
2023/09/15 18:24:35.244270 tthttp.go:160: Request Headers 
map[Accept:[*/*] Content-Type:[application/json] X-Request-Id:[e2da9cef-4ad9-4437-a7c9-d047e8986968]]
2023/09/15 18:24:35.346850 tthttp.go:174: Server Response - Status Code 200 
{"resourceType":"Patient","id":"9000000009","identifier":[{"system":"https://fhir.nhs.uk/Id/nhs-number","value":"9000000009","extension":[{"url":"https://fhir.hl7.org.uk/StructureDefinition/Extension-UKCore-NHSNumberVerificationStatus","valueCodeableConcept":{"coding":[{"system":"https://fhir.hl7.org.uk/CodeSystem/UKCore-NHSNumberVerificationStatus","version":"1.0.0","code":"01","display":"Number present and verified"}]}}]}],"meta":{"versionId":"2","security":[{"system":"http://terminology.hl7.org/CodeSystem/v3-Confidentiality","code":"U","display":"unrestricted"}]},"name":[{"id":"123","use":"usual","period":{"start":"2020-01-01","end":"2021-12-31"},"given":["Jane"],"family":"Smith","prefix":["Mrs"],"suffix":["MBE"]}],"gender":"female","birthDate":"2010-10-22","multipleBirthInteger":1,"deceasedDateTime":"2010-10-22T00:00:00+00:00","generalPractitioner":[{"id":"254406A3","type":"Organization","identifier":{"system":"https://fhir.nhs.uk/Id/ods-organization-code","value":"Y12345","period":{"start":"2020-01-01","end":"2021-12-31"}}}],"managingOrganization":{"type":"Organization","identifier":{"system":"https://fhir.nhs.uk/Id/ods-organization-code","value":"Y12345","period":{"start":"2020-01-01","end":"2021-12-31"}}},"extension":[{"url":"https://fhir.hl7.org.uk/StructureDefinition/Extension-UKCore-NominatedPharmacy","valueReference":{"identifier":{"system":"https://fhir.nhs.uk/Id/ods-organization-code","value":"Y12345"}}},{"url":"https://fhir.hl7.org.uk/StructureDefinition/Extension-UKCore-PreferredDispenserOrganization","valueReference":{"identifier":{"system":"https://fhir.nhs.uk/Id/ods-organization-code","value":"Y23456"}}},{"url":"https://fhir.hl7.org.uk/StructureDefinition/Extension-UKCore-MedicalApplianceSupplier","valueReference":{"identifier":{"system":"https://fhir.nhs.uk/Id/ods-organization-code","value":"Y34567"}}},{"url":"https://fhir.hl7.org.uk/StructureDefinition/Extension-UKCore-DeathNotificationStatus","extension":[{"url":"deathNotificationStatus","valueCodeableConcept":{"coding":[{"system":"https://fhir.hl7.org.uk/CodeSystem/UKCore-DeathNotificationStatus","version":"1.0.0","code":"2","display":"Formal - death notice received from Registrar of Deaths"}]}},{"url":"systemEffectiveDate","valueDateTime":"2010-10-22T00:00:00+00:00"}]},{"url":"https://fhir.hl7.org.uk/StructureDefinition/Extension-UKCore-NHSCommunication","extension":[{"url":"language","valueCodeableConcept":{"coding":[{"system":"https://fhir.hl7.org.uk/CodeSystem/UKCore-HumanLanguage","version":"1.0.0","code":"fr","display":"French"}]}},{"url":"interpreterRequired","valueBoolean":true}]},{"url":"https://fhir.hl7.org.uk/StructureDefinition/Extension-UKCore-ContactPreference","extension":[{"url":"PreferredWrittenCommunicationFormat","valueCodeableConcept":{"coding":[{"system":"https://fhir.hl7.org.uk/CodeSystem/UKCore-PreferredWrittenCommunicationFormat","code":"12","display":"Braille"}]}},{"url":"PreferredContactMethod","valueCodeableConcept":{"coding":[{"system":"https://fhir.hl7.org.uk/CodeSystem/UKCore-PreferredContactMethod","code":"1","display":"Letter"}]}},{"url":"PreferredContactTimes","valueString":"Not after 7pm"}]},{"url":"http://hl7.org/fhir/StructureDefinition/patient-birthPlace","valueAddress":{"city":"Manchester","district":"Greater Manchester","country":"GBR"}},{"url":"https://fhir.nhs.uk/StructureDefinition/Extension-PDS-RemovalFromRegistration","extension":[{"url":"removalFromRegistrationCode","valueCodeableConcept":{"coding":[{"system":"https://fhir.nhs.uk/CodeSystem/PDS-RemovalReasonExitCode","code":"SCT","display":"Transferred to Scotland"}]}},{"url":"effectiveTime","valuePeriod":{"start":"2020-01-01T00:00:00+00:00","end":"2021-12-31T00:00:00+00:00"}}]}],"telecom":[{"id":"789","period":{"start":"2020-01-01","end":"2021-12-31"},"system":"phone","value":"01632960587","use":"home"},{"id":"790","period":{"start":"2019-01-01","end":"2022-12-31"},"system":"email","value":"jane.smith@example.com","use":"home"},{"id":"OC789","period":{"start":"2020-01-01","end":"2021-12-31"},"system":"other","value":"01632960587","use":"home","extension":[{"url":"https://fhir.hl7.org.uk/StructureDefinition/Extension-UKCore-OtherContactSystem","valueCoding":{"system":"https://fhir.hl7.org.uk/CodeSystem/UKCore-OtherContactSystem","code":"textphone","display":"Minicom (Textphone)"}}]}],"contact":[{"id":"C123","period":{"start":"2020-01-01","end":"2021-12-31"},"relationship":[{"coding":[{"system":"http://terminology.hl7.org/CodeSystem/v2-0131","code":"C","display":"Emergency Contact"}]}],"telecom":[{"system":"phone","value":"01632960587"}]}],"address":[{"id":"456","period":{"start":"2020-01-01","end":"2021-12-31"},"use":"home","line":["1 Trevelyan Square","Boar Lane","City Centre","Leeds","West Yorkshire"],"postalCode":"LS1 6AE","extension":[{"url":"https://fhir.hl7.org.uk/StructureDefinition/Extension-UKCore-AddressKey","extension":[{"url":"type","valueCoding":{"system":"https://fhir.hl7.org.uk/CodeSystem/UKCore-AddressKeyType","code":"PAF"}},{"url":"value","valueString":"12345678"}]},{"url":"https://fhir.hl7.org.uk/StructureDefinition/Extension-UKCore-AddressKey","extension":[{"url":"type","valueCoding":{"system":"https://fhir.hl7.org.uk/CodeSystem/UKCore-AddressKeyType","code":"UPRN"}},{"url":"value","valueString":"123456789012"}]}]},{"id":"T456","period":{"start":"2020-01-01","end":"2021-12-31"},"use":"temp","text":"Student Accommodation","line":["1 Trevelyan Square","Boar Lane","City Centre","Leeds","West Yorkshire"],"postalCode":"LS1 6AE","extension":[{"url":"https://fhir.hl7.org.uk/StructureDefinition/Extension-UKCore-AddressKey","extension":[{"url":"type","valueCoding":{"system":"https://fhir.hl7.org.uk/CodeSystem/UKCore-AddressKeyType","code":"PAF"}},{"url":"value","valueString":"12345678"}]},{"url":"https://fhir.hl7.org.uk/StructureDefinition/Extension-UKCore-AddressKey","extension":[{"url":"type","valueCoding":{"system":"https://fhir.hl7.org.uk/CodeSystem/UKCore-AddressKeyType","code":"UPRN"}},{"url":"value","valueString":"123456789012"}]}]}]}
2023/09/15 18:24:35.347444 tttmplts.go:87: Processing Template allpatientSrvs_tmplt
2023/09/15 18:24:35.353188 ttproxy.go:149: Response Status Code 200
2023/09/15 18:27:28.303515 ttserver.go:52: ICB Workflow Service stopped
2023/09/15 18:27:30.050944 ttutil.go:133: -----------------------------------------------------------------------------------
2023/09/15 18:27:30.051295 ttdb.go:51: Opening DB Connection to mysql instance
User: root
Host: tuk.coil1nnpqdlr.eu-west-1.rds.amazonaws.com
Port: :3306
Name: tuk
Connect Timeout 2s
Read Timeout 5s
2023/09/15 18:27:30.051409 ttdb.go:54: Opened Database
2023/09/15 18:27:30.239565 ttdb.go:379: Persisting Template dsubcancel_tmplt
2023/09/15 18:27:30.302492 ttdb.go:385: Persisted Template dsubcancel_tmplt
2023/09/15 18:27:30.302528 ttdb.go:366: Persisted Template dsubcancel_tmplt.xml
2023/09/15 18:27:30.366873 ttdb.go:379: Persisting Template cgl_tmplt
2023/09/15 18:27:30.464998 ttdb.go:385: Persisted Template cgl_tmplt
2023/09/15 18:27:30.465040 ttdb.go:366: Persisted Template cgl_tmplt.html
2023/09/15 18:27:30.528934 ttdb.go:379: Persisting Template pdssearch_tmplt
2023/09/15 18:27:30.594809 ttdb.go:385: Persisted Template pdssearch_tmplt
2023/09/15 18:27:30.594847 ttdb.go:366: Persisted Template pdssearch_tmplt.html
2023/09/15 18:27:30.657539 ttdb.go:379: Persisting Template dsubsubscribe_tmplt
2023/09/15 18:27:30.722776 ttdb.go:385: Persisted Template dsubsubscribe_tmplt
2023/09/15 18:27:30.722856 ttdb.go:366: Persisted Template dsubsubscribe_tmplt.xml
2023/09/15 18:27:30.785335 ttdb.go:379: Persisting Template notification_tmplt
2023/09/15 18:27:30.849207 ttdb.go:385: Persisted Template notification_tmplt
2023/09/15 18:27:30.849370 ttdb.go:366: Persisted Template notification_tmplt.txt
2023/09/15 18:27:30.916699 ttdb.go:379: Persisting Template wfstate2t_tmplt
2023/09/15 18:27:31.037339 ttdb.go:385: Persisted Template wfstate2t_tmplt
2023/09/15 18:27:31.037446 ttdb.go:366: Persisted Template wfstate2t_tmplt.html
2023/09/15 18:27:31.099931 ttdb.go:379: Persisting Template publishfile2t_tmplt
2023/09/15 18:27:31.164010 ttdb.go:385: Persisted Template publishfile2t_tmplt
2023/09/15 18:27:31.164183 ttdb.go:366: Persisted Template publishfile2t_tmplt.html
2023/09/15 18:27:31.227597 ttdb.go:379: Persisting Template react_tmplt
2023/09/15 18:27:31.290330 ttdb.go:385: Persisted Template react_tmplt
2023/09/15 18:27:31.290552 ttdb.go:366: Persisted Template react_tmplt.html
2023/09/15 18:27:31.358649 ttdb.go:379: Persisting Template pdsretrieve_tmplt
2023/09/15 18:27:31.430260 ttdb.go:385: Persisted Template pdsretrieve_tmplt
2023/09/15 18:27:31.430410 ttdb.go:366: Persisted Template pdsretrieve_tmplt.html
2023/09/15 18:27:31.494351 ttdb.go:379: Persisting Template allpatientSrvs_tmplt
2023/09/15 18:27:31.558376 ttdb.go:385: Persisted Template allpatientSrvs_tmplt
2023/09/15 18:27:31.558400 ttdb.go:366: Persisted Template allpatientSrvs_tmplt.html
2023/09/15 18:27:31.621742 ttdb.go:379: Persisting Template spa2t_tmplt
2023/09/15 18:27:31.697447 ttdb.go:385: Persisted Template spa2t_tmplt
2023/09/15 18:27:31.697472 ttdb.go:366: Persisted Template spa2t_tmplt.html
2023/09/15 18:27:31.760902 ttdb.go:379: Persisting Template xdw2t_tmplt
2023/09/15 18:27:31.839961 ttdb.go:385: Persisted Template xdw2t_tmplt
2023/09/15 18:27:31.840072 ttdb.go:366: Persisted Template xdw2t_tmplt.html
2023/09/15 18:27:31.903258 ttdb.go:379: Persisting Template spaheader2t_tmplt
2023/09/15 18:27:31.974450 ttdb.go:385: Persisted Template spaheader2t_tmplt
2023/09/15 18:27:31.974582 ttdb.go:366: Persisted Template spaheader2t_tmplt.html
2023/09/15 18:27:32.038188 ttdb.go:379: Persisting Template pds_tmplt
2023/09/15 18:27:32.103183 ttdb.go:385: Persisted Template pds_tmplt
2023/09/15 18:27:32.103328 ttdb.go:366: Persisted Template pds_tmplt.html
2023/09/15 18:27:32.167745 ttdb.go:379: Persisting Template error_tmplt
2023/09/15 18:27:32.230748 ttdb.go:385: Persisted Template error_tmplt
2023/09/15 18:27:32.231120 ttdb.go:366: Persisted Template error_tmplt.html
2023/09/15 18:27:32.297400 ttdb.go:379: Persisting Template dsuback_tmplt
2023/09/15 18:27:32.361869 ttdb.go:385: Persisted Template dsuback_tmplt
2023/09/15 18:27:32.362026 ttdb.go:366: Persisted Template dsuback_tmplt.xml
2023/09/15 18:27:32.426867 ttdb.go:379: Persisting Template pixm_tmplt
2023/09/15 18:27:32.494245 ttdb.go:385: Persisted Template pixm_tmplt
2023/09/15 18:27:32.494397 ttdb.go:366: Persisted Template pixm_tmplt.html
2023/09/15 18:27:32.558861 ttdb.go:379: Persisting Template subscriptions2t_tmplt
2023/09/15 18:27:32.624694 ttdb.go:385: Persisted Template subscriptions2t_tmplt
2023/09/15 18:27:32.624852 ttdb.go:366: Persisted Template subscriptions2t_tmplt.html
2023/09/15 18:27:32.687835 ttdb.go:379: Persisting Template codemaps2t_tmplt
2023/09/15 18:27:32.757458 ttdb.go:385: Persisted Template codemaps2t_tmplt
2023/09/15 18:27:32.757615 ttdb.go:366: Persisted Template codemaps2t_tmplt.html
2023/09/15 18:27:32.820078 ttdb.go:379: Persisting Template mhdpublish_tmplt
2023/09/15 18:27:32.890870 ttdb.go:385: Persisted Template mhdpublish_tmplt
2023/09/15 18:27:32.891095 ttdb.go:366: Persisted Template mhdpublish_tmplt.json
2023/09/15 18:27:32.954355 ttdb.go:379: Persisting Template events_tmplt
2023/09/15 18:27:33.028709 ttdb.go:385: Persisted Template events_tmplt
2023/09/15 18:27:33.028863 ttdb.go:366: Persisted Template events_tmplt.html
2023/09/15 18:27:33.094328 ttdb.go:379: Persisting Template uploadfile2t_tmplt
2023/09/15 18:27:33.158779 ttdb.go:385: Persisted Template uploadfile2t_tmplt
2023/09/15 18:27:33.158932 ttdb.go:366: Persisted Template uploadfile2t_tmplt.html
2023/09/15 18:27:33.159200 ttserver.go:40: Starting ICB Workflow Service. Service Endpoint http://MacBook-Pro-3.lan:8080/
2023/09/15 18:27:36.534117 ttgethandler.go:10: Processing new GET Request
2023/09/15 18:27:36.534363 ttproxy.go:138: 	Request Query Params
2023/09/15 18:27:36.535212 ttutil.go:140: 	{
  "User": "ian.thomas",
  "Org": "2tsolutions",
  "Role": "clinical",
  "Nhs": "9000000009"
}
2023/09/15 18:27:36.535406 ttgethandler.go:15: Path = /beta/spa/consumer/patient
2023/09/15 18:27:36.535505 tttmplts.go:37: CGL Worker starting
2023/09/15 18:27:36.535591 tttmplts.go:30: PIXm Worker starting
2023/09/15 18:27:36.536888 tthttp.go:15: Creating PIXm PDQ - Server URL http://lac-demo-01.tianispirit.co.uk:8081/SpiritPIXFhir/r4/Patient?identifier=2.16.840.1.113883.2.1.4.1%7C9000000009
2023/09/15 18:27:36.539332 tthttp.go:160: Request Headers 
map[Content-Type:[application/json]]
2023/09/15 18:27:36.539377 tthttp.go:160: Request Headers 
map[Accept:[application/json] X-Api-Key:[FNhb#OhxWiEiMdf+@6085k5Zmt] X-Api-Secret:[9710ea0fb4ffb5d56c2e62c71c30bdfhjsyr56a79d]]
2023/09/15 18:27:36.598237 tthttp.go:174: Server Response - Status Code 0 
2023/09/15 18:27:36.598653 tttmplts.go:32: PIXm Worker done
2023/09/15 18:27:36.598712 tttmplts.go:33: PIXm Worker Status Code 408
2023/09/15 18:27:36.737963 tthttp.go:174: Server Response - Status Code 404 
{"errors":[{"message":"No clients matching nhs number 9000000009","path":"\/"}],"status":404}
2023/09/15 18:27:36.742304 ttutil.go:140: 	{
  "data": {
    "client": {
      "basicDetails": {
        "address": {},
        "name": {}
      },
      "bbvInformation": {},
      "drugTestResults": {
        "results": {}
      },
      "riskInformation": {
        "mentalHealthDomain": {},
        "riskOfHarmToSelfDomain": {},
        "socialDomain": {},
        "substanceMisuseDomain": {}
      },
      "safeguardingInformation": {}
    },
    "keyWorker": {
      "name": {}
    }
  }
}
2023/09/15 18:27:36.742431 tttmplts.go:39: CGL Worker done
2023/09/15 18:27:36.742463 tttmplts.go:40: CGL Worker Status Code 404
2023/09/15 18:27:36.742714 tthttp.go:56: Creating PDS Search Request - Server URL https://sandbox.api.service.nhs.uk/personal-demographics/FHIR/R4/Patient/9000000009
2023/09/15 18:27:36.742840 tthttp.go:160: Request Headers 
map[Accept:[*/*] Content-Type:[application/json] X-Request-Id:[f43b1c0c-cce5-4384-a2ff-83f35614b33b]]
2023/09/15 18:27:36.926851 tthttp.go:174: Server Response - Status Code 200 
{"resourceType":"Patient","id":"9000000009","identifier":[{"system":"https://fhir.nhs.uk/Id/nhs-number","value":"9000000009","extension":[{"url":"https://fhir.hl7.org.uk/StructureDefinition/Extension-UKCore-NHSNumberVerificationStatus","valueCodeableConcept":{"coding":[{"system":"https://fhir.hl7.org.uk/CodeSystem/UKCore-NHSNumberVerificationStatus","version":"1.0.0","code":"01","display":"Number present and verified"}]}}]}],"meta":{"versionId":"2","security":[{"system":"http://terminology.hl7.org/CodeSystem/v3-Confidentiality","code":"U","display":"unrestricted"}]},"name":[{"id":"123","use":"usual","period":{"start":"2020-01-01","end":"2021-12-31"},"given":["Jane"],"family":"Smith","prefix":["Mrs"],"suffix":["MBE"]}],"gender":"female","birthDate":"2010-10-22","multipleBirthInteger":1,"deceasedDateTime":"2010-10-22T00:00:00+00:00","generalPractitioner":[{"id":"254406A3","type":"Organization","identifier":{"system":"https://fhir.nhs.uk/Id/ods-organization-code","value":"Y12345","period":{"start":"2020-01-01","end":"2021-12-31"}}}],"managingOrganization":{"type":"Organization","identifier":{"system":"https://fhir.nhs.uk/Id/ods-organization-code","value":"Y12345","period":{"start":"2020-01-01","end":"2021-12-31"}}},"extension":[{"url":"https://fhir.hl7.org.uk/StructureDefinition/Extension-UKCore-NominatedPharmacy","valueReference":{"identifier":{"system":"https://fhir.nhs.uk/Id/ods-organization-code","value":"Y12345"}}},{"url":"https://fhir.hl7.org.uk/StructureDefinition/Extension-UKCore-PreferredDispenserOrganization","valueReference":{"identifier":{"system":"https://fhir.nhs.uk/Id/ods-organization-code","value":"Y23456"}}},{"url":"https://fhir.hl7.org.uk/StructureDefinition/Extension-UKCore-MedicalApplianceSupplier","valueReference":{"identifier":{"system":"https://fhir.nhs.uk/Id/ods-organization-code","value":"Y34567"}}},{"url":"https://fhir.hl7.org.uk/StructureDefinition/Extension-UKCore-DeathNotificationStatus","extension":[{"url":"deathNotificationStatus","valueCodeableConcept":{"coding":[{"system":"https://fhir.hl7.org.uk/CodeSystem/UKCore-DeathNotificationStatus","version":"1.0.0","code":"2","display":"Formal - death notice received from Registrar of Deaths"}]}},{"url":"systemEffectiveDate","valueDateTime":"2010-10-22T00:00:00+00:00"}]},{"url":"https://fhir.hl7.org.uk/StructureDefinition/Extension-UKCore-NHSCommunication","extension":[{"url":"language","valueCodeableConcept":{"coding":[{"system":"https://fhir.hl7.org.uk/CodeSystem/UKCore-HumanLanguage","version":"1.0.0","code":"fr","display":"French"}]}},{"url":"interpreterRequired","valueBoolean":true}]},{"url":"https://fhir.hl7.org.uk/StructureDefinition/Extension-UKCore-ContactPreference","extension":[{"url":"PreferredWrittenCommunicationFormat","valueCodeableConcept":{"coding":[{"system":"https://fhir.hl7.org.uk/CodeSystem/UKCore-PreferredWrittenCommunicationFormat","code":"12","display":"Braille"}]}},{"url":"PreferredContactMethod","valueCodeableConcept":{"coding":[{"system":"https://fhir.hl7.org.uk/CodeSystem/UKCore-PreferredContactMethod","code":"1","display":"Letter"}]}},{"url":"PreferredContactTimes","valueString":"Not after 7pm"}]},{"url":"http://hl7.org/fhir/StructureDefinition/patient-birthPlace","valueAddress":{"city":"Manchester","district":"Greater Manchester","country":"GBR"}},{"url":"https://fhir.nhs.uk/StructureDefinition/Extension-PDS-RemovalFromRegistration","extension":[{"url":"removalFromRegistrationCode","valueCodeableConcept":{"coding":[{"system":"https://fhir.nhs.uk/CodeSystem/PDS-RemovalReasonExitCode","code":"SCT","display":"Transferred to Scotland"}]}},{"url":"effectiveTime","valuePeriod":{"start":"2020-01-01T00:00:00+00:00","end":"2021-12-31T00:00:00+00:00"}}]}],"telecom":[{"id":"789","period":{"start":"2020-01-01","end":"2021-12-31"},"system":"phone","value":"01632960587","use":"home"},{"id":"790","period":{"start":"2019-01-01","end":"2022-12-31"},"system":"email","value":"jane.smith@example.com","use":"home"},{"id":"OC789","period":{"start":"2020-01-01","end":"2021-12-31"},"system":"other","value":"01632960587","use":"home","extension":[{"url":"https://fhir.hl7.org.uk/StructureDefinition/Extension-UKCore-OtherContactSystem","valueCoding":{"system":"https://fhir.hl7.org.uk/CodeSystem/UKCore-OtherContactSystem","code":"textphone","display":"Minicom (Textphone)"}}]}],"contact":[{"id":"C123","period":{"start":"2020-01-01","end":"2021-12-31"},"relationship":[{"coding":[{"system":"http://terminology.hl7.org/CodeSystem/v2-0131","code":"C","display":"Emergency Contact"}]}],"telecom":[{"system":"phone","value":"01632960587"}]}],"address":[{"id":"456","period":{"start":"2020-01-01","end":"2021-12-31"},"use":"home","line":["1 Trevelyan Square","Boar Lane","City Centre","Leeds","West Yorkshire"],"postalCode":"LS1 6AE","extension":[{"url":"https://fhir.hl7.org.uk/StructureDefinition/Extension-UKCore-AddressKey","extension":[{"url":"type","valueCoding":{"system":"https://fhir.hl7.org.uk/CodeSystem/UKCore-AddressKeyType","code":"PAF"}},{"url":"value","valueString":"12345678"}]},{"url":"https://fhir.hl7.org.uk/StructureDefinition/Extension-UKCore-AddressKey","extension":[{"url":"type","valueCoding":{"system":"https://fhir.hl7.org.uk/CodeSystem/UKCore-AddressKeyType","code":"UPRN"}},{"url":"value","valueString":"123456789012"}]}]},{"id":"T456","period":{"start":"2020-01-01","end":"2021-12-31"},"use":"temp","text":"Student Accommodation","line":["1 Trevelyan Square","Boar Lane","City Centre","Leeds","West Yorkshire"],"postalCode":"LS1 6AE","extension":[{"url":"https://fhir.hl7.org.uk/StructureDefinition/Extension-UKCore-AddressKey","extension":[{"url":"type","valueCoding":{"system":"https://fhir.hl7.org.uk/CodeSystem/UKCore-AddressKeyType","code":"PAF"}},{"url":"value","valueString":"12345678"}]},{"url":"https://fhir.hl7.org.uk/StructureDefinition/Extension-UKCore-AddressKey","extension":[{"url":"type","valueCoding":{"system":"https://fhir.hl7.org.uk/CodeSystem/UKCore-AddressKeyType","code":"UPRN"}},{"url":"value","valueString":"123456789012"}]}]}]}
2023/09/15 18:27:37.115252 tttmplts.go:100: Caching 24 Templates
2023/09/15 18:27:37.127373 tttmplts.go:87: Processing Template allpatientSrvs_tmplt
2023/09/15 18:27:37.202176 ttproxy.go:149: Response Status Code 200
2023/09/15 18:28:39.496685 ttserver.go:52: ICB Workflow Service stopped
2023/09/15 18:28:41.379339 ttutil.go:133: -----------------------------------------------------------------------------------
2023/09/15 18:28:41.379867 ttdb.go:51: Opening DB Connection to mysql instance
User: root
Host: tuk.coil1nnpqdlr.eu-west-1.rds.amazonaws.com
Port: :3306
Name: tuk
Connect Timeout 2s
Read Timeout 5s
2023/09/15 18:28:41.380010 ttdb.go:54: Opened Database
2023/09/15 18:28:41.565118 ttdb.go:379: Persisting Template dsubcancel_tmplt
2023/09/15 18:28:41.627144 ttdb.go:385: Persisted Template dsubcancel_tmplt
2023/09/15 18:28:41.627213 ttdb.go:366: Persisted Template dsubcancel_tmplt.xml
2023/09/15 18:28:41.690881 ttdb.go:379: Persisting Template cgl_tmplt
2023/09/15 18:28:41.788379 ttdb.go:385: Persisted Template cgl_tmplt
2023/09/15 18:28:41.788403 ttdb.go:366: Persisted Template cgl_tmplt.html
2023/09/15 18:28:41.851454 ttdb.go:379: Persisting Template pdssearch_tmplt
2023/09/15 18:28:41.917188 ttdb.go:385: Persisted Template pdssearch_tmplt
2023/09/15 18:28:41.917222 ttdb.go:366: Persisted Template pdssearch_tmplt.html
2023/09/15 18:28:41.980223 ttdb.go:379: Persisting Template dsubsubscribe_tmplt
2023/09/15 18:28:42.042009 ttdb.go:385: Persisted Template dsubsubscribe_tmplt
2023/09/15 18:28:42.042059 ttdb.go:366: Persisted Template dsubsubscribe_tmplt.xml
2023/09/15 18:28:42.104681 ttdb.go:379: Persisting Template notification_tmplt
2023/09/15 18:28:42.167403 ttdb.go:385: Persisted Template notification_tmplt
2023/09/15 18:28:42.167492 ttdb.go:366: Persisted Template notification_tmplt.txt
2023/09/15 18:28:42.229410 ttdb.go:379: Persisting Template wfstate2t_tmplt
2023/09/15 18:28:42.350536 ttdb.go:385: Persisted Template wfstate2t_tmplt
2023/09/15 18:28:42.350609 ttdb.go:366: Persisted Template wfstate2t_tmplt.html
2023/09/15 18:28:42.414586 ttdb.go:379: Persisting Template publishfile2t_tmplt
2023/09/15 18:28:42.476997 ttdb.go:385: Persisted Template publishfile2t_tmplt
2023/09/15 18:28:42.477032 ttdb.go:366: Persisted Template publishfile2t_tmplt.html
2023/09/15 18:28:42.540622 ttdb.go:379: Persisting Template react_tmplt
2023/09/15 18:28:42.602994 ttdb.go:385: Persisted Template react_tmplt
2023/09/15 18:28:42.603098 ttdb.go:366: Persisted Template react_tmplt.html
2023/09/15 18:28:42.664110 ttdb.go:379: Persisting Template pdsretrieve_tmplt
2023/09/15 18:28:42.731541 ttdb.go:385: Persisted Template pdsretrieve_tmplt
2023/09/15 18:28:42.731595 ttdb.go:366: Persisted Template pdsretrieve_tmplt.html
2023/09/15 18:28:42.794990 ttdb.go:379: Persisting Template allpatientSrvs_tmplt
2023/09/15 18:28:42.857892 ttdb.go:385: Persisted Template allpatientSrvs_tmplt
2023/09/15 18:28:42.857941 ttdb.go:366: Persisted Template allpatientSrvs_tmplt.html
2023/09/15 18:28:42.920054 ttdb.go:379: Persisting Template spa2t_tmplt
2023/09/15 18:28:42.997116 ttdb.go:385: Persisted Template spa2t_tmplt
2023/09/15 18:28:42.997192 ttdb.go:366: Persisted Template spa2t_tmplt.html
2023/09/15 18:28:43.060805 ttdb.go:379: Persisting Template xdw2t_tmplt
2023/09/15 18:28:43.140598 ttdb.go:385: Persisted Template xdw2t_tmplt
2023/09/15 18:28:43.140768 ttdb.go:366: Persisted Template xdw2t_tmplt.html
2023/09/15 18:28:43.202656 ttdb.go:379: Persisting Template spaheader2t_tmplt
2023/09/15 18:28:43.273423 ttdb.go:385: Persisted Template spaheader2t_tmplt
2023/09/15 18:28:43.273567 ttdb.go:366: Persisted Template spaheader2t_tmplt.html
2023/09/15 18:28:43.338725 ttdb.go:379: Persisting Template pds_tmplt
2023/09/15 18:28:43.404591 ttdb.go:385: Persisted Template pds_tmplt
2023/09/15 18:28:43.404707 ttdb.go:366: Persisted Template pds_tmplt.html
2023/09/15 18:28:43.467346 ttdb.go:379: Persisting Template error_tmplt
2023/09/15 18:28:43.530903 ttdb.go:385: Persisted Template error_tmplt
2023/09/15 18:28:43.530935 ttdb.go:366: Persisted Template error_tmplt.html
2023/09/15 18:28:43.594522 ttdb.go:379: Persisting Template dsuback_tmplt
2023/09/15 18:28:43.659781 ttdb.go:385: Persisted Template dsuback_tmplt
2023/09/15 18:28:43.659944 ttdb.go:366: Persisted Template dsuback_tmplt.xml
2023/09/15 18:28:43.722832 ttdb.go:379: Persisting Template pixm_tmplt
2023/09/15 18:28:43.790962 ttdb.go:385: Persisted Template pixm_tmplt
2023/09/15 18:28:43.791121 ttdb.go:366: Persisted Template pixm_tmplt.html
2023/09/15 18:28:43.854600 ttdb.go:379: Persisting Template subscriptions2t_tmplt
2023/09/15 18:28:43.919714 ttdb.go:385: Persisted Template subscriptions2t_tmplt
2023/09/15 18:28:43.919868 ttdb.go:366: Persisted Template subscriptions2t_tmplt.html
2023/09/15 18:28:43.983185 ttdb.go:379: Persisting Template codemaps2t_tmplt
2023/09/15 18:28:44.056058 ttdb.go:385: Persisted Template codemaps2t_tmplt
2023/09/15 18:28:44.056206 ttdb.go:366: Persisted Template codemaps2t_tmplt.html
2023/09/15 18:28:44.119459 ttdb.go:379: Persisting Template mhdpublish_tmplt
2023/09/15 18:28:44.189423 ttdb.go:385: Persisted Template mhdpublish_tmplt
2023/09/15 18:28:44.189607 ttdb.go:366: Persisted Template mhdpublish_tmplt.json
2023/09/15 18:28:44.254015 ttdb.go:379: Persisting Template events_tmplt
2023/09/15 18:28:44.325837 ttdb.go:385: Persisted Template events_tmplt
2023/09/15 18:28:44.325990 ttdb.go:366: Persisted Template events_tmplt.html
2023/09/15 18:28:44.388975 ttdb.go:379: Persisting Template uploadfile2t_tmplt
2023/09/15 18:28:44.497499 ttdb.go:385: Persisted Template uploadfile2t_tmplt
2023/09/15 18:28:44.497637 ttdb.go:366: Persisted Template uploadfile2t_tmplt.html
2023/09/15 18:28:44.497901 ttserver.go:40: Starting ICB Workflow Service. Service Endpoint http://MacBook-Pro-3.lan:8080/
2023/09/15 18:28:47.686764 ttgethandler.go:10: Processing new GET Request
2023/09/15 18:28:47.687000 ttproxy.go:138: 	Request Query Params
2023/09/15 18:28:47.687690 ttutil.go:140: 	{
  "User": "ian.thomas",
  "Org": "2tsolutions",
  "Role": "clinical",
  "Nhs": "9000000009"
}
2023/09/15 18:28:47.687750 ttgethandler.go:15: Path = /beta/spa/consumer/patient
2023/09/15 18:28:47.687865 tttmplts.go:37: CGL Worker starting
2023/09/15 18:28:47.687865 tttmplts.go:30: PIXm Worker starting
2023/09/15 18:28:47.688975 tthttp.go:15: Creating PIXm PDQ - Server URL http://lac-demo-01.tianispirit.co.uk:8081/SpiritPIXFhir/r4/Patient?identifier=2.16.840.1.113883.2.1.4.1%7C9000000009
2023/09/15 18:28:47.691679 tthttp.go:160: Request Headers 
map[Content-Type:[application/json]]
2023/09/15 18:28:47.691715 tthttp.go:160: Request Headers 
map[Accept:[application/json] X-Api-Key:[FNhb#OhxWiEiMdf+@6085k5Zmt] X-Api-Secret:[9710ea0fb4ffb5d56c2e62c71c30bdfhjsyr56a79d]]
2023/09/15 18:28:47.729571 tthttp.go:174: Server Response - Status Code 0 
2023/09/15 18:28:47.730035 tttmplts.go:32: PIXm Worker done
2023/09/15 18:28:47.730117 tttmplts.go:33: PIXm Worker Status Code 408
2023/09/15 18:28:47.880854 tthttp.go:174: Server Response - Status Code 404 
{"errors":[{"message":"No clients matching nhs number 9000000009","path":"\/"}],"status":404}
2023/09/15 18:28:47.883791 ttutil.go:140: 	{
  "data": {
    "client": {
      "basicDetails": {
        "address": {},
        "name": {}
      },
      "bbvInformation": {},
      "drugTestResults": {
        "results": {}
      },
      "riskInformation": {
        "mentalHealthDomain": {},
        "riskOfHarmToSelfDomain": {},
        "socialDomain": {},
        "substanceMisuseDomain": {}
      },
      "safeguardingInformation": {}
    },
    "keyWorker": {
      "name": {}
    }
  }
}
2023/09/15 18:28:47.883878 tttmplts.go:39: CGL Worker done
2023/09/15 18:28:47.883907 tttmplts.go:40: CGL Worker Status Code 404
2023/09/15 18:28:47.884070 tthttp.go:56: Creating PDS Search Request - Server URL https://sandbox.api.service.nhs.uk/personal-demographics/FHIR/R4/Patient/9000000009
2023/09/15 18:28:47.884204 tthttp.go:160: Request Headers 
map[Accept:[*/*] Content-Type:[application/json] X-Request-Id:[15d68602-b759-490e-b19e-40d26523b5ee]]
2023/09/15 18:28:48.021182 tthttp.go:174: Server Response - Status Code 200 
{"resourceType":"Patient","id":"9000000009","identifier":[{"system":"https://fhir.nhs.uk/Id/nhs-number","value":"9000000009","extension":[{"url":"https://fhir.hl7.org.uk/StructureDefinition/Extension-UKCore-NHSNumberVerificationStatus","valueCodeableConcept":{"coding":[{"system":"https://fhir.hl7.org.uk/CodeSystem/UKCore-NHSNumberVerificationStatus","version":"1.0.0","code":"01","display":"Number present and verified"}]}}]}],"meta":{"versionId":"2","security":[{"system":"http://terminology.hl7.org/CodeSystem/v3-Confidentiality","code":"U","display":"unrestricted"}]},"name":[{"id":"123","use":"usual","period":{"start":"2020-01-01","end":"2021-12-31"},"given":["Jane"],"family":"Smith","prefix":["Mrs"],"suffix":["MBE"]}],"gender":"female","birthDate":"2010-10-22","multipleBirthInteger":1,"deceasedDateTime":"2010-10-22T00:00:00+00:00","generalPractitioner":[{"id":"254406A3","type":"Organization","identifier":{"system":"https://fhir.nhs.uk/Id/ods-organization-code","value":"Y12345","period":{"start":"2020-01-01","end":"2021-12-31"}}}],"managingOrganization":{"type":"Organization","identifier":{"system":"https://fhir.nhs.uk/Id/ods-organization-code","value":"Y12345","period":{"start":"2020-01-01","end":"2021-12-31"}}},"extension":[{"url":"https://fhir.hl7.org.uk/StructureDefinition/Extension-UKCore-NominatedPharmacy","valueReference":{"identifier":{"system":"https://fhir.nhs.uk/Id/ods-organization-code","value":"Y12345"}}},{"url":"https://fhir.hl7.org.uk/StructureDefinition/Extension-UKCore-PreferredDispenserOrganization","valueReference":{"identifier":{"system":"https://fhir.nhs.uk/Id/ods-organization-code","value":"Y23456"}}},{"url":"https://fhir.hl7.org.uk/StructureDefinition/Extension-UKCore-MedicalApplianceSupplier","valueReference":{"identifier":{"system":"https://fhir.nhs.uk/Id/ods-organization-code","value":"Y34567"}}},{"url":"https://fhir.hl7.org.uk/StructureDefinition/Extension-UKCore-DeathNotificationStatus","extension":[{"url":"deathNotificationStatus","valueCodeableConcept":{"coding":[{"system":"https://fhir.hl7.org.uk/CodeSystem/UKCore-DeathNotificationStatus","version":"1.0.0","code":"2","display":"Formal - death notice received from Registrar of Deaths"}]}},{"url":"systemEffectiveDate","valueDateTime":"2010-10-22T00:00:00+00:00"}]},{"url":"https://fhir.hl7.org.uk/StructureDefinition/Extension-UKCore-NHSCommunication","extension":[{"url":"language","valueCodeableConcept":{"coding":[{"system":"https://fhir.hl7.org.uk/CodeSystem/UKCore-HumanLanguage","version":"1.0.0","code":"fr","display":"French"}]}},{"url":"interpreterRequired","valueBoolean":true}]},{"url":"https://fhir.hl7.org.uk/StructureDefinition/Extension-UKCore-ContactPreference","extension":[{"url":"PreferredWrittenCommunicationFormat","valueCodeableConcept":{"coding":[{"system":"https://fhir.hl7.org.uk/CodeSystem/UKCore-PreferredWrittenCommunicationFormat","code":"12","display":"Braille"}]}},{"url":"PreferredContactMethod","valueCodeableConcept":{"coding":[{"system":"https://fhir.hl7.org.uk/CodeSystem/UKCore-PreferredContactMethod","code":"1","display":"Letter"}]}},{"url":"PreferredContactTimes","valueString":"Not after 7pm"}]},{"url":"http://hl7.org/fhir/StructureDefinition/patient-birthPlace","valueAddress":{"city":"Manchester","district":"Greater Manchester","country":"GBR"}},{"url":"https://fhir.nhs.uk/StructureDefinition/Extension-PDS-RemovalFromRegistration","extension":[{"url":"removalFromRegistrationCode","valueCodeableConcept":{"coding":[{"system":"https://fhir.nhs.uk/CodeSystem/PDS-RemovalReasonExitCode","code":"SCT","display":"Transferred to Scotland"}]}},{"url":"effectiveTime","valuePeriod":{"start":"2020-01-01T00:00:00+00:00","end":"2021-12-31T00:00:00+00:00"}}]}],"telecom":[{"id":"789","period":{"start":"2020-01-01","end":"2021-12-31"},"system":"phone","value":"01632960587","use":"home"},{"id":"790","period":{"start":"2019-01-01","end":"2022-12-31"},"system":"email","value":"jane.smith@example.com","use":"home"},{"id":"OC789","period":{"start":"2020-01-01","end":"2021-12-31"},"system":"other","value":"01632960587","use":"home","extension":[{"url":"https://fhir.hl7.org.uk/StructureDefinition/Extension-UKCore-OtherContactSystem","valueCoding":{"system":"https://fhir.hl7.org.uk/CodeSystem/UKCore-OtherContactSystem","code":"textphone","display":"Minicom (Textphone)"}}]}],"contact":[{"id":"C123","period":{"start":"2020-01-01","end":"2021-12-31"},"relationship":[{"coding":[{"system":"http://terminology.hl7.org/CodeSystem/v2-0131","code":"C","display":"Emergency Contact"}]}],"telecom":[{"system":"phone","value":"01632960587"}]}],"address":[{"id":"456","period":{"start":"2020-01-01","end":"2021-12-31"},"use":"home","line":["1 Trevelyan Square","Boar Lane","City Centre","Leeds","West Yorkshire"],"postalCode":"LS1 6AE","extension":[{"url":"https://fhir.hl7.org.uk/StructureDefinition/Extension-UKCore-AddressKey","extension":[{"url":"type","valueCoding":{"system":"https://fhir.hl7.org.uk/CodeSystem/UKCore-AddressKeyType","code":"PAF"}},{"url":"value","valueString":"12345678"}]},{"url":"https://fhir.hl7.org.uk/StructureDefinition/Extension-UKCore-AddressKey","extension":[{"url":"type","valueCoding":{"system":"https://fhir.hl7.org.uk/CodeSystem/UKCore-AddressKeyType","code":"UPRN"}},{"url":"value","valueString":"123456789012"}]}]},{"id":"T456","period":{"start":"2020-01-01","end":"2021-12-31"},"use":"temp","text":"Student Accommodation","line":["1 Trevelyan Square","Boar Lane","City Centre","Leeds","West Yorkshire"],"postalCode":"LS1 6AE","extension":[{"url":"https://fhir.hl7.org.uk/StructureDefinition/Extension-UKCore-AddressKey","extension":[{"url":"type","valueCoding":{"system":"https://fhir.hl7.org.uk/CodeSystem/UKCore-AddressKeyType","code":"PAF"}},{"url":"value","valueString":"12345678"}]},{"url":"https://fhir.hl7.org.uk/StructureDefinition/Extension-UKCore-AddressKey","extension":[{"url":"type","valueCoding":{"system":"https://fhir.hl7.org.uk/CodeSystem/UKCore-AddressKeyType","code":"UPRN"}},{"url":"value","valueString":"123456789012"}]}]}]}
2023/09/15 18:28:48.217157 tttmplts.go:100: Caching 24 Templates
2023/09/15 18:28:48.223310 tttmplts.go:87: Processing Template allpatientSrvs_tmplt
2023/09/15 18:28:48.290059 tttmplts.go:93: template: pdsretrieve_tmplt:179:72: executing "pdsretrieve_tmplt" at <ne>: wrong number of args for ne: want 2 got 0
2023/09/15 18:28:48.290264 ttproxy.go:105: template: pdsretrieve_tmplt:179:72: executing "pdsretrieve_tmplt" at <ne>: wrong number of args for ne: want 2 got 0
2023/09/15 18:28:48.290345 ttproxy.go:149: Response Status Code 500
2023/09/15 18:28:48.290363 ttproxy.go:151: 
2023/09/15 18:28:48.290375 ttproxy.go:152: Response Headers
2023/09/15 18:28:48.290607 ttutil.go:140: 	{
  "Access-Control-Allow-Origin": "*",
  "Content-Type": "",
  "Server": "Workflow Service"
}
2023/09/15 18:28:48.290638 ttproxy.go:154: ----------------
2023/09/15 18:28:48.290650 ttproxy.go:155: Response
2023/09/15 18:28:48.290660 ttproxy.go:156: ----------------
2023/09/15 18:28:48.290981 ttutil.go:140: 	{
  "Host": "MacBook-Pro-3.lan",
  "Path": "/beta/spa/consumer/patient",
  "Method": "GET",
  "SourceIP": "[::1]:57688",
  "ReqContentType": "",
  "RspContentType": "",
  "ResponseBody": "{\"resourceType\":\"Patient\",\"id\":\"9000000009\",\"identifier\":[{\"system\":\"https://fhir.nhs.uk/Id/nhs-number\",\"value\":\"9000000009\",\"extension\":[{\"url\":\"https://fhir.hl7.org.uk/StructureDefinition/Extension-UKCore-NHSNumberVerificationStatus\",\"valueCodeableConcept\":{\"coding\":[{\"system\":\"https://fhir.hl7.org.uk/CodeSystem/UKCore-NHSNumberVerificationStatus\",\"version\":\"1.0.0\",\"code\":\"01\",\"display\":\"Number present and verified\"}]}}]}],\"meta\":{\"versionId\":\"2\",\"security\":[{\"system\":\"http://terminology.hl7.org/CodeSystem/v3-Confidentiality\",\"code\":\"U\",\"display\":\"unrestricted\"}]},\"name\":[{\"id\":\"123\",\"use\":\"usual\",\"period\":{\"start\":\"2020-01-01\",\"end\":\"2021-12-31\"},\"given\":[\"Jane\"],\"family\":\"Smith\",\"prefix\":[\"Mrs\"],\"suffix\":[\"MBE\"]}],\"gender\":\"female\",\"birthDate\":\"2010-10-22\",\"multipleBirthInteger\":1,\"deceasedDateTime\":\"2010-10-22T00:00:00+00:00\",\"generalPractitioner\":[{\"id\":\"254406A3\",\"type\":\"Organization\",\"identifier\":{\"system\":\"https://fhir.nhs.uk/Id/ods-organization-code\",\"value\":\"Y12345\",\"period\":{\"start\":\"2020-01-01\",\"end\":\"2021-12-31\"}}}],\"managingOrganization\":{\"type\":\"Organization\",\"identifier\":{\"system\":\"https://fhir.nhs.uk/Id/ods-organization-code\",\"value\":\"Y12345\",\"period\":{\"start\":\"2020-01-01\",\"end\":\"2021-12-31\"}}},\"extension\":[{\"url\":\"https://fhir.hl7.org.uk/StructureDefinition/Extension-UKCore-NominatedPharmacy\",\"valueReference\":{\"identifier\":{\"system\":\"https://fhir.nhs.uk/Id/ods-organization-code\",\"value\":\"Y12345\"}}},{\"url\":\"https://fhir.hl7.org.uk/StructureDefinition/Extension-UKCore-PreferredDispenserOrganization\",\"valueReference\":{\"identifier\":{\"system\":\"https://fhir.nhs.uk/Id/ods-organization-code\",\"value\":\"Y23456\"}}},{\"url\":\"https://fhir.hl7.org.uk/StructureDefinition/Extension-UKCore-MedicalApplianceSupplier\",\"valueReference\":{\"identifier\":{\"system\":\"https://fhir.nhs.uk/Id/ods-organization-code\",\"value\":\"Y34567\"}}},{\"url\":\"https://fhir.hl7.org.uk/StructureDefinition/Extension-UKCore-DeathNotificationStatus\",\"extension\":[{\"url\":\"deathNotificationStatus\",\"valueCodeableConcept\":{\"coding\":[{\"system\":\"https://fhir.hl7.org.uk/CodeSystem/UKCore-DeathNotificationStatus\",\"version\":\"1.0.0\",\"code\":\"2\",\"display\":\"Formal - death notice received from Registrar of Deaths\"}]}},{\"url\":\"systemEffectiveDate\",\"valueDateTime\":\"2010-10-22T00:00:00+00:00\"}]},{\"url\":\"https://fhir.hl7.org.uk/StructureDefinition/Extension-UKCore-NHSCommunication\",\"extension\":[{\"url\":\"language\",\"valueCodeableConcept\":{\"coding\":[{\"system\":\"https://fhir.hl7.org.uk/CodeSystem/UKCore-HumanLanguage\",\"version\":\"1.0.0\",\"code\":\"fr\",\"display\":\"French\"}]}},{\"url\":\"interpreterRequired\",\"valueBoolean\":true}]},{\"url\":\"https://fhir.hl7.org.uk/StructureDefinition/Extension-UKCore-ContactPreference\",\"extension\":[{\"url\":\"PreferredWrittenCommunicationFormat\",\"valueCodeableConcept\":{\"coding\":[{\"system\":\"https://fhir.hl7.org.uk/CodeSystem/UKCore-PreferredWrittenCommunicationFormat\",\"code\":\"12\",\"display\":\"Braille\"}]}},{\"url\":\"PreferredContactMethod\",\"valueCodeableConcept\":{\"coding\":[{\"system\":\"https://fhir.hl7.org.uk/CodeSystem/UKCore-PreferredContactMethod\",\"code\":\"1\",\"display\":\"Letter\"}]}},{\"url\":\"PreferredContactTimes\",\"valueString\":\"Not after 7pm\"}]},{\"url\":\"http://hl7.org/fhir/StructureDefinition/patient-birthPlace\",\"valueAddress\":{\"city\":\"Manchester\",\"district\":\"Greater Manchester\",\"country\":\"GBR\"}},{\"url\":\"https://fhir.nhs.uk/StructureDefinition/Extension-PDS-RemovalFromRegistration\",\"extension\":[{\"url\":\"removalFromRegistrationCode\",\"valueCodeableConcept\":{\"coding\":[{\"system\":\"https://fhir.nhs.uk/CodeSystem/PDS-RemovalReasonExitCode\",\"code\":\"SCT\",\"display\":\"Transferred to Scotland\"}]}},{\"url\":\"effectiveTime\",\"valuePeriod\":{\"start\":\"2020-01-01T00:00:00+00:00\",\"end\":\"2021-12-31T00:00:00+00:00\"}}]}],\"telecom\":[{\"id\":\"789\",\"period\":{\"start\":\"2020-01-01\",\"end\":\"2021-12-31\"},\"system\":\"phone\",\"value\":\"01632960587\",\"use\":\"home\"},{\"id\":\"790\",\"period\":{\"start\":\"2019-01-01\",\"end\":\"2022-12-31\"},\"system\":\"email\",\"value\":\"jane.smith@example.com\",\"use\":\"home\"},{\"id\":\"OC789\",\"period\":{\"start\":\"2020-01-01\",\"end\":\"2021-12-31\"},\"system\":\"other\",\"value\":\"01632960587\",\"use\":\"home\",\"extension\":[{\"url\":\"https://fhir.hl7.org.uk/StructureDefinition/Extension-UKCore-OtherContactSystem\",\"valueCoding\":{\"system\":\"https://fhir.hl7.org.uk/CodeSystem/UKCore-OtherContactSystem\",\"code\":\"textphone\",\"display\":\"Minicom (Textphone)\"}}]}],\"contact\":[{\"id\":\"C123\",\"period\":{\"start\":\"2020-01-01\",\"end\":\"2021-12-31\"},\"relationship\":[{\"coding\":[{\"system\":\"http://terminology.hl7.org/CodeSystem/v2-0131\",\"code\":\"C\",\"display\":\"Emergency Contact\"}]}],\"telecom\":[{\"system\":\"phone\",\"value\":\"01632960587\"}]}],\"address\":[{\"id\":\"456\",\"period\":{\"start\":\"2020-01-01\",\"end\":\"2021-12-31\"},\"use\":\"home\",\"line\":[\"1 Trevelyan Square\",\"Boar Lane\",\"City Centre\",\"Leeds\",\"West Yorkshire\"],\"postalCode\":\"LS1 6AE\",\"extension\":[{\"url\":\"https://fhir.hl7.org.uk/StructureDefinition/Extension-UKCore-AddressKey\",\"extension\":[{\"url\":\"type\",\"valueCoding\":{\"system\":\"https://fhir.hl7.org.uk/CodeSystem/UKCore-AddressKeyType\",\"code\":\"PAF\"}},{\"url\":\"value\",\"valueString\":\"12345678\"}]},{\"url\":\"https://fhir.hl7.org.uk/StructureDefinition/Extension-UKCore-AddressKey\",\"extension\":[{\"url\":\"type\",\"valueCoding\":{\"system\":\"https://fhir.hl7.org.uk/CodeSystem/UKCore-AddressKeyType\",\"code\":\"UPRN\"}},{\"url\":\"value\",\"valueString\":\"123456789012\"}]}]},{\"id\":\"T456\",\"period\":{\"start\":\"2020-01-01\",\"end\":\"2021-12-31\"},\"use\":\"temp\",\"text\":\"Student Accommodation\",\"line\":[\"1 Trevelyan Square\",\"Boar Lane\",\"City Centre\",\"Leeds\",\"West Yorkshire\"],\"postalCode\":\"LS1 6AE\",\"extension\":[{\"url\":\"https://fhir.hl7.org.uk/StructureDefinition/Extension-UKCore-AddressKey\",\"extension\":[{\"url\":\"type\",\"valueCoding\":{\"system\":\"https://fhir.hl7.org.uk/CodeSystem/UKCore-AddressKeyType\",\"code\":\"PAF\"}},{\"url\":\"value\",\"valueString\":\"12345678\"}]},{\"url\":\"https://fhir.hl7.org.uk/StructureDefinition/Extension-UKCore-AddressKey\",\"extension\":[{\"url\":\"type\",\"valueCoding\":{\"system\":\"https://fhir.hl7.org.uk/CodeSystem/UKCore-AddressKeyType\",\"code\":\"UPRN\"}},{\"url\":\"value\",\"valueString\":\"123456789012\"}]}]}]}",
  "StatusCode": 500,
  "IsBase64": false,
  "Timeout": 0
}
2023/09/15 18:28:48.291012 ttproxy.go:158: -------------
2023/09/15 18:28:48.291028 ttproxy.go:160: Error template: pdsretrieve_tmplt:179:72: executing "pdsretrieve_tmplt" at <ne>: wrong number of args for ne: want 2 got 0
2023/09/15 18:28:48.291037 ttproxy.go:161: -------------
2023/09/15 18:29:45.913984 ttserver.go:52: ICB Workflow Service stopped
2023/09/15 18:29:47.545727 ttutil.go:133: -----------------------------------------------------------------------------------
2023/09/15 18:29:47.546240 ttdb.go:51: Opening DB Connection to mysql instance
User: root
Host: tuk.coil1nnpqdlr.eu-west-1.rds.amazonaws.com
Port: :3306
Name: tuk
Connect Timeout 2s
Read Timeout 5s
2023/09/15 18:29:47.546395 ttdb.go:54: Opened Database
2023/09/15 18:29:47.720257 ttdb.go:379: Persisting Template dsubcancel_tmplt
2023/09/15 18:29:47.784497 ttdb.go:385: Persisted Template dsubcancel_tmplt
2023/09/15 18:29:47.784545 ttdb.go:366: Persisted Template dsubcancel_tmplt.xml
2023/09/15 18:29:47.847358 ttdb.go:379: Persisting Template cgl_tmplt
2023/09/15 18:29:47.946658 ttdb.go:385: Persisted Template cgl_tmplt
2023/09/15 18:29:47.946682 ttdb.go:366: Persisted Template cgl_tmplt.html
2023/09/15 18:29:48.010209 ttdb.go:379: Persisting Template pdssearch_tmplt
2023/09/15 18:29:48.076056 ttdb.go:385: Persisted Template pdssearch_tmplt
2023/09/15 18:29:48.076146 ttdb.go:366: Persisted Template pdssearch_tmplt.html
2023/09/15 18:29:48.139082 ttdb.go:379: Persisting Template dsubsubscribe_tmplt
2023/09/15 18:29:48.201478 ttdb.go:385: Persisted Template dsubsubscribe_tmplt
2023/09/15 18:29:48.201573 ttdb.go:366: Persisted Template dsubsubscribe_tmplt.xml
2023/09/15 18:29:48.266356 ttdb.go:379: Persisting Template notification_tmplt
2023/09/15 18:29:48.329676 ttdb.go:385: Persisted Template notification_tmplt
2023/09/15 18:29:48.329782 ttdb.go:366: Persisted Template notification_tmplt.txt
2023/09/15 18:29:48.433292 ttdb.go:379: Persisting Template wfstate2t_tmplt
2023/09/15 18:29:48.628661 ttdb.go:385: Persisted Template wfstate2t_tmplt
2023/09/15 18:29:48.628839 ttdb.go:366: Persisted Template wfstate2t_tmplt.html
2023/09/15 18:29:48.748856 ttdb.go:379: Persisting Template publishfile2t_tmplt
2023/09/15 18:29:48.854852 ttdb.go:385: Persisted Template publishfile2t_tmplt
2023/09/15 18:29:48.855035 ttdb.go:366: Persisted Template publishfile2t_tmplt.html
2023/09/15 18:29:48.973778 ttdb.go:379: Persisting Template react_tmplt
2023/09/15 18:29:49.084811 ttdb.go:385: Persisted Template react_tmplt
2023/09/15 18:29:49.084850 ttdb.go:366: Persisted Template react_tmplt.html
2023/09/15 18:29:49.147738 ttdb.go:379: Persisting Template pdsretrieve_tmplt
2023/09/15 18:29:49.212100 ttdb.go:385: Persisted Template pdsretrieve_tmplt
2023/09/15 18:29:49.212125 ttdb.go:366: Persisted Template pdsretrieve_tmplt.html
2023/09/15 18:29:49.273371 ttdb.go:379: Persisting Template allpatientSrvs_tmplt
2023/09/15 18:29:49.335675 ttdb.go:385: Persisted Template allpatientSrvs_tmplt
2023/09/15 18:29:49.336583 ttdb.go:366: Persisted Template allpatientSrvs_tmplt.html
2023/09/15 18:29:49.399220 ttdb.go:379: Persisting Template spa2t_tmplt
2023/09/15 18:29:49.473857 ttdb.go:385: Persisted Template spa2t_tmplt
2023/09/15 18:29:49.473885 ttdb.go:366: Persisted Template spa2t_tmplt.html
2023/09/15 18:29:49.535366 ttdb.go:379: Persisting Template xdw2t_tmplt
2023/09/15 18:29:49.613512 ttdb.go:385: Persisted Template xdw2t_tmplt
2023/09/15 18:29:49.613608 ttdb.go:366: Persisted Template xdw2t_tmplt.html
2023/09/15 18:29:49.676145 ttdb.go:379: Persisting Template spaheader2t_tmplt
2023/09/15 18:29:49.745962 ttdb.go:385: Persisted Template spaheader2t_tmplt
2023/09/15 18:29:49.746151 ttdb.go:366: Persisted Template spaheader2t_tmplt.html
2023/09/15 18:29:49.809708 ttdb.go:379: Persisting Template pds_tmplt
2023/09/15 18:29:49.874423 ttdb.go:385: Persisted Template pds_tmplt
2023/09/15 18:29:49.874551 ttdb.go:366: Persisted Template pds_tmplt.html
2023/09/15 18:29:49.936595 ttdb.go:379: Persisting Template error_tmplt
2023/09/15 18:29:50.000838 ttdb.go:385: Persisted Template error_tmplt
2023/09/15 18:29:50.001050 ttdb.go:366: Persisted Template error_tmplt.html
2023/09/15 18:29:50.066268 ttdb.go:379: Persisting Template dsuback_tmplt
2023/09/15 18:29:50.129330 ttdb.go:385: Persisted Template dsuback_tmplt
2023/09/15 18:29:50.129482 ttdb.go:366: Persisted Template dsuback_tmplt.xml
2023/09/15 18:29:50.193739 ttdb.go:379: Persisting Template pixm_tmplt
2023/09/15 18:29:50.264192 ttdb.go:385: Persisted Template pixm_tmplt
2023/09/15 18:29:50.264330 ttdb.go:366: Persisted Template pixm_tmplt.html
2023/09/15 18:29:50.330488 ttdb.go:379: Persisting Template subscriptions2t_tmplt
2023/09/15 18:29:50.398161 ttdb.go:385: Persisted Template subscriptions2t_tmplt
2023/09/15 18:29:50.398308 ttdb.go:366: Persisted Template subscriptions2t_tmplt.html
2023/09/15 18:29:50.462071 ttdb.go:379: Persisting Template codemaps2t_tmplt
2023/09/15 18:29:50.529832 ttdb.go:385: Persisted Template codemaps2t_tmplt
2023/09/15 18:29:50.529990 ttdb.go:366: Persisted Template codemaps2t_tmplt.html
2023/09/15 18:29:50.593755 ttdb.go:379: Persisting Template mhdpublish_tmplt
2023/09/15 18:29:50.663610 ttdb.go:385: Persisted Template mhdpublish_tmplt
2023/09/15 18:29:50.663770 ttdb.go:366: Persisted Template mhdpublish_tmplt.json
2023/09/15 18:29:50.726310 ttdb.go:379: Persisting Template events_tmplt
2023/09/15 18:29:50.796881 ttdb.go:385: Persisted Template events_tmplt
2023/09/15 18:29:50.797027 ttdb.go:366: Persisted Template events_tmplt.html
2023/09/15 18:29:50.861022 ttdb.go:379: Persisting Template uploadfile2t_tmplt
2023/09/15 18:29:50.932114 ttdb.go:385: Persisted Template uploadfile2t_tmplt
2023/09/15 18:29:50.932305 ttdb.go:366: Persisted Template uploadfile2t_tmplt.html
2023/09/15 18:29:50.932601 ttserver.go:40: Starting ICB Workflow Service. Service Endpoint http://MacBook-Pro-3.lan:8080/
2023/09/15 18:29:54.141598 ttgethandler.go:10: Processing new GET Request
2023/09/15 18:29:54.141793 ttproxy.go:138: 	Request Query Params
2023/09/15 18:29:54.142166 ttutil.go:140: 	{
  "User": "ian.thomas",
  "Org": "2tsolutions",
  "Role": "clinical",
  "Nhs": "9000000009"
}
2023/09/15 18:29:54.142208 ttgethandler.go:15: Path = /beta/spa/consumer/patient
2023/09/15 18:29:54.142251 tttmplts.go:37: CGL Worker starting
2023/09/15 18:29:54.142245 tttmplts.go:30: PIXm Worker starting
2023/09/15 18:29:54.142409 tthttp.go:15: Creating PIXm PDQ - Server URL http://lac-demo-01.tianispirit.co.uk:8081/SpiritPIXFhir/r4/Patient?identifier=2.16.840.1.113883.2.1.4.1%7C9000000009
2023/09/15 18:29:54.143809 tthttp.go:160: Request Headers 
map[Content-Type:[application/json]]
2023/09/15 18:29:54.143886 tthttp.go:160: Request Headers 
map[Accept:[application/json] X-Api-Key:[FNhb#OhxWiEiMdf+@6085k5Zmt] X-Api-Secret:[9710ea0fb4ffb5d56c2e62c71c30bdfhjsyr56a79d]]
2023/09/15 18:29:54.184228 tthttp.go:174: Server Response - Status Code 0 
2023/09/15 18:29:54.184662 tttmplts.go:32: PIXm Worker done
2023/09/15 18:29:54.184733 tttmplts.go:33: PIXm Worker Status Code 408
2023/09/15 18:29:54.318143 tthttp.go:174: Server Response - Status Code 404 
{"errors":[{"message":"No clients matching nhs number 9000000009","path":"\/"}],"status":404}
2023/09/15 18:29:54.324414 ttutil.go:140: 	{
  "data": {
    "client": {
      "basicDetails": {
        "address": {},
        "name": {}
      },
      "bbvInformation": {},
      "drugTestResults": {
        "results": {}
      },
      "riskInformation": {
        "mentalHealthDomain": {},
        "riskOfHarmToSelfDomain": {},
        "socialDomain": {},
        "substanceMisuseDomain": {}
      },
      "safeguardingInformation": {}
    },
    "keyWorker": {
      "name": {}
    }
  }
}
2023/09/15 18:29:54.324603 tttmplts.go:39: CGL Worker done
2023/09/15 18:29:54.324646 tttmplts.go:40: CGL Worker Status Code 404
2023/09/15 18:29:54.324921 tthttp.go:56: Creating PDS Search Request - Server URL https://sandbox.api.service.nhs.uk/personal-demographics/FHIR/R4/Patient/9000000009
2023/09/15 18:29:54.325077 tthttp.go:160: Request Headers 
map[Accept:[*/*] Content-Type:[application/json] X-Request-Id:[b11091ed-7eef-41bc-afa0-0ba99cbb3172]]
2023/09/15 18:29:54.471562 tthttp.go:174: Server Response - Status Code 200 
{"resourceType":"Patient","id":"9000000009","identifier":[{"system":"https://fhir.nhs.uk/Id/nhs-number","value":"9000000009","extension":[{"url":"https://fhir.hl7.org.uk/StructureDefinition/Extension-UKCore-NHSNumberVerificationStatus","valueCodeableConcept":{"coding":[{"system":"https://fhir.hl7.org.uk/CodeSystem/UKCore-NHSNumberVerificationStatus","version":"1.0.0","code":"01","display":"Number present and verified"}]}}]}],"meta":{"versionId":"2","security":[{"system":"http://terminology.hl7.org/CodeSystem/v3-Confidentiality","code":"U","display":"unrestricted"}]},"name":[{"id":"123","use":"usual","period":{"start":"2020-01-01","end":"2021-12-31"},"given":["Jane"],"family":"Smith","prefix":["Mrs"],"suffix":["MBE"]}],"gender":"female","birthDate":"2010-10-22","multipleBirthInteger":1,"deceasedDateTime":"2010-10-22T00:00:00+00:00","generalPractitioner":[{"id":"254406A3","type":"Organization","identifier":{"system":"https://fhir.nhs.uk/Id/ods-organization-code","value":"Y12345","period":{"start":"2020-01-01","end":"2021-12-31"}}}],"managingOrganization":{"type":"Organization","identifier":{"system":"https://fhir.nhs.uk/Id/ods-organization-code","value":"Y12345","period":{"start":"2020-01-01","end":"2021-12-31"}}},"extension":[{"url":"https://fhir.hl7.org.uk/StructureDefinition/Extension-UKCore-NominatedPharmacy","valueReference":{"identifier":{"system":"https://fhir.nhs.uk/Id/ods-organization-code","value":"Y12345"}}},{"url":"https://fhir.hl7.org.uk/StructureDefinition/Extension-UKCore-PreferredDispenserOrganization","valueReference":{"identifier":{"system":"https://fhir.nhs.uk/Id/ods-organization-code","value":"Y23456"}}},{"url":"https://fhir.hl7.org.uk/StructureDefinition/Extension-UKCore-MedicalApplianceSupplier","valueReference":{"identifier":{"system":"https://fhir.nhs.uk/Id/ods-organization-code","value":"Y34567"}}},{"url":"https://fhir.hl7.org.uk/StructureDefinition/Extension-UKCore-DeathNotificationStatus","extension":[{"url":"deathNotificationStatus","valueCodeableConcept":{"coding":[{"system":"https://fhir.hl7.org.uk/CodeSystem/UKCore-DeathNotificationStatus","version":"1.0.0","code":"2","display":"Formal - death notice received from Registrar of Deaths"}]}},{"url":"systemEffectiveDate","valueDateTime":"2010-10-22T00:00:00+00:00"}]},{"url":"https://fhir.hl7.org.uk/StructureDefinition/Extension-UKCore-NHSCommunication","extension":[{"url":"language","valueCodeableConcept":{"coding":[{"system":"https://fhir.hl7.org.uk/CodeSystem/UKCore-HumanLanguage","version":"1.0.0","code":"fr","display":"French"}]}},{"url":"interpreterRequired","valueBoolean":true}]},{"url":"https://fhir.hl7.org.uk/StructureDefinition/Extension-UKCore-ContactPreference","extension":[{"url":"PreferredWrittenCommunicationFormat","valueCodeableConcept":{"coding":[{"system":"https://fhir.hl7.org.uk/CodeSystem/UKCore-PreferredWrittenCommunicationFormat","code":"12","display":"Braille"}]}},{"url":"PreferredContactMethod","valueCodeableConcept":{"coding":[{"system":"https://fhir.hl7.org.uk/CodeSystem/UKCore-PreferredContactMethod","code":"1","display":"Letter"}]}},{"url":"PreferredContactTimes","valueString":"Not after 7pm"}]},{"url":"http://hl7.org/fhir/StructureDefinition/patient-birthPlace","valueAddress":{"city":"Manchester","district":"Greater Manchester","country":"GBR"}},{"url":"https://fhir.nhs.uk/StructureDefinition/Extension-PDS-RemovalFromRegistration","extension":[{"url":"removalFromRegistrationCode","valueCodeableConcept":{"coding":[{"system":"https://fhir.nhs.uk/CodeSystem/PDS-RemovalReasonExitCode","code":"SCT","display":"Transferred to Scotland"}]}},{"url":"effectiveTime","valuePeriod":{"start":"2020-01-01T00:00:00+00:00","end":"2021-12-31T00:00:00+00:00"}}]}],"telecom":[{"id":"789","period":{"start":"2020-01-01","end":"2021-12-31"},"system":"phone","value":"01632960587","use":"home"},{"id":"790","period":{"start":"2019-01-01","end":"2022-12-31"},"system":"email","value":"jane.smith@example.com","use":"home"},{"id":"OC789","period":{"start":"2020-01-01","end":"2021-12-31"},"system":"other","value":"01632960587","use":"home","extension":[{"url":"https://fhir.hl7.org.uk/StructureDefinition/Extension-UKCore-OtherContactSystem","valueCoding":{"system":"https://fhir.hl7.org.uk/CodeSystem/UKCore-OtherContactSystem","code":"textphone","display":"Minicom (Textphone)"}}]}],"contact":[{"id":"C123","period":{"start":"2020-01-01","end":"2021-12-31"},"relationship":[{"coding":[{"system":"http://terminology.hl7.org/CodeSystem/v2-0131","code":"C","display":"Emergency Contact"}]}],"telecom":[{"system":"phone","value":"01632960587"}]}],"address":[{"id":"456","period":{"start":"2020-01-01","end":"2021-12-31"},"use":"home","line":["1 Trevelyan Square","Boar Lane","City Centre","Leeds","West Yorkshire"],"postalCode":"LS1 6AE","extension":[{"url":"https://fhir.hl7.org.uk/StructureDefinition/Extension-UKCore-AddressKey","extension":[{"url":"type","valueCoding":{"system":"https://fhir.hl7.org.uk/CodeSystem/UKCore-AddressKeyType","code":"PAF"}},{"url":"value","valueString":"12345678"}]},{"url":"https://fhir.hl7.org.uk/StructureDefinition/Extension-UKCore-AddressKey","extension":[{"url":"type","valueCoding":{"system":"https://fhir.hl7.org.uk/CodeSystem/UKCore-AddressKeyType","code":"UPRN"}},{"url":"value","valueString":"123456789012"}]}]},{"id":"T456","period":{"start":"2020-01-01","end":"2021-12-31"},"use":"temp","text":"Student Accommodation","line":["1 Trevelyan Square","Boar Lane","City Centre","Leeds","West Yorkshire"],"postalCode":"LS1 6AE","extension":[{"url":"https://fhir.hl7.org.uk/StructureDefinition/Extension-UKCore-AddressKey","extension":[{"url":"type","valueCoding":{"system":"https://fhir.hl7.org.uk/CodeSystem/UKCore-AddressKeyType","code":"PAF"}},{"url":"value","valueString":"12345678"}]},{"url":"https://fhir.hl7.org.uk/StructureDefinition/Extension-UKCore-AddressKey","extension":[{"url":"type","valueCoding":{"system":"https://fhir.hl7.org.uk/CodeSystem/UKCore-AddressKeyType","code":"UPRN"}},{"url":"value","valueString":"123456789012"}]}]}]}
2023/09/15 18:29:54.667973 tttmplts.go:100: Caching 24 Templates
2023/09/15 18:29:54.677109 tttmplts.go:87: Processing Template allpatientSrvs_tmplt
2023/09/15 18:29:54.750857 ttproxy.go:149: Response Status Code 200
2023/09/15 18:31:17.709667 ttserver.go:52: ICB Workflow Service stopped
2023/09/15 18:31:20.609475 ttutil.go:133: -----------------------------------------------------------------------------------
2023/09/15 18:31:20.609940 ttdb.go:51: Opening DB Connection to mysql instance
User: root
Host: tuk.coil1nnpqdlr.eu-west-1.rds.amazonaws.com
Port: :3306
Name: tuk
Connect Timeout 2s
Read Timeout 5s
2023/09/15 18:31:20.610065 ttdb.go:54: Opened Database
2023/09/15 18:31:20.786399 ttdb.go:379: Persisting Template dsubcancel_tmplt
2023/09/15 18:31:20.850211 ttdb.go:385: Persisted Template dsubcancel_tmplt
2023/09/15 18:31:20.850274 ttdb.go:366: Persisted Template dsubcancel_tmplt.xml
2023/09/15 18:31:20.915395 ttdb.go:379: Persisting Template cgl_tmplt
2023/09/15 18:31:21.013083 ttdb.go:385: Persisted Template cgl_tmplt
2023/09/15 18:31:21.013116 ttdb.go:366: Persisted Template cgl_tmplt.html
2023/09/15 18:31:21.077461 ttdb.go:379: Persisting Template pdssearch_tmplt
2023/09/15 18:31:21.143455 ttdb.go:385: Persisted Template pdssearch_tmplt
2023/09/15 18:31:21.143475 ttdb.go:366: Persisted Template pdssearch_tmplt.html
2023/09/15 18:31:21.207473 ttdb.go:379: Persisting Template dsubsubscribe_tmplt
2023/09/15 18:31:21.272403 ttdb.go:385: Persisted Template dsubsubscribe_tmplt
2023/09/15 18:31:21.272427 ttdb.go:366: Persisted Template dsubsubscribe_tmplt.xml
2023/09/15 18:31:21.336680 ttdb.go:379: Persisting Template notification_tmplt
2023/09/15 18:31:21.399159 ttdb.go:385: Persisted Template notification_tmplt
2023/09/15 18:31:21.399195 ttdb.go:366: Persisted Template notification_tmplt.txt
2023/09/15 18:31:21.462118 ttdb.go:379: Persisting Template wfstate2t_tmplt
2023/09/15 18:31:21.581252 ttdb.go:385: Persisted Template wfstate2t_tmplt
2023/09/15 18:31:21.581376 ttdb.go:366: Persisted Template wfstate2t_tmplt.html
2023/09/15 18:31:21.644124 ttdb.go:379: Persisting Template publishfile2t_tmplt
2023/09/15 18:31:21.708525 ttdb.go:385: Persisted Template publishfile2t_tmplt
2023/09/15 18:31:21.708610 ttdb.go:366: Persisted Template publishfile2t_tmplt.html
2023/09/15 18:31:21.771330 ttdb.go:379: Persisting Template react_tmplt
2023/09/15 18:31:21.834553 ttdb.go:385: Persisted Template react_tmplt
2023/09/15 18:31:21.834672 ttdb.go:366: Persisted Template react_tmplt.html
2023/09/15 18:31:21.897569 ttdb.go:379: Persisting Template pdsretrieve_tmplt
2023/09/15 18:31:21.966343 ttdb.go:385: Persisted Template pdsretrieve_tmplt
2023/09/15 18:31:21.966477 ttdb.go:366: Persisted Template pdsretrieve_tmplt.html
2023/09/15 18:31:22.033814 ttdb.go:379: Persisting Template allpatientSrvs_tmplt
2023/09/15 18:31:22.099049 ttdb.go:385: Persisted Template allpatientSrvs_tmplt
2023/09/15 18:31:22.099184 ttdb.go:366: Persisted Template allpatientSrvs_tmplt.html
2023/09/15 18:31:22.163619 ttdb.go:379: Persisting Template spa2t_tmplt
2023/09/15 18:31:22.240235 ttdb.go:385: Persisted Template spa2t_tmplt
2023/09/15 18:31:22.240301 ttdb.go:366: Persisted Template spa2t_tmplt.html
2023/09/15 18:31:22.303609 ttdb.go:379: Persisting Template xdw2t_tmplt
2023/09/15 18:31:22.382042 ttdb.go:385: Persisted Template xdw2t_tmplt
2023/09/15 18:31:22.382122 ttdb.go:366: Persisted Template xdw2t_tmplt.html
2023/09/15 18:31:22.447139 ttdb.go:379: Persisting Template spaheader2t_tmplt
2023/09/15 18:31:22.515807 ttdb.go:385: Persisted Template spaheader2t_tmplt
2023/09/15 18:31:22.516064 ttdb.go:366: Persisted Template spaheader2t_tmplt.html
2023/09/15 18:31:22.581059 ttdb.go:379: Persisting Template pds_tmplt
2023/09/15 18:31:22.645094 ttdb.go:385: Persisted Template pds_tmplt
2023/09/15 18:31:22.645272 ttdb.go:366: Persisted Template pds_tmplt.html
2023/09/15 18:31:22.709683 ttdb.go:379: Persisting Template error_tmplt
2023/09/15 18:31:22.772215 ttdb.go:385: Persisted Template error_tmplt
2023/09/15 18:31:22.772361 ttdb.go:366: Persisted Template error_tmplt.html
2023/09/15 18:31:22.835795 ttdb.go:379: Persisting Template dsuback_tmplt
2023/09/15 18:31:22.908905 ttdb.go:385: Persisted Template dsuback_tmplt
2023/09/15 18:31:22.909084 ttdb.go:366: Persisted Template dsuback_tmplt.xml
2023/09/15 18:31:22.972501 ttdb.go:379: Persisting Template pixm_tmplt
2023/09/15 18:31:23.042576 ttdb.go:385: Persisted Template pixm_tmplt
2023/09/15 18:31:23.042956 ttdb.go:366: Persisted Template pixm_tmplt.html
2023/09/15 18:31:23.108134 ttdb.go:379: Persisting Template subscriptions2t_tmplt
2023/09/15 18:31:23.175797 ttdb.go:385: Persisted Template subscriptions2t_tmplt
2023/09/15 18:31:23.175970 ttdb.go:366: Persisted Template subscriptions2t_tmplt.html
2023/09/15 18:31:23.239582 ttdb.go:379: Persisting Template codemaps2t_tmplt
2023/09/15 18:31:23.307628 ttdb.go:385: Persisted Template codemaps2t_tmplt
2023/09/15 18:31:23.307663 ttdb.go:366: Persisted Template codemaps2t_tmplt.html
2023/09/15 18:31:23.369492 ttdb.go:379: Persisting Template mhdpublish_tmplt
2023/09/15 18:31:23.438534 ttdb.go:385: Persisted Template mhdpublish_tmplt
2023/09/15 18:31:23.438647 ttdb.go:366: Persisted Template mhdpublish_tmplt.json
2023/09/15 18:31:23.501705 ttdb.go:379: Persisting Template events_tmplt
2023/09/15 18:31:23.569709 ttdb.go:385: Persisted Template events_tmplt
2023/09/15 18:31:23.569783 ttdb.go:366: Persisted Template events_tmplt.html
2023/09/15 18:31:23.632776 ttdb.go:379: Persisting Template uploadfile2t_tmplt
2023/09/15 18:31:23.696829 ttdb.go:385: Persisted Template uploadfile2t_tmplt
2023/09/15 18:31:23.696981 ttdb.go:366: Persisted Template uploadfile2t_tmplt.html
2023/09/15 18:31:23.697252 ttserver.go:40: Starting ICB Workflow Service. Service Endpoint http://MacBook-Pro-3.lan:8080/
2023/09/15 18:31:27.463929 ttgethandler.go:10: Processing new GET Request
2023/09/15 18:31:27.464136 ttproxy.go:138: 	Request Query Params
2023/09/15 18:31:27.464575 ttutil.go:140: 	{
  "User": "ian.thomas",
  "Org": "2tsolutions",
  "Role": "clinical",
  "Nhs": "9000000009"
}
2023/09/15 18:31:27.464632 ttgethandler.go:15: Path = /beta/spa/consumer/patient
2023/09/15 18:31:27.464703 tttmplts.go:37: CGL Worker starting
2023/09/15 18:31:27.464703 tttmplts.go:30: PIXm Worker starting
2023/09/15 18:31:27.465529 tthttp.go:15: Creating PIXm PDQ - Server URL http://lac-demo-01.tianispirit.co.uk:8081/SpiritPIXFhir/r4/Patient?identifier=2.16.840.1.113883.2.1.4.1%7C9000000009
2023/09/15 18:31:27.468641 tthttp.go:160: Request Headers 
map[Content-Type:[application/json]]
2023/09/15 18:31:27.468804 tthttp.go:160: Request Headers 
map[Accept:[application/json] X-Api-Key:[FNhb#OhxWiEiMdf+@6085k5Zmt] X-Api-Secret:[9710ea0fb4ffb5d56c2e62c71c30bdfhjsyr56a79d]]
2023/09/15 18:31:27.738433 tthttp.go:174: Server Response - Status Code 0 
2023/09/15 18:31:27.739086 tttmplts.go:32: PIXm Worker done
2023/09/15 18:31:27.739165 tttmplts.go:33: PIXm Worker Status Code 408
2023/09/15 18:31:27.991298 tthttp.go:174: Server Response - Status Code 404 
{"errors":[{"message":"No clients matching nhs number 9000000009","path":"\/"}],"status":404}
2023/09/15 18:31:27.993853 ttutil.go:140: 	{
  "data": {
    "client": {
      "basicDetails": {
        "address": {},
        "name": {}
      },
      "bbvInformation": {},
      "drugTestResults": {
        "results": {}
      },
      "riskInformation": {
        "mentalHealthDomain": {},
        "riskOfHarmToSelfDomain": {},
        "socialDomain": {},
        "substanceMisuseDomain": {}
      },
      "safeguardingInformation": {}
    },
    "keyWorker": {
      "name": {}
    }
  }
}
2023/09/15 18:31:27.993924 tttmplts.go:39: CGL Worker done
2023/09/15 18:31:27.993947 tttmplts.go:40: CGL Worker Status Code 404
2023/09/15 18:31:27.994091 tthttp.go:56: Creating PDS Search Request - Server URL https://sandbox.api.service.nhs.uk/personal-demographics/FHIR/R4/Patient/9000000009
2023/09/15 18:31:27.994167 tthttp.go:160: Request Headers 
map[Accept:[*/*] Content-Type:[application/json] X-Request-Id:[a427ec7e-d6e5-449f-9509-71ef86f241c9]]
2023/09/15 18:31:28.264475 tthttp.go:174: Server Response - Status Code 200 
{"resourceType":"Patient","id":"9000000009","identifier":[{"system":"https://fhir.nhs.uk/Id/nhs-number","value":"9000000009","extension":[{"url":"https://fhir.hl7.org.uk/StructureDefinition/Extension-UKCore-NHSNumberVerificationStatus","valueCodeableConcept":{"coding":[{"system":"https://fhir.hl7.org.uk/CodeSystem/UKCore-NHSNumberVerificationStatus","version":"1.0.0","code":"01","display":"Number present and verified"}]}}]}],"meta":{"versionId":"2","security":[{"system":"http://terminology.hl7.org/CodeSystem/v3-Confidentiality","code":"U","display":"unrestricted"}]},"name":[{"id":"123","use":"usual","period":{"start":"2020-01-01","end":"2021-12-31"},"given":["Jane"],"family":"Smith","prefix":["Mrs"],"suffix":["MBE"]}],"gender":"female","birthDate":"2010-10-22","multipleBirthInteger":1,"deceasedDateTime":"2010-10-22T00:00:00+00:00","generalPractitioner":[{"id":"254406A3","type":"Organization","identifier":{"system":"https://fhir.nhs.uk/Id/ods-organization-code","value":"Y12345","period":{"start":"2020-01-01","end":"2021-12-31"}}}],"managingOrganization":{"type":"Organization","identifier":{"system":"https://fhir.nhs.uk/Id/ods-organization-code","value":"Y12345","period":{"start":"2020-01-01","end":"2021-12-31"}}},"extension":[{"url":"https://fhir.hl7.org.uk/StructureDefinition/Extension-UKCore-NominatedPharmacy","valueReference":{"identifier":{"system":"https://fhir.nhs.uk/Id/ods-organization-code","value":"Y12345"}}},{"url":"https://fhir.hl7.org.uk/StructureDefinition/Extension-UKCore-PreferredDispenserOrganization","valueReference":{"identifier":{"system":"https://fhir.nhs.uk/Id/ods-organization-code","value":"Y23456"}}},{"url":"https://fhir.hl7.org.uk/StructureDefinition/Extension-UKCore-MedicalApplianceSupplier","valueReference":{"identifier":{"system":"https://fhir.nhs.uk/Id/ods-organization-code","value":"Y34567"}}},{"url":"https://fhir.hl7.org.uk/StructureDefinition/Extension-UKCore-DeathNotificationStatus","extension":[{"url":"deathNotificationStatus","valueCodeableConcept":{"coding":[{"system":"https://fhir.hl7.org.uk/CodeSystem/UKCore-DeathNotificationStatus","version":"1.0.0","code":"2","display":"Formal - death notice received from Registrar of Deaths"}]}},{"url":"systemEffectiveDate","valueDateTime":"2010-10-22T00:00:00+00:00"}]},{"url":"https://fhir.hl7.org.uk/StructureDefinition/Extension-UKCore-NHSCommunication","extension":[{"url":"language","valueCodeableConcept":{"coding":[{"system":"https://fhir.hl7.org.uk/CodeSystem/UKCore-HumanLanguage","version":"1.0.0","code":"fr","display":"French"}]}},{"url":"interpreterRequired","valueBoolean":true}]},{"url":"https://fhir.hl7.org.uk/StructureDefinition/Extension-UKCore-ContactPreference","extension":[{"url":"PreferredWrittenCommunicationFormat","valueCodeableConcept":{"coding":[{"system":"https://fhir.hl7.org.uk/CodeSystem/UKCore-PreferredWrittenCommunicationFormat","code":"12","display":"Braille"}]}},{"url":"PreferredContactMethod","valueCodeableConcept":{"coding":[{"system":"https://fhir.hl7.org.uk/CodeSystem/UKCore-PreferredContactMethod","code":"1","display":"Letter"}]}},{"url":"PreferredContactTimes","valueString":"Not after 7pm"}]},{"url":"http://hl7.org/fhir/StructureDefinition/patient-birthPlace","valueAddress":{"city":"Manchester","district":"Greater Manchester","country":"GBR"}},{"url":"https://fhir.nhs.uk/StructureDefinition/Extension-PDS-RemovalFromRegistration","extension":[{"url":"removalFromRegistrationCode","valueCodeableConcept":{"coding":[{"system":"https://fhir.nhs.uk/CodeSystem/PDS-RemovalReasonExitCode","code":"SCT","display":"Transferred to Scotland"}]}},{"url":"effectiveTime","valuePeriod":{"start":"2020-01-01T00:00:00+00:00","end":"2021-12-31T00:00:00+00:00"}}]}],"telecom":[{"id":"789","period":{"start":"2020-01-01","end":"2021-12-31"},"system":"phone","value":"01632960587","use":"home"},{"id":"790","period":{"start":"2019-01-01","end":"2022-12-31"},"system":"email","value":"jane.smith@example.com","use":"home"},{"id":"OC789","period":{"start":"2020-01-01","end":"2021-12-31"},"system":"other","value":"01632960587","use":"home","extension":[{"url":"https://fhir.hl7.org.uk/StructureDefinition/Extension-UKCore-OtherContactSystem","valueCoding":{"system":"https://fhir.hl7.org.uk/CodeSystem/UKCore-OtherContactSystem","code":"textphone","display":"Minicom (Textphone)"}}]}],"contact":[{"id":"C123","period":{"start":"2020-01-01","end":"2021-12-31"},"relationship":[{"coding":[{"system":"http://terminology.hl7.org/CodeSystem/v2-0131","code":"C","display":"Emergency Contact"}]}],"telecom":[{"system":"phone","value":"01632960587"}]}],"address":[{"id":"456","period":{"start":"2020-01-01","end":"2021-12-31"},"use":"home","line":["1 Trevelyan Square","Boar Lane","City Centre","Leeds","West Yorkshire"],"postalCode":"LS1 6AE","extension":[{"url":"https://fhir.hl7.org.uk/StructureDefinition/Extension-UKCore-AddressKey","extension":[{"url":"type","valueCoding":{"system":"https://fhir.hl7.org.uk/CodeSystem/UKCore-AddressKeyType","code":"PAF"}},{"url":"value","valueString":"12345678"}]},{"url":"https://fhir.hl7.org.uk/StructureDefinition/Extension-UKCore-AddressKey","extension":[{"url":"type","valueCoding":{"system":"https://fhir.hl7.org.uk/CodeSystem/UKCore-AddressKeyType","code":"UPRN"}},{"url":"value","valueString":"123456789012"}]}]},{"id":"T456","period":{"start":"2020-01-01","end":"2021-12-31"},"use":"temp","text":"Student Accommodation","line":["1 Trevelyan Square","Boar Lane","City Centre","Leeds","West Yorkshire"],"postalCode":"LS1 6AE","extension":[{"url":"https://fhir.hl7.org.uk/StructureDefinition/Extension-UKCore-AddressKey","extension":[{"url":"type","valueCoding":{"system":"https://fhir.hl7.org.uk/CodeSystem/UKCore-AddressKeyType","code":"PAF"}},{"url":"value","valueString":"12345678"}]},{"url":"https://fhir.hl7.org.uk/StructureDefinition/Extension-UKCore-AddressKey","extension":[{"url":"type","valueCoding":{"system":"https://fhir.hl7.org.uk/CodeSystem/UKCore-AddressKeyType","code":"UPRN"}},{"url":"value","valueString":"123456789012"}]}]}]}
2023/09/15 18:31:28.453407 tttmplts.go:100: Caching 24 Templates
2023/09/15 18:31:28.459127 tttmplts.go:87: Processing Template allpatientSrvs_tmplt
2023/09/15 18:31:28.527641 ttproxy.go:149: Response Status Code 200
2023/09/15 19:00:26.697361 ttserver.go:52: ICB Workflow Service stopped
